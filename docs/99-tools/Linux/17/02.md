---
title: 
sidebarDepth: 0 
category: Tools 
tag: Linux
---
# é€šè¿‡ systemctl ç®¡ç†æœåŠ¡

åŸºæœ¬é‚£ä¸ªï¼Œsystemd å¯åŠ¨æœåŠ¡çš„æœºåˆ¶ï¼Œä¸»è¦æ˜¯é€šè¿‡ systemctl æŒ‡ä»¤æ¥å¤„ç†ã€‚

è€Œä»¥å‰çš„ systemV éœ€è¦ serviceã€chkconfigã€setupã€init ç­‰æŒ‡ä»¤æ¥å®Œæˆã€‚

## ğŸ€ ç®¡ç†å•ä¸€æœåŠ¡ service unit çš„å¯åŠ¨ã€å¼€æœºå¯åŠ¨ä¸è§‚å¯ŸçŠ¶æ€

```bash
systemctl [command] [unit]

commond ä¸»è¦æœ‰ï¼š
	startï¼š ç«‹åˆ»å¯åŠ¨åé¢çš„ unit
	stopï¼šç«‹åˆ»å…³é—­åé¢çš„ unit
	restartï¼šç«‹åˆ»å…³é—­åå¯åŠ¨åé¢çš„ unit
	reloadï¼šä¸å…³é—­åé¢çš„ unit çš„æƒ…å†µä¸‹ï¼Œé‡è½½é…ç½®æ–‡ä»¶ï¼Œè®©è®¾ç½®ç”Ÿæ•ˆ
	enableï¼šè®¾ç½®å¼€æœºå¯åŠ¨
	disableï¼šå–æ¶ˆå¼€æœºå¯åŠ¨
	statusï¼šåˆ—å‡º unit æœ‰æ²¡æœ‰æ­£åœ¨æ‰§è¡Œã€å¼€æœºé¢„è®¾æ‰§è¡Œã€ç™»å½•ç­‰ä¿¡æ¯
	is-activeï¼šç›®å‰æ˜¯å¦åœ¨è¿è¡Œ
	is-enableï¼šæ˜¯å¦å¼€æœºå¯åŠ¨
```

```bash
# èŒƒä¾‹ 1ï¼šçœ‹çœ‹ç›®å‰ atd è¿™ä¸ªæœåŠ¡çš„çŠ¶æ€
[root@study ~]# systemctl status atd.service 
* atd.service - Job spooling tools
   Loaded: loaded (/usr/lib/systemd/system/atd.service; enabled; vendor preset: enabled)
   Active: active (running) since Tue 2020-03-17 10:49:55 CST; 1 day 5h ago
 Main PID: 1398 (atd)
    Tasks: 1
   CGroup: /system.slice/atd.service
           `-1398 /usr/sbin/atd -f

Mar 17 10:49:55 study.centos.mrcode systemd[1]: Started Job spooling tools.
# é‡ç‚¹åœ¨ç¬¬ 2ã€3 è¡Œæ•°æ®
# Loadedï¼šå¼€æœºæ˜¯å¦å¯åŠ¨
# Activeï¼šæ˜¯å¦æ­£åœ¨è¿è¡Œä¸­
# æœ€åä¸€è¡Œï¼šè¯¥æœåŠ¡çš„å¯åŠ¨ä¿¡æ¯
# ç™»å½•æ–‡ä»¶æ ¼å¼ä¸ºï¼šæ—¶é—´ã€ä¿¡æ¯å‘é€ä¸»æœºã€å“ªä¸€ä¸ªæœåŠ¡çš„ä¿¡æ¯ã€å®é™…ä¿¡æ¯å†…å®¹
```

```bash
# èŒƒä¾‹ 2ï¼šæ­£å¸¸å…³é—­ atd æœåŠ¡ï¼Œé kill -9
[root@study ~]# systemctl stop atd.service 
[root@study ~]# systemctl status atd.service 
* atd.service - Job spooling tools
   Loaded: loaded (/usr/lib/systemd/system/atd.service; enabled; vendor preset: enabled)
   Active: inactive (dead) since Wed 2020-03-18 16:40:06 CST; 13s ago
  Process: 1398 ExecStart=/usr/sbin/atd -f $OPTS (code=exited, status=0/SUCCESS)
 Main PID: 1398 (code=exited, status=0/SUCCESS)

Mar 17 10:49:55 study.centos.mrcode systemd[1]: Started Job spooling tools.
Mar 18 16:40:06 study.centos.mrcode systemd[1]: Stopping Job spooling tools...
Mar 18 16:40:06 study.centos.mrcode systemd[1]: Stopped Job spooling tools.
# è¿™ä¸‹å°±æ˜ç™½äº†ã€‚åé¢ä¸¤è¡Œä¿¡æ¯æ˜¯æ‰§è¡Œ stop åå‘ç”Ÿçš„äº‹ä»¶æ—¥å¿—ä¿¡æ¯
```

ä¸è¦ä½¿ç”¨ kill çš„æ–¹å¼æ¥å…³æ‰ä¸€ä¸ªæ­£å¸¸çš„æœåŠ¡ï¼Œå¦åˆ™ systemctl æ— æ³•ç›‘æ§è¯¥æœåŠ¡ã€‚ä¸Šé¢ä¿¡æ¯çš„ Active çŠ¶æ€æœ‰å¦‚ä¸‹å‡ ä¸ªå¸¸è§çš„çŠ¶æ€ï¼š

- activeï¼ˆrunningï¼‰ï¼šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç¨‹åºæ­£åœ¨è¿è¡Œ

- activeï¼ˆexitedï¼‰ï¼šä»…æ‰§è¡Œä¸€æ¬¡å°±æ­£å¸¸ç»“æŸçš„æœåŠ¡ï¼Œç›®å‰å¹¶æ²¡æœ‰ä»»ä½•ç¨‹åºåœ¨ç³»ç»Ÿä¸­æ‰§è¡Œã€‚

  æ¯”å¦‚ï¼šå¼€æœºæˆ–æ˜¯æŒ‚è½½æ—¶æ‰ä¼šè¿›è¡Œä¸€æ¬¡çš„ quotaon åŠŸèƒ½ï¼Œå°±æ˜¯è¿™ç§æ¨¡å¼ï¼Œquotaon ä¸éœ€è¦ä¸€ç›´æ‰§è¡Œï¼Œåªéœ€è¦æ‰§è¡Œä¸€æ¬¡ä¹‹åï¼Œå°±äº¤ç»™æ–‡ä»¶ç³»ç»Ÿè‡ªè¡Œå¤„ç†äº†ã€‚é€šå¸¸ç”¨ bash shell å†™çš„å°å‹æœåŠ¡ï¼Œå¤§å¤šå±äºæ­¤ç§ç±»å‹ï¼ˆæ— éœ€å¸¸é©»å†…å­˜ï¼‰

- activeï¼ˆwaitingï¼‰ï¼šæ­£åœ¨æ‰§è¡Œä¸­ä¸­ï¼Œä¸è¿‡åœ¨åœ¨ç­‰å¾…å…¶ä»–çš„äº‹ä»¶æ‰èƒ½ç»§ç»­å¤„ç†

- inactiveï¼šè¿™ä¸ªæœåŠ¡ç›®å‰æ²¡æœ‰è¿è¡Œ

å¼€æœºé¢„è®¾çŠ¶æ€æœ‰ä»¥ä¸‹ï¼š

- enabledï¼šå¼€æœºæ‰§è¡Œ
- disabledï¼šå¼€æœºä¸æ‰§è¡Œ
- staticï¼šä¸å¯ä»¥è‡ªå·±å¯åŠ¨ã€‚ä¸è¿‡å¯èƒ½ä¼šè¢«å…¶ä»–çš„ enabled çš„æœåŠ¡æ¥å”¤é†’ï¼ˆä¾èµ–æœåŠ¡ï¼‰
- maskï¼šæ— æ³•è¢«å¯åŠ¨ï¼Œå› ä¸ºå·²ç»è¢«å¼ºåˆ¶æ³¨é”€ï¼ˆéåˆ é™¤ï¼‰ã€‚å¯é€šè¿‡ systemctl unmask æ–¹å¼æ”¹å›åŸæœ¬çš„çŠ¶æ€

### æœåŠ¡å¯åŠ¨ã€å…³é—­ä¸è§‚å¯Ÿè”ç³»

ä¹ é¢˜ 1ï¼šæ‰¾åˆ°ç³»ç»Ÿä¸­åä¸º chronyd çš„æœåŠ¡ï¼Œè§‚å¯Ÿæ­¤æœåŠ¡çŠ¶æ€ï¼Œå¹¶å°†æœåŠ¡è®¾ç½®ä¸ºï¼š

1. å¼€æœºä¸ä¼šå¯åŠ¨
2. ç°åœ¨çŠ¶æ€æ˜¯å…³é—­çš„æƒ…å†µ

```bash
[root@study ~]# systemctl status chronyd.service 
* chronyd.service - NTP client/server
	# å¼€æœºå¯åŠ¨
   Loaded: loaded (/usr/lib/systemd/system/chronyd.service; enabled; vendor preset: enabled)
   # æ­£åœ¨è¿è¡Œä¸­
   Active: active (running) since Tue 2020-03-17 10:49:42 CST; 1 day 6h ago
     Docs: man:chronyd(8)
           man:chrony.conf(5)
    Tasks: 1
   CGroup: /system.slice/chronyd.service
           `-933 /usr/sbin/chronyd

Mar 17 10:49:39 study.centos.mrcode systemd[1]: Starting NTP client/server...
Mar 17 10:49:39 study.centos.mrcode chronyd[933]: chronyd version 3.4 starting (+CMDMON +NTP +REFCLOCK +RTC +PRIVDROP +SCFILTER +SIGND +ASYNCDNS +SECHASH +IPV6 +DEBUG)
Mar 17 10:49:39 study.centos.mrcode chronyd[933]: Frequency 0.000 +/- 1000000.000 ppm read from /var/lib/chrony/drift
Mar 17 10:49:42 study.centos.mrcode systemd[1]: Permission denied while opening PID file or unsafe symlink chain: /var/run/chrony/chronyd.pid
Mar 17 10:49:42 study.centos.mrcode systemd[1]: Started NTP client/server.

# å–æ¶ˆå¼€æœºå¯åŠ¨
[root@study ~]# systemctl disable chronyd.service 
Removed symlink /etc/systemd/system/multi-user.target.wants/chronyd.service.
# å–æ¶ˆå¼€æœºå¯åŠ¨ï¼Œè¿™é‡Œå…¶å®å°±æ˜¯ç§»é™¤äº† /etc/systemd/system è¯¥ç›®å½•ä¸‹çš„ä¸€ä¸ªé“¾æ¥æ–‡ä»¶

# åœæ­¢è¯¥æœåŠ¡
[root@study ~]# systemctl stop chronyd.service 
[root@study ~]# systemctl status chronyd.service 
* chronyd.service - NTP client/server
   Loaded: loaded (/usr/lib/systemd/system/chronyd.service; disabled; vendor preset: enabled)
   Active: inactive (dead)
     Docs: man:chronyd(8)
           man:chrony.conf(5)

Mar 17 10:49:39 study.centos.mrcode systemd[1]: Starting NTP client/server...
Mar 17 10:49:39 study.centos.mrcode chronyd[933]: chronyd version 3.4 starting (+CMDMON +NTP +REFCLOCK +RTC +PRIVDROP +SCFILTER +SIGND +ASYNCDNS +SECHASH +IPV6 +DEBUG)
Mar 17 10:49:39 study.centos.mrcode chronyd[933]: Frequency 0.000 +/- 1000000.000 ppm read from /var/lib/chrony/drift
Mar 17 10:49:42 study.centos.mrcode systemd[1]: Permission denied while opening PID file or unsafe symlink chain: /var/run/chrony/chronyd.pid
Mar 17 10:49:42 study.centos.mrcode systemd[1]: Started NTP client/server.
Mar 18 16:53:11 study.centos.mrcode systemd[1]: Stopping NTP client/server...
Mar 18 16:53:11 study.centos.mrcode systemd[1]: Stopped NTP client/server.
```

ä¹ é¢˜ 2ï¼šå°† cups æœåŠ¡æ•´ä¸ªå…³é—­ï¼ˆå› ä¸ºæ²¡æœ‰æ‰“å°æœºå®‰è£…åœ¨æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿæ²¡æœ‰ç½‘ç»œæ‰“å°æœºï¼‰

```bash
[root@study ~]# systemctl status cups.service 
* cups.service - CUPS Printing Service
   Loaded: loaded (/usr/lib/systemd/system/cups.service; enabled; vendor preset: enabled)
   # ä¹¦ä¸Šè¿™é‡ŒçŠ¶æ€æ˜¯ inactive(dead) æ²¡æœ‰è¿è¡ŒçŠ¶æ€ï¼Œç¬”è€…è¿™é‡Œç¡®å®åœ¨è¿è¡ŒçŠ¶æ€
   Active: active (running) since Tue 2020-03-17 10:49:55 CST; 1 day 6h ago
 Main PID: 1374 (cupsd)
   CGroup: /system.slice/cups.service
           `-1374 /usr/sbin/cupsd -f

Mar 17 10:49:55 study.centos.mrcode systemd[1]: Started CUPS Printing Service.

# åœæ­¢æœåŠ¡
[root@study ~]# systemctl stop cups.service 
Warning: Stopping cups.service, but it can still be activated by:
  cups.path
  cups.socket
# å–æ¶ˆå¼€æœºå¯åŠ¨
[root@study ~]# systemctl disable cups.service 
Removed symlink /etc/systemd/system/multi-user.target.wants/cups.path.
Removed symlink /etc/systemd/system/multi-user.target.wants/cups.service.
Removed symlink /etc/systemd/system/sockets.target.wants/cups.socket.
Removed symlink /etc/systemd/system/printer.target.wants/cups.service.
# è¿™é‡Œä¸€å…±ç§»é™¤äº† 4 ä¸ªè¿ç»“æ–‡ä»¶ï¼Œè¯´æ˜è¿™å‡ ä¸ªæ–‡ä»¶å¯èƒ½æ˜¯ç›¸ä¾èµ–æ€§
[root@study ~]# netstat -tlunp | grep cups
# cups æœåŠ¡æ²¡æœ‰è¢«å¯åŠ¨ï¼Œæ‰€ä»¥æ²¡æœ‰ç«¯å£äº§ç”Ÿ

# å°è¯•å¯åŠ¨ cups.socket ç›‘å¬å®¢æˆ·ç«¯çš„éœ€æ±‚
[root@study ~]# systemctl start cups.socket
[root@study ~]# systemctl status cups.service cups.socket cups.path 
* cups.service - CUPS Printing Service
   Loaded: loaded (/usr/lib/systemd/system/cups.service; disabled; vendor preset: enabled)
   Active: inactive (dead) since Wed 2020-03-18 16:57:19 CST; 4min 8s ago
 Main PID: 1374 (code=exited, status=0/SUCCESS)

Mar 17 10:49:55 study.centos.mrcode systemd[1]: Started CUPS Printing Service.
Mar 18 16:57:19 study.centos.mrcode systemd[1]: Stopping CUPS Printing Service...
Mar 18 16:57:19 study.centos.mrcode systemd[1]: Stopped CUPS Printing Service.

* cups.socket - CUPS Printing Service Sockets
   Loaded: loaded (/usr/lib/systemd/system/cups.socket; disabled; vendor preset: enabled)
   Active: active (listening) since Tue 2020-03-17 10:49:38 CST; 1 day 6h ago
   Listen: /var/run/cups/cups.sock (Stream)

Mar 17 10:49:38 study.centos.mrcode systemd[1]: Listening on CUPS Printing Service Sockets.

* cups.path - CUPS Printer Service Spool
   Loaded: loaded (/usr/lib/systemd/system/cups.path; disabled; vendor preset: enabled)
   Active: active (waiting) since Tue 2020-03-17 10:49:38 CST; 1 day 6h ago

Mar 17 10:49:38 study.centos.mrcode systemd[1]: Started CUPS Printer Service Spool.
# ç¬”è€…è¿™é‡Œå’Œä¹¦ä¸Šåˆä¸ä¸€æ ·ï¼Œä¹¦ä¸Š cups.path æ˜¯ inactive(dead) çŠ¶æ€ï¼Œæˆ‘è¿™é‡Œåˆ™æ˜¯ç­‰å¾…çŠ¶æ€


# å°è¯•ä½¿ç”¨ lp æŒ‡ä»¤æ‰“å°
[root@study ~]# echo "testing" | lp
lp: Error - no default destination available.
# å®é™…ä¸Šæ²¡æœ‰æ‰“å°æœºï¼Œå‡ºç°é”™è¯¯ä¹Ÿæ­£å¸¸
[root@study ~]# systemctl status cups.service                       
* cups.service - CUPS Printing Service
   Loaded: loaded (/usr/lib/systemd/system/cups.service; disabled; vendor preset: enabled)
   # è¢«å¯åŠ¨äº†
   Active: active (running) since Wed 2020-03-18 17:03:17 CST; 41s ago
 Main PID: 23325 (cupsd)
    Tasks: 1
   CGroup: /system.slice/cups.service
           `-23325 /usr/sbin/cupsd -f

Mar 18 17:03:17 study.centos.mrcode systemd[1]: Started CUPS Printing Service.
[root@study ~]# netstat -tlunp | grep cups
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      23325/cupsd         
tcp6       0      0 ::1:631                 :::*                    LISTEN      23325/cupsd 

# è¿™é‡Œç«Ÿç„¶è¢«è‡ªåŠ¨å¯åŠ¨äº†ï¼Œæˆ‘ä»¬åˆšåˆšæ“ä½œå‘½åæ˜¯ stop äº†è¿™ä¸ªæœåŠ¡
```

ä¸Šé¢ä¾‹å­å……åˆ†æ¼”ç¤ºäº†å¾ˆå¤šæœåŠ¡ä¹‹é—´æ˜¯æœ‰ç›¸ä¾æ€§çš„ï¼Œcups æ˜¯ä¸€ç§æ‰“å°æœåŠ¡ï¼Œä¼šå¯ç”¨ 631 port æ¥æä¾›ç½‘ç»œæ‰“å°æœºçš„æ‰“å°åŠŸèƒ½ã€‚ä½†æ˜¯æˆ‘ä»¬æ— éœ€ä¸€ç›´å¯åŠ¨ 631 çš„ç«¯å£ï¼Œå› æ­¤ï¼Œå¤šäº†ä¸€ä¸ª cups.socket çš„æœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡å¯ä»¥åœ¨ã€Œç”¨æˆ·æœ‰éœ€è¦æ‰“å°æ—¶ï¼Œæ‰ä¼šä¸»åŠ¨å”¤é†’ cups.serviceã€ï¼Œç”±äºæœ‰äº†è¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥å°±ç®—äº‹å…ˆå§ 3 ä¸ª cups çš„æœåŠ¡éƒ½ stop æ‰ï¼Œå½“ç”¨æˆ·å‘å…¶ä»–ä¸¤ä¸ª cups.pathã€cups.socket æå‡ºè¦æ±‚æ—¶ï¼Œ cups.service å°±ä¼šè¢«å”¤é†’

### å¼ºè¿«æœåŠ¡æ³¨é”€ mask çš„ç»ƒä¹ 

æ¯”è¾ƒæ­£å¸¸çš„åšæ³•æ˜¯ï¼šè¦å…³é—­ cups.service æ—¶ï¼Œè¿åŒå…¶ä»–ä¸¤ä¸ªä¼šå”¤é†’ service çš„ cups.socket ä¸ cups.path éƒ½å…³é—­ï¼Œé‚£å°±æ²¡æœ‰äº‹æƒ…äº†ã€‚

ä¸æ­£å¸¸çš„åšæ³•æ˜¯ï¼šå¼ºè¿« cups.service æ³¨é”€ï¼Œé€šè¿‡ mask æ–¹å¼

```bash
[root@study ~]# systemctl stop cups.service 
Warning: Stopping cups.service, but it can still be activated by:
  cups.socket
  cups.path
[root@study ~]# systemctl mask cups.service 
Created symlink from /etc/systemd/system/cups.service to /dev/null.
[root@study ~]# systemctl status cups.service 
* cups.service
   Loaded: masked (/dev/null; bad)
   Active: inactive (dead) since Wed 2020-03-18 17:11:29 CST; 32s ago
 Main PID: 23325 (code=exited, status=0/SUCCESS)

Mar 18 17:03:17 study.centos.mrcode systemd[1]: Started CUPS Printing Service.
Mar 18 17:11:29 study.centos.mrcode systemd[1]: Stopping CUPS Printing Service...
Mar 18 17:11:29 study.centos.mrcode systemd[1]: Stopped CUPS Printing Service.
[root@study ~]# systemctl start cups.service 
Failed to start cups.service: Unit is masked.
```

é€šè¿‡ mask ä¹‹åï¼Œä»–çš„è¿ç»“æ–‡ä»¶è¢«è¿ç»“åˆ°äº† `/dev/null`ï¼Œæ‰€ä»¥å°±æ— æ³•å¯åŠ¨äº†

```bash
# å–æ¶ˆæ³¨é”€
[root@study ~]# systemctl unmask cups.service 
Removed symlink /etc/systemd/system/cups.service.
[root@study ~]# systemctl status cups.service 
* cups.service - CUPS Printing Service
   Loaded: loaded (/usr/lib/systemd/system/cups.service; disabled; vendor preset: enabled)
   Active: inactive (dead) since Wed 2020-03-18 17:11:29 CST; 2min 30s ago
 Main PID: 23325 (code=exited, status=0/SUCCESS)

Mar 18 17:03:17 study.centos.mrcode systemd[1]: Started CUPS Printing Service.
Mar 18 17:11:29 study.centos.mrcode systemd[1]: Stopping CUPS Printing Service...
Mar 18 17:11:29 study.centos.mrcode systemd[1]: Stopped CUPS Printing Service.
# æ¢å¤æ­£å¸¸äº†
```

## ğŸ€ è§‚å¯Ÿç³»ç»Ÿä¸Šæ‰€æœ‰çš„æœåŠ¡

```bash
systemctl [command][--type=TYPE][--all]

commandï¼š
	list-unitsï¼šæŒ‰ unit åˆ—å‡ºç›®å‰æœ‰å¯åŠ¨çš„ unitã€‚è‹¥åŠ ä¸Š --all æ‰ä¼šåˆ—å‡ºæ²¡æœ‰å¯åŠ¨çš„
	list-unit-filesï¼šæŒ‰ `/usr/lib/systemd/system` å†…çš„æ–‡ä»¶ï¼Œå°†æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨è¯´æ˜
--typeï¼šä¹‹å‰æåˆ°è¿‡çš„ unit typeï¼Œä¸»è¦æœ‰ serviceã€socketã€target ç­‰
```

```bash
èŒƒä¾‹ 1ï¼šåˆ—å‡ºç³»ç»Ÿä¸Šæœ‰å¯åŠ¨çš„ unit
[root@study ~]# systemctl
UNIT                                                                                     LOAD   ACTIVE SUB       DESCRIPTION
proc-sys-fs-binfmt_misc.automount                                                        loaded active waiting   Arbitrary Executable File Formats File System Automount Point
sys-devices-pci0000:00-0000:00:03.0-net-enp0s3.device                                    loaded active plugged   82540EM Gigabit Ethernet Controller (PRO/1000 MT Desktop Adapter)
sys-devices-pci0000:00-0000:00:05.0-sound-card0.device                                   loaded active plugged   82801AA AC'97 Audio Controller
sys-devices-pci0000:00-0000:00:0d.0-ata3-host2-target2:0:0-2:0:0:0-block-sda-sda1.device loaded active plugged   VBOX_HARDDISK 1
...
vsftpd.service  loaded active running   Vsftpd ftp daemon

LOAD   = Reflects whether the unit definition was properly loaded.
ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
SUB    = The low-level unit activation state, values depend on unit type.

152 loaded units listed. Pass --all to see loaded but inactive units, too.
To show all installed unit files use 'systemctl list-unit-files'.
lines 106-160/160 (END)
# æœåŠ¡å¤ªå¤šäº†ï¼Œä¸ªåˆ«å­—æ®µå«ä¹‰å¦‚ä¸‹
# UNITï¼šé¡¹ç›®åç§°ï¼ŒåŒ…æ‹¬å„ä¸ª unit çš„ç±»å‹ï¼ˆçœ‹æ‰©å±•åï¼‰
# LOADï¼šå¼€æœºæ—¶æ˜¯å¦ä¼šè¢«åŠ è½½ï¼Œé»˜è®¤ systemctl æ˜¾ç¤ºçš„æ˜¯æœ‰åŠ è½½çš„é¡¹ç›®
# ACTIVEï¼šç›®å‰çš„çŠ¶æ€ï¼Œç»­ä¸åç»­çš„ SUB æ­é…ï¼Œå°±æ˜¯ç”¨ systemctl status è§‚å¯Ÿæ—¶ï¼Œactive é¡¹ç›®
# DESCRIPTIONï¼šè¯¦ç»†æè¿°
# å¦å¤–ï¼Œsystemctl ä¸åŠ å‚æ•°ï¼Œé¢„è®¾æ˜¯ list-units 
```

```bash
# èŒƒä¾‹ 2ï¼šåˆ—å‡ºæ‰€æœ‰å·²ç»å®‰è£…çš„ unit æœ‰å“ªäº›
[root@study ~]# systemctl list-unit-files 
UNIT FILE                                     STATE   
proc-sys-fs-binfmt_misc.automount             static  
dev-hugepages.mount                           static  
dev-mqueue.mount                              static  
proc-fs-nfsd.mount                            static  
proc-sys-fs-binfmt_misc.mount                 static  
sys-fs-fuse-connections.mount                 static  
sys-kernel-config.mount                       static  
sys-kernel-debug.mount                        static  
tmp.mount                                     disabled
var-lib-nfs-rpc_pipefs.mount                  static  
brandbot.path                                 disabled
cups.path                                     disabled
systemd-ask-password-console.path             static  
systemd-ask-password-plymouth.path            static  
systemd-ask-password-wall.path                static  
session-2.scope                               static  
session-92.scope                              static  
session-c1.scope                              static  
abrt-ccpp.service                             enabled 
abrt-oops.service                             enabled 
# ä¼šå°†ç³»ç»Ÿä¸Šæ‰€æœ‰çš„æœåŠ¡éƒ½åˆ—å‡ºæ¥ï¼ŒSTATE åˆ™æ˜¯å‰é¢è®²åˆ°è¿‡çš„
```

```bash
# èŒƒä¾‹ 3ï¼šåªåˆ—å‡ºæŸç§ç±»å‹çš„ unit
# è¿™æ ·å°±åªä¼šæ˜¾ç¤º .service ç±»å‹çš„æœåŠ¡äº†
[root@study ~]# systemctl list-units --type=service --all
  UNIT                                                  LOAD      ACTIVE   SUB     DESCRIPTION
  abrt-ccpp.service                                     loaded    active   exited  Install ABRT coredump hook
  abrt-oops.service                                     loaded    active   running ABRT kernel log watcher
  abrt-vmcore.service                                   loaded    inactive dead    Harvest vmcores for ABRT
  abrt-xorg.service                                     loaded    active   running ABRT Xorg log watcher
  abrtd.service                                         loaded    active   running ABRT Automated Bug Reporting Tool
  accounts-daemon.service                               loaded    active   running Accounts Service
  alsa-restore.service                                  loaded    inactive dead    Save/Restore Sound Card State
  alsa-state.service                                    loaded    active   running Manage Sound Card State (restore and store)
* apparmor.service                                      not-found inactive dead    apparmor.service

# æŸ¥æ‰¾æ˜¯å¦æœ‰ cpu ä¸ºåçš„æœåŠ¡
[root@study ~]# systemctl list-units --type=service --all | grep cpu
  cpupower.service                                      loaded    inactive dead    Configure CPU power related settings
# CPU ç”µæºç®¡ç†æœºåˆ¶çš„æœåŠ¡ 
```

## ğŸ€ ç®¡ç†ä¸åŒçš„æ“ä½œç¯å¢ƒï¼ˆtarget unitï¼‰

```bash
[root@study ~]# systemctl list-units --type=target --all            
  UNIT                   LOAD      ACTIVE   SUB    DESCRIPTION
  basic.target           loaded    active   active Basic System
  cryptsetup.target      loaded    active   active Local Encrypted Volumes
* dbus.target            not-found inactive dead   dbus.target
  emergency.target       loaded    inactive dead   Emergency Mode
  final.target           loaded    inactive dead   Final Step
  getty-pre.target       loaded    active   active Login Prompts (Pre)
  getty.target           loaded    active   active Login Prompts
  graphical.target       loaded    active   active Graphical Interface
  local-fs-pre.target    loaded    active   active Local File Systems (Pre)
  local-fs.target        loaded    active   active Local File Systems
  multi-user.target      loaded    active   active Multi-User System
  network-online.target  loaded    active   active Network is Online
  network-pre.target     loaded    active   active Network (Pre)
  network.target         loaded    active   active Network
  nfs-client.target      loaded    active   active NFS client services
  nss-lookup.target      loaded    inactive dead   Host and Network Name Lookups
  nss-user-lookup.target loaded    active   active User and Group Name Lookups
  paths.target           loaded    active   active Paths
  remote-fs-pre.target   loaded    active   active Remote File Systems (Pre)
  remote-fs.target       loaded    active   active Remote File Systems
  rescue.target          loaded    inactive dead   Rescue Mode
  rpc_pipefs.target      loaded    active   active rpc_pipefs.target
  rpcbind.target         loaded    active   active RPC Port Mapper
  shutdown.target        loaded    inactive dead   Shutdown
  slices.target          loaded    active   active Slices
  sockets.target         loaded    active   active Sockets
  sound.target           loaded    active   active Sound Card
  swap.target            loaded    active   active Swap
  sysinit.target         loaded    active   active System Initialization
* syslog.target          not-found inactive dead   syslog.target
  time-sync.target       loaded    inactive dead   System Time Synchronized
  timers.target          loaded    active   active Timers
  umount.target          loaded    inactive dead   Unmount All Filesystems

LOAD   = Reflects whether the unit definition was properly loaded.
ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
SUB    = The low-level unit activation state, values depend on unit type.

33 loaded units listed.
To show all installed unit files use 'systemctl list-unit-files'.
```

ç¬”è€…è¿™é‡Œä¸ä¹¦ä¸Šä¹Ÿä¸å¤ªä¸€æ ·ï¼ˆå¯èƒ½è¿˜æ˜¯å› ä¸ºç³»ç»Ÿç‰ˆæœ¬çš„åŸå› ï¼Œæˆ‘çš„æ¯”è¾ƒæ–°ä¸€ç‚¹ï¼‰ï¼Œæœ‰ 33 ä¸ª target unitï¼Œä¸æ“ä½œç•Œé¢ç›¸å…³æ€§è¾ƒé«˜çš„ target ä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ª

- graphical.targetï¼šæ–‡å­— + å›¾å½¢ç•Œé¢ï¼Œè¯¥é¡¹ç›®å·²åŒ…å«äº†ä¸‹é¢çš„ multi-user.target é¡¹ç›®
- multi-user.targetï¼šçº¯æ–‡æœ¬æ¨¡å¼
- rescue.targetï¼šåœ¨æ— æ³•ä½¿ç”¨ root ç™»å½•çš„æƒ…å†µä¸‹ï¼Œsystemd åœ¨å¼€æœºæ—¶ä¼šå¤šåŠ ä¸€ä¸ªé¢å¤–çš„æš‚æ—¶ç³»ç»Ÿï¼Œä¸ä½ åŸæœ¬çš„ç³»ç»Ÿæ— å…³ã€‚è¿™æ—¶å°±å¯ä»¥å–å¾— root çš„æƒé™æ¥ç»´æŠ¤ä½ çš„ç³»ç»Ÿã€‚ç”±äºæ˜¯é¢å¤–çš„ç³»ç»Ÿï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ chroot æ–¹å¼æ¥å–å¾—åŸæœ‰çš„ç³»ç»Ÿï¼ˆåç»­ä¼šè®²è§£ï¼‰
- emergency.targetï¼šç´§æ€¥å¤„ç†ç³»ç»Ÿçš„é”™è¯¯ï¼Œéœ€è¦ä½¿ç”¨ root ç™»å½•çš„æƒ…å†µï¼Œåœ¨æ— æ³•ä½¿ç”¨ rescue.target æ—¶ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨è¯¥æ¨¡å¼
- shutdown.targetï¼šå…³æœºæµç¨‹
- getty.targetï¼šå¯ä»¥è®¾ç½®ä½ éœ€è¦å‡ ä¸ª tty ä¹‹ç±»çš„ï¼Œå¦‚æœæƒ³è¦é™ä½ tty çš„é¡¹ç›®ï¼Œå¯ä»¥ä¿®æ”¹è¯¥é…ç½®æ–‡ä»¶

æŒ‰åŠŸèƒ½åˆ†ç±»å¦‚ä¸‹ï¼š

- æ­£å¸¸æ¨¡å¼ï¼šgraphical.targetã€multi-user.target
- æ•‘æ´æ¨¡å¼ï¼šrescue.targetã€emergency.target

å¦‚ä½•è·å–å½“å‰çš„æ¨¡å¼ä¸ä¿®æ”¹

```bash
systemctl [command] [unit.target]

commandï¼š
	get-defaultï¼šå–å¾—ç›®å‰çš„ target
	set-defaultï¼šå°† target è®¾ç½®ä¸ºé»˜è®¤çš„æ“ä½œæ¨¡å¼
	isolateï¼šåˆ‡æ¢åˆ°åé¢æŒ‡å®šçš„æ“ä½œæ¨¡å¼
```

```bash
# èŒƒä¾‹ 1ï¼šæˆ‘ä»¬çš„æµ‹è¯•æœºå™¨é»˜è®¤æ˜¯å›¾å½¢ç•Œé¢ï¼Œå…ˆè§‚å¯Ÿæ˜¯å¦æ˜¯å›¾å½¢æ¨¡å¼ï¼Œå†å°†é»˜è®¤æ¨¡å¼è®¾ç½®ä¸ºæ–‡å­—æ¨¡å¼
[root@study ~]# systemctl get-default 
graphical.target			# æœçœŸæ˜¯
[root@study ~]# systemctl set-default multi-user.target 
Removed symlink /etc/systemd/system/default.target.
Created symlink from /etc/systemd/system/default.target to /usr/lib/systemd/system/multi-user.target.
[root@study ~]# systemctl get-default 
multi-user.target
# å·²åˆ‡æ¢åˆ°æ–‡å­—æ¨¡å¼ä¸ºé»˜è®¤æ¨¡å¼äº†

# èŒƒä¾‹ 2ï¼šåœ¨ä¸é‡æ–°å¯åŠ¨çš„æƒ…å†µä¸‹ï¼Œå°†ç›®å‰çš„æ“ä½œç¯å¢ƒæ”¹ä¸ºçº¯æ–‡æœ¬æ¨¡å¼ï¼Œå…³æ‰å›¾å½¢ç•Œé¢
systemctl isolate multi-user.target

# èŒƒä¾‹ 3ï¼šåˆ‡æ¢åˆ°å›¾å½¢ç•Œé¢
systemctl isolate graphical.target
```

æ³¨æ„ï¼šåœ¨ service éƒ¨åˆ†ç”¨ startã€stopã€restart ï¼Œåœ¨ target ä¸­ä½¿ç”¨ ä¸Šè¿°æåˆ°çš„æŒ‡ä»¤ï¼Œisolate åˆ‡æ¢ï¼›è¿˜æä¾›äº†å‡ ä¸ªç®€å•ç›´è§‚çš„æŒ‡ä»¤ä½¿ç”¨

```bash
systemctl poweroff		# ç³»ç»Ÿå…³æœº
systemctl reboot		# é‡æ–°å¯åŠ¨
systemctl suspend		# è¿›å…¥æš‚åœæ¨¡å¼
systemctl hibernate		# è¿›å…¥ä¼‘çœ æ¨¡å¼
systemctl rescue		# å¼ºåˆ¶è¿›å…¥æ•‘æ´æ¨¡å¼
systemctl emergency		# å¼ºåˆ¶è¿›å…¥ç´§æ€¥æ•‘æ´æ¨¡å¼
```

- suspendï¼šæš‚åœæ¨¡å¼

  è¯¥æ¨¡å¼ä¼šå°†ç³»ç»Ÿçš„çŠ¶æ€æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç„¶åå…³é—­æ‰å¤§éƒ¨åˆ†çš„ç³»ç»Ÿç¡¬ä»¶ï¼Œå½“ç”¨æˆ·æŒ‰ä¸‹å”¤é†’æœºå™¨çš„æŒ‰é’®ï¼Œç³»ç»Ÿæ•°æ®ä¼šä»å†…å­˜ä¸­æ¢å¤ï¼Œç„¶åé‡æ–°é©±åŠ¨è¢«å¤§éƒ¨åˆ†å…³é—­çš„ç¡¬ä»¶ï¼Œå”¤é†’é€Ÿåº¦å¾ˆå¿«ï¼›

- hibernateï¼šä¼‘çœ æ¨¡å¼

  å°†ç³»ç»ŸçŠ¶æ€ä¿å­˜åˆ°ç¡¬ç›˜ä¸­ï¼Œä¿å­˜å®Œæˆåï¼Œè®¡ç®—æœºå…³é—­ã€‚å½“ç”¨æˆ·å°è¯•å”¤é†’ç³»ç»Ÿæ—¶ï¼Œä¼šå¼€å§‹æ­£å¸¸å·¥ä½œï¼Œç„¶åå°†ä¿å­˜åœ¨ç¡¬ç›˜ä¸­çš„ç³»ç»ŸçŠ¶æ€æ¢å¤å›æ¥ã€‚ç”±äºæ•°æ®ä»ç¡¬ç›˜è¯»å–ï¼Œæ‰€ä»¥å”¤é†’æ•ˆç‡ä¸ç¡¬ç›˜é€Ÿåº¦æœ‰å…³

## ğŸ€ åˆ†æä¸ªæœåŠ¡ä¹‹é—´çš„ç›¸ä¾æ€§

æœ¬ç« å¼€å§‹è®²åˆ°è¿‡ systemd ç›¸ä¾æ€§çš„é—®é¢˜å®¢æœï¼Œé‚£ä¹ˆï¼Œå¦‚ä½•è¿½è¸ªæŸä¸€ä¸ª unit çš„ç›¸ä¾æ€§å‘¢ï¼Ÿæ¯”å¦‚æ€ä¹ˆçŸ¥é“ `graphical.target` ä¼šç”¨åˆ° `multi-user.target` ï¼Ÿ

```bash
systemctl list-dependencies [unit] [--reverse]

-- reverseï¼šåå‘è¿½è¸ªè°ä½¿ç”¨è¿™ä¸ª unit
```

```bash
# èŒƒä¾‹ 1ï¼šåˆ—å‡ºç›®å‰çš„ target ç¯å¢ƒä¸‹ï¼Œç”¨åˆ°ä»€ä¹ˆç‰¹åˆ«çš„ unit
[root@study ~]# systemctl get-default 
multi-user.target
[root@study ~]# systemctl list-dependencies 
default.target
* |-abrt-ccpp.service
* |-abrt-oops.service
* |-abrt-vmcore.service
* |-abrt-xorg.service
* |-abrtd.service
* |-atd.service
* |-getty.target
* | `-getty@tty1.service
* |-nfs-client.target
* | |-auth-rpcgss-module.service
* | |-rpc-statd-notify.service
* | `-remote-fs-pre.target
* `-remote-fs.target
*   `-nfs-client.target
*     |-auth-rpcgss-module.service
*     |-rpc-statd-notify.service
*     `-remote-fs-pre.target

```

è¿™é‡Œä¸åŠ  unit åˆ™æ˜¯ä½¿ç”¨é»˜è®¤çš„ targetï¼Œå¯ä»¥çœ‹åˆ°ä¸€é¢—ä¾èµ–æ ‘ï¼Œéå¸¸ç›´è§‚

```bash
# åå‘è¿½è¸ª
[root@study ~]# systemctl list-dependencies --reverse 
default.target
* `-graphical.target

# æŸ¥çœ‹ graphical.target ä½¿ç”¨äº†å¤šå°‘æœåŠ¡
[root@study ~]# systemctl list-dependencies graphical.target
graphical.target
* |-accounts-daemon.service
* |-gdm.service
* |-initial-setup-reconfiguration.service
* |-network.service
* |-rtkit-daemon.service
* |-systemd-update-utmp-runlevel.service
* |-udisks2.service
* `-multi-user.target
*   |-abrt-ccpp.service
*   |-abrt-oops.service
*   |-abrt-vmcore.service
```

## ğŸ€ ä¸ systemd çš„ deaemon è¿è¡Œè¿‡ç¨‹ç›¸å…³ç›®å½•ç®€ä»‹

æ¯”è¾ƒé‡è¦çš„ systemd å¯åŠ¨è„šæœ¬é…ç½®æ–‡ä»¶åœ¨ `/usr/lib/systemd/system/`ã€`/etc/systemd/system/` ç›®å½•ä¸‹ï¼Œè¿˜æœ‰ä»¥ä¸‹ç›®å½•ä¸ç³»ç»Ÿçš„ daemon è¿è¡Œæœ‰å…³ï¼š

- `/usr/lib/systemd/system/`ï¼š

  ä½¿ç”¨ CentOS å®˜æ–¹æä¾›çš„è½¯ä»¶å®‰è£…åï¼Œé»˜è®¤çš„å¯åŠ¨è„šæœ¬é…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨è¿™é‡Œï¼Œè¿™é‡Œçš„æ•°æ®å°½é‡ä¸è¦ä¿®æ”¹ï¼Œè¦ä¿®æ”¹æ—¶ï¼Œå¯ä»¥åˆ° `/etc/systemd/system/` ä¸‹ä¿®æ”¹

- `/run/systemd/system/`ï¼š

  ç³»ç»Ÿæ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€äº§ç”Ÿçš„æœåŠ¡è„šæœ¬ï¼Œè¿™äº›è„šæœ¬çš„ä¼˜å…ˆé¡ºåºæ¯” `/usr/lib/systemd/system/` é«˜

- `/etc/systemd/system/`ï¼š

  ç®¡ç†å‘˜æ ¹æ®éœ€æ±‚å»ºç«‹çš„æ‰§è¡Œè„šæœ¬ï¼Œæ‰§è¡Œä¼˜å…ˆé¡ºåºæ¯” `/run/systemd/system/` é«˜

- `/etc/sysconfig/*`ï¼š

  å‡ ä¹æ‰€æœ‰çš„æœåŠ¡éƒ½ä¼šå°†åˆå§‹åŒ–çš„ä¸€äº›é€‰é¡¹è®¾ç½®å†™å…¥åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚

  æ¯”å¦‚ mandb è¦æ›´æ–°çš„ man page ç´¢å¼•ä¸­ï¼Œéœ€è¦åŠ å…¥çš„å‚æ•°å°±å†™å…¥åˆ°æ­¤ç›®å½•ä¸‹çš„ man-db ä¸­ã€‚è€Œç½‘ç»œçš„è®¾ç½®å†™åœ¨ `/etc/sysconfig/network-scripts/` ï¼›æ‰€ä»¥è¯¥ç›®å½•ä¹Ÿå¾ˆé‡è¦

- `/var/lib/`ï¼š

  ä¸€äº›ä¼šäº§ç”Ÿæ•°æ®çš„æœåŠ¡éƒ½ä¼šè®²å®ƒçš„æ•°æ®å†™å…¥åˆ°è¯¥ç›®å½•ä¸­ã€‚

  æ¯”å¦‚ï¼šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿ Mariadb çš„æ•°æ®åº“é»˜è®¤å†™å…¥åˆ° `/var/lib/mysql/` ç›®å½•ä¸‹çš„

- `/run/`ï¼šå­˜æ”¾äº†å¾ˆå¤š daemon çš„æš‚å­˜æ–‡ä»¶ï¼ŒåŒ…æ‹¬ lock file ä»¥åŠ PID file ç­‰

æˆ‘ä»¬çŸ¥é“ systemd æœ‰å¾ˆå¤šæœ¬æœºä¼šç”¨åˆ°çš„ socket æœåŠ¡ï¼Œä¼šäº§ç”Ÿå¾ˆå¤šçš„ socket fileï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼çŸ¥é“è¿™äº› socket file çš„å­˜æ”¾ä½ç½®

```bash
[root@study ~]# systemctl list-sockets 
LISTEN                          UNIT                         ACTIVATES
/dev/log                        systemd-journald.socket      systemd-journald.service
/run/dbus/system_bus_socket     dbus.socket                  dbus.service
/run/dmeventd-client            dm-event.socket              dm-event.service
/run/dmeventd-server            dm-event.socket              dm-event.service
/run/lvm/lvmetad.socket         lvm2-lvmetad.socket          lvm2-lvmetad.service
/run/lvm/lvmpolld.socket        lvm2-lvmpolld.socket         lvm2-lvmpolld.service
/run/systemd/initctl/fifo       systemd-initctl.socket       systemd-initctl.service
/run/systemd/journal/socket     systemd-journald.socket      systemd-journald.service
/run/systemd/journal/stdout     systemd-journald.socket      systemd-journald.service
/run/systemd/shutdownd          systemd-shutdownd.socket     systemd-shutdownd.service
/run/udev/control               systemd-udevd-control.socket systemd-udevd.service
/var/run/avahi-daemon/socket    avahi-daemon.socket          avahi-daemon.service
/var/run/cups/cups.sock         cups.socket                  cups.service
/var/run/libvirt/virtlockd-sock virtlockd.socket             virtlockd.service
/var/run/libvirt/virtlogd-sock  virtlogd.socket              virtlogd.service
/var/run/rpcbind.sock           rpcbind.socket               rpcbind.service
0.0.0.0:111                     rpcbind.socket               rpcbind.service
0.0.0.0:111                     rpcbind.socket               rpcbind.service
@ISCSIADM_ABSTRACT_NAMESPACE    iscsid.socket                iscsid.service
@ISCSID_UIP_ABSTRACT_NAMESPACE  iscsiuio.socket              iscsiuio.service
[::]:111                        rpcbind.socket               rpcbind.service
[::]:111                        rpcbind.socket               rpcbind.service
kobject-uevent 1                systemd-udevd-kernel.socket  systemd-udevd.service

23 sockets listed.
Pass --all to see loaded but inactive sockets, too.

```

ä¸Šé¢åˆ—å‡ºäº†æ­£åœ¨ç›‘å¬æœ¬åœ°æœåŠ¡éœ€æ±‚çš„ socket file æ‰€åœ¨çš„æ–‡ä»¶åä½ç½®

## ğŸ€ ç½‘ç»œæœåŠ¡äºç«¯å£å¯¹åº”ç®€ä»‹

IP ä¸ PORT æ˜¯è‹±ç‰¹ç½‘è”æœºçš„æœ€é‡è¦æœºåˆ¶ä¹‹ä¸€ï¼Œè¿˜æœ‰å„ç§çš„é€šä¿¡åè®®ï¼Œå¦‚ httpã€ftpï¼›åœ¨ `/etc/services` é‡Œé¢å¯¹åº”äº†åè®®ä¸ç«¯å£å·çš„æ˜ å°„å…³ç³»

```bash
[root@study ~]# cat /etc/services
# daemon name	port/å°åŒ…åè®®	æœåŠ¡è¯´æ˜
ftp             21/tcp
ftp             21/udp          fsp fspd
ssh             22/tcp                          # The Secure Shell (SSH) Protocol
ssh             22/udp                          # The Secure Shell (SSH) Protocol
http            80/tcp          www www-http    # WorldWideWeb HTTP
http            80/udp          www www-http    # HyperText Transfer Protocol
http            80/sctp                         # HyperText Transfer Protocol
https           443/tcp                         # http protocol over TLS/SSL
https           443/udp                         # http protocol over TLS/SSL
https           443/sctp                        # http protocol over TLS/SSL
# è¯¥æ–‡ä»¶ä¸‹æœ‰å¤§é‡çš„æ•°æ®
```

ä¸å»ºè®®ä¿®æ”¹è¿™äº›ç«¯å£ï¼Œé™¤éä½ æƒ³å§è¿™äº›éšè—èµ·æ¥ï¼Œä¸è®©å¤–éƒ¨è®¿é—®åˆ°

## ğŸ€ å…³é—­ç½‘ç»œæœåŠ¡

å½“ä½ ç¬¬ä¸€æ¬¡ä½¿ç”¨ systemctl è§‚å¯Ÿæœ¬åœ°æœåŠ¡å™¨å¯åŠ¨çš„æœåŠ¡æ—¶ï¼Œä¼šå‘ç°æœ‰å¾ˆå¤š daemonï¼Œè¿™æ˜¯å› ä¸º systemd å°†è®¸å¤šåŸæœ¬ä¸è¢«åˆ—ä¸º daemon çš„ç¨‹åºä¹Ÿçº³å…¥ç®¡ç†æ£€æµ‹èŒƒå›´å†…ï¼Œä½†æ˜¯é‚£äº›å¤§éƒ¨åˆ†éƒ½å±äº Linux ç³»ç»ŸåŸºç¡€è¿è¡Œæ‰€éœ€çš„ç¯å¢ƒï¼Œä½ ä¸æ¸…æ¥šçš„æƒ…å†µä¸‹ï¼Œæœ€å¥½ä¸è¦å»ä¿®æ”¹ä»–ä»¬

é™¤äº†æœ¬åœ°æœåŠ¡ä¹‹å¤–ï¼Œè¦è§‚å¯Ÿç½‘ç»œæœåŠ¡ï¼Œè™½ç„¶ç½‘ç»œæœåŠ¡é»˜è®¤æœ‰ SELinux ç®¡ç†ï¼Œä¸è¿‡ï¼Œè¿˜æ˜¯å»ºè®®éå¿…è¦çš„ç½‘ç»œæœåŠ¡å°±å…³é—­å®ƒã€‚åŸºæœ¬ä¸Šä¼šäº§ç”Ÿä¸€ä¸ªç½‘ç»œç›‘å¬ç«¯å£çš„ç¨‹åºï¼Œå°±å¯ä»¥ç§°å®ƒä¸ºç½‘ç»œæœåŠ¡äº†ï¼Œå¯é€šè¿‡å¦‚ä¸‹æ–¹å¼è§‚å¯Ÿç½‘ç»œç«¯å£

```bash
[root@study ~]# netstat -tlunp
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1578/master         
tcp        0      0 127.0.0.1:6010          0.0.0.0:*               LISTEN      2350/sshd: mrcode@p 
tcp        0      0 127.0.0.1:6011          0.0.0.0:*               LISTEN      10579/sshd: root@pt 
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      1/systemd           
tcp        0      0 192.168.122.1:53        0.0.0.0:*               LISTEN      1975/dnsmasq        
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1378/sshd           
tcp6       0      0 ::1:25                  :::*                    LISTEN      1578/master         
tcp6       0      0 ::1:6010                :::*                    LISTEN      2350/sshd: mrcode@p 
tcp6       0      0 ::1:6011                :::*                    LISTEN      10579/sshd: root@pt 
tcp6       0      0 :::555                  :::*                    LISTEN      11573/vsftpd        
tcp6       0      0 :::111                  :::*                    LISTEN      1/systemd           
tcp6       0      0 :::22                   :::*                    LISTEN      1378/sshd           
udp        0      0 192.168.122.1:53        0.0.0.0:*                           1975/dnsmasq        
udp        0      0 0.0.0.0:67              0.0.0.0:*                           1975/dnsmasq        
udp        0      0 0.0.0.0:111             0.0.0.0:*                           1/systemd           
udp        0      0 0.0.0.0:33017           0.0.0.0:*                           920/avahi-daemon: r 
udp        0      0 0.0.0.0:669             0.0.0.0:*                           925/rpcbind         
udp        0      0 0.0.0.0:5353            0.0.0.0:*                           920/avahi-daemon: r 
udp6       0      0 :::111                  :::*                                1/systemd           
udp6       0      0 :::669                  :::*                                925/rpcbind 
```

æ¯”å¦‚ä¸Šé¢æ˜¾ç¤º `avahi-daemon` æœåŠ¡ç›‘å¬äº† 5353 å’Œ 33017 ç«¯å£ï¼Œå¯ä»¥é€šè¿‡ systemctl æŸ¥æ‰¾æ˜¯å¦çœŸçš„æœ‰ avahi-daemon æœåŠ¡

```bash
[root@study ~]# systemctl list-units --all | grep avahi-daemon
  avahi-daemon.service                                                                                           loaded    active   running   Avahi mDNS/DNS-SD Stack
  avahi-daemon.socket                                                                                            loaded    active   running   Avahi mDNS/DNS-SD Stack Activation Socket
```

avahi-daemon çš„ç›®çš„æ˜¯åœ¨å±€åŸŸç½‘è¿›è¡Œç±»ä¼¼ç½‘èŠ³çš„æœç´¢ï¼Œå› æ­¤è¿™ä¸ªæœåŠ¡å¯ä»¥ååŠ©ä½ åœ¨åŒºç½‘å†…éšæ—¶äº†è§£å³æ’å³ç”¨çš„è®¾å¤‡ã€‚åŒ…æ‹¬ç¬”è®°æœ¬ç”µè„‘ç­‰ï¼Œåªè¦ä½ è¿ä¸ŠåŒºç½‘ï¼Œä½ å°±èƒ½çŸ¥é“è°è¿›æ¥äº†ã€‚é—®é¢˜æ˜¯ï¼Œä½ å¯èƒ½ä¸éœ€è¦è¿™ä¸ªåè®®ï¼Œå…³é—­å®ƒ

```bash
# å…³é—­ä¸¤ä¸ªæœåŠ¡ï¼Œå¹¶ä¸”å–æ¶ˆå¼€æœºå¯åŠ¨
[root@study ~]# systemctl stop avahi-daemon.service 
Warning: Stopping avahi-daemon.service, but it can still be activated by:
  avahi-daemon.socket
[root@study ~]# systemctl stop avahi-daemon.socket  
[root@study ~]# systemctl disable avahi-daemon.service avahi-daemon.socket 
Removed symlink /etc/systemd/system/multi-user.target.wants/avahi-daemon.service.
Removed symlink /etc/systemd/system/sockets.target.wants/avahi-daemon.socket.
Removed symlink /etc/systemd/system/dbus-org.freedesktop.Avahi.service.
[root@study ~]# netstat -tlunp
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1578/master         
tcp        0      0 127.0.0.1:6010          0.0.0.0:*               LISTEN      2350/sshd: mrcode@p 
tcp        0      0 127.0.0.1:6011          0.0.0.0:*               LISTEN      10579/sshd: root@pt 
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      1/systemd           
tcp        0      0 192.168.122.1:53        0.0.0.0:*               LISTEN      1975/dnsmasq        
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1378/sshd           
tcp6       0      0 ::1:25                  :::*                    LISTEN      1578/master         
tcp6       0      0 ::1:6010                :::*                    LISTEN      2350/sshd: mrcode@p 
tcp6       0      0 ::1:6011                :::*                    LISTEN      10579/sshd: root@pt 
tcp6       0      0 :::555                  :::*                    LISTEN      11573/vsftpd        
tcp6       0      0 :::111                  :::*                    LISTEN      1/systemd           
tcp6       0      0 :::22                   :::*                    LISTEN      1378/sshd           
udp        0      0 192.168.122.1:53        0.0.0.0:*                           1975/dnsmasq        
udp        0      0 0.0.0.0:67              0.0.0.0:*                           1975/dnsmasq        
udp        0      0 0.0.0.0:111             0.0.0.0:*                           1/systemd           
udp        0      0 0.0.0.0:669             0.0.0.0:*                           925/rpcbind         
udp6       0      0 :::111                  :::*                                1/systemd           
udp6       0      0 :::669                  :::*                                925/rpcbind  
```

ä¸€èˆ¬æ¥è¯´ï¼Œä½ æœ¬åœ°æœåŠ¡å™¨è‡³å°‘éœ€è¦ 25 ç«¯å£ï¼Œè€Œ 22 ç«¯å£æœ€å¥½åŠ ä¸Šé˜²ç«å¢™æ¥ç®¡ç†è¿œç¨‹è”æœºç™»å½•æ¯”è¾ƒå¦¥å½“ã€‚555 ç«¯å£æ˜¯æˆ‘ä»¬å‰é¢ç»ƒä¹ æµ‹è¯•ä¿®æ”¹çš„ã€‚è¿™æ ·çš„ç³»ç»Ÿèƒ½å¤Ÿè¢«é»‘çš„æœºä¼šå·²ç»å°‘å¾ˆå¤šäº†ã€‚