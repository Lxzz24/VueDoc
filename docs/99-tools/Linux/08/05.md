---
title: å…‰ç›˜å†™å…¥å·¥å…·
sidebarDepth: 0 
category: Tools 
tag: Linux
---


ä¼ä¸šå–œæ¬¢ä½¿ç”¨ç£å¸¦æ¥è¿›è¡Œå¤‡ä»½ï¼Œå®¹é‡é«˜ã€å­˜å‚¨æ—¶é™å¸¸ã€è€æ‘”ç­‰ç­‰ï¼Œè‡³äºä»¥å‰çš„ DVD/CD ç­‰ï¼Œå› ä¸ºå­˜å‚¨é€Ÿåº¦æ…¢ã€å®¹é‡æ²¡æœ‰å¤§å¹…åº¦æå‡ï¼Œå¾ˆå°‘ä½¿ç”¨äº†

è™½ç„¶ç°åœ¨å¾ˆå°‘ä½¿ç”¨äº†ï¼Œä¸è¿‡åœ¨ç‰¹åˆ«çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è¿™ä¸œè¥¿åˆä¸è¡Œï¼Œå› æ­¤è¿™é‡Œä»‹ç»åœ¨æ–‡æœ¬æ¨¡å¼çš„åˆ»å½•è¡Œä¸ºæ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Œé€šå¸¸åšæ³•æ˜¯è¿™æ ·çš„ï¼š

1. ç°å°†æ‰€éœ€è¦å¤‡ä»½çš„æ•°æ®å»ºç«‹æˆä¸ºä¸€ä¸ªæ˜ åƒæ–‡æ¡£ï¼ˆiso)ï¼Œåˆ©ç”¨ mkisofs æŒ‡ä»¤æ¥å¤„ç†
2. å°†è¯¥æ˜ åƒæ–‡ä»¶åˆ»å½•åˆ°å…‰ç›˜æˆ–åˆ™ DVD ä¸­ï¼Œåˆ©ç”¨ cdrecord æŒ‡ä»¤æ¥å¤„ç†

## ğŸ€ mkisofs å»ºç«‹æ˜ åƒæ–‡æ¡£

åˆ»å½•å¯å¼€æœºä¸ä¸å¯å¼€æœºçš„å…‰ç›˜ï¼Œä½¿ç”¨æ–¹æ³•ä¸å¤ªä¸€æ ·

### åˆ¶ä½œä¸€èˆ¬æ•°æ®å…‰ç›˜æ˜ åƒæ–‡ä»¶

```bash
mkisofs [-o æ˜ åƒæ–‡æ¡£][-Jrv][-V vol][-m file] å¾…å¤‡ä»½æ–‡ä»¶ -graft-point isodir=systemdir ..
```

é€‰é¡¹ä¸å‚æ•°ï¼š

- oï¼šæ¥æƒ³è¦äº§ç”Ÿçš„æ˜ åƒæ–‡æ¡£å
- Jï¼šäº§ç”Ÿè¾ƒå…¼å®¹äº windows æœºå™¨çš„æ–‡ä»¶åç»“æ„ï¼Œå¯å¢åŠ æ–‡ä»¶åé•¿åº¦ 64 ä¸ª unicode å­—ç¬¦
- rï¼šé€šè¿‡ Rock Ridge äº§ç”Ÿæ”¯æŒ Unix/Linux çš„æ–‡ä»¶æ•°æ®ï¼Œå¯è®°å½•è¾ƒå¤šçš„ä¿¡æ¯ï¼ˆå¦‚ UID/GID) ç­‰
- vï¼šæ˜¾ç¤ºå»ºç«‹ ISO æ–‡ä»¶çš„è¿‡ç¨‹
- V volï¼šå»ºç«‹ Volume ï¼Œæœ‰ç‚¹åƒ windows åœ¨æ–‡ä»¶æ€»ç®¡å†…çœ‹åˆ°çš„ CD title çš„ä¸œè¥¿
- m fileï¼š-m ä¸ºæ’é™¤æ–‡ä»¶ï¼ˆexcludeï¼‰ï¼Œåé¢çš„æ–‡ä»¶ä¸å¤‡ä»½åˆ°è¯¥æ˜ åƒæ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ * é€šé…ç¬¦
- -graft-pointï¼šgraft æœ‰è½¬å«æˆ–ç§»æ¤çš„æ„æ€ï¼Œç›¸å…³èµ„æ–™åœ¨ä¸‹é¢è¯´æ˜

mkisofs æœ‰éå¸¸å¤šå¥½ç”¨çš„é€‰é¡¹ï¼Œåªæƒ³åˆ¶ä½œæ•°æ®å…‰ç›˜æ—¶ï¼Œä¸Šè¿°çš„é€‰é¡¹å°±å¤Ÿç”¨äº†ã€‚å…‰ç›˜æ ¼å¼ä¸€èˆ¬ç§°ä¸º iso9660ï¼Œè¿™ç§æ ¼å¼ä¸€èˆ¬ä»…æ”¯æŒæ—§ç‰ˆçš„ DOS æ–‡ä»¶åï¼ˆæ–‡ä»¶åªèƒ½ä»¥ 8.3 å³ æ–‡ä»¶å 8 ä¸ªå­—ç¬¦ï¼Œæ‰©å±•å 3 ä¸ªå­—ç¬¦çš„æ–¹å¼å­˜åœ¨ï¼‰ã€‚å¦‚æœåŠ ä¸Š -r é€‰é¡¹åï¼Œæ–‡ä»¶ä¿¡æ¯èƒ½å¤Ÿè¢«è®°å½•å¾—æ¯”è¾ƒå®Œæ•´

æ­¤å¤–ï¼Œä¸€èˆ¬é¢„è®¾çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è¦è¢«åŠ åˆ°æ˜ åƒä¸­çš„æ–‡ä»¶éƒ½ä¼šè¢«æ”¾ç½®åˆ°æ˜ åƒæ–‡ä»¶çš„æ ¹ç›®å½•ï¼Œå¦‚æ­¤ä¸€æ¥å¯èƒ½ä¼šé€ æˆåˆ»å½•åçš„æ–‡ä»¶åˆ†ç±»ä¸æ˜“çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ -graft-point é€‰é¡¹

- æ˜ åƒæ–‡ä»¶ä¸­çš„ç›®å½•æ‰€åœ¨ ç­‰äº å®é™… Linux æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•æ‰€åœ¨
- /movies=/srv/moviesï¼ˆåœ¨ Linux çš„ /srv/movies å†…çš„æ–‡ä»¶ï¼ŒåŠ åˆ°æ˜ åƒæ–‡ä»¶ä¸­çš„ /movies/ ç›®å½•ï¼‰
- /linux/etc=/etcï¼ˆå°† Linux ä¸­çš„ /etc/ å†…çš„æ‰€æœ‰æ•°æ®å¤‡ä»½åˆ°æ˜ åƒæ–‡ä»¶ä¸­çš„ /liux/etc ç›®å½•ä¸­

```bash
# å‡å¦‚æƒ³è¦è®² /rootã€/homeã€/etc ç­‰ç›®å½•å†…çš„æ•°æ®é€šè¿‡åˆ»å½•èµ·æ¥çš„è¯ï¼Œå…ˆè¦å¤„ç†ä¸‹æ˜ åƒ
# å…ˆä¸ä½¿ç”¨ -graft-point çš„é€‰é¡¹å¤„ç†
[root@study ~]# mkisofs -v -o /tmp/system.img /root /home/ /etc/
I: -input-charset not specified, using utf-8 (detected in locale settings)
genisoimage 1.1.11 (Linux)
Scanning /root
... å¾ˆå¤šçš„æ–‡ä»¶è®°å½•è¾“å‡º
Writing:   The File(s)                             Start Block 955
  9.23% done, estimate finish Tue Oct 29 03:55:51 2019
 18.47% done, estimate finish Tue Oct 29 03:55:51 2019
 27.72% done, estimate finish Tue Oct 29 03:55:51 2019
 36.94% done, estimate finish Tue Oct 29 03:55:51 2019
 46.19% done, estimate finish Tue Oct 29 03:55:51 2019
 55.39% done, estimate finish Tue Oct 29 03:55:51 2019
 64.62% done, estimate finish Tue Oct 29 03:55:51 2019
 73.85% done, estimate finish Tue Oct 29 03:55:51 2019
 83.08% done, estimate finish Tue Oct 29 03:55:52 2019
 92.33% done, estimate finish Tue Oct 29 03:55:52 2019
Total translation table size: 0
Total rockridge attributes bytes: 0
Total directory bytes: 1869824
Path table size(bytes): 13350
Done with: The File(s)                             Block(s)    53057
Writing:   Ending Padblock                         Start Block 54012
Done with: Ending Padblock                         Block(s)    150
Max brk space used 378000
54162 extents written (105 MB)
# ç¬”è€…è¿™ä¸ªç›´æ¥æˆåŠŸäº†ï¼Œåœ¨æ ‘ä¸Šå› ä¸º /etc/crontab å’Œ /root/crontab ä¸­æœ‰ç›¸åŒçš„æ–‡ä»¶
# ä»–ä»¬æ²¡æœ‰è¢«å½’æ¡£çš„æ—¶å€™ï¼Œéƒ½ä¼šå‡ºç°åœ¨æ˜ åƒæ–‡æ¡£ä¸­çš„æ ¹ç›®å½•ï¼Œæ‰€ä»¥æŠ¥é”™

[root@study ~]# ll -h /tmp/system.img 
-rw-r--r--. 1 root root 106M 10æœˆ 29 03:55 /tmp/system.img

# æŸ¥çœ‹è¯¥æ˜ åƒä¸­çš„å†…å®¹
# å¯ä»¥æŒ‚è½½åˆ°æŸä¸ªç›®å½•ä¸‹ï¼Œå†æŸ¥çœ‹
[root@study ~]# mount -o loop /tmp/system.img /mnt/
mount: /dev/loop0 å†™ä¿æŠ¤ï¼Œå°†ä»¥åªè¯»æ–¹å¼æŒ‚è½½
[root@study ~]# df -h /mnt/
æ–‡ä»¶ç³»ç»Ÿ        å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹
/dev/loop0      106M  106M     0  100% /mnt
# ä½¿ç”¨ ll /mnt æŒ‡ä»¤æŸ¥çœ‹ï¼Œåªå‘ç°é‡Œé¢å…¨æ˜¯æ²¡æœ‰è·¯å¾„çš„æ–‡ä»¶
```

å‘ç°æ‰€æœ‰çš„æ•°æ®éƒ½æ”¾åœ¨äº†æ˜ åƒæ–‡ä»¶ä¸­çš„æ ¹ç›®å½•ï¼Œä¸‹é¢ä½¿ç”¨å½’æ¡£å†çœ‹çœ‹

```bash
# å¸è½½æ‰
umount /mnt

[root@study ~]# mkisofs -r -V 'linux_file' -o /tmp/system.img -m /roo/etc --graft-point /root=/root /home/=/home /etc=/etc

[root@study ~]# ll -h /tmp/system.img 
-rw-r--r--. 1 root root 107M 10æœˆ 29 04:05 /tmp/system.img
[root@study ~]# mount -o loop /tmp/system.img /mnt/
mount: /dev/loop0 å†™ä¿æŠ¤ï¼Œå°†ä»¥åªè¯»æ–¹å¼æŒ‚è½½
[root@study ~]# ll /mnt/
æ€»ç”¨é‡ 46
dr-xr-xr-x. 143 root root 38912 10æœˆ  4 18:38 etc
dr-xr-xr-x.   4 root root  2048 10æœˆ  8 23:01 home
dr-xr-xr-x.   7 root root  4096 10æœˆ 29 00:57 root
dr-xr-xr-x.   9 root root  2048 10æœˆ 29 04:05 rr_moved
```

## ğŸ€ åˆ¶ä½œ/ä¿®æ”¹å¯å¼€æœºå…‰ç›˜æ˜ åƒæ–‡æ¡£

è¦åˆ¶ä½œä¸€é”®å®‰è£…ç³»ç»Ÿçš„å…‰ç›˜ï¼Œéœ€è¦ä¿®æ”¹åŸç‰ˆå…‰ç›˜æ˜ åƒæ–‡ä»¶ï¼Œæ”¹æˆå¯ä»¥è‡ªåŠ¨åŠ è½½æŸäº›ç¨‹åºçš„æµç¨‹ï¼›åˆ»å½•æˆå…‰ç›˜åï¼Œæ”¾å…¥å…‰é©±ï¼Œåªè¦å¼€æœºåˆ©ç”¨å…‰ç›˜æ¥å¼€æœºï¼Œå°±ç›´æ¥å®‰è£…ç³»ç»Ÿï¼Œä¸å†éœ€è¦è¯¢é—®ç®¡ç†å‘˜ä¸€äº›é—®é¢˜ï¼Œç­‰äºæ˜¯è‡ªåŠ¨åŒ–å¤„ç†ï¼Œå½“ç„¶è¿™äº›æµç¨‹å¾ˆéº»çƒ¦ï¼Œéœ€è¦äº†è§£ kickstart ç­‰ç›¸å…³æŠ€æœ¯ï¼Œè¿™é‡Œå…ˆä¸è°ˆã€‚æœ¬ç« è®©ä½ çŸ¥é“å¦‚ä½•è®©å…‰ç›˜å†…å®¹è¢«ä¿®æ”¹ä¹‹åï¼Œè¿˜å¯ä»¥åˆ»å½•æˆå¯å¼€æœºçš„æ˜ åƒæ–‡æ¡£

ç¬”è€…åˆšå¼€å§‹ä½¿ç”¨ macï¼Œä¼ å…¥è™šæ‹Ÿæœºæ–‡æ¡£ä¸çŸ¥é“æ€ä¹ˆå¼„ï¼Œç‰¹åˆ«æ…¢ã€‚å°±ä¸è·Ÿç€ç»ƒä¹ äº†ï¼Œç›´æ¥æˆªå›¾äº†

```bash
# æŸ¥çœ‹ iso çš„ä¿¡æ¯
isoinfo -d -i /home/CentOS-7.iso 
# æŒ‚è½½è¯¥ iso åˆ° /mnt
mount /home/CentOS-7.iso /mnt
mkdir /srv/newcd
# rsync å¯ä»¥å®Œæ•´å¤åˆ¶æ‰€æœ‰çš„æƒé™å±æ€§ç­‰æ•°æ®ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œé•œåƒå¤„ç†
# ç°åœ¨ newcd æ€»å·²ç»æ˜¯å®Œæ•´æ˜ åƒæ–‡æ¡£çš„å†…å®¹äº†
rsync -a /mnt /srv/newcd
ll /srv/newcd/
# è¿™é‡Œå°±å¯ä»¥ä¿®æ”¹ newcd é‡Œé¢çš„å†…å®¹äº†ï¼Œå‡è®¾å·²ç»å¤„ç†å®Œ
ll /srv/newcd/isolinux
cd /srv/newcd
mkisofs -o /custom.iso -b isolinux/isolinux.bin -c isolinux/boot.cat \
> -no-emul-boot -V 'CentOS 7 x86_64' -boot-load-size 4 -boot-info-table -R -J -v -T
# è¿è¡Œä¹‹åï¼Œå°±ä¼šå­˜åœ¨ä¸€ä¸ª /custom.img çš„æ–‡ä»¶å­˜åœ¨,å¯ä»¥å°†è¯¥æ–‡ä»¶åˆ»å½•åˆ°å…‰ç›˜ä¸Š
```

![image-20191101234333791](./assets/image-20191101234333791.png)

![image-20191101234746782](./assets/image-20191101234746782.png)

## ğŸ€ cdrecord å…‰ç›˜åˆ»å½•å·¥å…·

æ–°ç‰ˆçš„ CentOS 7 ä½¿ç”¨çš„æ˜¯ wodim æŒ‡ä»¤æ¥è¿›è¡Œåˆ»å½•è¡Œä¸ºï¼ˆæ—§ç‰ˆæ˜¯ cdrecordï¼Œä¸ºäº†å…¼å®¹ wodim ä¹Ÿé“¾æ¥äº†æ—§ç‰ˆçš„ï¼‰

```bash
# å¸¸è§çš„æŒ‡ä»¤å…¥æˆ
wodim --devices dev/det/sr0			# æŸ¥è¯¢åˆ»å½•æœºçš„ BUS ä½ç½®
wodim -v dev=/dev/sr0 blank=[fast|all]	# æŠ¹é™¤é‡å¤è¯»å†™ç‰‡
wodim -v dev=/dev/sr0 -format		# æ ¼å¼åŒ– DVD + RW
wodim -v dev=/dev/sr0 [å¯ç”¨é€‰é¡¹åŠŸèƒ½] file.iso
```

é€‰é¡¹ä¸å‚æ•°ï¼š

- devicesï¼šç”¨åœ¨æ‰«æç£ç›˜æ€»çº¿å¹¶æ‰¾å‡ºå¯ç”¨çš„åˆ»å½•æœºï¼Œåç»­çš„è£…ç½®ä¸º ATA æ¥å£
- vï¼šåœ¨ cdrecord è¿ä½œçš„è¿‡ç¨‹ä¸­ï¼Œæ˜¾ç¤ºè¿‡ç¨‹
- dev=/dev/sr0ï¼šå¯ä»¥æ‰¾å‡ºæ­¤å…‰é©±çš„ bus åœ°å€ï¼Œéå¸¸é‡è¦
- `blank[fast|all]ï¼šblank ä¸ºæŠ¹é™¤å¯é‡å¤å†™çš„ Cd/DVD-RW ï¼Œä½¿ç”¨ fast è¾ƒå¿«ï¼Œall è¾ƒå®Œæˆ
- formatï¼šå¯¹å…‰ç›˜è¿›è¡Œæ ¼å¼åŒ–ï¼Œä½†æ˜¯ä»…é’ˆå¯¹ DVD+RW è¿™ç§æ ¼å¼çš„ DVD
- å¯ç”¨é€‰é¡¹ä¸åŠŸèƒ½ï¼š
  - `-data`ï¼šæŒ‡å®šåé¢çš„æ–‡ä»¶ä»¥æ•°æ®æ ¼å¼å†™å…¥ï¼Œä¸æ˜¯ä»¥ CD éŸ³è½¨ï¼ˆ-audioï¼‰æ–¹å¼å†™å…¥
  - speed=xï¼šæŒ‡å®šåˆ»å½•é€Ÿåº¦ï¼Œä¾‹å¦‚ CD å¯ç”¨ speed=40 ä¸º 40 å€æ•°ï¼ŒDVD åˆ™å¯ç”¨ speed=4 ä¹‹ç±»
  - `-eject`ï¼šæŒ‡å®šåˆ»å½•å®Œæ¯•åè‡ªåŠ¨é€€å‡ºå…‰ç›˜
  - fs=Ymï¼šæŒ‡å®šå¤šå°‘ç¼“å­˜å­˜å‚¨å™¨ï¼Œå¯ç”¨åœ¨å°†æ˜ åƒæ¡£å…ˆæš‚å­˜è‡³ç¼“å†²å­˜å‚¨å™¨ã€‚é¢„è®¾ä¸º 4mï¼Œä¸€èˆ¬å»ºè®®å¯å¢åŠ åˆ° 8mï¼Œä¸è¿‡è¿˜æ˜¯å¾—è§†ä½ çš„åˆ»å½•æœºè€Œå®š
- é’ˆå¯¹ DVD çš„é€‰é¡¹åŠŸèƒ½ï¼š
  - driveropts=burnfreeï¼šæ‰“å¼€ Buffer Underrun Free æ¨¡å¼çš„å†™å…¥åŠŸèƒ½
  - `-sao`ï¼šæ”¯æŒ DVD-RW çš„æ ¼å¼

### ä¾¦æµ‹ä½ çš„åˆ»å½•æœºæ‰€åœ¨ä½ç½®

æ–‡ä¸èƒ½æ¨¡å¼çš„åˆ»å½•ç¡®å®æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦å…ˆæ‰¾åˆ°åˆ»å½•æœºæ‰è¡Œã€‚æ—©æœŸåˆ»å½•æœºéƒ½æ˜¯ä½¿ç”¨ SCSI æ¥å£ï¼Œå› æ­¤é…åˆ SCSI æ¥å£è®¤å®šæ¥æŸ¥è¯¢

```bash
[root@study ~]# ll /dev/sr0 
brw-rw----+ 1 root cdrom 11, 0 10æœˆ 28 21:38 /dev/sr0	 # ä¸€èˆ¬ Linux å…‰é©±æ–‡ä»¶å
[root@study ~]# wodim --devices dev=/dev/sr0
wodim: Warning: controller returns zero sized CD capabilities page.
wodim: Warning: controller returns wrong size for CD capabilities page.
wodim: Warning: controller returns wrong page 0 for CD capabilities page (2A).
wodim: Overview of accessible drives (1 found) :
-------------------------------------------------------------------------
 0  dev='/dev/sr0'      rwrw-- : 'VBOX' 'CD-ROM'
-------------------------------------------------------------------------

#ç¬”è€…è¿™ä¸ªæ˜¯è™šæ‹Ÿæœºçš„ï¼Œå› æ­¤æ— æ³•çœŸæ­£çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆä¸‹é¢çš„æŒ‡ä»¤ç›´æ¥è®°å½•ä¹¦ä¸Šçš„æ­¥éª¤
```

### è¿›å…¥ CD/DVD çš„åˆ»å½•åŠ¨ä½œ

å¦‚ä½•å°† /tmp/system.img åˆ»å½•åˆ° cd/dvd é‡Œé¢ï¼Ÿ

```bash
# 0. å…ˆæŠ¹é™¤å…‰ç›˜çš„åŸå§‹å†…å®¹ï¼šï¼ˆéå¯é‡å¤è¯»å†™åˆ™å¯ç•¥è¿‡æ­¤æ­¥éª¤ï¼‰
wodim -v dev=/dev/sr0 blank=fast
# ä¸­é—´ä¼šæŠ›å‡ºä¸€å †ä¿¡æ¯å‘Šè¯‰ä½ æŠ¹é™¤çš„è¿›åº¦ï¼Œè€Œä¸”ä¼šæœ‰ 10 ç§’çš„æ—¶é—´ç­‰å¾…ä½ å–æ¶ˆ
# 1. å¼€å§‹åˆ»å½•; eject åˆ»å½•å®Œæˆä¹‹åï¼ŒDVD ä¼šè¢«é€€å‡ºå…‰é©±ï¼Œè®°å¾—æ¨å›å»
wodim -v dev=/dev/sr0 speed=4 -dummy -eject /tmp/system.img
# 2. åˆ»å½•å®Œæˆåï¼Œæµ‹è¯•æŒ‚è½½ä¸€ä¸‹ï¼Œæ£€éªŒå†…å®¹
mount /dev/sr0/mnt
dh -h /mnt
ll /mnt
umount /mnt
```

ç®€å•åˆ»å½•ä¸Šé¢çš„è¯­æ³•å°±å¤Ÿäº†ï¼Œä½†æ˜¯è¿˜æ˜¯å»ºè®®åœ¨å›¾å½¢åŒ–ç•Œé¢ä¸­æ¥åˆ»å½•