---
title: æ–‡ä»¶ç³»ç»Ÿçš„ç®€å•æ“ä½œ
sidebarDepth: 0 
category: Tools 
tag: Linux
---

æœ¬ç« è®²è§£å¦‚ä½•æŸ¥è¯¢æ•´ä½“æ–‡ä»¶ç³»ç»Ÿçš„æ€»å®¹é‡ä¸æ¯ä¸ªç›®å½•æ‰€å ç”¨çš„å®¹é‡ã€‚
æ­¤å¤–å‰é¢è°ˆåˆ°çš„æ–‡ä»¶ç±»å‹ä¸­å°šæœªå°†æ¸…æ¥šçš„è¿æ¥æ–‡æ¡£ï¼ˆlink fileï¼‰ä¹Ÿä¼šåœ¨è¿™é‡Œä»‹ç»

## ğŸ€ ç£ç›˜ä¸ç›®å½•çš„å®¹é‡
ç£ç›˜æ•´ä½“æ•°æ®æ˜¯åœ¨ superblock åŒºå—ä¸­ï¼Œä½†æ˜¯æ¯ä¸ªå„åˆ«æ–‡ä»¶çš„å®¹é‡åˆ™åœ¨ inode ä¸­è®°è½½çš„ã€‚
å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤æŸ¥è¯¢ï¼š

- dfï¼šåˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ç£ç›˜ä½¿ç”¨é‡
- duï¼šè¯„ä¼°æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨é‡ï¼ˆå¸¸ç”¨åœ¨é¢„ä¼°ç›®å½•æ‰€å å®¹é‡ï¼‰

### df

```bash
df [-ahikHTm] [ç›®å½•æˆ–æ–‡ä»¶å]
```
- aï¼šåˆ—å‡ºæ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç³»ç»Ÿç‰¹æœ‰çš„ /proc ç­‰æ–‡ä»¶ç³»ç»Ÿ
- kï¼šä»¥ KBytes çš„å®¹é‡æ˜¾ç¤ºä¸ªæ–‡ä»¶ç³»ç»Ÿ
- mï¼šä»¥ MBytes çš„å®¹é‡æ˜¾ç¤º
- hï¼šä»¥äººç±»å®¹æ˜“é˜…è¯»çš„ GBytesã€MBytesã€KBytes ç­‰æ ¼å¼è‡ªè¡Œæ˜¾ç¤º
- Hï¼šä»¥ M=1000K å–ä»£ M=1024k çš„è¿›ä½æ–¹å¼
- Tï¼šè¿åŒè¯¥ partition çš„ filesystem åç§°ï¼ˆä¾‹å¦‚ xfsï¼‰ä¹Ÿåˆ—å‡º
- iï¼šä¸ç”¨ç£ç›˜å®¹é‡ï¼Œè€Œå·² inode çš„æ•°é‡æ¥æ˜¾ç¤º

å®è·µç»ƒä¹ 

å°†ç³»ç»Ÿå†…æ‰€æœ‰çš„ filesystem åˆ—å‡ºæ¥

```bash
[mrcode@study ~]$ df
Filesystem              1K-blocks    Used Available Use% Mounted on
devtmpfs                   578464       0    578464   0% /dev
tmpfs                      595476       0    595476   0% /dev/shm
tmpfs                      595476    8660    586816   2% /run
tmpfs                      595476       0    595476   0% /sys/fs/cgroup
/dev/mapper/centos-root  10475520 4795672   5679848  46% /
/dev/mapper/centos-home   5232640   40552   5192088   1% /home
/dev/sda2                 1038336  174108    864228  17% /boot
tmpfs                      119096      12    119084   1% /run/user/42
tmpfs                      119096       0    119096   0% /run/user/1000
# ä¸åŠ ä»»ä½•é€‰é¡¹ï¼Œä¼šé»˜è®¤å°†ç³»ç»Ÿå†…æ‰€æœ‰çš„ï¼ˆä¸å«ç‰¹æ®Šå†…å­˜å†…çš„æ–‡ä»¶ç³»ç»Ÿä¸ swapï¼‰éƒ½ä»¥ 1 Kbytes çš„å®¹é‡åˆ—å‡ºæ¥
# /dev/shm æ˜¯ä¸å†…å­˜æœ‰å…³çš„æŒ‚è½½ï¼Œå¯ä»¥å…ˆå¿½ç•¥
```

- Filesystemï¼šä»£è¡¨è¯¥æ–‡ä»¶ç³»ç»Ÿæ˜¯åœ¨å“ªä¸ª partition
- 1k-block2ï¼šè¯¥åˆ—ä¸‹çš„å•ä½ä¸º 1kbï¼Œå¯ä»¥åˆ©ç”¨ -h æˆ– -m æ¥æ”¹å˜å®¹é‡
- Usedï¼šå·²ä½¿ç”¨æ‰çš„ç£ç›˜ç©ºé—´
- Availableï¼šå¯ç”¨ç©ºé—´
- Use%ï¼šç£ç›˜ä½¿ç”¨ç‡
- Mounted onï¼šç£ç›˜æŒ‚è½½çš„ç›®å½•ï¼ˆæŒ‚è½½ç‚¹ï¼‰

å°†å®¹é‡ç»“æœä»¥å®¹æ˜“é˜…è¯»çš„å®¹é‡æ ¼å¼æ˜¾ç¤º

```bash
[mrcode@study ~]$ df -h
Filesystem               Size  Used Avail Use% Mounted on
devtmpfs                 565M     0  565M   0% /dev
tmpfs                    582M     0  582M   0% /dev/shm
tmpfs                    582M  8.5M  574M   2% /run
tmpfs                    582M     0  582M   0% /sys/fs/cgroup
/dev/mapper/centos-root   10G  4.6G  5.5G  46% /
/dev/mapper/centos-home  5.0G   40M  5.0G   1% /home
/dev/sda2               1014M  171M  844M  17% /boot
tmpfs                    117M   12K  117M   1% /run/user/42
tmpfs                    117M     0  117M   0% /run/user/1000
```

å°†ç³»ç»Ÿå†…çš„æ‰€æœ‰ç‰¹æ®Šæ–‡ä»¶æ ¼å¼åŠåç§°éƒ½åˆ—å‡ºæ¥

```bash
[mrcode@study ~]$ df -aT
Filesystem              Type       1K-blocks    Used Available Use% Mounted on
sysfs                   sysfs              0       0         0    - /sys
proc                    proc               0       0         0    - /proc
devtmpfs                devtmpfs      578464       0    578464   0% /dev
securityfs              securityfs         0       0         0    - /sys/kernel/security
tmpfs                   tmpfs         595476       0    595476   0% /dev/shm

# è¿™é‡Œåªæ˜¯å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œè¿˜æœ‰å¾ˆå¤šï¼Œå‡ ä¹ä¸Šéƒ½åœ¨å†…å­˜ä¸­ï¼Œä¾‹å¦‚ /proc è¿™ä¸ªæŒ‚è½½ç‚¹
# å› æ­¤è¿™äº›ç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿéƒ½ä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´
```

å°† /etc/ ä¸‹çš„å¯ç”¨çš„ç£ç›˜å®¹é‡ä»¥æ˜“è¯»æ ¼å¼æ˜¾ç¤º

```bash
[mrcode@study ~]$ df -h /etc/
Filesystem               Size  Used Avail Use% Mounted on
/dev/mapper/centos-root   10G  4.6G  5.5G  46% /

# åœ¨ df åé¢åŠ ä¸Šç›®å½•æˆ–åˆ™æ˜¯æ–‡ä»¶æ—¶ï¼Œdf ä¼šè‡ªåŠ¨åˆ†æè¯¥ç›®å½•æˆ–æ–‡ä»¶æ‰€åœ¨çš„ partitionï¼Œ
# å¹¶å°†è¯¥ partition å®¹é‡æ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥å°±å¯ä»¥çŸ¥é“è¯¥ç›®å½•ä¸‹åˆå¤šå°‘å®¹é‡å¯ç”¨äº†
```

å°†ç›®å‰å„ä¸ª partition å½“ä¸­å¯ç”¨çš„ inode æ•°é‡åˆ—å‡º

```bash
[mrcode@study ~]$ df -ih
Filesystem              Inodes IUsed IFree IUse% Mounted on
devtmpfs                  142K   382  141K    1% /dev
tmpfs                     146K     1  146K    1% /dev/shm
tmpfs                     146K   653  145K    1% /run
tmpfs                     146K    16  146K    1% /sys/fs/cgroup
/dev/mapper/centos-root   5.0M  150K  4.9M    3% /
/dev/mapper/centos-home   2.5M   237  2.5M    1% /home
/dev/sda2                 512K   340  512K    1% /boot
tmpfs                     146K     9  146K    1% /run/user/42
tmpfs                     146K     1  146K    1% /run/user/1000

# -i ä¸»è¦åˆ—å‡ºå¯ç”¨çš„ inode å‰©ä½™å®¹é‡ä¸æ€»å®¹é‡
# ä¼šå‘ç°ï¼Œé€šå¸¸ inode çš„æ•°é‡å‰©ä½™é€—æ¯” block è¿˜è¦å¤š
```

ç”±äº df ä¸»è¦è¯»å–çš„æ•°æ®å‡ ä¹éƒ½æ˜¯é’ˆå¯¹ä¸€æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤è¯»å–çš„èŒƒå›´ä¸»è¦æ˜¯åœ¨ Superblock å†…çš„ä¿¡æ¯ï¼Œæ‰€ä»¥è¯¥æŒ‡ä»¤æ˜¾ç¤ºç»“æœé€Ÿåº¦éå¸¸å¿«é€Ÿã€‚
åœ¨æ˜¾ç¤ºç»“æœä¸­ï¼Œè¦ç‰¹åˆ«ç•™æ„æ ¹ç›®å½•å®¹é‡ï¼Œå› ä¸ºæˆ‘ä»¬æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ç”±æ ¹ç›®å½•è¡ç”Ÿå‡ºæ¥çš„ï¼ˆè¿™é‡Œåº”è¯¥è¯´çš„æ˜¯ï¼Œå½“å‰è¿™é¢—ç£ç›˜åˆ†åŒºï¼Œæ²¡æœ‰é¢å¤–çš„æŒ‚è½½ï¼Œå‡ ä¹ä¸Šæ‰€æœ‰æ•°æ®éƒ½æ”¾åœ¨äº†åŒä¸€ä¸ªåˆ†åŒºä¸Šã€‚

å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä½¿ç”¨ -a å‚æ•°æ—¶ï¼Œç³»ç»Ÿä¼šå‡ºç° /proc è¿™ä¸ªæŒ‚è½½ç‚¹ï¼Œä½†æ˜¯é‡Œé¢çš„ä¸œè¥¿
éƒ½æ˜¯ 0ï¼Œä¸è¦ç´§å¼ ã€‚ /proc çš„ä¸œè¥¿éƒ½æ˜¯ linux ç³»ç»Ÿæ‰€éœ€è¦åŠ è½½çš„ç³»ç»Ÿæ•°æ®ï¼Œ
è€Œä¸”æ˜¯æŒ‚è½½åœ¨ã€Œå†…å­˜ä¸­ã€çš„ï¼Œæ‰€ä»¥ä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´

è‡³äº /dev/shm/ ç›®å½•ï¼Œå…¶å®æ˜¯åˆ©ç”¨å†…å­˜è™šæ‹Ÿå‡ºæ¥çš„ç£ç›˜ç©ºé—´ï¼Œé€šå¸¸æ˜¯æ€»ç‰©ç†å†…å­˜çš„ä¸€åŠã€‚
ç”±äºæ˜¯é€è¿‡å†…å­˜ä»¿çœŸå‡ºæ¥çš„ç£ç›˜ï¼Œåœ¨è¯¥ç›®å½•ä¸‹å»ºç«‹ä»»ä½•æ•°æ®æ–‡ä»¶æ—¶ï¼Œè®¿é—®é€Ÿåº¦éå¸¸å¿«ã€‚
åªæ˜¯ **è¯¥ç›®å½•ä¸‹çš„ä¸œè¥¿ä¸æ˜¯æŒä¹…æ€§çš„ï¼Œä¸‹æ¬¡å¼€æœºåå°±å¤±æ•ˆäº†**

### du

```bash
du [-ahskm] æ–‡ä»¶æˆ–ç›®å½•åç§°
```

- aï¼šåˆ—å‡ºæ‰€æœ‰çš„æ–‡ä»¶ä¸ç›®å½•å®¹é‡ï¼Œé»˜è®¤ä»…ç»Ÿè®¡ç›®å½•ä¸‹çš„æ–‡ä»¶é‡
- hï¼šä»¥äººç±»æ˜“è¯»çš„å®¹é‡æ ¼å¼æ˜¾ç¤º
- sï¼šåˆ—å‡ºæ€»é‡ï¼Œè€Œä¸åˆ—å‡ºæ¯ä¸ªå„åˆ«çš„ç›®å½•å ç”¨å®¹é‡
- Sï¼šä¸åŒ…æ‹¬å­ç›®å½•ä¸‹çš„æ€»è®¡ï¼Œä¸ -s æœ‰å·®åˆ«
- kï¼šä»¥ KBytes åˆ—å‡ºå®¹é‡æ˜¾ç¤º
- mï¼šä»¥ MBytes åˆ—å‡ºå®¹é‡æ˜¾ç¤º

å®è·µç»ƒä¹ 

```bash
# åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å®¹é‡
[root@study ~]# du
4       ./.cache/dconf
4       ./.cache/abrt
8       ./.cache
4       ./.dbus/session-bus
4       ./.dbus
0       ./.config/abrt
0       ./.config
0       ./.local/share
0       ./.local
56      .
# ä¸åŠ å‚æ•°ä¼šé»˜è®¤å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ç›®å½•æ‰€å ç”¨çš„ç£ç›˜ç©ºé—´
# å®é™…æ˜¾ç¤ºåªæ˜¾ç¤ºäº†ç›®å½•ï¼Œä¸åŒ…å«æ–‡ä»¶
# ä¸‹é¢å“ªä¸ª . çš„æ€»é‡ä¸º 56 K(é»˜è®¤æ˜¯ä»¥ kbytes æ˜¾ç¤ºçš„)ï¼Œæ˜¯ ç›®å½• + æ–‡ä»¶å ç”¨çš„
# çœ‹è¿™é‡Œçš„å‡ ä¸ªç›®å½•åŠ èµ·æ¥è‚¯å®šæ²¡æœ‰ 56 è¿™ä¹ˆå¤§

# åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å®¹é‡ï¼ˆåŒ…æ‹¬æ–‡ä»¶ï¼‰
[root@study ~]# du -a
4       ./.bash_logout
4       ./.bash_profile
4       ./.bashrc
4       ./.cshrc
4       ./.tcshrc
4       ./anaconda-ks.cfg  # çœç•¥äº†å¾ˆå¤šæ˜¾ç¤ºç»“æœï¼Œè¿™é‡Œå°±æ˜¯ä¸€ä¸ªæ–‡ä»¶
4       ./.cache/dconf/user
56      .

# æ£€æŸ¥æ ¹ç›®å½•ä¸‹æ¯ä¸ªç›®å½•æ‰€å ç”¨çš„å®¹é‡
[root@study ~]# du -sm /*
0       /bin
138     /boot
0       /dev
42      /etc
8       /home
0       /lib
0       /lib64
0       /media
0       /mnt
0       /opt
du: æ— æ³•è®¿é—®"/proc/32240/task/32240/fd/3": æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
du: æ— æ³•è®¿é—®"/proc/32240/task/32240/fdinfo/3": æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
du: æ— æ³•è®¿é—®"/proc/32240/fd/3": æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
du: æ— æ³•è®¿é—®"/proc/32240/fdinfo/3": æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
0       /proc       # ä¸å ç”¨ç©ºé—´
1       /root
9       /run
0       /sbin
0       /srv
0       /sys
1       /tmp
4182    /usr      # å¯ä»¥çœ‹åˆ°ç³»ç»ŸåˆæœŸæœ€å¤§çš„å°±æ˜¯è¿™ä¸ªäº†
347     /var
```

ä¸ df ä¸ä¸€æ ·ï¼Œdu æŒ‡ä»¤ä¼šç›´æ¥åˆ°æ–‡ä»¶ç³»ç»Ÿå†…æœå¯»æ‰€æœ‰çš„æ–‡ä»¶æ•°æ®ï¼Œæ‰€ä»¥ä¸Šè¿°ä¾‹å­æ˜¾ç¤ºä¸æ˜¯å¾ˆå¿«ï¼Œ
å› ä¸ºè¦æœå¯»æ–‡ä»¶æ•°æ®ã€‚é»˜è®¤å®¹é‡ä¸º kbï¼Œå¯ä½¿ç”¨ -h ç­‰å‚æ•°æ¥æ ¼å¼åŒ–å®¹é‡

```bash
# -s ä¸ -s çš„åŒºåˆ«ï¼Œçœ‹æ€»é‡
# -s ä¸º 56k æ˜¯åŒ…å«äº†ä¸‹é¢çš„æ‰€æœ‰å­ç›®å½•
# -S ä¸åŒ…å«å­ç›®å½•çš„ åªæœ‰ 44k
[root@study ~]# du -sh
56K     .
[root@study ~]# du -Sh
4.0K    ./.cache/dconf
4.0K    ./.cache/abrt
0       ./.cache
4.0K    ./.dbus/session-bus
0       ./.dbus
0       ./.config/abrt
0       ./.config
0       ./.local/share
0       ./.local
44K     .
```

## ğŸ€ å®ä½“é“¾æ¥ä¸ç¬¦å·é“¾æ¥ ln
link é“¾æ¥åœ¨å‰é¢ Linux æ–‡ä»¶å±æ€§ ä¸ Linux æ–‡ä»¶ç§ç±»ä¸æ‰©å±•å ä¸­ç®€å•è®²è§£è¿‡ã€‚æœ¬ç« è¯¦ç»†è®²è§£

é“¾æ¥æ–‡æ¡£æœ‰ä¸¤ç§ï¼š

- ç±»ä¼¼ windows çš„å¿«æ·æ–¹å¼çš„æ–‡ä»¶
- é€šè¿‡ inode è¿æ¥æ¥äº§ç”Ÿæ–°æ–‡æ¡£åï¼Œè€Œä¸æ˜¯äº§ç”Ÿæ–°æ–‡ä»¶ï¼Œ**ç§°ä¸ºå®ä½“é“¾æ¥**

### Hard Link å®ä½“é“¾æ¥ã€ç¡¬å¼è¿ç»“æˆ–å®é™…è¿ç»“

å‰é¢æ–‡ä»¶ç³»ç»Ÿä¸­äº†è§£åˆ°ï¼š

- æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šå ç”¨ä¸€ä¸ª inodeï¼Œæ–‡ä»¶å†…å®¹ç”± inode è®°å½•æŒ‡å‘
- æƒ³è¦è¯»å–è¯¥æ–‡ä»¶ï¼Œå¿…é¡»è¦ç»è¿‡ç›®å½•è®°å½•çš„æ–‡ä»¶åæ¥æŒ‡å‘åˆ°æ­£ç¡®çš„ inode å·ç æ‰èƒ½è¯»å–

ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶ååªä¸ç›®å½•æœ‰å…³ï¼Œä½†æ˜¯æ–‡ä»¶å†…å®¹åˆ™ä¸ inode æœ‰å…³ã€‚
å› æ­¤æœ‰æ²¡æœ‰å¯èƒ½ï¼šå¤šä¸ªæ–‡æ¡£åå¯¹åº”åˆ°åŒä¸€ä¸ª inode å·ç å‘¢ï¼Ÿè‚¯å®šæœ‰ï¼Œè¿™å°±æ˜¯ Hard Link çš„ç”±æ¥ã€‚

ç®€å•è¯´ï¼šhard link åªæ˜¯åœ¨æŸä¸ªç›®å½•ä¸‹æ–°å¢ä¸€ä¸ªæ–‡ä»¶åé“¾æ¥åˆ°æŸä¸ª inode å·ç çš„å…³è”è®°å½•è€Œå·²

ä¾‹å¦‚ï¼šå‡è®¾ /root/crontab æ˜¯ /etc/crontab çš„å®ä½“é“¾æ¥ï¼ˆä»–ä»¬ä¸¤ä¸ªæ–‡ä»¶åéƒ½å¯¹åº”åˆ°åŒä¸€ä¸ª inodeï¼‰ï¼Œ
è¿™ä¸¤ä¸ªæ–‡ä»¶åçš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯éƒ½ä¼šä¸€æ¨¡ä¸€æ ·ï¼ˆé™¤äº†æ–‡ä»¶åä¹‹å¤–ï¼‰

```bash
[root@study ~]# ll -i /etc/crontab
# æŸ¥çœ‹æ–‡ä»¶å±æ€§ä¸ inode å·ç 
17639161 -rw-r--r--. 1 root root 451 6æœˆ  10 2014 /etc/crontab
# å»ºç«‹å®ä½“é“¾æ¥
[root@study ~]# ln /etc/crontab .
# å¯¹æ¯”ä¸¤ä¸ªæ–‡ä»¶çš„å±æ€§
[root@study ~]# ll -i /etc/crontab crontab
17639161 -rw-r--r--. 2 root root 451 6æœˆ  10 2014 crontab
17639161 -rw-r--r--. 2 root root 451 6æœˆ  10 2014 /etc/crontab
```

![](./assets/markdown-img-paste-20191022221802204.png)

ä¸Šé¢åŸå§‹æ–‡ä»¶çš„ 1 å˜æˆäº† 2ï¼Œè¯¥å­—æ®µç§°ä¸ºã€Œè¿ç»“ã€ï¼Œè¡¨ç¤ºæœ‰å¤šå°‘ä¸ªæ–‡ä»¶åé“¾æ¥åˆ°è¿™ä¸ª inode å·ç ;

- è¿™é‡Œå°†ä»»æ„ä¸€ä¸ªæ–‡ä»¶åˆ é™¤ï¼Œå…¶å® inode ä¸ block éƒ½è¿˜æ˜¯å­˜åœ¨çš„ã€‚
- æ— è®ºé€šè¿‡å“ªä¸€ä¸ªæ–‡ä»¶æ¥ç¼–è¾‘å†…å®¹ï¼Œéƒ½ä¼šååº”åˆ° inode ä¸ block ä¸­

ä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨ hard link è®¾ç½®è¿æ¥æ–‡ä»¶æ—¶ï¼Œç£ç›˜ç©ºé—´ä¸ inode çš„æ•°ç›®éƒ½ä¸ä¼šæ”¹å˜ã€‚
é™¤éé‡åˆ°è¯´ï¼Œåœ¨ç›®å½•ä¸­æ–°å¢æ–‡ä»¶åæ—¶ï¼Œåˆšå¥½ block æ»¡äº†ï¼Œé‚£ä¹ˆå°±ä¼šå¤šå‡ºæ¥ä¸€ä¸ª block è®°å½•æ–‡ä»¶å

é™åˆ¶å¦‚ä¸‹ï¼š

- ä¸èƒ½è·¨ Filesystem ï¼šä¸æ˜¯åŒä¸€ä¸ª indoe å·ç äº†ï¼Œè‚¯å®šä¸èƒ½äº†
- ä¸èƒ½ link ç›®å½•ï¼š

  å¦‚æœä½¿ç”¨ hard link é“¾æ¥åˆ°ç›®å½•æ—¶ï¼Œé“¾æ¥çš„æ•°æ®éœ€è¦è¿åŒè¢«é“¾æ¥ç›®å½•ä¸‹æ‰€æœ‰æ•°æ®éƒ½å»ºç«‹è¿æ¥ã€‚
  å½“æ–°å»ºæ–‡ä»¶æ—¶éœ€è¦å»ºç«‹è¯¥æ–‡ä»¶çš„ hard linkï¼Œè¿™å¯¹ç¯å¢ƒå½±å“å¤ªå¤§ï¼Œæ‰€ä»¥ä¸æ”¯æŒ

## ğŸ€ Symbolic Link ç¬¦å·é“¾æ¥ã€å¿«æ·æ–¹å¼
Symbolic å°±æ˜¯å»ºç«‹ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶ä¼šè®©æ•°æ®çš„è¯»å–æŒ‡å‘ä»– link çš„é‚£ä¸ªæ–‡ä»¶åã€‚
åŸå§‹æ–‡ä»¶è¢«åˆ ï¼Œè¯¥æ–‡ä»¶è‚¯å®šä¹Ÿæ‰“ä¸å¼€äº†

```bash
# å»ºç«‹ç¬¦å·é“¾æ¥
[root@study ~]# ln -s /etc/crontab crontab2
# å¯¹æ¯”
[root@study ~]# ll -i /etc/crontab crontab crontab2
17639161 -rw-r--r--. 2 root root 451 6æœˆ  10 2014 crontab
17639161 -rw-r--r--. 2 root root 451 6æœˆ  10 2014 /etc/crontab
# å¯ä»¥çœ‹åˆ°ä¸Šé¢ä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·ï¼Œæœ‰ä¸€ä¸ª hard link å’ŒåŸå§‹æ–‡ä»¶ã€‚å¹¶ä¸”ä»–ä»¬çš„ inode æ˜¯ 2
# è€Œä¸‹é¢è¿™ä¸ªç¬¦å·é“¾æ¥çš„ä¿¡æ¯å’Œä¸Šé¢çš„éƒ½ä¸ä¸€æ ·ï¼Œå”¯ç‹¬åé¢æœ‰ä¸€ä¸ªè¿æ¥æŒ‡å‘äº†åŸå§‹æ–‡ä»¶
25377009 lrwxrwxrwx. 1 root root  12 10æœˆ 22 00:00 crontab2 -> /etc/crontab

```

![](./assets/markdown-img-paste-20191022223136195.png)


```bash
ln [-sf] æ¥æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶

-sï¼šä¸åŠ å‚æ•°å°±æ˜¯å»ºç«‹å®ä½“é“¾æ¥ hard linkï¼ŒåŠ  -s å°±æ˜¯å»ºç«‹ç¬¦å·é“¾æ¥
-fï¼šå¦‚æœ ç›®æ ‡æ–‡ä»¶ å­˜åœ¨æ—¶ï¼Œå°±ä¸»åŠ¨çš„å°†ç›®æ ‡æ–‡ä»¶ç›´æ¥ç§»é™¤åå†å»ºç«‹
```

å®è·µç»ƒä¹ 

```bash
# å°† /etc/passwd å¤åˆ¶åˆ° /tmp å¹¶è§‚å¯Ÿ inode ä¸ block
[root@study ~]# cd /tmp/
[root@study tmp]# cp -a /etc/passwd .
[root@study tmp]# du -sb; df -i
153266  .   # du -sb è®¡ç®— /tmp/ ä¸‹æœ‰å¤šå°‘ bytes å®¹é‡
æ–‡ä»¶ç³»ç»Ÿ                  Inode å·²ç”¨(I) å¯ç”¨(I) å·²ç”¨(I)% æŒ‚è½½ç‚¹
/dev/mapper/centos-root 5242880  153177 5089703       3% /
# df -i æ˜¾ç¤º inode çš„ä½¿ç”¨é‡

# å°† /tmp/passwd åˆ¶ä½œ hard link ç§°ä¸º passwd-hd æ–‡ä»¶ï¼Œå¹¶è§‚å¯Ÿæ–‡ä»¶ä¸å®¹é‡
[root@study tmp]# ln passwd passwd-hd
[root@study tmp]# du -sb; df -i
153266  .
æ–‡ä»¶ç³»ç»Ÿ                  Inode å·²ç”¨(I) å¯ç”¨(I) å·²ç”¨(I)% æŒ‚è½½ç‚¹
/dev/mapper/centos-root 5242880  153177 5089703       3% /
# è§‚å¯Ÿæ€»å®¹é‡ 153266 æ²¡æœ‰æ”¹å˜
# è§‚å¯Ÿå·²ç”¨çš„ inode 153177 æ²¡æœ‰æ”¹å˜

# å°† /tmp/passwd å»ºç«‹ç¬¦å·é“¾æ¥
[root@study tmp]# du -sb; df -i
153272  .
æ–‡ä»¶ç³»ç»Ÿ                  Inode å·²ç”¨(I) å¯ç”¨(I) å·²ç”¨(I)% æŒ‚è½½ç‚¹
/dev/mapper/centos-root 5242880  153178 5089702       3% /
# è§‚å¯Ÿæ€»å®¹é‡ 153266 å˜æˆäº† 153272
# è§‚å¯Ÿå·²ç”¨çš„ inode 153177 å˜æˆäº† 153178

[root@study tmp]# ls -li passwd*
16797769 -rw-r--r--. 2 root root 2323 10æœˆ  4 18:31 passwd
16797769 -rw-r--r--. 2 root root 2323 10æœˆ  4 18:31 passwd-hd
16807525 lrwxrwxrwx. 1 root root    6 10æœˆ 22 00:20 passwd-so -> passwd
# å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„ç¬¦å·é“¾æ¥æ–‡ä»¶å¤§å° 6 kbï¼Œè€Œä¸Šé¢ 153272 - 153266 = 6

## ğŸ€ åˆ é™¤æºæ–‡ä»¶ passwd ï¼Œå…¶ä»–ä¸¤ä¸ªé“¾æ¥æ–‡ä»¶æ˜¯å¦èƒ½æ‰“å¼€ï¼Ÿ
[root@study tmp]# rm passwd
rmï¼šæ˜¯å¦åˆ é™¤æ™®é€šæ–‡ä»¶ "passwd"ï¼Ÿy
[root@study tmp]# cat passwd-hd
... æ­£å¸¸æ˜¾ç¤º
[root@study tmp]# cat passwd-so
cat: passwd-so: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•

# æŸ¥çœ‹çŠ¶æ€
[root@study tmp]# ls -l passwd*
-rw-r--r--. 1 root root 2323 10æœˆ  4 18:31 passwd-hd
# è¿™é‡Œåé¢çš„æ–‡ä»¶ååœ¨èƒ½é“¾æ¥åˆ°æºæ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šæ˜¾ç¤ºç»¿è‰²ï¼Œç°åœ¨é“¾æ¥ä¸åˆ°äº†å°±ä¼šæ˜¾ç¤ºçº¢è‰²äº†
lrwxrwxrwx. 1 root root    6 10æœˆ 22 00:20 passwd-so -> passwd

```

![](./assets/markdown-img-paste-20191022225353742.png)

```bash
# å¦‚æœä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œå°† /bin/ ç›®å½•åˆ›å»ºäº†ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰
ln -s /bin /root/bin
[root@study bin]# ll -l /root/
lrwxrwxrwx. 1 root   root      5 10æœˆ 22 00:28 bin -> /bin/

# é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¦‚æœä½ è¦æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤çš„è¯ï¼Œ
# è¿™é‡Œåƒä¸‡ä¸è¦æ‰§è¡Œï¼Œå¦åˆ™ä¼šå°† bin ä¸‹çš„æ–‡ä»¶æ•°æ®å…¨éƒ¨å¹²æ‰çš„
cd /root/bin; rm .

# é€šè¿‡ä¸‹é¢çš„æ–¹å¼æŸ¥çœ‹ï¼Œå’Œç¡¬é“¾æ¥ä¸€æ ·ï¼Œä»–ä»¬éƒ½è¿åˆ°äº†åŒä¸€ä¸ª node
# æ‰€ä»¥è¿™é‡Œä¸æ–‡ä»¶é“¾æ¥è¿˜ä¸ä¸€æ ·ï¼Œä¸Šé¢çœ‹æ˜¯å•ç‹¬çš„ç›®å½• -> /bin/
# è¿™é‡Œ  cd é€šè¿‡å¿«æ·æ–¹å¼è¿›å…¥åˆ°çœŸæ­£çš„ç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ“ä½œç­‰åŒäºæ“ä½œ bin æœ¬èº«
[root@study bin]# ls -lid /bin/ /root/bin/
78 dr-xr-xr-x. 2 root root 57344 10æœˆ 11 05:03 /bin/
78 dr-xr-xr-x. 2 root root 57344 10æœˆ 11 05:03 /root/bin/

# ä½¿ç”¨å‘½ä»¤åˆ é™¤åˆšåˆšé‚£ä¸ªç›®å½•é“¾æ¥æ–‡æ¡£
# æ³¨æ„è¿™é‡Œçš„æç¤ºã€‚å¸¦æ–œæ è²Œä¼¼æ˜¯ç›´æ¥æŒ‡å‘äº†è¿æ¥çš„ç›®å½•ï¼Œä¸å¸¦æ‰æ˜¯ç¬¦å·é“¾æ¥æœ¬èº«
[root@study bin]# rm /root/bin/
rm: æ— æ³•åˆ é™¤"/root/bin/": æ˜¯ä¸€ä¸ªç›®å½•
[root@study bin]# rm /root/bin
rmï¼šæ˜¯å¦åˆ é™¤ç¬¦å·é“¾æ¥ "/root/bin"ï¼Ÿy
```

åŸºæœ¬ä¸Šï¼Œç¬¦å·é“¾æ¥çš„ç”¨é€”æ¯”è¾ƒå¹¿ã€‚éœ€è¦æŒæ¡

### å…³äºç›®å½•çš„ link æ•°é‡

åˆ›å»ºä¸€ä¸ªç›®å½• link ä¼šæ˜¾ç¤ºå‡ ï¼Ÿå¯¹äºæ–‡ä»¶æ¥è¯´ä¼šæ˜¾ç¤º 1.é‚£ä¹ˆç›®å½•å‘¢ï¼Ÿ

```bash
[root@study tmp]# ls -ld /tmp/
# link æ•°é‡ä¸º 40
drwxrwxrwt. 40 root root 4096 10æœˆ 22 00:43 /tmp/
# åˆ›å»ºç›®å½•
[root@study tmp]# mkdir testing1
[root@study tmp]# ls -ld /tmp/
# /tmp/ link +1 å˜æˆ 41 äº†
drwxrwxrwt. 41 root root 4096 10æœˆ 22 00:44 /tmp/

# çœ‹ä¸‹è¯¥ç›®å½•çš„ link ä¸º 2ï¼Œè¡¨ç¤ºæœ‰ä¸¤ä¸ª,æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ
[root@study tmp]# ls -ld /tmp/testing1/
drwxr-xr-x. 2 root root 6 10æœˆ 22 00:44 /tmp/testing1/

# æ–°å»ºç«‹çš„ä¸€ä¸ªç›®å½•ä¸‹åŒ…å«äº†å½“å‰ç›®å½•
# /tmp/testing1/ /temp/testing1/.  è¿™ä¸¤ä¸ªè·¯å¾„éƒ½é“¾æ¥åˆ°åŒä¸€ä¸ª inodeï¼Œæ‰€ä»¥ link ä¸º 2
[root@study tmp]# ls -al /tmp/testing1/
æ€»ç”¨é‡ 8
drwxr-xr-x.  2 root root    6 10æœˆ 22 00:44 .
drwxrwxrwt. 41 root root 4096 10æœˆ 22 00:46 ..

```
