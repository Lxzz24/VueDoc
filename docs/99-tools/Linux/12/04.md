---
title: 
sidebarDepth: 0 
category: Tools 
tag: Linux
---
# æ¡ä»¶åˆ¤æ–­

åœ¨ç¨‹åºä¸­ï¼Œæ²¡æœ‰æ¡ä»¶åˆ¤æ–­ `if then` æ–¹å¼çš„è¯ï¼Œåœ¨æ‰§è¡Œå¤šæ¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œå°±ä¼šå¾ˆéº»çƒ¦ã€‚

## ğŸ€ åˆ©ç”¨ `if...then`

### å•å±‚ã€ç®€å•æ¡ä»¶åˆ¤æ–­

```bash
if [ è¡¨è¾¾å¼ ]; then
	å½“æ¡ä»¶æˆç«‹æ—¶ï¼Œå¯ä»¥è¿›è¡Œçš„æŒ‡ä»¤å·¥ä½œå†…å®¹
fi
```

è‡³äºè¡¨è¾¾å¼çš„ç¼–ç ï¼Œä¸ä¸Šä¸€ç« çš„ test ä¸€è‡´ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹åˆ«çš„æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨ `&&` ä¸ `||` æ¥è¿æ¥å¤šä¸ªä¸­æ‹¬å·ï¼Œåœ¨è¿™é‡Œä»–ä»¬çš„å«ä¹‰å°±æ˜¯è¡¨ç¤º å¹¶ä¸” å’Œ æˆ–è€… çš„æ„æ€

æ‰€ä»¥åœ¨ä½¿ç”¨ä¸­æ‹¬å·çš„æ—¶å€™ï¼Œ `&&` å’Œ `||` ä¸æŒ‡ä»¤çŠ¶æ€ä¸‹çš„å«ä¹‰ä¸åŒã€‚æ¯”å¦‚ï¼š

```bash
[ "${yn}" == "Y" -o "${yn}" == "y" ]
å¯ä»¥æ›¿æ¢ä¸ºä¸‹é¢çš„æ–¹å¼
[ "${yn}" == "Y" ] || [ "${yn}" == "y" ]
```

è¿™æ ·å°±å¾ˆæ–¹ä¾¿ç»´æŠ¤äº†ï¼Œä¸€ä¸ªä¸­æ‹¬å·ä¸€ä¸ªè¡¨è¾¾å¼ã€‚é‚£ä¹ˆå°†è¿™ä¸ª script ä¿®æ”¹ä¸º `if...then` çš„å½¢å¼å¦‚ä¸‹

```bash
[mrcode@study bin]$ vi ans_yn.sh

#!/bin/bash
# Program:
#       This program shows the user's choice
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

read -p "è¯·è¾“å…¥ Y/Nï¼š" yn
# [ "${yn}" == "Y" -o "${yn}" == "y" ] && echo "Okï¼Œcontinue" && exit 0
if [ "${yn}" == "Y" ] || [ "${yn}" == "y" ]; then
        echo "Okï¼Œcontinue"
        exit 0
fi

# [ "${yn}" == "N" -o "${yn}" == "n" ] && echo "Ohï¼Œinterruptï¼" && exit 0
if [ "${yn}" == "N" ] || [ "${yn}" == "n" ]; then
        echo "Ohï¼Œinterruptï¼"
        exit 0
fi
echo "I don't know what your choice is" && exit 0
```

æ­¤æ–¹å¼åªæ˜¯åœ¨ä»£ç ç»„ç»‡ä¸Šæ›´åå‘äºç¬”è€…æ‰€å­¦çš„ JAVA è¯­è¨€äº†ï¼Œå¯¹äºå˜é‡çš„åˆ¤å®šè¿˜å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å¤šé‡åˆ¤æ–­æ¥è¾¾åˆ°æ•ˆæœ

### å¤šé‡ã€å¤æ‚æ¡ä»¶åˆ¤æ–­

ç®€å•è¯´ï¼Œä¸Šè¿°å®ä¾‹å¯¹äºå˜é‡ `${yn}` ä½¿ç”¨äº†ä¸¤æ¬¡ ifï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ç®€åŒ–

```bash
if [ æ¡ä»¶è¡¨è¾¾å¼ ]; then
	åšç‚¹å•¥
else
	åšç‚¹å•¥
fi
```

æ›´å¤æ‚çš„æƒ…å†µï¼Œå¢åŠ  elseif ï¼Œå¦‚ä¸‹

```bash
if [ æ¡ä»¶è¡¨è¾¾å¼ ]; then
	åšç‚¹å•¥
elif [ æ¡ä»¶è¡¨è¾¾å¼ ]; then
	åšç‚¹å•¥
else
	åšç‚¹å•¥
fi
```

æ”¹å†™ `ans_yn.sh` è„šæœ¬å¦‚ä¸‹

```bash
#!/bin/bash
# Program:
#       This program shows the user's choice
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

read -p "è¯·è¾“å…¥ Y/Nï¼š" yn
# [ "${yn}" == "Y" -o "${yn}" == "y" ] && echo "Okï¼Œcontinue" && exit 0
if [ "${yn}" == "Y" ] || [ "${yn}" == "y" ]; then
        echo "Okï¼Œcontinue"
        exit 0
else
        echo "Ohï¼Œinterruptï¼"
        exit 0
fi
echo "I don't know what your choice is" && exit 0

```



---



å¦ä¸€ä¸ªèŒƒä¾‹çŸ¥è¯†ï¼Œä¸Šä¸€èŠ‚æåˆ°å‚æ•°åŠŸèƒ½ï¼ˆ$1ï¼‰ï¼Œè®©ç”¨æˆ·åœ¨ä¸‹è¾¾æŒ‡ä»¤çš„æ—¶å€™å°†å‚æ•°å¸¦è¿›å»ï¼Œè®©ç”¨æˆ·è¾“å…¥ hello å…³é”®è¯ï¼Œåˆ©ç”¨å‚æ•°çš„æ–¹æ³•å¯ä»¥å¦‚ä¸‹è®¾è®¡ï¼š

1. åˆ¤æ–­ `$1` æ˜¯å¦ä¸º hello ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ˜¾ç¤ºã€ŒHello, how ary you?ã€
2. å¦‚æœæ— å‚æ•°ï¼Œåˆ™æç¤ºä½¿ç”¨è€…å¿…é¡»è¦ä½¿ç”¨çš„å‚æ•°ä¸‹è¾¾æ–¹æ³•
3. å¦‚æœå‚æ•°ä¸æ˜¯ helloï¼Œåˆ™æç¤ºä½¿ç”¨è€…ä»…èƒ½ä½¿ç”¨ hello ä¸ºå‚æ•°

```bash
#!/bin/bash
# Program:
#       ç›´æ¥æºå¸¦å‚æ•°æç¤º
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

if [ "$1" == "hello" ]; then
	echo "Hello, how ary you?"
elif [ -z "$1" ]; then
	echo "è¯·æºå¸¦å‚æ•°"
else
	echo "åªèƒ½æºå¸¦å‚æ•° hello"
fi
```

æµ‹è¯•è¾“å‡º

```bash
[mrcode@study bin]$ ./hello-2.sh 
è¯·æºå¸¦å‚æ•°
[mrcode@study bin]$ ./hello-2.sh hello
Hello, how ary you?
[mrcode@study bin]$ ./hello-2.sh hellox
åªèƒ½æºå¸¦å‚æ•° hello
```

ä¹¦ä¸Šä¾‹å­å¦‚ä¸‹ï¼š

```bash
#!/bin/bash
# Program:
#       Chek $1 is equal to "hello"
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

if [ "$1" == "hello" ]; then
	echo "Hello, how ary you?"
elif [ "$1" == "" ]; then
	echo "You MUST input parameters, ex> {${0} someword}"
else
	echo "The only parameter is 'hello', ex> {${0} hello}"
fi
```

ä¿¡æ¯è¾“å‡ºå¦‚ä¸‹

```bash
[mrcode@study bin]$ ./hello-2.sh 
You MUST input parameters, ex> {./hello-2.sh someword}
[mrcode@study bin]$ ./hello-2.sh hell
The only parameter is 'hello', ex> {./hello-2.sh hello}
[mrcode@study bin]$ ./hello-2.sh hello
Hello, how ary you?
```

ç¬”è€…ç‚¹è¯„ï¼šè¿™ä¸ªæ˜¾ç¤ºå¾ˆæ£’ï¼Œé”™è¯¯æç¤ºå‘ŠçŸ¥äº†ç”¨æˆ·è¦æ€ä¹ˆåš



---



é‚£ä¹ˆæ·±å…¥ç»ƒä¹ ã€‚

åœ¨ç¬¬åç« å­¦ä¹ äº† grep æŒ‡ä»¤ï¼Œç°åœ¨å¤šäº†è§£ä¸€ä¸ª netstat æŒ‡ä»¤ï¼Œå¯ä»¥æŸ¥è¯¢åˆ°ç›®å‰ä¸»æœºæœ‰å¼€å¯çš„ç½‘ç»œæœåŠ¡ç«¯å£ï¼ˆservice portsï¼‰ï¼Œç›¸å…³åŠŸèƒ½ä¼šåœ¨ **æœåŠ¡å™¨æ¶è®¾ç¯‡** ç»§ç»­ä»‹ç»ï¼›è¿™é‡Œåªéœ€è¦çŸ¥é“ `netstat -tuln`å¯ä»¥å–å¾—ç›®å‰ä¸»æœºæœ‰å¯åŠ¨çš„æœåŠ¡ï¼Œè€Œä¸”å–å¾—çš„ä¿¡æ¯ç±»ä¼¼ä¸‹é¢è¿™æ ·

```bash
[mrcode@study bin]$ netstat -tuln
Active Internet connections (only servers)
# å°åŒ…æ ¼å¼			 æœ¬åœ° IP:ç«¯å£			  è¿œç¨‹ IP:ç«¯å£				æ˜¯å¦ç›‘å¬
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:6010          0.0.0.0:*               LISTEN     
tcp        0      0 127.0.0.1:6011          0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN     
tcp        0      0 192.168.122.1:53        0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN     
tcp6       0      0 ::1:631                 :::*                    LISTEN     
tcp6       0      0 ::1:25                  :::*                    LISTEN     
tcp6       0      0 ::1:6010                :::*                    LISTEN     
tcp6       0      0 ::1:6011                :::*                    LISTEN     
tcp6       0      0 :::111                  :::*                    LISTEN     
tcp6       0      0 :::22                   :::*                    LISTEN     
udp        0      0 0.0.0.0:48829           0.0.0.0:*                          
udp        0      0 192.168.122.1:53        0.0.0.0:*                          
udp        0      0 0.0.0.0:67              0.0.0.0:*                          
udp        0      0 0.0.0.0:111             0.0.0.0:*                          
udp        0      0 127.0.0.1:323           0.0.0.0:*                          
udp        0      0 0.0.0.0:672             0.0.0.0:*                          
udp        0      0 0.0.0.0:5353            0.0.0.0:*                          
udp6       0      0 :::111                  :::*                               
udp6       0      0 ::1:323                 :::*                               
udp6       0      0 :::672                  :::*  
```

é‡ç‚¹å…³æ³¨ Local Address å­—æ®µï¼ˆæœ¬åœ°ä¸»æœº IP ä¸ç«¯å£å¯¹åº”ï¼‰ï¼Œä»£è¡¨æœ¬æœºæ‰€å¯åŠ¨çš„ç½‘ç»œæœåŠ¡ï¼Œ**127.0.0.1** åˆ™æ˜¯é’ˆå¯¹æœ¬æœºå¼€æ”¾ï¼Œè‹¥æ˜¯ **0.0.0.0 æˆ– :::** åˆ™ä»£è¡¨å¯¹æ•´ä¸ª Internet å¼€æ”¾ã€‚æ¯ä¸ªç«¯å£ port éƒ½æœ‰å…¶ç‰¹å®šçš„ç½‘ç»œæœåŠ¡ï¼Œå‡ ä¸ªå¸¸è§çš„ port ä¸ç½‘ç»œæœåŠ¡çš„å…³ç³»æ˜¯ï¼š

- 80ï¼šwww
- 22ï¼šssh
- 21ï¼šftp
- 25ï¼šmail
- 111ï¼šRPC
- 631ï¼šCUPSï¼ˆæ‰“å°æœåŠ¡åŠŸèƒ½ï¼‰

å‡è®¾æˆ‘è¦æ£€æµ‹å¸¸è§ç«¯å£ port 21ã€22ã€25ã€80 æ—¶ï¼Œå¯ä»¥é€šè¿‡ netstat æ£€æµ‹ä¸»æœºæ˜¯å¦æœ‰å¼€å¯è¿™å››ä¸ªä¸»è¦çš„ç½‘ç»œæœåŠ¡ç«¯å£ï¼Œç”±äºæ¯ä¸ªæœåŠ¡çš„å…³é”®è¯éƒ½æ˜¯æ¥åœ¨å†’å·ã€Œ:ã€åé¢ï¼Œæ‰€ä»¥å¯ä»¥æˆªå–ç±»ä¼¼ã€Œ:80ã€æ¥æ£€æµ‹ã€‚é‚£ä¹ˆç¨‹åºå¦‚ä¸‹

ä¸‹é¢æ˜¯ç¬”è€…å†™çš„è„šæœ¬

```bash
vim netstat.sh

#!/bin/bash
# Program:
#       
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

echo "ç°åœ¨å¼€å§‹æ£€æµ‹å½“å‰ä¸»æœºä¸Šçš„æœåŠ¡"
echo -e "wwwã€ftpã€mailã€www æœåŠ¡å°†è¢«æ£€æµ‹ \n"
# å°† local Address å­—æ®µæˆªå–å‡ºæ¥
datas=$(netstat -tuln | awk '{print $4}')
testing=$(grep ":80" ${datas}) 
if [ ! -z "${testing}" ]; then
	echo "www"
fi
testing=$(grep ":22" ${datas}) 
if [ ! -z "${testing}" ]; then
	echo "ssh"
fi
testing=$(grep ":21" ${datas}) 
if [ ! -z "${testing}" ]; then
	echo "ftp"
fi
testing=$(grep ":25" ${datas}) 
if [ ! -z "${testing}" ]; then
	echo "mail"
fi
```

ä¸è¿‡å¾ˆé—æ†¾ï¼Œgrep ååªèƒ½è·Ÿä¸€ä¸ªæ–‡ä»¶è·¯å¾„ã€‚é‚£ä¹ˆæ­£ç¡®çš„åšæ³•å¦‚ä¸‹

```bash
#!/bin/bash
# Program:
#       Using netstat and grep to detect wwwâ½€~Asshâ½€~Aftp and mail services
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

# 1. ä½…~Hä½‘~Jæ½ŸÂ¥å½Â¥ä·¾Kå½Â¥è¥¾Aä½~Zäº¾@ä¸¾H
echo "æ½Â°ä½œÂ¨å»¾@å¦¾Kæ¢¾@æ´¾Kå¼¾Sä½‰~Mä¸»å½œÂºä·¾Jæ½š~Då½œ~Mä½ŠÂ¡"
echo -e "wwwâ½€~Aftpâ½€~Amailâ½€~Awww å½œ~Mä½ŠÂ¡å¯¾Fè¢«æ¢¾@æ´¾K \n"

# 2. è¾¾[è ¾Lä½ˆÂ¤å­¾Zä½’~Lä¿¡å½Â¯è½¾Sä½‡Âº 
# å¯¾F local Address å¬¾Wæ®µå½ˆÂªä½~Vä½‡Âºå½Â¥ï»¾Lå¹¶æ½”~_å½ˆ~På½–~Gä»¶
testfile=/dev/shm/netstat_checking.txt
netstat -tuln | awk '{print $4}' > ${testfile}

testing=$(grep ":80" ${testfile})
if [ "${testing}" != "" ]; then
        echo "www is running in you system. "
fi

testing=$(grep ":22" ${testfile})
if [ ! -z "${testing}" ]; then
        echo "ssh  is running in you system. "
fi

testing=$(grep ":21" ${testfile})
if [ ! -z "${testing}" ]; then
        echo "ftp  is running in you system. "
fi
testing=$(grep ":25" ${testfile})
if [ ! -z "${testing}" ]; then
        echo "mail  is running in you system. "
fi
```

è¾“å‡ºä¿¡æ¯å¦‚ä¸‹

```bash
[mrcode@study bin]$ ./netstat.sh 
ç°åœ¨å¼€å§‹æ£€æµ‹å½“å‰ä¸»æœºä¸Šçš„æœåŠ¡
wwwã€ftpã€mailã€www æœåŠ¡å°†è¢«æ£€æµ‹ 

ssh  is running in you system. 
mail  is running in you system.
```



---

æ¡ä»¶åˆ¤æ–­è¿˜å¯ä»¥æ›´å¤æ‚ï¼Œæ¯”å¦‚ï¼šåœ¨å°æ¹¾å½“å…µæ˜¯å›½æ°‘åº”å°½çš„ä¹‰åŠ¡ï¼Œä¸è¿‡ï¼Œåœ¨å½“å…µçš„æ—¶å€™æ€»æ˜¯å¾ˆæƒ³é€€ä¼ï¼Œé‚£ä¹ˆå†™ä¸ªè„šæœ¬ç¨‹åºæ¥å®ç°ï¼šè®©ç”¨æˆ·è¾“å…¥ä»–çš„é€€ä¼æ—¥æœŸï¼Œè®¡ç®—å‡ºè¿˜æœ‰å¤šå°‘å¤©æ‰é€€ä¼ï¼Ÿçš„åŠŸèƒ½

é‚£ä¹ˆæ€è·¯å¦‚ä¸‹ï¼š

1. ç”¨æˆ·è¾“å…¥è‡ªå·±çš„é€€ä¼æ—¥æœŸ
2. ç”±ç°åœ¨çš„æ—¥æœŸå¯¹æ¯”é€€ä¼æ—¥æœŸ
3. ç”±ä¸¤ä¸ªæ—¥æœŸçš„æ¯”è¾ƒæ¥æ˜¾ç¤ºã€Œè¿˜éœ€è¦å‡ å¤©ã€æ‰èƒ½å¤Ÿé€€ä¼çš„å­—æ ·

æ¸©é¦¨æç¤ºï¼šæ—¥æœŸå¯ä»¥ä½¿ç”¨ `date --date="YYYYMMDD" +%s` æ¥å–å¾—æŒ‡å®šæ—¥æœŸçš„ç§’æ•°ï¼Œå†åˆ©ç”¨ç§’æ•°ç›¸å‡ï¼Œå†è®¡ç®—åˆ°å¤©

ç¬”è€…ä»ç°åœ¨å¼€å§‹ï¼Œå°±ä¸å†è´´å‡ºè‡ªå·±å†™çš„ä»£ç äº†ï¼Œå…ˆè‡ªå·±å†™ï¼Œç„¶åå¯¹ç…§ä¹¦ä¸Šçš„ï¼Œæœ€åéƒ¨åˆ†ä¿®æ”¹æˆä¹¦ä¸Šçš„å±•ç¤º

```bash
vim cal_retired.sh
  
#!/bin/bash
# Program:
#       You input you demobilization date,I calculate how many days before you demobilize.
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

# 1. å‘ŠçŸ¥ç”¨æˆ·ç¨‹åºçš„ç”¨é€”ï¼Œå¹¶ä¸”å‘ŠçŸ¥åº”è¯¥å¦‚ä½•è¾“å…¥æ—¥æœŸæ ¼å¼
# è¿™ä¸ªç¨‹åºå°†å°è¯•è®¡ç®—å‡ºï¼Œæ‚¨çš„é€€ä¼æ—¥æœŸè¿˜æœ‰å¤šå°‘å¤©
echo "This program will try to calculate :"
echo "How many days before your demobilization date..."
read -p "Please input your demobilization date (YYYYMMDD ex>20200112)ï¼š" date2

# 2. æµ‹è¯•åˆ¤å®šï¼Œè¾“å…¥å†…å®¹æ˜¯å¦æ­£ç¡®ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼
date_d=$(echo ${date2} | grep '[0-9]\{8\}')             # åŒ¹é… 8 ä½æ•°çš„å­—ç¬¦ä¸²
if [ -z "${date_d}" ]; then
        # æ‚¨è¾“å…¥äº†é”™è¯¯çš„æ—¥æœŸæ ¼å¼
        echo "You input the wrong date format..."
        exit 1
fi

# 3. å¼€å§‹è®¡ç®—æ—¥æœŸ
declare -i date_dem=$(date --date="${date_d}" +%s)              # é€€ä¼æ—¥æœŸç§’æ•°
declare -i date_now=$(date +%s)                                 # å½“å‰æ—¥æœŸç§’æ•°
declare -i date_total_s=$((${date_dem}-${date_now}))    		# å‰©ä½™ç§’æ•°
# éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™ç§åµŒå¥—æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‹¬å·ä¸€å®šè¦åµŒå¥—å¯¹ä½ç½®
declare -i date_d=$((${date_total_s}/60/60/24))                 # è½¬æ¢ä¸ºæ—¥
# ä¸­æ‹¬å·é‡Œé¢ä¸èƒ½ç›´æ¥ä½¿ç”¨ < è¿™ç§ç¬¦å·
if [ "${date_total_s}" -lt 0 ]; then
		# è¿™é‡Œæ˜¯ç”¨ -1 ä¹˜ï¼Œå¾—åˆ°æ˜¯æ­£æ•°ï¼Œæ ‡è¯†å·²ç»é€€ä¼å¤šå°‘å¤©äº†
        echo "You had been demobilization before:  $((-1*${date_d}))  ago"
else
        # è¿™é‡Œä½¿ç”¨ æ€»ç§’æ•° - è½¬æ¢ä¸ºæ—¥çš„å˜é‡ï¼ˆè¿™é‡Œåªæ˜¯è½¬æ¢ä¸ºäº†å¤©ï¼‰ï¼Œå‰©ä½™æ•°æ®è½¬æˆå°æ—¶
        # åˆ™è®¡ç®—åˆ° n å¤© n å°æ—¶
        declare -i date_h=$(($((${date_total_s}-${date_d}*60*60*24))/60/60))
        echo "You will demobilize after ${date_d} days and ${date_h} hours."
fi


```

æµ‹è¯•è¾“å‡º

```bash
[mrcode@study bin]$ ./cal_retired.sh 
This program will try to calculate :
How many days before your demobilization date...
Please input your demobilization date (YYYYMMDD ex>20200112)ï¼š20200120	# è¾“å…¥å½“å¤©
You had been demobilization before:  0  ago

[mrcode@study bin]$ ./cal_retired.sh 
This program will try to calculate :
How many days before your demobilization date...
Please input your demobilization date (YYYYMMDD ex>20200112)ï¼š20200119	# è¾“å…¥å‰ä¸€å¤©
You had been demobilization before:  1  ago

[mrcode@study bin]$ ./cal_retired.sh 
This program will try to calculate :
How many days before your demobilization date...
Please input your demobilization date (YYYYMMDD ex>20200112)ï¼š20200121	# è¾“å…¥æ˜å¤©
You will demobilize after 0 days and 8 hours.

[mrcode@study bin]$ ./cal_retired.sh 
This program will try to calculate :
How many days before your demobilization date...
Please input your demobilization date (YYYYMMDD ex>20200112)ï¼š2020^H^H3	# è¾“å…¥é”™è¯¯çš„æ ¼å¼
You input the wrong date format...

[mrcode@study bin]$ ./cal_retired.sh 
This program will try to calculate :
How many days before your demobilization date...
Please input your demobilization date (YYYYMMDD ex>20200112)ï¼š20300120	# è¾“å…¥10 å¹´å
You will demobilize after 3652 days and 8 hours.
```

ç¬”è€…æ€»ç»“ï¼š

- æœ¬ä¾‹ç»“åˆäº† grep æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„å‚æ•°ï¼Œå¦‚æœå®Œå…¨ä¸ç¬¦åˆï¼Œåˆ™ä¸ºç©ºç™½è¿”å›äº†
- ç»“åˆäº† declare -i å®šä¹‰æ•´æ•°å˜é‡
- ä½¿ç”¨äº† `$(($(())))` åµŒå¥—æŒ‡ä»¤æ‰§è¡Œè¯­æ³•
- è¯¥èŒƒä¾‹è¿˜æ˜¯æœ‰éš¾åº¦çš„ï¼Œéš¾ç‚¹åœ¨äº ç”¨æ­£åˆ™æ£€æŸ¥è¾“å…¥å‚æ•° å’Œ è®¡ç®— å¤© å¹¶è®¡ç®—å°æ—¶

## ğŸ€ åˆ©ç”¨ `case...esac` åˆ¤æ–­

ä½œä¸º JAVA ç¨‹åºå‘˜ï¼Œè¿™ä¸ªä¸ç”¨å¤šè§£é‡Šï¼Œç›´æ¥çœ‹è¯­æ³•

```bash
case $å˜é‡åç§° in		# å…³é”®è¯ä¸º case è¿˜æœ‰ å˜é‡å‰çš„ $ ç¬¦å·
	â€œå˜é‡å†…å®¹ 1â€)		# æ¯ä¸ªå˜é‡å†…å®¹å»ºè®®ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼Œå…³é”®è¯åˆ™ä¸ºå°æ‹¬å·
	 	ç¨‹åºæ®µ
	 ;;				  # ä½¿ç”¨ä¸¤ä¸ªè¿ç»­çš„åˆ†å·æ¥ç»“å°¾
	â€œå˜é‡å†…å®¹ 2â€)
	 	ç¨‹åºæ®µ
	 ;;
	*)			 	  # æœ€åä¸€ä¸ªå˜é‡å†…å®¹éœ€è¦ç”¨ * æ¥ä»£è¡¨æ‰€æœ‰å…¶ä»–å€¼
		ç¨‹åºæ®µ
	 ;;
esac				  # æœ€ç»ˆçš„ case ç»“å°¾ï¼Œå°±æ˜¯åè¿‡æ¥æ‹¼å†™çš„å­—ç¬¦ esac
```

å°†ä¸Šé¢ `./hello-2.sh ` çš„ä¾‹å­ä½¿ç”¨è¯¥è¯­æ³•ä¿®æ”¹

```bash
./hello-3.sh 

#!/bin/bash
# Program:
#       ç›´æ¥æºå¸¦å‚æ•°æç¤º
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

case $1 in
	"hello")
		echo "Hello, how ary you?"
	;;
	"")
		echo "è¯·æºå¸¦å‚æ•°"
	;;
	*)
		echo "åªèƒ½æºå¸¦å‚æ•° hello"
	;;
esac
```

æ­¤ç§åˆ¤å®šæ–¹å¼ï¼Œé’ˆå¯¹äºåˆ¤å®šå­—ç¬¦ä¸²æ—¶ä¼šæ›´åŠ çš„æ–¹ä¾¿ï¼ŒCentOS6.x ä»¥å‰ç³»ç»Ÿå¾ˆå¤šæœåŠ¡çš„å¯åŠ¨éƒ½æ˜¯ä½¿ç”¨ä½¿ç”¨è¿™ç§å†™æ³•å†™çš„ã€‚è™½ç„¶ CentOS7 å·²ç»ä½¿ç”¨ systemd ï¼Œä¸è¿‡ä»»ç„¶æœ‰æ•°ä¸ªæœåŠ¡æ—¶æ”¾åœ¨ `/etc/init.d` ç›®å½•ä¸‹çš„ã€æ¯”å¦‚æœ‰ä¸ªåä¸º `netconsole` çš„æœåŠ¡åœ¨è¯¥ç›®å½•ä¸‹

```bash
# é‡æ–°å¯åŠ¨è¯¥æœåŠ¡
# æ³¨æ„è¯¥æœåŠ¡éœ€è¦ä½¿ç”¨ root èº«ä»½æ‰è¡Œï¼Œä¸€èˆ¬è´¦æˆ·å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯ä¸ä¼šæˆåŠŸ
/etc/init.d/netconsole restart
```

æŸ¥é˜…è¯¥æ–‡ä»¶ï¼Œæ‰¾åˆ°æ–‡ä»¶æœ«å°¾ä¸ºå‘ç°ä»¥ä¸‹çš„å†…å®¹ï¼Œè¿™é‡Œå°±åˆ¤å®šäº†è¾“å…¥çš„å‚æ•°ï¼Œä½¿ç”¨çš„å°±æ˜¯ case è¯­æ³•

```bash
case "$1" in
    stop) stop ;;
    status) status ;;
    start|restart|reload|force-reload) restart ;;
    condrestart) condrestart ;;
    *) usage ;;
esac
```

æ‰€ä»¥å¯¹äºè„šæœ¬çš„ç¼–å†™ï¼Œå¯ä»¥å‚è€ƒè¿™äº›å·²ç»æœ‰çš„ï¼Œçœ‹çœ‹äººå®¶æ˜¯æ€ä¹ˆå†™çš„

ä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨ã€Œ`case $å˜é‡ in`ã€è¯­æ³•ï¼Œé‚£ä¸ªå˜é‡å¤§è‡´æœ‰ä¸¤ç§å–å¾—æ–¹å¼ï¼š

- ç›´æ¥ä¸‹è¾¾ï¼šåˆ©ç”¨ `script.sh variable` æ–¹å¼ç›´æ¥ç»™ $1 å˜é‡ï¼Œè¿™ä¹Ÿæ˜¯åœ¨ `/etc/init.d` ç›®å½•ä¸‹å¤§å¤šæ•°ç¨‹åºçš„è®¾è®¡æ–¹å¼
- äº¤äº’å¼ï¼šé€šè¿‡ read æŒ‡ä»¤è®©ç”¨æˆ·è¾“å…¥å˜é‡å†…å®¹

ä¸‹é¢æ¥æ¼”ç¤ºä¸‹ï¼š

- ç”¨æˆ·è¾“å…¥ `oneã€twoã€three` å¹¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Š
- å¦‚æœä¸æ˜¯ä»¥ä¸Šå˜é‡ï¼Œé‚£ä¹ˆæç¤ºç”¨æˆ·åªæœ‰è¿™ä¸‰ç§é€‰æ‹©

```bash
vim show123.sh

#!/bin/bash
# Program:
#       
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

# å¦‚éœ€è¦è®©ç”¨æˆ·äº¤äº’æ€§è¾“å…¥ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨è¿™ä¸¤è¡Œä»£æ›¿ï¼šcase "$1" in
# read -p "è¯·è¾“å…¥æ‚¨çš„é€‰æ‹©ï¼š" choice
# case "${choice}" in

case "$1" in
	"one") echo $1 ;;
	"two") echo $1 ;;
	"three") echo $1 ;;
	*) echo "åªèƒ½è¾“å…¥ oneã€twoã€three" ;;
esac
```

æµ‹è¯•è¾“å‡º

```bash
[mrcode@study bin]$ ./show123.sh 
åªèƒ½è¾“å…¥ oneã€twoã€three
[mrcode@study bin]$ ./show123.sh one
one
[mrcode@study bin]$ ./show123.sh two
two
[mrcode@study bin]$ ./show123.sh three
three
[mrcode@study bin]$ ./show123.sh three111
åªèƒ½è¾“å…¥ oneã€twoã€three
```

## ğŸ€ åˆ©ç”¨ function åŠŸèƒ½

å‡½æ•°åŠŸèƒ½ï¼Œä¸ç”¨å¤šè¯´ï¼Œå¯ä»¥è¢«å¤ç”¨ï¼Œä¼˜åŒ–ç¨‹åºç»“æ„ï¼Œè¯­æ³•å¦‚ä¸‹

```bash
function fname(){
	ç¨‹åºæ®µ
}
```

::: tip
ç”±äº shell script æ‰§è¡Œæ–¹å¼æ˜¯ç”±ä¸Šè€Œä¸‹ï¼Œç”±å·¦è€Œå³ï¼Œå› æ­¤ function çš„ä»£ç ä¸€å®šè¦åœ¨ç¨‹åºçš„æœ€å‰é¢
:::

ä¸‹é¢å°†  show123.sh  æ”¹å†™æˆä½¿ç”¨ function æ–¹å¼

```bash
vim show123-2.sh
#!/bin/bash
# Program:
#       
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

# å¦‚éœ€è¦è®©ç”¨æˆ·äº¤äº’æ€§è¾“å…¥ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨è¿™ä¸¤è¡Œä»£æ›¿ï¼šcase "$1" in
# read -p "è¯·è¾“å…¥æ‚¨çš„é€‰æ‹©ï¼š" choice
# case "${choice}" in

function printit(){
	echo -n "Your choice is " # -n å¯ä»¥ä¸æ–­è¡Œè¿ç»­åœ¨åŒä¸€è¡Œæ˜¾ç¤º
}

case "$1" in
	"one") printit; echo $1 ;;
	"two") printit; echo $1 | tr 'a-z' 'A-z' ;;  # è½¬æ¢ä¸ºå¤§å†™
	"three") printit; echo $1 ;;
	*) echo "åªèƒ½è¾“å…¥ oneã€twoã€three" ;;
esac
```

è¾“å‡ºä¿¡æ¯

```bash
[mrcode@study bin]$ ./show123-2.sh one
Your choice is one
[mrcode@study bin]$ vim show123-2.sh
[mrcode@study bin]$ ./show123-2.sh tow
åªèƒ½è¾“å…¥ oneã€twoã€three
[mrcode@study bin]$ ./show123-2.sh two
Your choice is TWO
```

ä¸Šè¿°ä»£ç ï¼Œåšäº†ä¸€ä¸ªæ‰“å°éƒ¨åˆ†é‡å¤ä¿¡æ¯çš„åŠŸèƒ½ï¼Œè¿™ä¸ªä¾‹å­æ¯”è¾ƒç®€å•ï¼Œå½“åœ¨ç¨‹åºä¸­æœ‰å¤§é‡é‡å¤ï¼Œå’Œå¤§é‡é€»è¾‘çš„æ—¶å€™ï¼Œå°±ä¼šä½“ç°å‡ºæ¥äº†

åŒæ ·ï¼Œfunction ä¹Ÿå¯ä»¥æœ‰å‚æ•°å˜é‡ï¼Œæ”¹å†™æˆæœ‰å‚æ•°è°ƒç”¨å‡½æ•°

```bash
vim show123-3.sh

#!/bin/bash
# Program:
#       
# History:
#       2020/01/20              mrcode          first relese
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

function printit(){
        echo "Your choice is ${1}" # åœ¨å‡½æ•°åŸŸä¸­ï¼Œçš„å‚æ•°å˜é‡ï¼Œä¸å¤–éƒ¨çš„ä¸ä¸€è‡´
}

case "$1" in
        "one") printit 1 ;;
        "two") printit 2 ;;
        "three") printit $1 ;;
        *) echo "åªèƒ½è¾“å…¥ oneã€twoã€three" ;;
esac
```

æµ‹è¯•å¦‚ä¸‹

```bash
[mrcode@study bin]$ ./show123-3.sh one
Your choice is 1			
[mrcode@study bin]$ ./show123-3.sh two
Your choice is 2 	# å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œç»™å®šå‚æ•° 1ï¼Œé‚£ä¹ˆåœ¨é‡Œé¢è·å– ${1}ï¼Œçš„æ—¶å€™å°±è·å–åˆ°äº†

[mrcode@study bin]$ ./show123-3.sh three		
Your choice is three	# åœ¨å¤–éƒ¨ç»™å®šçš„æ˜¯è„šæœ¬ä¸­çš„å˜é‡ $1, åœ¨å†…éƒ¨ä¹Ÿèƒ½è·å–åˆ°å˜é‡çš„å…·ä½“å†…å®¹
[mrcode@study bin]$ ./show123-3.sh threex
åªèƒ½è¾“å…¥ oneã€twoã€three
```

