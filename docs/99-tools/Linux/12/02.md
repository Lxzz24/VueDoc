---
title: 
sidebarDepth: 0 
category: Tools 
tag: Linux
---
# ç®€å•çš„ Shell Script ç»ƒä¹ 

æœ¬ç«  èŒƒä¾‹ä¸­ï¼Œå®ç°çš„æ–¹å¼å¾ˆå¤šï¼Œå»ºè®®å…ˆè‡ªè¡Œç¼–å†™ï¼Œå†å‚è€ƒä¾‹å­ï¼Œæ‰èƒ½åŠ æ·±æ¦‚å¿µ

## ğŸ€ ç®€å•èŒƒä¾‹

æœ¬å°èŠ‚èŒƒä¾‹åœ¨å¾ˆå¤šè„šæœ¬ç¨‹åºä¸­éƒ½ä¼šç”¨åˆ°ï¼Œè€Œä¸”ç®€å•

### å¯¹è°ˆå¼è„šæœ¬ï¼šå˜é‡ç±»å®¹ç”±ç”¨æˆ·å†³å®š

åœ¨å¾ˆå¤šåœºæ™¯ä¸­ï¼Œéœ€è¦ç”¨æˆ·è¾“å…¥ä¸€äº›å†…å®¹ï¼Œè®©ç¨‹åºå¯ä»¥é¡ºåˆ©è¿è¡Œã€‚æ¯”å¦‚ï¼Œå®‰è£…è½¯ä»¶æ—¶ï¼Œè®©ç”¨æˆ·é€‰æ‹©å®‰è£…ç›®å½•ï¼›

[BASH ä¸­çš„å˜é‡è¯»å–æŒ‡ä»¤ read](../10/02.mdl#read) ï¼Œé‚£ä¹ˆä»¥ read æŒ‡ä»¤çš„ç”¨é€”å®ç°ï¼š

1. ç”¨æˆ·è¾“å…¥ first name
2. ç”¨æˆ·è¾“å…¥ last name
3. æœ€ååœ¨å±å¹•ä¸Šæ˜¾ç¤ºï¼šYou full name isï¼šxxx

```bash
[mrcode@study bin]$ vim read.sh
#!/bin/bash
read -p 'first name: ' firstName
read -p 'last name: ' lastName
echo "You full name: ${firstName}${lastName}"
exit 0
```

```bash
# å¢åŠ æ‰§è¡Œæƒé™
[mrcode@study bin]$ chmod a+x read.sh
# æ‰§è¡Œ
[mrcode@study bin]$ ./read.sh 
first name: zhu
last name: mrcode
You full name: zhumrcode
```



ä¸‹é¢æ˜¯ä¹¦ä¸Šçš„ç¨‹åº

```bash
vim showname.sh
#!/bin/bash
# Programï¼š
#	ç”¨æˆ·è¾“å…¥å§“åï¼Œç¨‹åºæ˜¾ç¤ºå‡ºè¾“å…¥çš„å§“å
# Historyï¼š
#	2020/01/19	mrcode	first release
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

read -p "Please input you first name: " firstname		# æç¤ºä½¿ç”¨è€…è¾“å…¥
read -p "Please input you last name: " lastname			# æç¤ºä½¿ç”¨è€…è¾“å…¥
# -e å¼€å¯åæ–œæ è½¬ç§»çš„ç‰¹æ®Šå­—ç¬¦æ˜¾ç¤ºï¼Œæ¯”å¦‚ä¸‹é¢çš„ \n æ¢è¡Œæ˜¾ç¤º
echo -e â€œ\n Your full name is: ${firstname}${lastname}â€	# ç»“æœç”±å±å¹•è¾“å‡º	
```

```bash
# æ‰§è¡Œç»“æœ
[mrcode@study bin]$ ./showname.sh 
Please input you first name: zhu
Please input you last name: mrcode

 Your full name is: zhumrcode
```

ç¬”è€…å°ç»“ï¼šå¯ä»¥çœ‹åˆ°ä¸Šé¢è¿™ä¸ªè„šæœ¬ï¼Œå¢åŠ äº†ä¸€ä¸ªè‰¯å¥½çš„ä¹ æƒ¯ï¼Œå°±æ˜¯è„šæœ¬è¯´æ˜ç­‰ä¿¡æ¯

### éšæ—¥æœŸå˜åŒ–ï¼šåˆ©ç”¨ date è¿›è¡Œæ–‡ä»¶çš„å»ºç«‹

è€ƒè™‘ä¸€ä¸ªåœºæ™¯ï¼Œæ¯å¤©å¤‡ä»½ MySql çš„æ•°æ®æ–‡ä»¶ï¼Œå¤‡ä»½æ–‡ä»¶åä»¥å½“å¤©æ—¥æœŸå‘½åï¼Œå¦‚ `backup.2020-01-19.data`.

é‡ç‚¹æ˜¯ `2020-01-19` æ˜¯æ€ä¹ˆæ¥çš„ï¼ŸèŒƒä¾‹éœ€æ±‚å¦‚ä¸‹ï¼š

1. ç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ–‡ä»¶åå‰ç¼€
2.  åˆ›å»ºå‡ºä»¥æ—¥æœŸä¸ºåçš„ä¸‰ä¸ªç©ºæ–‡ä»¶ï¼ˆé€šè¿‡ touch æŒ‡ä»¤ï¼‰ï¼Œç”Ÿæˆ å‰å¤©ã€æ˜¨å¤©ã€ä»Šå¤© æ—¥æœŸï¼ŒåŠæ ¼å¼ä¸ºï¼šfilename_2020-01-19

```bash
vim create_3_filename.sh
#!/bin/bash
# Program: 
#       ç”¨æˆ·è¾“å…¥æ–‡ä»¶åå‰ç¼€ï¼Œç”Ÿæˆå‰å¤©ã€æ˜¨å¤©ã€ä»Šå¤©çš„ä¸‰ä¸ªç©ºæ–‡ä»¶
# Historyï¼š
#       2020/01/19      mrcode          first release
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

echo -e "å°†ä½¿ç”¨ â€˜touchâ€™ å‘½ä»¤åˆ›å»º 3 ä¸ªæ–‡ä»¶"
read -p "è¯·è¾“å…¥æ–‡ä»¶åï¼š" fileuser

# å®¹é”™ï¼Œä½¿ç”¨å˜é‡åŠŸèƒ½åˆ¤å®šä¸èµ‹å€¼é»˜è®¤å€¼
filename=${fileuser:-"filename"}

# date å‘½ä»¤çš„ä½¿ç”¨
date1=$(date --date='2 days ago' +%Y-%m-%d)		# ä¸¤å¤©å‰çš„æ—¥æœŸï¼Œå¹¶æ ¼å¼åŒ–æ˜¾ç¤º
date2=$(date --date='1 days ago' +%Y-%m-%d)	
date3=$(date +%Y-%m-%d)

file1="${filename}_${date1}"
file2="${filename}_${date2}"
file3="${filename}_${date3}"

# åœ¨è¿™é‡Œå…¶å®å¯ä»¥ç›´æ¥æ‹¼æ¥æ–‡ä»¶å
touch "${file1}"
touch "${file2}"
touch "${file3}"
```

è¿™é‡Œä½¿ç”¨äº†å˜é‡çš„èµ‹å€¼ç›¸å…³åŠŸèƒ½ï¼Œè¯¦å‚è€ƒï¼š[å˜é‡åŠŸèƒ½](../10/02.md#å˜é‡çš„æµ‹è¯•ä¸å†…å®¹æ›¿æ¢)

è¿è¡Œæµ‹è¯•

```bash
[mrcode@study bin]$ ./create_3_filename.sh 
å°†ä½¿ç”¨ â€˜touchâ€™ å‘½ä»¤åˆ›å»º 3 ä¸ªæ–‡ä»¶
è¯·è¾“å…¥æ–‡ä»¶åï¼šmrcode
[mrcode@study bin]$ ll
æ€»ç”¨é‡ 16
-rwxrwxr-x. 1 mrcode mrcode 677 1æœˆ  19 14:15 create_3_filename.sh
-rwxrwxr-x. 1 mrcode mrcode 239 1æœˆ  19 11:25 hello.sh
-rw-rw-r--. 1 mrcode mrcode   0 1æœˆ  19 14:15 mrcode_2020-01-17
-rw-rw-r--. 1 mrcode mrcode   0 1æœˆ  19 14:15 mrcode_2020-01-18
-rw-rw-r--. 1 mrcode mrcode   0 1æœˆ  19 14:15 mrcode_2020-01-19
# ä¸€æ¬¡æ­£å¸¸è¾“å…¥æ–‡ä»¶åï¼Œä¸€æ¬¡ç›´æ¥æŒ‰ enter æŒ‰é”®å®Œæˆè¾“å…¥ï¼ŒæŸ¥çœ‹æ˜¯å¦è¾¾åˆ°é»˜è®¤èµ‹å€¼ç­‰åŠŸèƒ½
```

### æ•°å€¼è¿ç®—ï¼šç®€å•çš„åŠ å‡ä¹˜é™¤

åœ¨å˜é‡åŠŸèƒ½è¯¾ç¨‹ä¸­è®²è§£åˆ°ï¼Œéœ€è¦ä½¿ç”¨ [declare](../10/02.md#declare-ã€-typeset) æ¥å®šä¹‰å˜é‡ä¸ºæ­£æ•°æ‰èƒ½è¿›è¡Œè®¡ç®—ï¼Œæ­¤å¤–ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ `$((è®¡ç®—è¡¨è¾¾å¼))` æ¥è¿›è¡Œæ•°å€¼è¿ç®—ï¼Œå¯æƒœçš„æ˜¯ï¼Œbashe shell é¢„è®¾ä»…æ”¯æŒæ•´æ•°æ•°æ®ã€‚

èŒƒä¾‹éœ€æ±‚ï¼š

1. è¦æ±‚ç”¨æˆ·è¾“å…¥ä¸¤ä¸ªå˜é‡
2. å°†ä¸¤ä¸ªå˜é‡ç›¸ä¹˜åè¾“å‡ºåˆ°å±å¹•

ä¸‹é¢æ˜¯ç¬”è€…è‡ªå·±å†™çš„

```bash
#!/bin/bash
# Program:
#       ç”¨æˆ·è¾“å…¥ 2 ä¸ªæ•´æ•°ï¼›è¾“å‡ºç›¸ä¹˜åçš„ç»“æœ
# Historyï¼š
#       2020/01/19      mrcode          first release
read -p 'è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•´æ•°ï¼š' intUser1
read -p 'è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•´æ•°ï¼š' intUser2
declare -i int1=${intUser1}
declare -i int2=${intUser2}

echo -e  "\n ${int1} x ${int2} = $((int1*int2))"
```

æµ‹è¯•è¾“å‡º

```bash
[mrcode@study bin]$ ./multiplying.sh 
è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•´æ•°ï¼š2
è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•´æ•°ï¼š3

 2 x 3 = 6
```

å…¶å®ç”¨ä¸‹é¢è¿™æ ·çš„æ–¹å¼æ¥å®šä¹‰å’Œè¾“å‡º

```bash
read -p 'è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•´æ•°ï¼š' intUser1
read -p 'è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•´æ•°ï¼š' intUser2
total=$((${intUser1}*${intUser2}))		# ä½¿ç”¨ $((è¿ç®—å†…å®¹)) æ–¹å¼è®¡ç®—
# declare -i total=${intUser1}*${intUser2}		# è¿˜å¯ä»¥ä½¿ç”¨æ­¤ç§æ–¹å¼
echo -e  "\n ${intUser1} x ${intUser2} = ${total}"
```

å»ºè®®ç”¨ `var = $((è®¡ç®—å†…å®¹))` æ–¹å¼æ¥è®¡ç®—ï¼Œæ­¤ç§æ–¹å¼ç®€å•ã€‚æ¯”å¦‚

```bash
# å–ä½™æ•°
[mrcode@study bin]$ echo $((3 % 2))
1

# å¯¹äºå°æ•°ï¼Œå¯ä»¥ä½¿ç”¨ bc æŒ‡ä»¤æ¥ååŠ©
[mrcode@study bin]$ echo $((3 / 2)); echo "3/2" | bc -l
1
1.50000000000000000000
```

### æ•°å€¼è¿ç®—ï¼šé€šè¿‡ bc è®¡ç®— pi

bc æä¾›äº†ä¸€ä¸ªè®¡ç®— pi çš„å…¬å¼ï¼š `pi=$(echo "scale=10; 4*a(1)" | bc -l)`ï¼Œæ­¤è®¡ç®—å…¬å¼å¯ä»¥é€šè¿‡ `man bc | grep 'pi'` å®šä½åˆ°ç›¸å…³æ–‡æ¡£ã€‚è¿™é‡Œçš„ scale æ˜¯è®¡ç®— pi çš„ç²¾åº¦ï¼Œè¶Šé«˜åˆ™åˆ©ç”¨åˆ°çš„ cpu èµ„æºè¶Šå¤šï¼Œè®¡ç®—æ—¶é—´è¶Šé•¿ã€‚

å¥½äº†ï¼Œäº†è§£åˆ°æ€ä¹ˆå¯ç”¨ pi è®¡ç®—ï¼Œè¿™é‡Œè¦æ±‚ç”¨æˆ·è¾“å…¥ scale è¿›è¡Œè®¡ç®— pi å€¼ï¼Œå¹¶è¾“å‡ºæ˜¾ç¤º

```bash
vim cal_pi.sh
#!/bin/bash
# Programï¼š
#	ç”¨æˆ·è¾“å…¥ scale çš„å€¼ï¼Œç¨‹åºè®¡ç®—å‡º scale ç²¾åº¦çš„ pi å€¼ï¼Œå¹¶æ˜¾ç¤º
# Historyï¼š
#	2020/01/19		mrcode		first release
# PATH å¸¸è§„èµ‹å€¼
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

read -p 'è¯·è¾“å…¥ scale çš„å€¼ï¼ˆ10~10000ï¼‰ï¼Ÿ' checking
num=${checking:-"10"}

echo -e '\nå¼€å§‹è®¡ç®— pi çš„å€¼'
time echo "scale=${num}; 4*a(1)" | bc -l
```

æµ‹è¯•è¾“å‡º

```bash
[mrcode@study bin]$ ./cal_pi.sh 
è¯·è¾“å…¥ scale çš„å€¼ï¼ˆ10~10000ï¼‰ï¼Ÿ20

å¼€å§‹è®¡ç®— pi çš„å€¼
3.14159265358979323844

real	0m0.002s
user	0m0.000s
sys	0m0.001s
```

## ğŸ€ script çš„æ‰§è¡Œæ–¹å¼å·®å¼‚ï¼ˆsourceã€sh scriptã€./scriptï¼‰

ä¸åŒçš„æ–¹å¼æ‰§è¡Œæ‰§è¡Œä¼šé€ æˆä¸ä¸€æ ·çš„ç»“æœï¼Œå°¤å…¶å½±å“ bash çš„ç¯å¢ƒå¾ˆå¤§ã€‚

### åˆ©ç”¨ç›´æ¥æ‰§è¡Œçš„æ–¹å¼æ¥æ‰§è¡Œ scriptï¼šåœ¨å­ç¨‹åºä¸­æ‰§è¡Œ

[ç›´æ¥æŒ‡ä»¤ä¸‹è¾¾](./01.md#ç¬¬ä¸€æ”¯-script-çš„ç¼–å†™ä¸æ‰§è¡Œ) æˆ–è€…æ˜¯åˆ©ç”¨ bashï¼ˆshï¼‰æ¥è¿è¡Œè„šæœ¬æ—¶ï¼Œéƒ½ä¼šä½¿ç”¨ä¸€ä¸ªæ–°çš„ bash ç¯å¢ƒæ¥æ‰§è¡Œè„šæœ¬çš„æŒ‡ä»¤ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ç§æ–¹å¼æ‰§è¡Œæ˜¯åœ¨å­ç¨‹åºçš„ bash å†…æ‰§è¡Œçš„ã€‚åœ¨ç¬¬åç«  BASH å†…è°ˆåˆ° [`export` è‡ªå®šä¹‰å˜é‡è½¬æˆç¯å¢ƒå˜é‡](../10/02.md) çš„åŠŸèƒ½æ—¶ï¼Œé‡ç‚¹åœ¨äºï¼šå½“å­ç¨‹åºå®Œæˆåï¼Œå­ç¨‹åºå†…çš„å„é¡¹å˜é‡æˆ–åŠ¨ä½œå°†ä¼šç»“æŸå„¿ä¸ä¼šä¼ å›åˆ°çˆ¶ç¨‹åºä¸­ã€‚

```bash
# è¿è¡Œä¸Šé¢èŒƒä¾‹çš„å§“åæ‰“å°
[mrcode@study bin]$ ./showname.sh 
Please input you first name: m
Please input you last name: q

 Your full name is: mq		#  echo -e "\n Your full name is: ${firstname}${lastname}" æ‰“å°å‡ºæ¥äº†ä¿¡æ¯
[mrcode@study bin]$ echo ${fristname}${lastname}		# ä½†æ˜¯åœ¨çˆ¶ç¨‹åºä¸­å´æ²¡æœ‰ä¿¡æ¯

```



### åˆ©ç”¨ source æ¥æ‰§è¡Œè„šæœ¬ï¼šåœ¨çˆ¶ç¨‹åºä¸­æ‰§è¡Œ

åŒæ ·çš„æµ‹è¯•ä»£ç ï¼Œä½¿ç”¨ source å°±ä¸ä¸€æ ·äº†

```bash
[mrcode@study bin]$ source showname.sh 
Please input you first name: m
Please input you last name: q

 Your full name is: mq
[mrcode@study bin]$ echo ${firstname}${lastname}
mq			# åœ¨çˆ¶ç¨‹åºä¸­è¿˜èƒ½è·å–åˆ°
```




