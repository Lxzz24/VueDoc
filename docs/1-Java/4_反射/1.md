---
title: Class ç±»
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

é™¤äº† `int` ç­‰åŸºæœ¬ç±»å‹å¤–ï¼ŒJava çš„å…¶ä»–ç±»å‹å…¨éƒ¨éƒ½æ˜¯ `class` ï¼ˆåŒ…æ‹¬ `interface` ï¼‰ã€‚ä¾‹å¦‚ï¼š

- String
- Object
- Runnable
- Exception
- ...

ä»”ç»†æ€è€ƒï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š `class` ï¼ˆåŒ…æ‹¬ `interface` ï¼‰çš„æœ¬è´¨æ˜¯æ•°æ®ç±»å‹ï¼ˆ `Type` ï¼‰ã€‚_æ— ç»§æ‰¿å…³ç³»çš„æ•°æ®ç±»å‹æ— æ³•èµ‹å€¼_ï¼š

```java
Number n = new Double(123.456); // OK
String s = new Double(123.456); // compile error!
```

è€Œ `class` æ˜¯ç”± JVM åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€åŠ è½½çš„ã€‚JVM åœ¨ç¬¬ä¸€æ¬¡è¯»å–åˆ°ä¸€ç§ `class` ç±»å‹æ—¶ï¼Œå°†å…¶åŠ è½½è¿›å†…å­˜ã€‚

æ¯åŠ è½½ä¸€ç§ `class` ï¼ŒJVM å°±ä¸ºå…¶åˆ›å»ºä¸€ä¸ª `Class` ç±»å‹çš„å®ä¾‹ï¼Œå¹¶å…³è”èµ·æ¥ã€‚

> [!warning]
> æ³¨æ„ï¼šè¿™é‡Œçš„ `Class` ç±»å‹æ˜¯ä¸€ä¸ªåå« `Class` çš„ `class` ã€‚å®ƒé•¿è¿™æ ·ï¼š

```java
public final class Class {
    private Class() {}
}
```

ä»¥ `String` ç±»ä¸ºä¾‹ï¼Œå½“ JVM åŠ è½½ `String` ç±»æ—¶ï¼Œå®ƒé¦–å…ˆè¯»å– `String.class` æ–‡ä»¶åˆ°å†…å­˜ï¼Œç„¶åï¼Œä¸º `String` ç±»åˆ›å»ºä¸€ä¸ª `Class` å®ä¾‹å¹¶å…³è”èµ·æ¥ï¼š

```java
Class cls = new Class(String);
```

è¿™ä¸ª `Class` å®ä¾‹æ˜¯ JVM å†…éƒ¨åˆ›å»ºçš„ï¼Œå¦‚æœæˆ‘ä»¬æŸ¥çœ‹ JDK æºç ï¼Œå¯ä»¥å‘ç° `Class` ç±»çš„æ„é€ æ–¹æ³•æ˜¯ `private` ï¼Œ_åªæœ‰ JVM èƒ½åˆ›å»º `Class` å®ä¾‹_ï¼Œæˆ‘ä»¬è‡ªå·±çš„ Java ç¨‹åºæ˜¯æ— æ³•åˆ›å»º `Class` å®ä¾‹çš„ã€‚

æ‰€ä»¥ï¼ŒJVM æŒæœ‰çš„æ¯ä¸ª `Class` å®ä¾‹éƒ½æŒ‡å‘ä¸€ä¸ªæ•°æ®ç±»å‹ï¼ˆ `class` æˆ– `interface` ï¼‰ï¼š

![](assets/20220628101926.png)

ä¸€ä¸ª `Class` å®ä¾‹åŒ…å«äº†è¯¥ class çš„æ‰€æœ‰å®Œæ•´ä¿¡æ¯ï¼š

![](assets/20220628102009.png)

ç”±äº JVM ä¸ºæ¯ä¸ªåŠ è½½çš„ `class` åˆ›å»ºäº†å¯¹åº”çš„ `Class` å®ä¾‹ï¼Œå¹¶åœ¨å®ä¾‹ä¸­ä¿å­˜äº†è¯¥ `class` çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬ _ç±»å_ã€_åŒ…å_ã€_çˆ¶ç±»_ã€_å®ç°çš„æ¥å£_ã€_æ‰€æœ‰æ–¹æ³•_ã€_å­—æ®µ_ ç­‰ï¼Œå› æ­¤ï¼Œå¦‚æœè·å–äº†æŸä¸ª `Class` å®ä¾‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸ª `Class` å®ä¾‹è·å–åˆ°è¯¥å®ä¾‹å¯¹åº”çš„ `class` çš„æ‰€æœ‰ä¿¡æ¯ã€‚

> [!important]
> _è¿™ç§é€šè¿‡ `Class` å®ä¾‹è·å– `class` ä¿¡æ¯çš„æ–¹æ³•ç§°ä¸ºåå°„ï¼ˆ Reflection ï¼‰_ã€‚

## ğŸ€ å¦‚ä½•è·å–ä¸€ä¸ª `class` çš„ `Class` å®ä¾‹ï¼Ÿ

æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼š

### æ–¹æ³•ä¸€ï¼š

ç›´æ¥é€šè¿‡ä¸€ä¸ª `class` çš„é™æ€å˜é‡ `class` è·å–ï¼š

```java
Class cls = String.class;
```

### ğŸŒ¸ æ–¹æ³•äºŒï¼š

å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå®ä¾‹å˜é‡ï¼Œå¯ä»¥é€šè¿‡è¯¥å®ä¾‹å˜é‡æä¾›çš„ `getClass()` æ–¹æ³•è·å–ï¼š

```java
String s = "Hello";
Class cls = s.getClass();
```

### æ–¹æ³•ä¸‰ï¼š

å¦‚æœçŸ¥é“ä¸€ä¸ª `class` çš„å®Œæ•´ç±»åï¼Œå¯ä»¥é€šè¿‡é™æ€æ–¹æ³• `Class.forName()` è·å–ï¼š

```java
Class cls = Class.forName("java.lang.String");
```

å› ä¸º `Class` å®ä¾‹åœ¨ JVM ä¸­æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥ï¼Œä¸Šè¿°æ–¹æ³•è·å–çš„ `Class` å®ä¾‹æ˜¯åŒä¸€ä¸ªå®ä¾‹ã€‚å¯ä»¥ç”¨ `==` æ¯”è¾ƒä¸¤ä¸ª `Class` å®ä¾‹ï¼š

```java
Class cls1 = String.class;

String s = "Hello";
Class cls2 = s.getClass();

boolean sameClass = cls1 == cls2; // true
```

æ³¨æ„ä¸€ä¸‹ `Class` å®ä¾‹æ¯”è¾ƒå’Œ `instanceof` çš„å·®åˆ«ï¼š

```java
Integer n = new Integer(123);

boolean b1 = n instanceof Integer; // trueï¼Œå› ä¸º n æ˜¯ Integer ç±»å‹
boolean b2 = n instanceof Number; // trueï¼Œå› ä¸º n æ˜¯ Number ç±»å‹çš„å­ç±»

boolean b3 = n.getClass() == Integer.class; // trueï¼Œå› ä¸º n.getClass() è¿”å› Integer.class
boolean b4 = n.getClass() == Number.class; // falseï¼Œå› ä¸º Integer.class!=Number.class
```

**_ç”¨ `instanceof` ä¸ä½†åŒ¹é…æŒ‡å®šç±»å‹ï¼Œè¿˜åŒ¹é…æŒ‡å®šç±»å‹çš„å­ç±»ã€‚_** è€Œç”¨ `==` åˆ¤æ–­ `class` å®ä¾‹å¯ä»¥ç²¾ç¡®åœ°åˆ¤æ–­æ•°æ®ç±»å‹ï¼Œä½†ä¸èƒ½ä½œå­ç±»å‹æ¯”è¾ƒã€‚

<u>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥ç”¨ `instanceof` åˆ¤æ–­æ•°æ®ç±»å‹</u>ï¼Œå› ä¸ºé¢å‘æŠ½è±¡ç¼–ç¨‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒå…·ä½“çš„å­ç±»å‹ã€‚åªæœ‰åœ¨éœ€è¦ç²¾ç¡®åˆ¤æ–­ä¸€ä¸ªç±»å‹æ˜¯ä¸æ˜¯æŸä¸ª `class` çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰ä½¿ç”¨ `==` åˆ¤æ–­ `class` å®ä¾‹ã€‚

å› ä¸ºåå°„çš„ç›®çš„æ˜¯ä¸ºäº†è·å¾—æŸä¸ªå®ä¾‹çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°æŸä¸ª `Object` å®ä¾‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„è·å–è¯¥ `Object` çš„ `class` ä¿¡æ¯ï¼š

```java
void printObjectInfo(Object obj) {
    Class cls = obj.getClass();
}
```

è¦ä» `Class` å®ä¾‹è·å–çš„åŸºæœ¬ä¿¡æ¯ï¼Œå‚è€ƒä¸‹é¢çš„ä»£ç ï¼š

```java
public class Main {
    public static void main(String[] args) {
        printClassInfo("".getClass());
        printClassInfo(Runnable.class);
        printClassInfo(java.time.Month.class);
        printClassInfo(String[].class);
        printClassInfo(int.class);
    }

    static void printClassInfo(Class cls) {
        System.out.println("Class name:" + cls.getName());
        System.out.println("Simple name:" + cls.getSimpleName());
        if (cls.getPackage() != null) {
            System.out.println("Package name:" + cls.getPackage().getName());
        }
        System.out.println("is interface:" + cls.isInterface());
        System.out.println("is enum:" + cls.isEnum());
        System.out.println("is array:" + cls.isArray());
        System.out.println("is primitive:" + cls.isPrimitive());
    }
}
```

æ³¨æ„åˆ°æ•°ç»„ï¼ˆä¾‹å¦‚ `String[]` ï¼‰ä¹Ÿæ˜¯ä¸€ç§ç±»ï¼Œè€Œä¸”ä¸åŒäº `String.class` ï¼Œå®ƒçš„ç±»åæ˜¯ `[Ljava.lang.String;` ã€‚æ­¤å¤–ï¼ŒJVM ä¸ºæ¯ä¸€ç§åŸºæœ¬ç±»å‹å¦‚ `int` ä¹Ÿåˆ›å»ºäº† `Class` å®ä¾‹ï¼Œé€šè¿‡ `int.class` è®¿é—®ã€‚

å¦‚æœè·å–åˆ°äº†ä¸€ä¸ª `Class` å®ä¾‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¯¥ `Class` å®ä¾‹æ¥åˆ›å»ºå¯¹åº”ç±»å‹çš„å®ä¾‹ï¼š

```java
// è·å– String çš„ Class å®ä¾‹:
Class cls = String.class;
// åˆ›å»ºä¸€ä¸ª String å®ä¾‹:
String s = (String) cls.newInstance();
```

ä¸Šè¿°ä»£ç ç›¸å½“äº `new String()` ã€‚

> é€šè¿‡ `Class.newInstance()` å¯ä»¥åˆ›å»ºç±»å®ä¾‹ï¼Œå®ƒçš„å±€é™æ˜¯ï¼šåªèƒ½è°ƒç”¨ `public` çš„æ— å‚æ•°æ„é€ æ–¹æ³•ã€‚å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œæˆ–è€…é `public` çš„æ„é€ æ–¹æ³•éƒ½æ— æ³•é€šè¿‡ `Class.newInstance()` è¢«è°ƒç”¨ã€‚

## ğŸ€ åŠ¨æ€åŠ è½½

JVM åœ¨æ‰§è¡Œ Java ç¨‹åºçš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰ç”¨åˆ°çš„ class å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ï¼Œè€Œæ˜¯ç¬¬ä¸€æ¬¡éœ€è¦ç”¨åˆ° class æ—¶æ‰åŠ è½½ã€‚ä¾‹å¦‚ï¼š

```java
public class Main {
    public static void main(String[] args) {
        if (args.length> 0) {
            create(args[0]);
        }
    }

    static void create(String name) {
        Person p = new Person(name);
    }
}
```

> [!tip]
> å½“æ‰§è¡Œ `Main.java` æ—¶ï¼Œç”±äºç”¨åˆ°äº† `Main` ï¼Œå› æ­¤ï¼ŒJVM é¦–å…ˆä¼šæŠŠ `Main.class` åŠ è½½åˆ°å†…å­˜ã€‚ç„¶è€Œï¼Œå¹¶ä¸ä¼šåŠ è½½ `Person.class` ï¼Œé™¤éç¨‹åºæ‰§è¡Œåˆ° `create()` æ–¹æ³•ï¼ŒJVM å‘ç°éœ€è¦åŠ è½½ `Person` ç±»æ—¶ï¼Œæ‰ä¼šé¦–æ¬¡åŠ è½½ `Person.class` ã€‚å¦‚æœæ²¡æœ‰æ‰§è¡Œ `create()` æ–¹æ³•ï¼Œé‚£ä¹ˆ `Person.class` æ ¹æœ¬å°±ä¸ä¼šè¢«åŠ è½½ã€‚

è¿™å°±æ˜¯ JVM åŠ¨æ€åŠ è½½ `class` çš„ç‰¹æ€§ã€‚

åŠ¨æ€åŠ è½½ `class` çš„ç‰¹æ€§å¯¹äº Java ç¨‹åºéå¸¸é‡è¦ã€‚åˆ©ç”¨ JVM åŠ¨æ€åŠ è½½ `class` çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬æ‰èƒ½ **_åœ¨è¿è¡ŒæœŸæ ¹æ®æ¡ä»¶åŠ è½½ä¸åŒçš„å®ç°ç±»_** ã€‚

> ä¾‹å¦‚ï¼Œ Commons Logging æ€»æ˜¯ä¼˜å…ˆä½¿ç”¨ Log4j ï¼Œåªæœ‰å½“ Log4j ä¸å­˜åœ¨æ—¶ï¼Œæ‰ä½¿ç”¨ JDK çš„ logging ã€‚


åˆ©ç”¨ JVM åŠ¨æ€åŠ è½½ç‰¹æ€§ï¼Œå¤§è‡´çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š

```java
// Commons Logging ä¼˜å…ˆä½¿ç”¨ Log4j:
LogFactory factory = null;
if (isClassPresent("org.apache.logging.log4j.Logger")) {
    factory = createLog4j();
} else {
    factory = createJdkLog();
}

boolean isClassPresent(String name) {
    try {
        Class.forName(name);
        return true;
    } catch (Exception e) {
        return false;
    }
}
```

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠ Log4j çš„ jar åŒ…æ”¾åˆ° classpath ä¸­ï¼Œ Commons Logging å°±ä¼šè‡ªåŠ¨ä½¿ç”¨ Log4j çš„åŸå› ã€‚

## ğŸ€ å°ç»“

- JVM ä¸ºæ¯ä¸ªåŠ è½½çš„ `class` åŠ `interface` åˆ›å»ºäº†å¯¹åº”çš„ `Class` å®ä¾‹æ¥ä¿å­˜ `class` åŠ `interface` çš„æ‰€æœ‰ä¿¡æ¯ï¼›
- è·å–ä¸€ä¸ª `class` å¯¹åº”çš„ `Class` å®ä¾‹åï¼Œå°±å¯ä»¥è·å–è¯¥ `class` çš„æ‰€æœ‰ä¿¡æ¯ï¼›
- é€šè¿‡ `Class` å®ä¾‹è·å– `class` ä¿¡æ¯çš„æ–¹æ³•ç§°ä¸ºåå°„ï¼ˆ Reflection ï¼‰ï¼›
- JVM æ€»æ˜¯åŠ¨æ€åŠ è½½ `class` ï¼Œå¯ä»¥åœ¨è¿è¡ŒæœŸæ ¹æ®æ¡ä»¶æ¥æ§åˆ¶åŠ è½½ `class` ã€‚
