---
title: MVC å¼€å‘
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::


æˆ‘ä»¬é€šè¿‡å‰é¢çš„ç« èŠ‚å¯ä»¥çœ‹åˆ°ï¼š

- Servlet é€‚åˆç¼–å†™ Java ä»£ç ï¼Œå®ç°å„ç§å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œä½†ä¸é€‚åˆè¾“å‡ºå¤æ‚çš„ HTMLï¼›
- JSP é€‚åˆç¼–å†™ HTMLï¼Œå¹¶åœ¨å…¶ä¸­æ’å…¥åŠ¨æ€å†…å®¹ï¼Œä½†ä¸é€‚åˆç¼–å†™å¤æ‚çš„ Java ä»£ç ã€‚

èƒ½å¦å°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œå‘æŒ¥å„è‡ªçš„ä¼˜ç‚¹ï¼Œé¿å…å„è‡ªçš„ç¼ºç‚¹ï¼Ÿ

ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚

å‡è®¾æˆ‘ä»¬å·²ç»ç¼–å†™äº†å‡ ä¸ª JavaBeanï¼š

```java
public class User {
    public long id;
    public String name;
    public School school;
}

public class School {
    public String name;
    public String address;
}
```

åœ¨ `UserServlet` ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä»æ•°æ®åº“è¯»å– `User`ã€`School` ç­‰ä¿¡æ¯ï¼Œç„¶åï¼ŒæŠŠè¯»å–åˆ°çš„ JavaBean å…ˆæ”¾åˆ° HttpServletRequest ä¸­ï¼Œå†é€šè¿‡ `forward()` ä¼ ç»™ `user.jsp` å¤„ç†ï¼š

```java
@WebServlet(urlPatterns = "/user")
public class UserServlet extends HttpServlet {
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        // å‡è£…ä»æ•°æ®åº“è¯»å–:
        School school = new School("No.1 Middle School", "101 South Street");
        User user = new User(123, "Bob", school);
        // æ”¾å…¥ Request ä¸­:
        req.setAttribute("user", user);
        // forward ç»™ user.jsp:
        req.getRequestDispatcher("/WEB-INF/user.jsp").forward(req, resp);
    }
}
```

åœ¨ `user.jsp` ä¸­ï¼Œæˆ‘ä»¬åªè´Ÿè´£å±•ç¤ºç›¸å…³ JavaBean çš„ä¿¡æ¯ï¼Œä¸éœ€è¦ç¼–å†™è®¿é—®æ•°æ®åº“ç­‰å¤æ‚é€»è¾‘ï¼š

```html
<%@ page import="com.itranswarp.learnjava.bean.*"%>
<%
    User user = (User) request.getAttribute("user");
%>
<html>
<head>
    <title>Hello World - JSP</title>
</head>
<body>
    <h1>Hello <%= user.name %>!</h1>
    <p>School Name:
    <span style="color:red">
        <%= user.school.name %>
    </span>
    </p>
    <p>School Address:
    <span style="color:red">
        <%= user.school.address %>
    </span>
    </p>
</body>
</html>
```

è¯·æ³¨æ„å‡ ç‚¹ï¼š

- éœ€è¦å±•ç¤ºçš„ `User` è¢«æ”¾å…¥ `HttpServletRequest` ä¸­ä»¥ä¾¿ä¼ é€’ç»™ JSPï¼Œå› ä¸ºä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ª `HttpServletRequest`ï¼Œæˆ‘ä»¬ä¹Ÿæ— éœ€æ¸…ç†å®ƒï¼Œå¤„ç†å®Œè¯¥è¯·æ±‚å `HttpServletRequest` å®ä¾‹å°†è¢«ä¸¢å¼ƒï¼›
- æŠŠ `user.jsp` æ”¾åˆ° `/WEB-INF/` ç›®å½•ä¸‹ï¼Œæ˜¯å› ä¸º `WEB-INF` æ˜¯ä¸€ä¸ªç‰¹æ®Šç›®å½•ï¼ŒWeb Server ä¼šé˜»æ­¢æµè§ˆå™¨å¯¹ `WEB-INF` ç›®å½•ä¸‹ä»»ä½•èµ„æºçš„è®¿é—®ï¼Œè¿™æ ·å°±é˜²æ­¢ç”¨æˆ·é€šè¿‡ `/user.jsp` è·¯å¾„ç›´æ¥è®¿é—®åˆ° JSP é¡µé¢ï¼›
- JSP é¡µé¢é¦–å…ˆä» `request` å˜é‡è·å– `User` å®ä¾‹ï¼Œç„¶ååœ¨é¡µé¢ä¸­ç›´æ¥è¾“å‡ºï¼Œæ­¤å¤„æœªè€ƒè™‘ HTML çš„è½¬ä¹‰é—®é¢˜ï¼Œæœ‰æ½œåœ¨å®‰å…¨é£é™©ã€‚

æˆ‘ä»¬åœ¨æµè§ˆå™¨è®¿é—® `http://localhost:8080/user`ï¼Œè¯·æ±‚é¦–å…ˆç”± `UserServlet` å¤„ç†ï¼Œç„¶åäº¤ç»™ `user.jsp` æ¸²æŸ“ï¼š

![mvc](./assets/l-20231221105422720.jpeg)

æˆ‘ä»¬æŠŠ `UserServlet` çœ‹ä½œä¸šåŠ¡é€»è¾‘å¤„ç†ï¼ŒæŠŠ `User` çœ‹ä½œæ¨¡å‹ï¼ŒæŠŠ `user.jsp` çœ‹ä½œæ¸²æŸ“ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼é€šå¸¸è¢«ç§°ä¸º MVCï¼šModel-View-Controllerï¼Œå³ `UserServlet` ä½œä¸ºæ§åˆ¶å™¨ï¼ˆControllerï¼‰ï¼Œ`User` ä½œä¸ºæ¨¡å‹ï¼ˆModelï¼‰ï¼Œ`user.jsp` ä½œä¸ºè§†å›¾ï¼ˆViewï¼‰ï¼Œæ•´ä¸ª MVC æ¶æ„å¦‚ä¸‹ï¼š

![image-20231221105530969](./assets/image-20231221105530969.png)

ä½¿ç”¨ MVC æ¨¡å¼çš„å¥½å¤„æ˜¯ï¼ŒController ä¸“æ³¨äºä¸šåŠ¡å¤„ç†ï¼Œå®ƒçš„å¤„ç†ç»“æœå°±æ˜¯ Modelã€‚Model å¯ä»¥æ˜¯ä¸€ä¸ª JavaBeanï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªå¯¹è±¡çš„ Mapï¼ŒController åªè´Ÿè´£æŠŠ Model ä¼ é€’ç»™ Viewï¼ŒView åªè´Ÿè´£æŠŠ Model ç»™ â€œæ¸²æŸ“â€ å‡ºæ¥ï¼Œè¿™æ ·ï¼Œä¸‰è€…èŒè´£æ˜ç¡®ï¼Œä¸”å¼€å‘æ›´ç®€å•ï¼Œå› ä¸ºå¼€å‘ Controller æ—¶æ— éœ€å…³æ³¨é¡µé¢ï¼Œå¼€å‘ View æ—¶æ— éœ€å…³å¿ƒå¦‚ä½•åˆ›å»º Modelã€‚

MVC æ¨¡å¼å¹¿æ³›åœ°åº”ç”¨åœ¨ Web é¡µé¢å’Œä¼ ç»Ÿçš„æ¡Œé¢ç¨‹åºä¸­ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé€šè¿‡ Servlet å’Œ JSP å®ç°äº†ä¸€ä¸ªç®€å•çš„ MVC æ¨¡å‹ï¼Œä½†å®ƒè¿˜ä¸å¤Ÿç®€æ´å’Œçµæ´»ï¼Œåç»­æˆ‘ä»¬ä¼šä»‹ç»æ›´ç®€å•çš„ Spring MVC å¼€å‘ã€‚

## ğŸ€ ç»ƒä¹ 


## ğŸ€ å°ç»“

MVC æ¨¡å¼æ˜¯ä¸€ç§åˆ†ç¦»ä¸šåŠ¡é€»è¾‘å’Œæ˜¾ç¤ºé€»è¾‘çš„è®¾è®¡æ¨¡å¼ï¼Œå¹¿æ³›åº”ç”¨åœ¨ Web å’Œæ¡Œé¢åº”ç”¨ç¨‹åºã€‚


