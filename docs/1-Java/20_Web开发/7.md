---
title: MVC å¼€å‘
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

é€šè¿‡ç»“åˆ Servlet å’Œ JSP çš„ MVC æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥å‘æŒ¥äºŒè€…å„è‡ªçš„ä¼˜ç‚¹ï¼š

- Servlet å®ç°ä¸šåŠ¡é€»è¾‘ï¼›
- JSP å®ç°å±•ç¤ºé€»è¾‘ã€‚

ä½†æ˜¯ï¼Œç›´æ¥æŠŠ MVC æ­åœ¨ Servlet å’Œ JSP ä¹‹ä¸Šè¿˜æ˜¯ä¸å¤ªå¥½ï¼ŒåŸå› å¦‚ä¸‹ï¼š

- Servlet æä¾›çš„æ¥å£ä»ç„¶ååº•å±‚ï¼Œéœ€è¦å®ç° Servlet è°ƒç”¨ç›¸å…³æ¥å£ï¼›
- JSP å¯¹é¡µé¢å¼€å‘ä¸å‹å¥½ï¼Œæ›´å¥½çš„æ›¿ä»£å“æ˜¯æ¨¡æ¿å¼•æ“ï¼›
- ä¸šåŠ¡é€»è¾‘æœ€å¥½ç”±çº¯ç²¹çš„ Java ç±»å®ç°ï¼Œè€Œä¸æ˜¯å¼ºè¿«ç»§æ‰¿è‡ª Servletã€‚

èƒ½ä¸èƒ½é€šè¿‡æ™®é€šçš„ Java ç±»å®ç° MVC çš„ Controllerï¼Ÿç±»ä¼¼ä¸‹é¢çš„ä»£ç ï¼š

```java
public class UserController {
    @GetMapping("/signin")
    public ModelAndView signin() {
        ...
    }

    @PostMapping("/signin")
    public ModelAndView doSignin(SignInBean bean) {
        ...
    }

    @GetMapping("/signout")
    public ModelAndView signout(HttpSession session) {
        ...
    }
}
```

ä¸Šé¢çš„è¿™ä¸ª Java ç±»æ¯ä¸ªæ–¹æ³•éƒ½å¯¹åº”ä¸€ä¸ª GET æˆ– POST è¯·æ±‚ï¼Œæ–¹æ³•è¿”å›å€¼æ˜¯ `ModelAndView`ï¼Œå®ƒåŒ…å«ä¸€ä¸ª View çš„è·¯å¾„ä»¥åŠä¸€ä¸ª Modelï¼Œè¿™æ ·ï¼Œå†ç”± MVC æ¡†æ¶å¤„ç†åè¿”å›ç»™æµè§ˆå™¨ã€‚

å¦‚æœæ˜¯ GET è¯·æ±‚ï¼Œæˆ‘ä»¬å¸Œæœ› MVC æ¡†æ¶èƒ½ç›´æ¥æŠŠ URL å‚æ•°æŒ‰æ–¹æ³•å‚æ•°å¯¹åº”èµ·æ¥ç„¶åä¼ å…¥ï¼š

```java
@GetMapping("/hello")
public ModelAndView hello(String name) {
    ...
}
```

å¦‚æœæ˜¯ POST è¯·æ±‚ï¼Œæˆ‘ä»¬å¸Œæœ› MVC æ¡†æ¶èƒ½ç›´æ¥æŠŠ Post å‚æ•°å˜æˆä¸€ä¸ª JavaBean åé€šè¿‡æ–¹æ³•å‚æ•°ä¼ å…¥ï¼š

```java
@PostMapping("/signin")
public ModelAndView doSignin(SignInBean bean) {
    ...
}
```

ä¸ºäº†å¢åŠ çµæ´»æ€§ï¼Œå¦‚æœ Controller çš„æ–¹æ³•åœ¨å¤„ç†è¯·æ±‚æ—¶éœ€è¦è®¿é—® `HttpServletRequest`ã€`HttpServletResponse`ã€`HttpSession` è¿™äº›å®ä¾‹æ—¶ï¼Œåªè¦æ–¹æ³•å‚æ•°æœ‰å®šä¹‰ï¼Œå°±å¯ä»¥è‡ªåŠ¨ä¼ å…¥ï¼š

```java
@GetMapping("/signout")
public ModelAndView signout(HttpSession session) {
    ...
}
```

ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬åœ¨è®¾è®¡ MVC æ¡†æ¶æ—¶ï¼Œä¸Šå±‚ä»£ç æ‰€éœ€è¦çš„ä¸€åˆ‡ä¿¡æ¯ã€‚

## ğŸ€ è®¾è®¡ MVC æ¡†æ¶

å¦‚ä½•è®¾è®¡ä¸€ä¸ª MVC æ¡†æ¶ï¼Ÿåœ¨ä¸Šæ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®šä¹‰äº†ä¸Šå±‚ä»£ç ç¼–å†™ Controller çš„ä¸€åˆ‡æ¥å£ä¿¡æ¯ï¼Œå¹¶ä¸”å¹¶ä¸è¦æ±‚å®ç°ç‰¹å®šæ¥å£ï¼Œåªéœ€è¿”å› `ModelAndView` å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª `View` å’Œä¸€ä¸ª `Model`ã€‚å®é™…ä¸Š `View` å°±æ˜¯æ¨¡æ¿çš„è·¯å¾„ï¼Œè€Œ `Model` å¯ä»¥ç”¨ä¸€ä¸ª `Map<String, Object>` è¡¨ç¤ºï¼Œå› æ­¤ï¼Œ`ModelAndView` å®šä¹‰éå¸¸ç®€å•ï¼š

```java
public class ModelAndView {
    Map<String, Object> model;
    String view;
}
```

æ¯”è¾ƒå¤æ‚çš„æ˜¯æˆ‘ä»¬éœ€è¦åœ¨ MVC æ¡†æ¶ä¸­åˆ›å»ºä¸€ä¸ªæ¥æ”¶æ‰€æœ‰è¯·æ±‚çš„ `Servlet`ï¼Œé€šå¸¸æˆ‘ä»¬æŠŠå®ƒå‘½åä¸º `DispatcherServlet`ï¼Œå®ƒæ€»æ˜¯æ˜ å°„åˆ° `/`ï¼Œç„¶åï¼Œæ ¹æ®ä¸åŒçš„ Controller çš„æ–¹æ³•å®šä¹‰çš„ `@Get` æˆ– `@Post` çš„ Path å†³å®šè°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼Œæœ€åï¼Œè·å¾—æ–¹æ³•è¿”å›çš„ `ModelAndView` åï¼Œæ¸²æŸ“æ¨¡æ¿ï¼Œå†™å…¥ `HttpServletResponse`ï¼Œå³å®Œæˆäº†æ•´ä¸ª MVC çš„å¤„ç†ã€‚

è¿™ä¸ª MVC çš„æ¶æ„å¦‚ä¸‹ï¼š

![image-20231221105759223](./assets/image-20231221105759223.png)

å…¶ä¸­ï¼Œ`DispatcherServlet` ä»¥åŠå¦‚ä½•æ¸²æŸ“å‡ç”± MVC æ¡†æ¶å®ç°ï¼Œåœ¨ MVC æ¡†æ¶ä¹‹ä¸Šåªéœ€è¦ç¼–å†™æ¯ä¸€ä¸ª Controllerã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç¼–å†™æœ€å¤æ‚çš„ `DispatcherServlet`ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å­˜å‚¨è¯·æ±‚è·¯å¾„åˆ°æŸä¸ªå…·ä½“æ–¹æ³•çš„æ˜ å°„ï¼š

```java
@WebServlet(urlPatterns = "/")
public class DispatcherServlet extends HttpServlet {
    private Map<String, GetDispatcher> getMappings = new HashMap<>();
    private Map<String, PostDispatcher> postMappings = new HashMap<>();
}
```

å¤„ç†ä¸€ä¸ª GET è¯·æ±‚æ˜¯é€šè¿‡ `GetDispatcher` å¯¹è±¡å®Œæˆçš„ï¼Œå®ƒéœ€è¦å¦‚ä¸‹ä¿¡æ¯ï¼š

```java
class GetDispatcher {
    Object instance; // Controller å®ä¾‹
    Method method; // Controller æ–¹æ³•
    String[] parameterNames; // æ–¹æ³•å‚æ•°åç§°
    Class<?>[] parameterClasses; // æ–¹æ³•å‚æ•°ç±»å‹
}
```

æœ‰äº†ä»¥ä¸Šä¿¡æ¯ï¼Œå°±å¯ä»¥å®šä¹‰ `invoke()` æ¥å¤„ç†çœŸæ­£çš„è¯·æ±‚ï¼š

```java
class GetDispatcher {
    ...
    public ModelAndView invoke(HttpServletRequest request, HttpServletResponse response) {
        Object[] arguments = new Object[parameterClasses.length];
        for (int i = 0; i < parameterClasses.length; i++) {
            String parameterName = parameterNames[i];
            Class<?> parameterClass = parameterClasses[i];
            if (parameterClass == HttpServletRequest.class) {
                arguments[i] = request;
            } else if (parameterClass == HttpServletResponse.class) {
                arguments[i] = response;
            } else if (parameterClass == HttpSession.class) {
                arguments[i] = request.getSession();
            } else if (parameterClass == int.class) {
                arguments[i] = Integer.valueOf(getOrDefault(request, parameterName, "0"));
            } else if (parameterClass == long.class) {
                arguments[i] = Long.valueOf(getOrDefault(request, parameterName, "0"));
            } else if (parameterClass == boolean.class) {
                arguments[i] = Boolean.valueOf(getOrDefault(request, parameterName, "false"));
            } else if (parameterClass == String.class) {
                arguments[i] = getOrDefault(request, parameterName, "");
            } else {
                throw new RuntimeException("Missing handler for type:" + parameterClass);
            }
        }
        return (ModelAndView) this.method.invoke(this.instance, arguments);
    }

    private String getOrDefault(HttpServletRequest request, String name, String defaultValue) {
        String s = request.getParameter(name);
        return s == null ? defaultValue : s;
    }
}
```

ä¸Šè¿°ä»£ç æ¯”è¾ƒç¹çï¼Œä½†é€»è¾‘éå¸¸ç®€å•ï¼Œå³é€šè¿‡æ„é€ æŸä¸ªæ–¹æ³•éœ€è¦çš„æ‰€æœ‰å‚æ•°åˆ—è¡¨ï¼Œä½¿ç”¨åå°„è°ƒç”¨è¯¥æ–¹æ³•åè¿”å›ç»“æœã€‚

ç±»ä¼¼çš„ï¼Œ`PostDispatcher` éœ€è¦å¦‚ä¸‹ä¿¡æ¯ï¼š

```java
class PostDispatcher {
    Object instance; // Controller å®ä¾‹
    Method method; // Controller æ–¹æ³•
    Class<?>[] parameterClasses; // æ–¹æ³•å‚æ•°ç±»å‹
    ObjectMapper objectMapper; // JSON æ˜ å°„
}
```

å’Œ GET è¯·æ±‚ä¸åŒï¼ŒPOST è¯·æ±‚ä¸¥æ ¼åœ°æ¥è¯´ä¸èƒ½æœ‰ URL å‚æ•°ï¼Œæ‰€æœ‰æ•°æ®éƒ½åº”å½“ä» Post Body ä¸­è¯»å–ã€‚è¿™é‡Œæˆ‘ä»¬ä¸ºäº†ç®€åŒ–å¤„ç†ï¼Œ* åªæ”¯æŒ * JSON æ ¼å¼çš„ POST è¯·æ±‚ï¼Œè¿™æ ·ï¼ŒæŠŠ Post æ•°æ®è½¬åŒ–ä¸º JavaBean å°±éå¸¸å®¹æ˜“ã€‚

```java
class PostDispatcher {
    ...
    public ModelAndView invoke(HttpServletRequest request, HttpServletResponse response) {
        Object[] arguments = new Object[parameterClasses.length];
        for (int i = 0; i < parameterClasses.length; i++) {
            Class<?> parameterClass = parameterClasses[i];
            if (parameterClass == HttpServletRequest.class) {
                arguments[i] = request;
            } else if (parameterClass == HttpServletResponse.class) {
                arguments[i] = response;
            } else if (parameterClass == HttpSession.class) {
                arguments[i] = request.getSession();
            } else {
                // è¯»å– JSON å¹¶è§£æä¸º JavaBean:
                BufferedReader reader = request.getReader();
                arguments[i] = this.objectMapper.readValue(reader, parameterClass);
            }
        }
        return (ModelAndView) this.method.invoke(instance, arguments);
    }
}
```

æœ€åï¼Œæˆ‘ä»¬æ¥å®ç°æ•´ä¸ª `DispatcherServlet` çš„å¤„ç†æµç¨‹ï¼Œä»¥ `doGet()` ä¸ºä¾‹ï¼š

```java
public class DispatcherServlet extends HttpServlet {
    ...
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        resp.setContentType("text/html");
        resp.setCharacterEncoding("UTF-8");
        String path = req.getRequestURI().substring(req.getContextPath().length());
        // æ ¹æ®è·¯å¾„æŸ¥æ‰¾ GetDispatcher:
        GetDispatcher dispatcher = this.getMappings.get(path);
        if (dispatcher == null) {
            // æœªæ‰¾åˆ°è¿”å› 404:
            resp.sendError(404);
            return;
        }
        // è°ƒç”¨ Controller æ–¹æ³•è·å¾—è¿”å›å€¼:
        ModelAndView mv = dispatcher.invoke(req, resp);
        // å…è®¸è¿”å› null:
        if (mv == null) {
            return;
        }
        // å…è®¸è¿”å› `redirect:` å¼€å¤´çš„ view è¡¨ç¤ºé‡å®šå‘:
        if (mv.view.startsWith("redirect:")) {
            resp.sendRedirect(mv.view.substring(9));
            return;
        }
        // å°†æ¨¡æ¿å¼•æ“æ¸²æŸ“çš„å†…å®¹å†™å…¥å“åº”:
        PrintWriter pw = resp.getWriter();
        this.viewEngine.render(mv, pw);
        pw.flush();
    }
}
```

è¿™é‡Œæœ‰å‡ ä¸ªå°æ”¹è¿›ï¼š

- å…è®¸ Controller æ–¹æ³•è¿”å› `null`ï¼Œè¡¨ç¤ºå†…éƒ¨å·²è‡ªè¡Œå¤„ç†å®Œæ¯•ï¼›
- å…è®¸ Controller æ–¹æ³•è¿”å›ä»¥ `redirect:` å¼€å¤´çš„ view åç§°ï¼Œè¡¨ç¤ºä¸€ä¸ªé‡å®šå‘ã€‚

è¿™æ ·ä½¿å¾—ä¸Šå±‚ä»£ç ç¼–å†™æ›´çµæ´»ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ˜¾ç¤ºç”¨æˆ·èµ„æ–™çš„è¯·æ±‚å¯ä»¥è¿™æ ·å†™ï¼š

```java
@GetMapping("/user/profile")
public ModelAndView profile(HttpServletResponse response, HttpSession session) {
    User user = (User) session.getAttribute("user");
    if (user == null) {
        // æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ:
        return new ModelAndView("redirect:/signin");
    }
    if (!user.isManager()) {
        // æƒé™ä¸å¤Ÿï¼Œè¿”å› 403:
        response.sendError(403);
        return null;
    }
    return new ModelAndView("/profile.html", Map.of("user", user));
}
```

æœ€åä¸€æ­¥æ˜¯åœ¨ `DispatcherServlet` çš„ `init()` æ–¹æ³•ä¸­åˆå§‹åŒ–æ‰€æœ‰ Get å’Œ Post çš„æ˜ å°„ï¼Œä»¥åŠç”¨äºæ¸²æŸ“çš„æ¨¡æ¿å¼•æ“ï¼š

```java
public class DispatcherServlet extends HttpServlet {
    private Map<String, GetDispatcher> getMappings = new HashMap<>();
    private Map<String, PostDispatcher> postMappings = new HashMap<>();
    private ViewEngine viewEngine;

    @Override
    public void init() throws ServletException {
        this.getMappings = scanGetInControllers();
        this.postMappings = scanPostInControllers();
        this.viewEngine = new ViewEngine(getServletContext());
    }
    ...
}
```

å¦‚ä½•æ‰«ææ‰€æœ‰ Controller ä»¥è·å–æ‰€æœ‰æ ‡è®°æœ‰ `@GetMapping` å’Œ `@PostMapping` çš„æ–¹æ³•ï¼Ÿå½“ç„¶æ˜¯ä½¿ç”¨åå°„äº†ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒç¹çï¼Œä½†æˆ‘ä»¬ç›¸ä¿¡å„ä½ç«¥é‹å¯ä»¥è½»æ¾å®ç°ã€‚

è¿™æ ·ï¼Œæ•´ä¸ª MVC æ¡†æ¶å°±æ­å»ºå®Œæ¯•ã€‚

## ğŸ€ å®ç°æ¸²æŸ“

æœ‰çš„ç«¥é‹å¯¹å¦‚ä½•ä½¿ç”¨æ¨¡æ¿å¼•æ“è¿›è¡Œæ¸²æŸ“æœ‰ç–‘é—®ï¼Œå³å¦‚ä½•å®ç°ä¸Šè¿°çš„ `ViewEngine`ï¼Ÿå…¶å® `ViewEngine` éå¸¸ç®€å•ï¼Œåªéœ€è¦å®ç°ä¸€ä¸ªç®€å•çš„ `render()` æ–¹æ³•ï¼š

```
public class ViewEngine {
    public void render(ModelAndView mv, Writer writer) throws IOException {
        String view = mv.view;
        Map<String, Object> model = mv.model;
        // æ ¹æ® view æ‰¾åˆ°æ¨¡æ¿æ–‡ä»¶:
        Template template = getTemplateByPath(view);
        // æ¸²æŸ“å¹¶å†™å…¥ Writer:
        template.write(writer, model);
    }
}
```

Java æœ‰å¾ˆå¤šå¼€æºçš„æ¨¡æ¿å¼•æ“ï¼Œå¸¸ç”¨çš„æœ‰ï¼š

- [Thymeleaf](https://www.thymeleaf.org/)
- [FreeMarker](https://freemarker.apache.org/)
- [Velocity](https://velocity.apache.org/)

ä»–ä»¬çš„ç”¨æ³•éƒ½å¤§åŒå°å¼‚ã€‚è¿™é‡Œæˆ‘ä»¬æ¨èä¸€ä¸ªä½¿ç”¨ [Jinja](https://palletsprojects.com/p/jinja/) è¯­æ³•çš„æ¨¡æ¿å¼•æ“[Pebble](https://pebbletemplates.io/)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯è¯­æ³•ç®€å•ï¼Œæ”¯æŒæ¨¡æ¿ç»§æ‰¿ï¼Œç¼–å†™å‡ºæ¥çš„æ¨¡æ¿ç±»ä¼¼ï¼š

```html
<html>
<body>
  <ul>
  {% for user in users %}
    <li><a href="{{ user.url }}">{{ user.username }}</a></li>
  {% endfor %}
  </ul>
</body>
</html>
```

å³å˜é‡ç”¨ `{{xxx}}` è¡¨ç¤ºï¼Œæ§åˆ¶è¯­å¥ç”¨ `{% xxx %}` è¡¨ç¤ºã€‚

ä½¿ç”¨ Pebble æ¸²æŸ“åªéœ€è¦å¦‚ä¸‹å‡ è¡Œä»£ç ï¼š

```java
public class ViewEngine {
    private final PebbleEngine engine;

    public ViewEngine(ServletContext servletContext) {
        // å®šä¹‰ä¸€ä¸ª ServletLoader ç”¨äºåŠ è½½æ¨¡æ¿:
        ServletLoader loader = new ServletLoader(servletContext);
        // æ¨¡æ¿ç¼–ç :
        loader.setCharset("UTF-8");
        // æ¨¡æ¿å‰ç¼€ï¼Œè¿™é‡Œé»˜è®¤æ¨¡æ¿å¿…é¡»æ”¾åœ¨ `/WEB-INF/templates` ç›®å½•:
        loader.setPrefix("/WEB-INF/templates");
        // æ¨¡æ¿åç¼€:
        loader.setSuffix("");
        // åˆ›å»º Pebble å®ä¾‹:
        this.engine = new PebbleEngine.Builder()
            .autoEscaping(true) // é»˜è®¤æ‰“å¼€ HTML å­—ç¬¦è½¬ä¹‰ï¼Œé˜²æ­¢ XSS æ”»å‡»
            .cacheActive(false) // ç¦ç”¨ç¼“å­˜ä½¿å¾—æ¯æ¬¡ä¿®æ”¹æ¨¡æ¿å¯ä»¥ç«‹åˆ»çœ‹åˆ°æ•ˆæœ
            .loader(loader).build();
    }

    public void render(ModelAndView mv, Writer writer) throws IOException {
        // æŸ¥æ‰¾æ¨¡æ¿:
        PebbleTemplate template = this.engine.getTemplate(mv.view);
        // æ¸²æŸ“:
        template.evaluate(writer, mv.model);
    }
}
```

æœ€åæˆ‘ä»¬æ¥çœ‹çœ‹æ•´ä¸ªå·¥ç¨‹çš„ç»“æ„ï¼š

![image-20231221105848787](./assets/image-20231221105848787.png)

å…¶ä¸­ï¼Œ`framework` åŒ…æ˜¯ MVC çš„æ¡†æ¶ï¼Œå®Œå…¨å¯ä»¥å•ç‹¬ç¼–è¯‘åä½œä¸ºä¸€ä¸ª Maven ä¾èµ–å¼•å…¥ï¼Œ`controller` åŒ…æ‰æ˜¯æˆ‘ä»¬éœ€è¦ç¼–å†™çš„ä¸šåŠ¡é€»è¾‘ã€‚

æˆ‘ä»¬è¿˜ç¡¬æ€§è§„å®šæ¨¡æ¿å¿…é¡»æ”¾åœ¨ `webapp/WEB-INF/templates` ç›®å½•ä¸‹ï¼Œé™æ€æ–‡ä»¶å¿…é¡»æ”¾åœ¨ `webapp/static` ç›®å½•ä¸‹ï¼Œå› æ­¤ï¼Œä¸ºäº†ä¾¿äºå¼€å‘ï¼Œæˆ‘ä»¬è¿˜é¡ºå¸¦å®ç°ä¸€ä¸ª `FileServlet` æ¥å¤„ç†é™æ€æ–‡ä»¶ï¼š

```java
@WebServlet(urlPatterns = { "/favicon.ico", "/static/*"})
public class FileServlet extends HttpServlet {
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        // è¯»å–å½“å‰è¯·æ±‚è·¯å¾„:
        ServletContext ctx = req.getServletContext();
        // RequestURI åŒ…å« ContextPath, éœ€è¦å»æ‰:
        String urlPath = req.getRequestURI().substring(ctx.getContextPath().length());
        // è·å–çœŸå®æ–‡ä»¶è·¯å¾„:
        String filepath = ctx.getRealPath(urlPath);
        if (filepath == null) {
            // æ— æ³•è·å–åˆ°è·¯å¾„:
            resp.sendError(HttpServletResponse.SC_NOT_FOUND);
            return;
        }
        Path path = Paths.get(filepath);
        if (!path.toFile().isFile()) {
            // æ–‡ä»¶ä¸å­˜åœ¨:
            resp.sendError(HttpServletResponse.SC_NOT_FOUND);
            return;
        }
        // æ ¹æ®æ–‡ä»¶åçŒœæµ‹ Content-Type:
        String mime = Files.probeContentType(path);
        if (mime == null) {
            mime = "application/octet-stream";
        }
        resp.setContentType(mime);
        // è¯»å–æ–‡ä»¶å¹¶å†™å…¥ Response:
        OutputStream output = resp.getOutputStream();
        try (InputStream input = new BufferedInputStream(new FileInputStream(filepath))) {
            input.transferTo(output);
        }
        output.flush();
    }
}
```

è¿è¡Œä»£ç ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥ URL`http://localhost:8080/hello?name=Bob` å¯ä»¥çœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼š

![mvc](./assets/l-20231221105625058.png)

ä¸ºäº†æŠŠæ–¹æ³•å‚æ•°çš„åç§°ç¼–è¯‘åˆ° class æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿å¤„ç† `@GetMapping` æ—¶ä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰“å¼€ç¼–è¯‘å™¨çš„ä¸€ä¸ªå‚æ•°ï¼Œåœ¨ Eclipse ä¸­å‹¾é€‰ `Preferences`-`Java`-`Compiler`-`Store information about method parameters (usable via reflection)`ï¼›åœ¨ Idea ä¸­é€‰æ‹© `Preferences`-`Build, Execution, Deployment`-`Compiler`-`Java Compiler`-`Additional command line parameters`ï¼Œå¡«å…¥ `-parameters`ï¼›åœ¨ Maven çš„ `pom.xml` æ·»åŠ ä¸€æ®µé…ç½®å¦‚ä¸‹ï¼š

```xml
<project ...>
    <modelVersion>4.0.0</modelVersion>
    ...
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <compilerArgs>
                        <arg>-parameters</arg>
                    </compilerArgs>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

æœ‰äº›ç”¨è¿‡ Spring MVC çš„ç«¥é‹ä¼šå‘ç°ï¼Œæœ¬èŠ‚å®ç°çš„è¿™ä¸ª MVC æ¡†æ¶ï¼Œä¸Šå±‚ä»£ç ä½¿ç”¨çš„å…¬å…±ç±»å¦‚ `GetMapping`ã€`PostMapping` å’Œ `ModelAndView` éƒ½å’Œ Spring MVC éå¸¸ç±»ä¼¼ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬è¿™ä¸ª MVC æ¡†æ¶ä¸»è¦å‚è€ƒå°±æ˜¯ Spring MVCï¼Œé€šè¿‡å®ç°ä¸€ä¸ª â€œç®€åŒ–ç‰ˆâ€MVCï¼Œå¯ä»¥æŒæ¡ Java Web MVC å¼€å‘çš„æ ¸å¿ƒæ€æƒ³ä¸åŸç†ï¼Œå¯¹å°†æ¥ç›´æ¥ä½¿ç”¨ Spring MVC æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚

## ğŸ€ ç»ƒä¹ 

å®ç°ä¸€ä¸ª MVC æ¡†æ¶

## ğŸ€ å°ç»“

ä¸€ä¸ª MVC æ¡†æ¶æ˜¯åŸºäº Servlet åŸºç¡€æŠ½è±¡å‡ºæ›´é«˜çº§çš„æ¥å£ï¼Œä½¿å¾—ä¸Šå±‚åŸºäº MVC æ¡†æ¶çš„å¼€å‘å¯ä»¥ä¸æ¶‰åŠ Servlet ç›¸å…³çš„ `HttpServletRequest` ç­‰æ¥å£ï¼Œå¤„ç†å¤šä¸ªè¯·æ±‚æ›´åŠ çµæ´»ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ä»»æ„æ¨¡æ¿å¼•æ“ï¼Œä¸å¿…ä½¿ç”¨ JSPã€‚


