---
title: æŠ½è±¡å·¥å‚
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---


> æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚

æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„åˆ›å»ºå‹æ¨¡å¼ã€‚

æŠ½è±¡å·¥å‚æ¨¡å¼å’Œå·¥å‚æ–¹æ³•ä¸å¤ªä¸€æ ·ï¼Œå®ƒè¦è§£å†³çš„é—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œä¸ä½†å·¥å‚æ˜¯æŠ½è±¡çš„ï¼Œäº§å“æ˜¯æŠ½è±¡çš„ï¼Œè€Œä¸”æœ‰å¤šä¸ªäº§å“éœ€è¦åˆ›å»ºï¼Œå› æ­¤ï¼Œè¿™ä¸ªæŠ½è±¡å·¥å‚ä¼šå¯¹åº”åˆ°å¤šä¸ªå®é™…å·¥å‚ï¼Œæ¯ä¸ªå®é™…å·¥å‚è´Ÿè´£åˆ›å»ºå¤šä¸ªå®é™…äº§å“ï¼š

![image-20231220094108349](./assets/image-20231220094108349.png)

è¿™ç§æ¨¡å¼æœ‰ç‚¹ç±»ä¼¼äºå¤šä¸ªä¾›åº”å•†è´Ÿè´£æä¾›ä¸€ç³»åˆ—ç±»å‹çš„äº§å“ã€‚æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š

å‡è®¾æˆ‘ä»¬å¸Œæœ›ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ª [Markdown](https://baike.baidu.com/item/MarkDown) æ–‡æœ¬è½¬æ¢ä¸º HTML å’Œ Word çš„æœåŠ¡ï¼Œå®ƒçš„æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š

```java
public interface AbstractFactory {
    // åˆ›å»º Html æ–‡æ¡£:
    HtmlDocument createHtml(String md);
    // åˆ›å»º Word æ–‡æ¡£:
    WordDocument createWord(String md);
}
```

æ³¨æ„åˆ°ä¸Šé¢çš„æŠ½è±¡å·¥å‚ä»…ä»…æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ²¡æœ‰ä»»ä½•ä»£ç ã€‚åŒæ ·çš„ï¼Œå› ä¸º `HtmlDocument` å’Œ `WordDocument` éƒ½æ¯”è¾ƒå¤æ‚ï¼Œç°åœ¨æˆ‘ä»¬å¹¶ä¸çŸ¥é“å¦‚ä½•å®ç°å®ƒä»¬ï¼Œæ‰€ä»¥åªæœ‰æ¥å£ï¼š

```java
// Html æ–‡æ¡£æ¥å£:
public interface HtmlDocument {
    String toHtml();
    void save(Path path) throws IOException;
}

// Word æ–‡æ¡£æ¥å£:
public interface WordDocument {
    void save(Path path) throws IOException;
}
```

è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®šä¹‰å¥½äº†æŠ½è±¡å·¥å‚ï¼ˆ`AbstractFactory`ï¼‰ä»¥åŠä¸¤ä¸ªæŠ½è±¡äº§å“ï¼ˆ`HtmlDocument` å’Œ `WordDocument`ï¼‰ã€‚å› ä¸ºå®ç°å®ƒä»¬æ¯”è¾ƒå›°éš¾ï¼Œæˆ‘ä»¬å†³å®šè®©ä¾›åº”å•†æ¥å®Œæˆã€‚

ç°åœ¨å¸‚åœºä¸Šæœ‰ä¸¤å®¶ä¾›åº”å•†ï¼šFastDoc Soft çš„äº§å“ä¾¿å®œï¼Œå¹¶ä¸”è½¬æ¢é€Ÿåº¦å¿«ï¼Œè€Œ GoodDoc Soft çš„äº§å“è´µï¼Œä½†è½¬æ¢æ•ˆæœå¥½ã€‚æˆ‘ä»¬å†³å®šåŒæ—¶ä½¿ç”¨è¿™ä¸¤å®¶ä¾›åº”å•†çš„äº§å“ï¼Œä»¥ä¾¿ç»™å…è´¹ç”¨æˆ·å’Œä»˜è´¹ç”¨æˆ·æä¾›ä¸åŒçš„æœåŠ¡ã€‚

æˆ‘ä»¬å…ˆçœ‹çœ‹ FastDoc Soft çš„äº§å“æ˜¯å¦‚ä½•å®ç°çš„ã€‚é¦–å…ˆï¼ŒFastDoc Soft å¿…é¡»è¦æœ‰å®é™…çš„äº§å“ï¼Œå³ `FastHtmlDocument` å’Œ `FastWordDocument`ï¼š

```java
public class FastHtmlDocument implements HtmlDocument {
    public String toHtml() {
        ...
    }
    public void save(Path path) throws IOException {
        ...
    }
}

public class FastWordDocument implements WordDocument {
    public void save(Path path) throws IOException {
        ...
    }
}
```

ç„¶åï¼ŒFastDoc Soft å¿…é¡»æä¾›ä¸€ä¸ªå®é™…çš„å·¥å‚æ¥ç”Ÿäº§è¿™ä¸¤ç§äº§å“ï¼Œå³ `FastFactory`ï¼š

```java
public class FastFactory implements AbstractFactory {
    public HtmlDocument createHtml(String md) {
        return new FastHtmlDocument(md);
    }
    public WordDocument createWord(String md) {
        return new FastWordDocument(md);
    }
}
```

è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ FastDoc Soft çš„æœåŠ¡äº†ã€‚å®¢æˆ·ç«¯ç¼–å†™ä»£ç å¦‚ä¸‹ï¼š

```java
// åˆ›å»º AbstractFactoryï¼Œå®é™…ç±»å‹æ˜¯ FastFactory:
AbstractFactory factory = new FastFactory();
// ç”Ÿæˆ Html æ–‡æ¡£:
HtmlDocument html = factory.createHtml("#Hello\nHello, world!");
html.save(Paths.get(".", "fast.html"));
// ç”Ÿæˆ Word æ–‡æ¡£:
WordDocument word = factory.createWord("#Hello\nHello, world!");
word.save(Paths.get(".", "fast.doc"));
```

å¦‚æœæˆ‘ä»¬è¦åŒæ—¶ä½¿ç”¨ GoodDoc Soft çš„æœåŠ¡æ€ä¹ˆåŠï¼Ÿå› ä¸ºç”¨äº†æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ŒGoodDoc Soft åªéœ€è¦æ ¹æ®æˆ‘ä»¬å®šä¹‰çš„æŠ½è±¡å·¥å‚å’ŒæŠ½è±¡äº§å“æ¥å£ï¼Œå®ç°è‡ªå·±çš„å®é™…å·¥å‚å’Œå®é™…äº§å“å³å¯ï¼š

```java
// å®é™…å·¥å‚:
public class GoodFactory implements AbstractFactory {
    public HtmlDocument createHtml(String md) {
        return new GoodHtmlDocument(md);
    }
    public WordDocument createWord(String md) {
        return new GoodWordDocument(md);
    }
}

// å®é™…äº§å“:
public class GoodHtmlDocument implements HtmlDocument {
    ...
}

public class GoodWordDocument implements HtmlDocument {
    ...
}
```

å®¢æˆ·ç«¯è¦ä½¿ç”¨ GoodDoc Soft çš„æœåŠ¡ï¼Œåªéœ€è¦æŠŠåŸæ¥çš„ `new FastFactory()` åˆ‡æ¢ä¸º `new GoodFactory()` å³å¯ã€‚

æ³¨æ„åˆ°å®¢æˆ·ç«¯ä»£ç é™¤äº†é€šè¿‡ `new` åˆ›å»ºäº† `FastFactory` æˆ– `GoodFactory` å¤–ï¼Œå…¶ä½™ä»£ç åªå¼•ç”¨äº†äº§å“æ¥å£ï¼Œå¹¶æœªå¼•ç”¨ä»»ä½•å®é™…äº§å“ï¼ˆä¾‹å¦‚ï¼Œ`FastHtmlDocument`ï¼‰ï¼Œå¦‚æœæŠŠåˆ›å»ºå·¥å‚çš„ä»£ç æ”¾åˆ° `AbstractFactory` ä¸­ï¼Œå°±å¯ä»¥è¿å®é™…å·¥å‚ä¹Ÿå±è”½äº†ï¼š

```java
public interface AbstractFactory {
    public static AbstractFactory createFactory(String name) {
        if (name.equalsIgnoreCase("fast")) {
            return new FastFactory();
        } else if (name.equalsIgnoreCase("good")) {
            return new GoodFactory();
        } else {
            throw new IllegalArgumentException("Invalid factory name");
        }
    }
}
```

æˆ‘ä»¬æ¥çœ‹çœ‹ `FastFactory` å’Œ `GoodFactory` åˆ›å»ºçš„ `WordDocument` çš„å®é™…æ•ˆæœï¼š

![worddoc](./assets/l-20231220094014402.png)

æ³¨æ„ï¼šå‡ºäºç®€åŒ–ä»£ç çš„ç›®çš„ï¼Œæˆ‘ä»¬åªæ”¯æŒä¸¤ç§ Markdown è¯­æ³•ï¼šä»¥ `#` å¼€å¤´çš„æ ‡é¢˜ä»¥åŠæ™®é€šæ­£æ–‡ã€‚

## ğŸ€ ç»ƒä¹ 

ä½¿ç”¨ Abstract Factory æ¨¡å¼å®ç° `HtmlDocument` å’Œ `WordDocument`ã€‚



## ğŸ€ å°ç»“

æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯ä¸ºäº†è®©åˆ›å»ºå·¥å‚å’Œä¸€ç»„äº§å“ä¸ä½¿ç”¨ç›¸åˆ†ç¦»ï¼Œå¹¶å¯ä»¥éšæ—¶åˆ‡æ¢åˆ°å¦ä¸€ä¸ªå·¥å‚ä»¥åŠå¦ä¸€ç»„äº§å“ï¼›

æŠ½è±¡å·¥å‚æ¨¡å¼å®ç°çš„å…³é”®ç‚¹æ˜¯å®šä¹‰å·¥å‚æ¥å£å’Œäº§å“æ¥å£ï¼Œä½†å¦‚ä½•å®ç°å·¥å‚ä¸äº§å“æœ¬èº«éœ€è¦ç•™ç»™å…·ä½“çš„å­ç±»å®ç°ï¼Œå®¢æˆ·ç«¯åªå’ŒæŠ½è±¡å·¥å‚ä¸æŠ½è±¡äº§å“æ‰“äº¤é“ã€‚



