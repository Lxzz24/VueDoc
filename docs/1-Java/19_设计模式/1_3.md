---
title: ç”Ÿæˆå™¨
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---


> å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚

ç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilderï¼‰æ˜¯ä½¿ç”¨å¤šä¸ª â€œå°å‹â€ å·¥å‚æ¥æœ€ç»ˆåˆ›å»ºå‡ºä¸€ä¸ªå®Œæ•´å¯¹è±¡ã€‚

å½“æˆ‘ä»¬ä½¿ç”¨ Builder çš„æ—¶å€™ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯å› ä¸ºåˆ›å»ºè¿™ä¸ªå¯¹è±¡çš„æ­¥éª¤æ¯”è¾ƒå¤šï¼Œæ¯ä¸ªæ­¥éª¤éƒ½éœ€è¦ä¸€ä¸ªé›¶éƒ¨ä»¶ï¼Œæœ€ç»ˆç»„åˆæˆä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡ã€‚

æˆ‘ä»¬ä»ç„¶ä»¥ Markdown è½¬ HTML ä¸ºä¾‹ï¼Œå› ä¸ºç›´æ¥ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„è½¬æ¢å™¨æ¯”è¾ƒå›°éš¾ï¼Œä½†å¦‚æœé’ˆå¯¹ç±»ä¼¼ä¸‹é¢çš„ä¸€è¡Œæ–‡æœ¬ï¼š

```markdown
## ğŸ€ this is a headi
```

è½¬æ¢æˆ HTML å°±å¾ˆç®€å•ï¼š

```html
<h1>this is a heading</h1>
```

å› æ­¤ï¼Œæˆ‘ä»¬æŠŠ Markdown è½¬ HTML çœ‹ä½œä¸€è¡Œä¸€è¡Œçš„è½¬æ¢ï¼Œæ¯ä¸€è¡Œæ ¹æ®è¯­æ³•ï¼Œä½¿ç”¨ä¸åŒçš„è½¬æ¢å™¨ï¼š

- å¦‚æœä»¥ `#` å¼€å¤´ï¼Œä½¿ç”¨ `HeadingBuilder` è½¬æ¢ï¼›
- å¦‚æœä»¥ `>` å¼€å¤´ï¼Œä½¿ç”¨ `QuoteBuilder` è½¬æ¢ï¼›
- å¦‚æœä»¥ `---` å¼€å¤´ï¼Œä½¿ç”¨ `HrBuilder` è½¬æ¢ï¼›
- å…¶ä½™ä½¿ç”¨ `ParagraphBuilder` è½¬æ¢ã€‚

è¿™ä¸ª `HtmlBuilder` å†™å‡ºæ¥å¦‚ä¸‹ï¼š

```java
public class HtmlBuilder {
    private HeadingBuilder headingBuilder = new HeadingBuilder();
    private HrBuilder hrBuilder = new HrBuilder();
    private ParagraphBuilder paragraphBuilder = new ParagraphBuilder();
    private QuoteBuilder quoteBuilder = new QuoteBuilder();

    public String toHtml(String markdown) {
        StringBuilder buffer = new StringBuilder();
        markdown.lines().forEach(line -> {
            if (line.startsWith("#")) {
                buffer.append(headingBuilder.buildHeading(line)).append('\n');
            } else if (line.startsWith(">")) {
                buffer.append(quoteBuilder.buildQuote(line)).append('\n');
            } else if (line.startsWith("---")) {
                buffer.append(hrBuilder.buildHr(line)).append('\n');
            } else {
                buffer.append(paragraphBuilder.buildParagraph(line)).append('\n');
            }
        });
        return buffer.toString();
    }
}
```

æ³¨æ„è§‚å¯Ÿä¸Šè¿°ä»£ç ï¼Œ`HtmlBuilder` å¹¶ä¸æ˜¯ä¸€æ¬¡æ€§æŠŠæ•´ä¸ª Markdown è½¬æ¢ä¸º HTMLï¼Œè€Œæ˜¯ä¸€è¡Œä¸€è¡Œè½¬æ¢ï¼Œå¹¶ä¸”ï¼Œå®ƒè‡ªå·±å¹¶ä¸ä¼šå°†æŸä¸€è¡Œè½¬æ¢ä¸ºç‰¹å®šçš„ HTMLï¼Œè€Œæ˜¯æ ¹æ®ç‰¹æ€§æŠŠæ¯ä¸€è¡Œéƒ½ â€œå§”æ‰˜â€ ç»™ä¸€ä¸ª `XxxBuilder` å»è½¬æ¢ï¼Œæœ€åï¼ŒæŠŠæ‰€æœ‰è½¬æ¢çš„ç»“æœç»„åˆèµ·æ¥ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚

è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦é’ˆå¯¹æ¯ä¸€ç§ç±»å‹ç¼–å†™ä¸åŒçš„ Builderã€‚ä¾‹å¦‚ï¼Œé’ˆå¯¹ä»¥ `#` å¼€å¤´çš„è¡Œï¼Œéœ€è¦ `HeadingBuilder`ï¼š

```java
public class HeadingBuilder {
    public String buildHeading(String line) {
        int n = 0;
        while (line.charAt(0) == '#') {
            n++;
            line = line.substring(1);
        }
        return String.format("<h%d>%s</h%d>", n, line.strip(), n);
    }
}
```

> [!tip]
> æ³¨æ„ï¼šå®é™…è§£æ Markdown æ˜¯å¸¦æœ‰çŠ¶æ€çš„ï¼Œå³ä¸‹ä¸€è¡Œçš„è¯­ä¹‰å¯èƒ½ä¸ä¸Šä¸€è¡Œç›¸å…³ã€‚è¿™é‡Œæˆ‘ä»¬ç®€åŒ–äº†è¯­æ³•ï¼ŒæŠŠæ¯ä¸€è¡Œè§†ä¸ºå¯ä»¥ç‹¬ç«‹è½¬æ¢ã€‚

å¯è§ï¼Œä½¿ç”¨ Builder æ¨¡å¼æ—¶ï¼Œé€‚ç”¨äºåˆ›å»ºçš„å¯¹è±¡æ¯”è¾ƒå¤æ‚ï¼Œæœ€å¥½ä¸€æ­¥ä¸€æ­¥åˆ›å»ºå‡º â€œé›¶ä»¶â€ï¼Œæœ€åå†è£…é…èµ·æ¥ã€‚

JavaMail çš„ `MimeMessage` å°±å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ª Builder æ¨¡å¼ï¼Œåªä¸è¿‡ Builder å’Œæœ€ç»ˆäº§å“åˆäºŒä¸ºä¸€ï¼Œéƒ½æ˜¯ `MimeMessage`ï¼š

```java
Multipart multipart = new MimeMultipart();
// æ·»åŠ  text:
BodyPart textpart = new MimeBodyPart();
textpart.setContent(body, "text/html;charset=utf-8");
multipart.addBodyPart(textpart);
// æ·»åŠ  image:
BodyPart imagepart = new MimeBodyPart();
imagepart.setFileName(fileName);
imagepart.setDataHandler(new DataHandler(new ByteArrayDataSource(input, "application/octet-stream")));
multipart.addBodyPart(imagepart);

MimeMessage message = new MimeMessage(session);
// è®¾ç½®å‘é€æ–¹åœ°å€:
message.setFrom(new InternetAddress("me@example.com"));
// è®¾ç½®æ¥æ”¶æ–¹åœ°å€:
message.setRecipient(Message.RecipientType.TO, new InternetAddress("xiaoming@somewhere.com"));
// è®¾ç½®é‚®ä»¶ä¸»é¢˜:
message.setSubject("Hello", "UTF-8");
// è®¾ç½®é‚®ä»¶å†…å®¹ä¸º multipart:
message.setContent(multipart);
```

å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ– Builder æ¨¡å¼ï¼Œä»¥é“¾å¼è°ƒç”¨çš„æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸ç¼–å†™è¿™æ ·çš„ä»£ç ï¼š

```java
StringBuilder builder = new StringBuilder();
builder.append(secure ? "https://" : "http://")
       .append("www.liaoxuefeng.com")
       .append("/")
       .append("?t=0");
String url = builder.toString();
```

ç”±äºæˆ‘ä»¬ç»å¸¸éœ€è¦æ„é€  URL å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨ Builder æ¨¡å¼ç¼–å†™ä¸€ä¸ª URLBuilderï¼Œè°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼š

```java
String url = URLBuilder.builder() // åˆ›å»º Builder
        .setDomain("www.liaoxuefeng.com") // è®¾ç½® domain
        .setScheme("https") // è®¾ç½® scheme
        .setPath("/") // è®¾ç½®è·¯å¾„
        .setQuery(Map.of("a", "123", "q", "K&R")) // è®¾ç½® query
        .build(); // å®Œæˆ build
```

## ğŸ€ ç»ƒä¹ 

ä½¿ç”¨ Builder æ¨¡å¼å®ç°ä¸€ä¸ª URLBuilder


## ğŸ€ å°ç»“

Builder æ¨¡å¼æ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œéœ€è¦å¤šä¸ªæ­¥éª¤å®Œæˆåˆ›å»ºï¼Œæˆ–è€…éœ€è¦å¤šä¸ªé›¶ä»¶ç»„è£…çš„åœºæ™¯ï¼Œä¸”åˆ›å»ºè¿‡ç¨‹ä¸­å¯ä»¥çµæ´»è°ƒç”¨ä¸åŒçš„æ­¥éª¤æˆ–ç»„ä»¶ã€‚


