---
title: é€‚é…å™¨
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---


> å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚

é€‚é…å™¨æ¨¡å¼æ˜¯ Adapterï¼Œä¹Ÿç§° Wrapperï¼Œæ˜¯æŒ‡å¦‚æœä¸€ä¸ªæ¥å£éœ€è¦ B æ¥å£ï¼Œä½†æ˜¯å¾…ä¼ å…¥çš„å¯¹è±¡å´æ˜¯ A æ¥å£ï¼Œæ€ä¹ˆåŠï¼Ÿ

æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ã€‚å¦‚æœå»ç¾å›½ï¼Œæˆ‘ä»¬éšèº«å¸¦çš„ç”µå™¨æ˜¯æ— æ³•ç›´æ¥ä½¿ç”¨çš„ï¼Œå› ä¸ºç¾å›½çš„æ’åº§æ ‡å‡†å’Œä¸­å›½ä¸åŒï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€‚é…å™¨ï¼š

![adapter](./assets/l.jpeg)

åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œé€‚é…å™¨ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ª `Task` ç±»ï¼Œå®ç°äº† `Callable` æ¥å£ï¼š

```java
public class Task implements Callable<Long> {
    private long num;
    public Task(long num) {
        this.num = num;
    }

    public Long call() throws Exception {
        long r = 0;
        for (long n = 1; n <= this.num; n++) {
            r = r + n;
        }
        System.out.println("Result:" + r);
        return r;
    }
}
```

ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œå®ƒï¼š

```java
Callable<Long> callable = new Task(123450000L);
Thread thread = new Thread(callable); // compile error!
thread.start();
```

å‘ç°ç¼–è¯‘ä¸è¿‡ï¼å› ä¸º `Thread` æ¥æ”¶ `Runnable` æ¥å£ï¼Œä½†ä¸æ¥æ”¶ `Callable` æ¥å£ï¼Œè‚¿ä¹ˆåŠï¼Ÿ

ä¸€ä¸ªåŠæ³•æ˜¯æ”¹å†™ `Task` ç±»ï¼ŒæŠŠå®ç°çš„ `Callable` æ”¹ä¸º `Runnable`ï¼Œä½†è¿™æ ·åšä¸å¥½ï¼Œå› ä¸º `Task` å¾ˆå¯èƒ½åœ¨å…¶ä»–åœ°æ–¹ä½œä¸º `Callable` è¢«å¼•ç”¨ï¼Œæ”¹å†™ `Task` çš„æ¥å£ï¼Œä¼šå¯¼è‡´å…¶ä»–æ­£å¸¸å·¥ä½œçš„ä»£ç æ— æ³•ç¼–è¯‘ã€‚

å¦ä¸€ä¸ªåŠæ³•ä¸ç”¨æ”¹å†™ `Task` ç±»ï¼Œè€Œæ˜¯ç”¨ä¸€ä¸ª Adapterï¼ŒæŠŠè¿™ä¸ª `Callable` æ¥å£ â€œå˜æˆâ€ `Runnable` æ¥å£ï¼Œè¿™æ ·ï¼Œå°±å¯ä»¥æ­£å¸¸ç¼–è¯‘ï¼š

```java
Callable<Long> callable = new Task(123450000L);
Thread thread = new Thread(new RunnableAdapter(callable));
thread.start();
```

è¿™ä¸ª `RunnableAdapter` ç±»å°±æ˜¯ Adapterï¼Œå®ƒæ¥æ”¶ä¸€ä¸ª `Callable`ï¼Œè¾“å‡ºä¸€ä¸ª `Runnable`ã€‚æ€ä¹ˆå®ç°è¿™ä¸ª `RunnableAdapter` å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹å®Œæ•´çš„ä»£ç ï¼š

```java
public class RunnableAdapter implements Runnable {
    // å¼•ç”¨å¾…è½¬æ¢æ¥å£:
    private Callable<?> callable;

    public RunnableAdapter(Callable<?> callable) {
        this.callable = callable;
    }

    // å®ç°æŒ‡å®šæ¥å£:
    public void run() {
        // å°†æŒ‡å®šæ¥å£è°ƒç”¨å§”æ‰˜ç»™è½¬æ¢æ¥å£è°ƒç”¨:
        try {
            callable.call();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}
```

ç¼–å†™ä¸€ä¸ª Adapter çš„æ­¥éª¤å¦‚ä¸‹ï¼š

1. å®ç°ç›®æ ‡æ¥å£ï¼Œè¿™é‡Œæ˜¯ `Runnable`ï¼›
2. å†…éƒ¨æŒæœ‰ä¸€ä¸ªå¾…è½¬æ¢æ¥å£çš„å¼•ç”¨ï¼Œè¿™é‡Œæ˜¯é€šè¿‡å­—æ®µæŒæœ‰ `Callable` æ¥å£ï¼›
3. åœ¨ç›®æ ‡æ¥å£çš„å®ç°æ–¹æ³•å†…éƒ¨ï¼Œè°ƒç”¨å¾…è½¬æ¢æ¥å£çš„æ–¹æ³•ã€‚

è¿™æ ·ä¸€æ¥ï¼ŒThread å°±å¯ä»¥æ¥æ”¶è¿™ä¸ª `RunnableAdapter`ï¼Œå› ä¸ºå®ƒå®ç°äº† `Runnable` æ¥å£ã€‚`Thread` ä½œä¸ºè°ƒç”¨æ–¹ï¼Œå®ƒä¼šè°ƒç”¨ `RunnableAdapter` çš„ `run()` æ–¹æ³•ï¼Œåœ¨è¿™ä¸ª `run()` æ–¹æ³•å†…éƒ¨ï¼Œåˆè°ƒç”¨äº† `Callable` çš„ `call()` æ–¹æ³•ï¼Œç›¸å½“äº `Thread` é€šè¿‡ä¸€å±‚è½¬æ¢ï¼Œé—´æ¥è°ƒç”¨äº† `Callable` çš„ `call()` æ–¹æ³•ã€‚

é€‚é…å™¨æ¨¡å¼åœ¨ Java æ ‡å‡†åº“ä¸­æœ‰å¹¿æ³›åº”ç”¨ã€‚æ¯”å¦‚æˆ‘ä»¬æŒæœ‰æ•°æ®ç±»å‹æ˜¯ `String[]`ï¼Œä½†æ˜¯éœ€è¦ `List` æ¥å£æ—¶ï¼Œå¯ä»¥ç”¨ä¸€ä¸ª Adapterï¼š

```java
String[] exist = new String[] {"Good", "morning", "Bob", "and", "Alice"};
Set<String> set = new HashSet<>(Arrays.asList(exist));
```

æ³¨æ„åˆ° `List<T> Arrays.asList(T[])` å°±ç›¸å½“äºä¸€ä¸ªè½¬æ¢å™¨ï¼Œå®ƒå¯ä»¥æŠŠæ•°ç»„è½¬æ¢ä¸º `List`ã€‚

æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ï¼šå‡è®¾æˆ‘ä»¬æŒæœ‰ä¸€ä¸ª `InputStream`ï¼Œå¸Œæœ›è°ƒç”¨ `readText(Reader)` æ–¹æ³•ï¼Œä½†å®ƒçš„å‚æ•°ç±»å‹æ˜¯ `Reader` è€Œä¸æ˜¯ `InputStream`ï¼Œæ€ä¹ˆåŠï¼Ÿ

å½“ç„¶æ˜¯ä½¿ç”¨é€‚é…å™¨ï¼ŒæŠŠ `InputStream` â€œå˜æˆâ€ `Reader`ï¼š

```java
InputStream input = Files.newInputStream(Paths.get("/path/to/file"));
Reader reader = new InputStreamReader(input, "UTF-8");
readText(reader);
```

`InputStreamReader` å°±æ˜¯ Java æ ‡å‡†åº“æä¾›çš„ `Adapter`ï¼Œå®ƒè´Ÿè´£æŠŠä¸€ä¸ª `InputStream` é€‚é…ä¸º `Reader`ã€‚ç±»ä¼¼çš„è¿˜æœ‰ `OutputStreamWriter`ã€‚

å¦‚æœæˆ‘ä»¬æŠŠ `readText(Reader)` æ–¹æ³•å‚æ•°ä» `Reader` æ”¹ä¸º `FileReader`ï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿè¿™ä¸ªæ—¶å€™ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ª `FileReader` ç±»å‹ï¼Œå°±å¿…é¡»æŠŠ `InputStream` é€‚é…ä¸º `FileReader`ï¼š

```java
FileReader reader = new InputStreamReader(input, "UTF-8"); // compile error!
```

ç›´æ¥ä½¿ç”¨ `InputStreamReader` è¿™ä¸ª Adapter æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºå®ƒåªèƒ½è½¬æ¢å‡º `Reader` æ¥å£ã€‚äº‹å®ä¸Šï¼Œè¦æŠŠ `InputStream` è½¬æ¢ä¸º `FileReader` ä¹Ÿä¸æ˜¯ä¸å¯èƒ½ï¼Œä½†éœ€è¦èŠ±è´¹åå€ä»¥ä¸Šçš„åŠŸå¤«ã€‚è¿™æ—¶ï¼Œé¢å‘æŠ½è±¡ç¼–ç¨‹è¿™ä¸€åŸåˆ™å°±ä½“ç°å‡ºäº†å¨åŠ›ï¼šæŒæœ‰é«˜å±‚æ¥å£ä¸ä½†ä»£ç æ›´çµæ´»ï¼Œè€Œä¸”æŠŠå„ç§æ¥å£ç»„åˆèµ·æ¥ä¹Ÿæ›´å®¹æ˜“ã€‚ä¸€æ—¦æŒæœ‰æŸä¸ªå…·ä½“çš„å­ç±»ç±»å‹ï¼Œè¦æƒ³åšä¸€äº›æ”¹åŠ¨å°±éå¸¸å›°éš¾ã€‚

## ğŸ€ ç»ƒä¹ 

ä½¿ç”¨ Adapter æ¨¡å¼å°† `Callable` æ¥å£é€‚é…ä¸º `Runnable`ã€‚


## ğŸ€ å°ç»“

Adapter æ¨¡å¼å¯ä»¥å°†ä¸€ä¸ª A æ¥å£è½¬æ¢ä¸º B æ¥å£ï¼Œä½¿å¾—æ–°çš„å¯¹è±¡ç¬¦åˆ B æ¥å£è§„èŒƒã€‚

ç¼–å†™ Adapter å®é™…ä¸Šå°±æ˜¯ç¼–å†™ä¸€ä¸ªå®ç°äº† B æ¥å£ï¼Œå¹¶ä¸”å†…éƒ¨æŒæœ‰ A æ¥å£çš„ç±»ï¼š

```java
public BAdapter implements B {
    private A a;
    public BAdapter(A a) {
        this.a = a;
    }
    public void b() {
        a.a();
    }
}
```

åœ¨ Adapter å†…éƒ¨å°† B æ¥å£çš„è°ƒç”¨ â€œè½¬æ¢â€ ä¸ºå¯¹ A æ¥å£çš„è°ƒç”¨ã€‚

åªæœ‰ Aã€B æ¥å£å‡ä¸ºæŠ½è±¡æ¥å£æ—¶ï¼Œæ‰èƒ½éå¸¸ç®€å•åœ°å®ç° Adapter æ¨¡å¼ã€‚





