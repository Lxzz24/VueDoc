---
title: è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼ˆ11 ç§ï¼‰
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

> è¡Œä¸ºå‹æ¨¡å¼ä¸»è¦æ¶‰åŠç®—æ³•å’Œå¯¹è±¡é—´çš„èŒè´£åˆ†é…ã€‚é€šè¿‡ä½¿ç”¨å¯¹è±¡ç»„åˆï¼Œè¡Œä¸ºå‹æ¨¡å¼å¯ä»¥æè¿°ä¸€ç»„å¯¹è±¡åº”è¯¥å¦‚ä½•åä½œæ¥å®Œæˆä¸€ä¸ªæ•´ä½“ä»»åŠ¡ã€‚

:::: tabs

@tab è´£ä»»é“¾

## 1. Chain of Responsibility

::: tip ä¸ºæŸä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªå¯¹è±¡é“¾ï¼Œæ¯ä¸ªå¯¹è±¡ä¾åºæ£€æŸ¥æ­¤è¯·æ±‚å¹¶å¯¹å…¶è¿›è¡Œå¤„ç†æˆ–è€…å°†å®ƒä¼ ç»™é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¯¹è±¡
:::

### ï¼ˆ1ï¼‰æ„å›¾

_ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚_ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚_å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾_ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20230415171040969.png)

å…¶ä¸­ï¼š

- Handler å®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ï¼›ï¼ˆå¯é€‰ï¼‰å®ç°åç»§é“¾ã€‚
- ConcreteHandler å¤„ç†å®ƒæ‰€è´Ÿè´£çš„è¯·æ±‚ï¼›å¯è®¿é—®å®ƒçš„åç»§è€…ï¼ˆsuccessorï¼‰ï¼›å¦‚æœå¯å¤„ç†è¯¥è¯·æ±‚ï¼Œå°±å¤„ç†å®ƒï¼Œå¦åˆ™å°†è¯¥è¯·æ±‚è½¬å‘ç»™åç»§è€…ã€‚
- Client å‘é“¾ä¸Šçš„å…·ä½“å¤„ç†è€… (ConcreteHandler) å¯¹è±¡æäº¤è¯·æ±‚ã€‚

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Chain of Responsibility æ¨¡å¼é€‚ç”¨äºä»¥ä¸‹æ¡ä»¶ï¼š

- æœ‰å¤šä¸ªçš„å¯¹è±¡å¯ä»¥å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚
- æƒ³åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹å‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚
- å¯å¤„ç†ä¸€ä¸ªè¯·æ±‚çš„å¯¹è±¡é›†åˆåº”è¢«åŠ¨æ€æŒ‡å®šã€‚

```java
public class ChainOfResponsibilityPattern {
    public static void main(String[] args) {
        Handler counsellor = new Counsellor();
        Handler dean = new Dean();
        Handler headmaster= new Headmaster();

        counsellor.setNext(dean);
        dean.setNext(headmaster);

        counsellor.HandRequest(25);
    }

}

abstract class Handler{
    protected Handler next;

    public void setNext(Handler next){
        this.next = next;
    }

    public abstract void HandRequest(int request);
}

class Counsellor extends Handler{

    @Override
    public void HandRequest(int request) {
        if (request <= 7){
            System.out.println("è¾…å¯¼å‘˜å®¡æ‰¹é€šè¿‡~");
        }else {
            if (next != null){
                next.HandRequest(request);
            }else {
                System.out.println("æ— æ³•å®¡æ‰¹");
            }
        }
    }
}

class Dean extends Handler{

    @Override
    public void HandRequest(int request) {
        if (request <= 15){
            System.out.println("é™¢é•¿å®¡æ‰¹é€šè¿‡~");
        }else {
            if (next != null){
                next.HandRequest(request);
            }else {
                System.out.println("æ— æ³•å®¡æ‰¹");
            }
        }
    }
}

class Headmaster extends Handler{

    @Override
    public void HandRequest(int request) {
        if (request <= 30){
            System.out.println("æ ¡é•¿å®¡æ‰¹é€šè¿‡~");
        }else {
            if (next != null){
                next.HandRequest(request);
            }else {
                System.out.println("æ— æ³•å®¡æ‰¹");
            }
        }
    }
}
```

@tab å‘½ä»¤

## ğŸŒ¸ 2. Command

::: tip å°†è¯·æ±‚å°è£…ä¸ºå¯¹è±¡
:::

### ï¼ˆ1ï¼‰æ„å›¾

å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿å¾—å¯ä»¥ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹**è¯·æ±‚æ’é˜Ÿ**æˆ–è®°å½•**è¯·æ±‚æ—¥å¿—**ï¼Œä»¥åŠæ”¯æŒå¯**æ’¤é”€**çš„æ“ä½œã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20230415173855870.png)

å…¶ä¸­ï¼š

- _Command_ å£°æ˜æ‰§è¡Œæ“ä½œçš„æ¥å£ã€‚
- _ConcreteCommand_ å°†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡ç»‘å®šäºä¸€ä¸ªåŠ¨ä½œï¼šè°ƒç”¨æ¥æ”¶è€…ç›¸åº”çš„æ“ä½œï¼Œä»¥å®ç° Executeã€‚
- Client åˆ›å»ºä¸€ä¸ªå…·ä½“å‘½ä»¤å¯¹è±¡å¹¶è®¾å®šå®ƒçš„æ¥æ”¶è€…ã€‚
- Invoker è¦æ±‚è¯¥å‘½ä»¤æ‰§è¡Œè¿™ä¸ªè¯·æ±‚ã€‚
- Receiver çŸ¥é“å¦‚ä½•å®æ–½ä¸æ‰§è¡Œä¸€ä¸ªè¯·æ±‚ç›¸å…³çš„æ“ä½œã€‚_ä»»ä½•ç±»éƒ½å¯èƒ½ä½œä¸ºä¸€ä¸ªæ¥æ”¶è€…_ã€‚

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Command æ¨¡å¼é€‚ç”¨äºï¼š

- æŠ½è±¡å‡ºå¾…æ‰§è¡Œçš„åŠ¨ä½œä»¥å‚æ•°åŒ–æŸå¯¹è±¡ã€‚
- åœ¨ä¸åŒçš„æ—¶åˆ»æŒ‡å®šã€æ’åˆ—å’Œæ‰§è¡Œè¯·æ±‚ã€‚
- æ”¯æŒå–æ¶ˆæ“ä½œã€‚
- æ”¯æŒä¿®æ”¹æ—¥å¿—ã€‚
- ç”¨æ„å»ºåœ¨åŸè¯­æ“ä½œä¸Šçš„é«˜å±‚æ“ä½œæ„é€ ä¸€ä¸ªç³»ç»Ÿã€‚

```java
public class CommandPattern {
    public static void main(String[] args) {
        Tv tv = new Tv(); // æ¥æ”¶è€… å¯¹è±¡ ç”µè§†æœº

        Command onCommand = new OnCommand(tv); // å‘½ä»¤å¯¹è±¡ å¼€æœºå‘½ä»¤
        Command offCommand = new OnCommand(tv); // å‘½ä»¤å¯¹è±¡ å…³æœºå‘½ä»¤

        Invoker invoker = new Invoker(); //è¯·æ±‚è€…
        invoker.setCommand(onCommand); // ç»™è¯·æ±‚è€…è®¾ç½® å¼€æœº å‘½ä»¤
        invoker.call(); // è¯·æ±‚è€…å»è¯·æ±‚å‘½ä»¤

        System.out.println("==============åˆ†å‰²çº¿===============");

        invoker.setCommand(offCommand); // ç»™è¯·æ±‚è€…è®¾ç½® å…³æœºå‘½ä»¤
        invoker.call(); // è¯·æ±‚è€…å»è¯·æ±‚å‘½ä»¤

    }
}

class Invoker{ // è¯·æ±‚è€…
    private Command command; // å‘½ä»¤

    public void setCommand(Command command){ // è®¾ç½®è¯·æ±‚è€…çš„å‘½ä»¤
        this.command = command;
    }

    public void call(){ // è°ƒç”¨
        command.Execute();
    }
}

interface Command{ // å‘½ä»¤æ¥å£
    void Execute(); // æ‰§è¡Œå‘½ä»¤

}

class OnCommand implements Command{// å¼€æœºå‘½ä»¤
    private Tv tv;

    public OnCommand(Tv tv){
        this.tv = tv;
    }

    @Override
    public void Execute() {
        tv.OnAction();
    }
}

class OffCommand implements Command{ // å…³æœºå‘½ä»¤
    private Tv tv;

    public OffCommand(Tv tv){
        this.tv = tv;
    }

    @Override
    public void Execute() {
        tv.OffAction();
    }
}

class Tv{
    public void OnAction(){ // å¼€æœºè¡Œä¸º
        System.out.println("ç”µè§†æœºå¼€æœºäº†...");
    }

    public void OffAction(){ // å…³æœºè¡Œä¸º
        System.out.println("ç”µè§†æœºå…³æœºäº†...");
    }
}
```

@tab è§£é‡Šå™¨

## 3. Interpreter

> æ²¡è€ƒè¿‡

::: tip ä¸ºè¯­è¨€åˆ›å»ºè§£é‡Šå™¨ï¼Œé€šå¸¸ç”±è¯­è¨€çš„è¯­æ³•å’Œè¯­æ³•åˆ†ææ¥å®šä¹‰
:::

### ï¼ˆ1ï¼‰æ„å›¾

ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œ_å®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤º_ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145354943.png)

- Context ä¸Šä¸‹æ–‡
- NonterminalExpression éç»ˆç»“ç¬¦è¡¨è¾¾å¼

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Interpreter æ¨¡å¼é€‚ç”¨äºå½“æœ‰ä¸€ä¸ªè¯­è¨€éœ€è¦è§£é‡Šæ‰§è¡Œï¼Œå¹¶ä¸”å¯å°†è¯¥è¯­è¨€ä¸­çš„å¥å­è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘æ—¶ï¼Œä»¥ä¸‹æƒ…å†µæ•ˆæœæœ€å¥½ï¼š

- è¯¥æ–‡æ³•ç®€å•ã€‚å¯¹äºå¤æ‚çš„å‘æ–‡ï¼Œæ–‡æ³•çš„ç±»å±‚æ¬¡å˜å¾—åºå¤§è€Œæ— æ³•ç®¡ç†ã€‚
- æ•ˆç‡ä¸æ˜¯ä¸€ä¸ªå…³é”®é—®é¢˜ã€‚æœ€é«˜æ•ˆçš„è§£é‡Šå™¨é€šå¸¸ä¸æ˜¯é€šè¿‡ç›´æ¥è§£é‡Šè¯­æ³•åˆ†ææ ‘å®ç°çš„ï¼Œè€Œæ˜¯é¦–å…ˆå°†å®ƒä»¬è½¬æ¢æˆå¦ä¸€ç§å½¢å¼ã€‚

```java
public class InterpreterPattern {

    public static void main(String[] args) {

        Context context = new Context();

        context.check("AåŒºçš„å¼€å‘äººå‘˜");
        context.check("BåŒºçš„è°ƒè¯•äººå‘˜");
        context.check("CåŒºçš„æµ‹è¯•äººå‘˜");

        System.out.println("========åˆ†å‰²çº¿=============");

        context.check("DåŒºçš„ç¨‹åºå‘˜");
        context.check("DåŒºçš„æµ‹è¯•å‘˜");
        context.check("CåŒºçš„ç¨‹åºå‘˜");

    }
}

class Context{
    private String[] regions = {"AåŒº","BåŒº","CåŒº"};
    private String[] persions = {"å¼€å‘äººå‘˜","æµ‹è¯•äººå‘˜","è°ƒè¯•äººå‘˜"};
    private NonterminalExpression nonterminal;

    public Context(){
        TerminalExpression region = new TerminalExpression(regions);
        TerminalExpression person = new TerminalExpression(persions);
        nonterminal = new NonterminalExpression(region,person);
    }

    public void check(String info){
        boolean result = nonterminal.Interpret(info);
        if (result){
            System.out.println("è¯†åˆ«æˆåŠŸ~");
        }else {
            System.out.println("è¯†åˆ«å¤±è´¥~");
        }
    }

}

interface Expression{
    boolean Interpret(String info);
}

class NonterminalExpression implements Expression{

    private TerminalExpression region;
    private TerminalExpression person;

    public NonterminalExpression(TerminalExpression region,TerminalExpression person){
        this.region =region;
        this.person = person;
    }

    @Override
    public boolean Interpret(String info) {
        String[] str = info.split("çš„");
        // BåŒºçš„è°ƒè¯•äººå‘˜ --> str = {"BåŒº","è°ƒè¯•äººå‘˜"};
        return region.Interpret(str[0]) && person.Interpret(str[1]);
    }
}

class TerminalExpression implements Expression{

    private Set<String> set = new HashSet<>();

    public TerminalExpression(String[] data){
        for (String str : data) {
            set.add(str);
        }
    }

    @Override
    public boolean Interpret(String info) {
        return set.contains(info);
    }
}
```

@tab è¿­ä»£å™¨

## 4. Iterator

::: tip æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²å…¶å†…éƒ¨çš„è¡¨ç¤º
:::

### ï¼ˆ1ï¼‰æ„å›¾

æä¾›ä¸€ç§æ–¹æ³•*é¡ºåºè®¿é—®*ä¸€ä¸ª**èšåˆå¯¹è±¡**ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œä¸”*ä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤º*ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145419785.png)

å…¶ä¸­ï¼š

- Iterator (è¿­ä»£å™¨) _å®šä¹‰è®¿é—®å’Œéå†å…ƒç´ çš„æ¥å£_ã€‚
- ConcreteIteratorï¼ˆå…·ä½“è¿­ä»£å™¨ï¼‰_å®ç°è¿­ä»£å™¨æ¥å£_ï¼›å¯¹è¯¥èšåˆéå†æ—¶è·Ÿè¸ªå½“å‰ä½ç½®ã€‚
- Aggregate (èšåˆ) å®šä¹‰åˆ›å»ºç›¸åº”è¿­ä»£å™¨å¯¹è±¡çš„æ¥å£ã€‚
- ConcreteAggregate (å…·ä½“èšåˆ) å®ç°åˆ›å»ºç›¸åº”è¿­ä»£å™¨çš„æ¥å£ï¼Œè¯¥æ“ä½œè¿”å› ConcreteIterator çš„ä¸€ä¸ªé€‚å½“çš„å®ä¾‹ã€‚

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Iterator æ¨¡å¼é€‚ç”¨äºï¼š

- è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— é¡»æš´éœ²å®ƒçš„å†…éƒ¨è¡¨ç¤ºã€‚
- æ”¯æŒå¯¹èšåˆå¯¹è±¡çš„å¤šç§éå†ã€‚
- ä¸ºéå†ä¸åŒçš„èšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ã€‚

```java
public class IteratorPattern {

    public static void main(String[] args) {
        BookAggregate bookAggregate = new BookAggregate();

        String[] books = {"æ•°æ®ç»“æ„","æ“ä½œç³»ç»Ÿ","è®¡ç®—æœºç½‘ç»œ","è®¡ç®—æœºç»„æˆåŸç†"};
        double[] prices = {10.24,20.48,40.96,81.92};

        for (int i = 0; i < 4; i++) {
            bookAggregate.Add(new Book(books[i],prices[i]));
        }

        Iterator iterator = bookAggregate.CreateIterator();
        while (iterator.hasNext()) {
            Book book = (Book) iterator.next();
            System.out.println("ä¹¦åï¼š" + book.getName() + " ä»·æ ¼ï¼š" + book.getPrice());
        }

    }

}

interface Iterator{
    boolean hasNext();
    Object next();
}

class BookIterator implements Iterator{
    private int index;
    private BookAggregate bookAggregate;

    public BookIterator(BookAggregate bookAggregate){
        this.index = 0;
        this.bookAggregate = bookAggregate;
    }

    @Override
    public boolean hasNext() {
        if (index < bookAggregate.getSize()){
            return true;
        }
        return false;
    }

    @Override
    public Object next() {
        Object obj = bookAggregate.get(index);
        index ++ ;
        return obj;
    }
}

class BookAggregate implements Aggregate{

    private List<Book> list = new ArrayList<>();

    public void Add(Book book){
        list.add(book);
    }

    public Book get(int index){
        return list.get(index);
    }

    public int getSize(){
        return list.size();
    }

    @Override
    public Iterator CreateIterator() {
        return new BookIterator(this);
    }
}

interface Aggregate{
    Iterator CreateIterator();
}

class Book{
    private String name;
    private double price;

    public Book(String name,double price){
        this.name = name;
        this.price = price;
    }

    public String getName(){
        return name;
    }

    public double getPrice(){
        return price;
    }
}
```

@tab ä¸­ä»‹è€…

## 5. Mediator

::: tip é›†ä¸­ç›¸å…³å¯¹è±¡ä¹‹é—´å¤æ‚çš„æ²Ÿé€šå’Œæ§åˆ¶æ–¹å¼
:::

### ï¼ˆ1ï¼‰æ„å›¾

ç”¨ä¸€ä¸ª**ä¸­ä»‹å¯¹è±¡**æ¥*å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’*ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼çš„ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶*è€¦åˆæ¾æ•£*ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145449796.png)

å…¶ä¸­ï¼š

- Mediator (ä¸­ä»‹è€…) å®šä¹‰ä¸€ä¸ªæ¥å£ç”¨äºå„åŒäº‹ (Colleague) å¯¹è±¡é€šä¿¡ã€‚
- ConcreteMediator (å…·ä½“ä¸­ä»‹è€…) é€šè¿‡åè°ƒå„åŒäº‹å¯¹è±¡å®ç°åä½œè¡Œä¸ºï¼›äº†è§£å¹¶ç»´æŠ¤å®ƒçš„å„ä¸ªåŒäº‹ã€‚
- Colleague class (åŒäº‹ç±») çŸ¥é“å®ƒçš„ä¸­ä»‹è€…å¯¹è±¡ï¼›æ¯ä¸€ä¸ªåŒäº‹ç±»å¯¹è±¡åœ¨éœ€è¦ä¸å…¶ä»–åŒäº‹é€šä¿¡çš„æ—¶å€™ä¸å®ƒçš„ä¸­ä»‹è€…é€šä¿¡ã€‚

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Mediator æ¨¡å¼é€‚ç”¨äºï¼š

- ä¸€ç»„å¯¹è±¡ä»¥*å®šä¹‰è‰¯å¥½*ä½†æ˜¯~~å¤æ‚çš„æ–¹å¼è¿›è¡Œé€šä¿¡~~ï¼Œäº§ç”Ÿçš„~~ç›¸äº’ä¾èµ–å…³ç³»ç»“æ„æ··ä¹±ä¸”éš¾ä»¥ç†è§£~~ã€‚
- ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å…¶ä»–å¾ˆå¤šå¯¹è±¡å¹¶ä¸”ç›´æ¥ä¸è¿™äº›å¯¹è±¡é€šä¿¡ï¼Œå¯¼è‡´éš¾ä»¥å¤ç”¨è¯¥å¯¹è±¡ã€‚
- æƒ³å®šåˆ¶ä¸€ä¸ªåˆ†å¸ƒåœ¨å¤šä¸ªç±»ä¸­çš„è¡Œä¸ºï¼Œè€Œåˆä¸æƒ³ç”Ÿæˆå¤ªå¤šçš„å­ç±»ã€‚

```java
public class MediatorPattern {
    public static void main(String[] args) {
        ConcreteMediator mediator = new ConcreteMediator();

        Colleague1 colleague1 = new Colleague1(mediator);
        Colleague2 colleague2 = new Colleague2(mediator);

        mediator.setColleague1(colleague1);
        mediator.setColleague2(colleague2);

        colleague1.sendMessage("è½¯è€ƒåŠ æ²¹~");
        colleague2.sendMessage("ç¥ä½ ä¸Šå²¸~");
    }
}

abstract class Colleague {
    protected Mediator mediator;
}

class Colleague1 extends Colleague {
    public Colleague1(Mediator mediator) {
        this.mediator = mediator;
    }

    public void sendMessage(String message) {
        mediator.sendMessage(messageï¼Œthis);
    }

    public void Notify(String message) {
        System.out.println("åŒäº‹1æ”¶åˆ°æ¶ˆæ¯ï¼š" + message);
    }
}

class Colleague2 extends Colleague {
    public Colleague2(Mediator mediator) {
        this.mediator = mediator;
    }

    public void sendMessage(String message) {
        mediator.sendMessage(messageï¼Œthis);
    }

    public void Notify(String message) {
        System.out.println("åŒäº‹2æ”¶åˆ°æ¶ˆæ¯ï¼š" + message);
    }
}

abstract class Mediator {
    public abstract void sendMessage(String messageï¼ŒColleague colleague);
}

class ConcreteMediator extends Mediator {
    private Colleague1 colleague1;
    private Colleague2 colleague2;

    public void setColleague1(Colleague1 colleague1) {
        this.colleague1 = colleague1;
    }

    public void setColleague2(Colleague2 colleague2) {
        this.colleague2 = colleague2;
    }

    @Override
    public void sendMessage(String messageï¼ŒColleague colleague) {
        if (colleague == colleague1) {
            // è®©åŒäº‹2æ”¶åˆ°æ¶ˆæ¯
            colleague2.Notify(message);
        } else {
            // è®©åŒäº‹1æ”¶åˆ°æ¶ˆæ¯
            colleague1.Notify(message);
        }
    }
}
```

@tab å¤‡å¿˜å½•

## 6. Memento

::: tip å½“ä½ éœ€è¦è®©å¯¹è±¡è¿”å›ä¹‹å‰çš„çŠ¶æ€æ—¶(ä¾‹å¦‚ï¼Œä½ çš„ç”¨æˆ·è¯·æ±‚"æ’¤é”€")ï¼Œä½ ä½¿ç”¨å¤‡å¿˜å½•æ¨¡å¼
:::

### ï¼ˆ1ï¼‰æ„å›¾

åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹*æ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€*ï¼Œå¹¶åœ¨å¯¹è±¡ä¹‹å¤–*ä¿å­˜*è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯ä»¥å°†å¯¹è±¡*æ¢å¤*åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145510432.png)

- Mementoï¼ˆå¤‡å¿˜å½•ï¼‰ï¼šå­˜å‚¨åŸå‘å™¨å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼›é˜²æ­¢åŸå‘å™¨ä»¥å¤–çš„å¯¹è±¡è®¿é—®å¤‡å¿˜å½•ï¼›
- Originatorï¼ˆåŸå‘å™¨ï¼‰ï¼šåˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•ï¼Œç”¨äºè®°å½•å½“å‰æ—¶åˆ»å®ƒçš„å†…éƒ¨çŠ¶æ€ï¼›ä½¿ç”¨å¤‡å¿˜å½•æ¢å¤å†…éƒ¨çŠ¶æ€
- Caretakerï¼ˆç®¡ç†è€…ï¼‰

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Memento æ¨¡å¼é€‚ç”¨äºï¼š

- _å¿…é¡»ä¿å­˜ä¸€ä¸ªå¯¹è±¡åœ¨æŸä¸€ä¸ªæ—¶åˆ»çš„ï¼ˆéƒ¨åˆ†ï¼‰çŠ¶æ€_ï¼Œè¿™æ ·ä»¥åéœ€è¦æ—¶å®ƒæ‰èƒ½æ¢å¤åˆ°å…ˆå‰çš„çŠ¶æ€ã€‚
- å¦‚æœä¸€ä¸ªç”¨æ¥å£æ¥è®©å…¶ä»–å¯¹è±¡ç›´æ¥å¾—åˆ°è¿™äº›çŠ¶æ€ï¼Œå°†ä¼šæš´éœ²å¯¹è±¡çš„å®ç°ç»†èŠ‚å¹¶ç ´åå¯¹è±¡çš„å°è£…æ€§ã€‚

```java
public class MementoPattern {
    public static void main(String[] args) {
        Caretaker caretaker = new Caretaker();
        Originator originator = new Originator();

        originator.setState("1024");
        Memento backup1 = originator.createMemento();
        caretaker.addMemento(backup1);

        originator.setState("2048");
        Memento backup2 = originator.createMemento();
        caretaker.addMemento(backup2);

        originator.setState("4096");
        Memento backup3 = originator.createMemento();
        caretaker.addMemento(backup3);

        System.out.println(originator.getState());
        caretaker.showMemento();

        Memento memento1 = caretaker.getMemento(2);
        originator.setState(memento1.getState());

        System.out.println("æ ¹æ®ç¬¬2æ¬¡å¤‡ä»½è¿˜åŸä¹‹åçš„çŠ¶æ€ä¸ºï¼š" + originator.getState());
    }
}

class Originator{ // åŸå‘å™¨
    private String state;

    public void setState(String state){
        this.state = state;
    }

    public String getState(){
        return state;
    }

    public Memento createMemento(){
        return new Memento(state);
    }

    public void setMemento(Memento memento){
        state = memento.getState();
    }
}

class Memento{ // å¤‡å¿˜å½•
    private String state;

    public String getState(){
        return state;
    }

    public Memento(String state){
        this.state = state;
    }
}

class Caretaker{ // ç®¡ç†è€…
    private List<Memento> mementoList = new ArrayList<>();

    public void addMemento(Memento memento){
        mementoList.add(memento);
    }

    public Memento getMemento(int index){
        // åˆ¤æ–­å‚æ•°æ˜¯å¦åˆæ³•
        if (index >=1 && index <= mementoList.size()) {
            return mementoList.get(index - 1);
        }
        return null;
    }

    public void showMemento(){
        int cnt = 1;
        for (Memento memento : mementoList) {
            System.out.println("ç¬¬" + cnt + "æ¬¡å¤‡ä»½ï¼ŒçŠ¶æ€ä¸ºï¼š" + memento.getState());
            cnt ++;
        }
    }
}
```

@tab è§‚å¯Ÿè€…

## ğŸŒ¸ 7. Observer

::: tip å¯¹è±¡é—´å®šä¹‰ä¸€å¯¹å¤šçš„ä¾èµ–ï¼Œä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€ï¼Œä¾èµ–å®ƒçš„å¯¹è±¡éƒ½ä¼šæ”¶åˆ°é€šçŸ¥
:::

### ï¼ˆ1ï¼‰æ„å›¾

å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145530766.png)

å…¶ä¸­ï¼š

- _Subject (ç›®æ ‡) çŸ¥é“å®ƒçš„è§‚å¯Ÿè€…ï¼Œå¯ä»¥æœ‰ä»»æ„å¤šä¸ªè§‚å¯Ÿè€…è§‚å¯ŸåŒä¸€ä¸ªç›®æ ‡_ï¼›æä¾›æ³¨å†Œå’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡çš„æ¥å£ã€‚
- Observer (è§‚å¯Ÿè€…) ä¸ºé‚£äº›åœ¨ç›®æ ‡å‘ç”Ÿæ”¹å˜æ—¶éœ€è·å¾—é€šçŸ¥çš„å¯¹è±¡å®šä¹‰ä¸€ä¸ªæ›´æ–°æ¥å£ã€‚
- ConcreteSubject (å…·ä½“ç›®æ ‡) å°†æœ‰å…³çŠ¶æ€å­˜å…¥å„ ConcreteObserver å¯¹è±¡ï¼›å½“å®ƒçš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå‘å®ƒçš„å„ä¸ªè§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚
- ConcreteObserver (å…·ä½“è§‚å¯Ÿè€…) ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘ ConcreteSubject å¯¹è±¡çš„å¼•ç”¨ï¼›å­˜å‚¨æœ‰å…³çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€åº”ä¸ç›®æ ‡çš„çŠ¶æ€ä¿æŒä¸€è‡´ã€‚
- å®ç° Observer çš„æ›´æ–°æ¥å£ï¼Œä»¥ä½¿è‡ªèº«çŠ¶æ€ä¸ç›®æ ‡çš„çŠ¶æ€ä¿æŒä¸€è‡´ã€‚

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Observer æ¨¡å¼é€‚ç”¨äºï¼š

- å½“ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢ä¾èµ–äºå¦ä¸€ä¸ªæ–¹é¢ï¼Œå°†è¿™ä¸¤è€…å°è£…åœ¨ç‹¬ç«‹çš„å¯¹è±¡ä¸­ä»¥ä½¿å®ƒä»¬å¯ä»¥å„è‡ªç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨ã€‚
- _å½“å¯¹ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜éœ€è¦åŒæ—¶æ”¹å˜å…¶ä»–å¯¹è±¡ï¼Œè€Œä¸çŸ¥é“å…·ä½“æœ‰å¤šå°‘å¯¹è±¡æœ‰å¾…æ”¹å˜æ—¶_ã€‚
- å½“ä¸€ä¸ªå¯¹è±¡å¿…é¡»é€šçŸ¥å…¶ä»–å¯¹è±¡ï¼Œè€Œå®ƒåˆä¸èƒ½å‡å®šå…¶ä»–å¯¹è±¡æ˜¯è°ï¼Œå³*ä¸å¸Œæœ›è¿™äº›å¯¹è±¡æ˜¯ **ç´§è€¦åˆ** çš„*ã€‚

```java
public class ObserverPattern {
    public static void main(String[] args) {
        Subject subjectA = new ConcreteSubject("ç›®æ ‡A");

        Observer observerB = new ConcreteObserver("å¼ ä¸‰"ï¼ŒsubjectA);
        Observer observerC = new ConcreteObserver("æå››"ï¼ŒsubjectA);
        Observer observerD = new ConcreteObserver("ç‹äº”"ï¼ŒsubjectA);

        subjectA.setState("æ›´æ–°äº†");
    }
}


interface Subject { // ç›®æ ‡æ¥å£
    void Attach(Observer observer); // æ·»åŠ è§‚å¯Ÿè€…

    void Detach(Observer observer); // åˆ é™¤è§‚å¯Ÿè€…

    void Notify(); // çŠ¶æ€æ”¹å˜åï¼Œé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…

    void setState(String state); // è®¾ç½®çŠ¶æ€ï¼ˆæ”¹å˜çŠ¶æ€ï¼‰

    String getState(); // è·å–çŠ¶æ€


}

class ConcreteSubject implements Subject {
    private String name;
    private String state;


    private List<Observer> observerList;

    public ConcreteSubject(String name) {
        state = "æœªæ›´æ–°";
        this.name = name;
        observerList = new ArrayList<>();
    }

    @Override
    public void Attach(Observer observer) {
        observerList.add(observer);
    }

    @Override
    public void Detach(Observer observer) {
        observerList.remove(observer);
    }

    @Override
    public void Notify() {
        for (Observer observer : observerList) {
            observer.update();
        }
    }

    @Override
    public void setState(String state) {
        this.state = state;

        System.out.println(name + "çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå˜åŒ–åçš„çŠ¶æ€ä¸ºï¼š" + state);
        Notify();
    }

    @Override
    public String getState() {
        return state;
    }


}

interface Observer { // è§‚å¯Ÿè€…æ¥å£
    void update(); // æ”¶åˆ°é€šçŸ¥ï¼Œæ›´æ–°è§‚å¯Ÿè€…çš„çŠ¶æ€
}

class ConcreteObserver implements Observer {


    private String name;
    private String state;

    private Subject subject;

    public ConcreteObserver(String nameï¼ŒSubject subject) {
        this.name = name;
        this.subject = subject;
        subject.Attach(this);
        state = subject.getState();
    }

    @Override
    public void update() {
        System.out.println(name + " æ”¶åˆ°é€šçŸ¥");
        state = subject.getState(); //  è®©å½“å‰è§‚å¯Ÿè€…çš„çŠ¶æ€ å’Œ ç›®æ ‡æ”¹å˜åçš„çŠ¶æ€ä¿æŒä¸€è‡´
        System.out.println(name + " æ”¹å˜åçš„çŠ¶æ€ä¸ºï¼š" + state);
    }
}
```

@tab çŠ¶æ€

## ğŸŒ¸ 8. State

::: tip å…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸º
:::

### ï¼ˆ1ï¼‰æ„å›¾

å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶*å†…éƒ¨çŠ¶æ€æ”¹å˜*æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145747952.png)

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

State æ¨¡å¼é€‚ç”¨äºï¼š

- ä¸€ä¸ªå¯¹è±¡çš„*è¡Œä¸ºå†³å®šäºå®ƒçš„çŠ¶æ€*ï¼Œå¹¶ä¸”å®ƒ*å¿…é¡»åœ¨è¿è¡Œæ—¶åˆ»æ ¹æ®çŠ¶æ€æ”¹å˜å®ƒçš„è¡Œä¸º*ã€‚
- ä¸€ä¸ªæ“ä½œä¸­*å«æœ‰åºå¤§çš„å¤šåˆ†æ”¯çš„æ¡ä»¶è¯­å¥*ï¼Œä¸”è¿™äº›*åˆ†æ”¯ä¾èµ–äºè¯¥å¯¹è±¡çš„çŠ¶æ€*ã€‚è¿™ä¸ªçŠ¶æ€å¸¸ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªæšä¸¾å¸¸é‡è¡¨ç¤ºã€‚

```java
public class StatePattern {
    public static void main(String[] args) {
        Context context = new Context(); // count = 3

        System.out.println("çŠ¶æ€ï¼š" + context.getState() + " æ•°é‡ï¼š" + context.getCount());

        context.Request(); // è´­ä¹°ä¸€ä¸ªé¥®æ–™ count = 2
        context.Request(); // è´­ä¹°ä¸€ä¸ªé¥®æ–™ count = 1
        context.Request(); // è´­ä¹°ä¸€ä¸ªé¥®æ–™ count = 0

        System.out.println("çŠ¶æ€ï¼š" + context.getState() + " æ•°é‡ï¼š" + context.getCount());

        context.Request(); // æ— è´§ï¼Œç­‰å¾…è¡¥è´§

        System.out.println("çŠ¶æ€ï¼š" + context.getState() + " æ•°é‡ï¼š" + context.getCount());

        context.Request(); // è´­ä¹°ä¸€ä¸ªé¥®æ–™ count = 4
        System.out.println("çŠ¶æ€ï¼š" + context.getState() + " æ•°é‡ï¼š" + context.getCount());

    }
}

class Context{ // è´©å–æœº
    private int count;

    private State state;

    public Context(){
        count = 3;
        state = new StateA();
    }

    public int getCount() {
        return count;
    }

    public void setCount(int count) {
        this.count = count;
    }

    public State getState() {
        return state;
    }

    public void setState(State state) {
        this.state = state;
    }

    public void Request(){  // è´­ä¹°é¥®æ–™
        state.Handle(this);
    }
}

interface State{
    void Handle(Context context);
}

class StateA implements State{

    @Override
    public void Handle(Context context) {
        int count = context.getCount();

        if (count >= 1){
            System.out.println("è´­ä¹°æˆåŠŸ~");
            context.setCount(count - 1);

            if (context.getCount() == 0){
                context.setState(new StateB()); // è®¾ç½®ä¸ºæ— è´§çŠ¶æ€
            }
        }else {
            System.out.println("è´­ä¹°å¤±è´¥~");
        }
    }
}

class StateB implements State{

    @Override
    public void Handle(Context context) {
        int count = context.getCount();

        if (count == 0){
            System.out.println("è´­ä¹°å¤±è´¥ï¼ç­‰å¾…è¡¥è´§~");

            context.setCount(5);
            System.out.println("è¡¥è´§æˆåŠŸï¼Œè¯·é‡æ–°è´­ä¹°~");

            context.setState(new StateA());
        }
    }
}
```

@tab ç­–ç•¥

## ğŸŒ¸ 9. Strategy

::: tip å®šä¹‰äº†ç®—æ³•æ—ï¼Œåˆ†åˆ«å°é—­èµ·æ¥ï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ·
:::

### ï¼ˆ1ï¼‰æ„å›¾

å®šä¹‰ä¸€ç³»åˆ—çš„**ç®—æ³•**ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ª**å°è£…**èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚æ­¤æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒä»¬çš„å®¢æˆ·è€Œå˜åŒ–ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145813957.png)

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Strategy æ¨¡å¼é€‚ç”¨äºï¼š

- è®¸å¤šç›¸å…³çš„ç±»ä»…ä»…æ˜¯*è¡Œä¸ºæœ‰å¼‚*ã€‚
- _éœ€è¦ä½¿ç”¨ä¸€ä¸ªç®—æ³•çš„ä¸åŒå˜ä½“_ã€‚
- ç®—æ³•ä½¿ç”¨å®¢æˆ·ä¸åº”è¯¥çŸ¥é“çš„æ•°æ®ã€‚å¯ä½¿ç”¨ç­–ç•¥æ¨¡å¼ä»¥*é¿å…æš´éœ²å¤æ‚çš„ã€ä¸ç®—æ³•ç›¸å…³çš„æ•°æ®ç»“æ„*ã€‚
- ä¸€ä¸ªç±»å®šä¹‰äº†å¤šç§è¡Œä¸ºï¼Œå¹¶ä¸”è¿™äº›è¡Œä¸ºåœ¨è¿™ä¸ªç±»çš„æ“ä½œä¸­ä»¥å¤šä¸ªæ¡ä»¶è¯­å¥çš„å½¢å¼å‡ºç°ï¼ˆè¶…å¸‚æ‰“æŠ˜ï¼Œæ™®é€š/é«˜çº§ä¼šå‘˜ä»·ï¼‰ï¼Œå°†ç›¸å…³çš„æ¡ä»¶åˆ†æ”¯ç§»å…¥å®ƒä»¬å„è‡ªçš„ Strategy ç±»ä¸­ï¼Œä»¥ä»£æ›¿è¿™äº›æ¡ä»¶è¯­å¥ã€‚

```java
public class StrategyPattern {
    public static void main(String[] args) {

        OperationContext context = new OperationContext(new Addstrategy());
        context.Operation(20,17);

        context = new OperationContext(new Substrategy());
        context.Operation(20,17);

        context = new OperationContext(new Multstrategy());
        context.Operation(20,17);
    }
}

class OperationContext{
    private Strategy strategy;

    public OperationContext(Strategy strategy){
        this.strategy = strategy;
    }

    public void Operation(int aï¼Œint b){
        strategy.TwoNumberOperation(a,b);
    }
}

interface Strategy{
    void TwoNumberOperation(int a,int b);
}

class Addstrategy implements Strategy{
    @Override
    public void TwoNumberOperation(int aï¼Œint b) {
        System.out.println(a + b);
    }
}

class Substrategy implements Strategy{
    @Override
    public void TwoNumberOperation(int aï¼Œint b) {
        System.out.println(a - b);
    }
}

class Multstrategy implements Strategy{
    @Override
    public void TwoNumberOperation(int aï¼Œint b) {
        System.out.println(a * b);
    }
}
```

@tab æ¨¡æ¿æ–¹æ³•

## 10. Template Method

::: tip åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å®šä¹‰ä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­
:::

### ï¼ˆ1ï¼‰æ„å›¾

å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„**ç®—æ³•éª¨æ¶**ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚Template Method ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³*å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤*ã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145831835.png)

å…¶ä¸­ï¼š

- AbstractClassï¼ˆæŠ½è±¡ç±»ï¼‰å®šä¹‰æŠ½è±¡çš„*åŸè¯­æ“ä½œ*ï¼Œå…·ä½“çš„å­ç±»å°†é‡å®šä¹‰å®ƒä»¬ä»¥å®ç°ä¸€ä¸ªç®—æ³•çš„å„æ­¥éª¤ï¼›å®ç°æ¨¡æ¿æ–¹æ³•ï¼Œå®šä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼Œè¯¥æ¨¡æ¿æ–¹æ³•ä¸ä»…è°ƒç”¨åŸè¯­æ“ä½œï¼Œä¹Ÿè°ƒç”¨å®šä¹‰åœ¨ AbstractClass æˆ–å…¶ä»–å¯¹è±¡ä¸­çš„æ“ä½œã€‚
- ConcreteClassï¼ˆå…·ä½“ç±»ï¼‰å®ç°åŸè¯­æ“ä½œä»¥å®Œæˆç®—æ³•ä¸­ä¸ç‰¹å®šå­ç±»ç›¸å…³çš„æ­¥éª¤ã€‚

> æŠ½è±¡ç±»æ§åˆ¶æ­¥éª¤ï¼Œå„å­ç±»ç»§æ‰¿çˆ¶ç±»å…·ä½“å®ç°æ“ä½œæ­¥éª¤

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Template Method æ¨¡å¼é€‚ç”¨äºï¼š

- ä¸€æ¬¡æ€§å®ç°ä¸€ä¸ªç®—æ³•çš„ä¸å˜çš„éƒ¨åˆ†ï¼Œå¹¶å°†å¯å˜çš„è¡Œä¸ºç•™ç»™å­ç±»æ¥å®ç°ã€‚
- å„å­ç±»ä¸­å…¬å…±çš„è¡Œä¸ºåº”è¢«æå–å‡ºæ¥å¹¶é›†ä¸­åˆ°ä¸€ä¸ªå…¬å…±çˆ¶ç±»ä¸­ï¼Œä»¥é¿å…ä»£ç é‡å¤ã€‚
- æ§åˆ¶å­ç±»æ‰©å±•ï¼šæ¨¡æ¿æ–¹æ³•åœ¨ç‰¹å®šç‚¹è°ƒç”¨ â€œhookâ€ æ“ä½œ (é»˜è®¤è¡Œä¸ºï¼Œå­ç±»å¯ä»¥åœ¨å¿…è¦æ—¶è¿›è¡Œé‡å®šä¹‰æ‰©å±•)ï¼Œè¿™å°±åªå…è®¸åœ¨è¿™äº›ç‚¹è¿›è¡Œæ‰©å±•ã€‚

```java
public class TemplateMethodPattern {
    public static void main(String[] args) {
        // çˆ¶ç±»å å¯¹è±¡å = new å­ç±»å();

        Person student = new Student();
        Person teacher = new Teacher();

        student.TemplateMethod();

        System.out.println("=========åˆ†å‰²çº¿=============");

        teacher.TemplateMethod();
    }
}

abstract class Person{
    public void TemplateMethod(){
        System.out.println("ä¸Šè¯¾ å»æ•™å®¤");
        PrimitiveOperation1();
        System.out.println("ä¸‹è¯¾ ç¦»å¼€æ•™å®¤");
        PrimitiveOperation2();
    }

    public abstract void PrimitiveOperation1(); // åŸè¯­æ“ä½œ 1ï¼šä¸Šè¯¾è¿‡ç¨‹ å­¦ç”Ÿ å¬è¯¾... è€å¸ˆ è®²è¯¾
    public abstract void PrimitiveOperation2(); // åŸè¯­æ“ä½œ 2ï¼šä½œä¸š  å­¦ç”Ÿ å†™ä½œä¸š æäº¤ä½œä¸š... è€å¸ˆæ‰¹æ”¹ä½œä¸š æ‰“åˆ†æ•°
}

class Student extends Person{

    @Override
    public void PrimitiveOperation1() {
        System.out.println("å­¦ç”Ÿï¼šå¬è¯¾ å­¦ä¹  åšç¬”è®° æå‡ºé—®é¢˜");
    }

    @Override
    public void PrimitiveOperation2() {
        System.out.println("å­¦ç”Ÿï¼šå†™ä½œä¸š æäº¤ä½œä¸š");
    }
}

class Teacher extends Person{

    @Override
    public void PrimitiveOperation1() {
        System.out.println("è€å¸ˆï¼šä¸Šè¯¾ è®²è¯¾ è§£ç­”é—®é¢˜ å¸ƒç½®ä½œä¸š");
    }

    @Override
    public void PrimitiveOperation2() {
        System.out.println("è€å¸ˆï¼šæ‰¹æ”¹ä½œä¸š æ‰“åˆ†æ•°");
    }
}
```

@tab è®¿é—®è€…

## ğŸŒ¸ 11. Visitor

::: tip å½“ä½ æƒ³è¦ä¸ºä¸€ä¸ªå¯¹è±¡çš„ç»„åˆå¢åŠ æ–°çš„èƒ½åŠ›ï¼Œä¸”å°è£…å¹¶ä¸é‡è¦æ—¶ï¼Œå°±ä½¿ç”¨è®¿é—®è€…æ¨¡å¼
:::

### ï¼ˆ1ï¼‰æ„å›¾

_è¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸ**å¯¹è±¡ç»“æ„**ä¸­çš„å„å…ƒç´ çš„æ“ä½œ_ã€‚å®ƒå…è®¸åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚

### ï¼ˆ2ï¼‰ç±»å›¾

![](./assets/image-20240430145858087.png)

å…¶ä¸­ï¼š

- Visitor (è®¿é—®è€…) ä¸ºè¯¥å¯¹è±¡ç»“æ„ä¸­ ConcreteElement çš„æ¯ä¸€ä¸ªç±»å£°æ˜ä¸€ä¸ª Visit æ“ä½œã€‚è¯¥æ“ä½œçš„åå­—å’Œç‰¹å¾æ ‡è¯†äº†å‘é€ Vist è¯·æ±‚ç»™è¯¥è®¿é—®è€…çš„é‚£ä¸ªç±»ï¼Œè¿™ä½¿å¾—è®¿é—®è€…å¯ä»¥ç¡®å®šæ­£è¢«è®¿é—®å…ƒç´ çš„å…·ä½“çš„ç±»ã€‚è¿™æ ·è®¿é—®è€…å°±å¯ä»¥é€šè¿‡è¯¥å…ƒç´ çš„ç‰¹å®šæ¥å£ç›´æ¥è®¿é—®å®ƒã€‚
- ConcreteVisitor (å…·ä½“è®¿é—®è€…) å®ç°æ¯ä¸ªæœ‰ Visitor å£°æ˜çš„æ“ä½œï¼Œæ¯ä¸ªæ“ä½œå®ç°æœ¬ç®—æ³•çš„ä¸€éƒ¨åˆ†ï¼Œè€Œè¯¥ç®—æ³•ç‰‡æ®µä¹ƒæ˜¯å¯¹åº”äºç»“æ„ä¸­å¯¹è±¡çš„ç±»ã€‚Concrete Visitor ä¸ºè¯¥ç®—æ³•æä¾›äº†ä¸Šä¸‹æ–‡å¹¶å­˜å‚¨å®ƒçš„å±€éƒ¨çŠ¶æ€ã€‚è¿™ä¸€çŠ¶æ€å¸¸å¸¸åœ¨éå†è¯¥ç»“æ„çš„è¿‡ç¨‹ä¸­ç´¯ç§¯ç»“æœã€‚
- Element (å…ƒç´ ) å®šä¹‰ä»¥ä¸€ä¸ªè®¿é—®è€…ä¸ºå‚æ•°çš„ Accept æ“ä½œã€‚
- ConcreteElement (å…·ä½“å…ƒç´ ) å®ç°ä»¥ä¸€ä¸ªè®¿é—®è€…ä¸ºå‚æ•°çš„ Accept æ“ä½œã€‚
- ObjectStructure (å¯¹è±¡ç»“æ„) èƒ½æšä¸¾å®ƒçš„å…ƒç´ ï¼›å¯ä»¥æä¾›ä¸€ä¸ªé«˜å±‚çš„æ¥å£ä»¥å…è®¸è¯¥è®¿é—®è€…è®¿é—®å®ƒçš„å…ƒç´ ï¼›å¯ä»¥æ˜¯ä¸€ä¸ªç»„åˆæˆ–è€…ä¸€ä¸ªé›†åˆï¼Œå¦‚ä¸€ä¸ªåˆ—è¡¨æˆ–ä¸€ä¸ªæ— åºé›†åˆã€‚

### ï¼ˆ3ï¼‰é€‚ç”¨æ€§

Visitor æ¨¡å¼é€‚ç”¨äºï¼š

- ä¸€ä¸ªå¯¹è±¡ç»“æ„åŒ…å«å¾ˆå¤šç±»å¯¹è±¡ï¼Œå®ƒä»¬æœ‰ä¸åŒçš„æ¥å£ï¼Œè€Œç”¨æˆ·æƒ³å¯¹è¿™äº›å¯¹è±¡å®æ–½ä¸€äº›ä¾èµ–äºå…¶å…·ä½“ç±»çš„æ“ä½œã€‚
- éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œåˆæƒ³è¦é¿å…è¿™äº›æ“ä½œ â€œæ±¡æŸ“â€ è¿™äº›å¯¹è±¡çš„ç±»ã€‚
- å®šä¹‰å¯¹è±¡ç»“æ„çš„ç±»å¾ˆå°‘æ”¹å˜ï¼Œä½†ç»å¸¸éœ€è¦åœ¨æ­¤ç»“æ„ä¸Šå®šä¹‰æ–°çš„æ“ä½œã€‚

```java
public class VisitorPattern {
    public static void main(String[] args) {
        PersonStructure structure = new PersonStructure();

        Visitor1 visitor1 = new Visitor1();
        System.out.println("è®¿é—®è€…1çš„è®¿é—®è®°å½•ï¼š");
        structure.Accept(visitor1);
        System.out.println("å­¦ç”Ÿå¹´é¾„çš„æ€»å’Œï¼š" + visitor1.getStudentAgeSum() +" è€å¸ˆå¹´é¾„çš„æ€»å’Œï¼š" + visitor1.getTeacherAgeSum());

        System.out.println("=========åˆ†å‰²çº¿==============");

        Visitor2 visitor2 = new Visitor2();
        System.out.println("è®¿é—®è€…2çš„è®¿é—®è®°å½•ï¼š");
        structure.Accept(visitor2);
        System.out.println("å­¦ç”Ÿçš„æœ€é«˜æˆç»©ï¼š" + visitor2.getMaxScore() + " è€å¸ˆçš„æœ€é«˜å·¥é¾„ï¼š" + visitor2.getMaxWorkYear());

    }
}

interface Visitor{
    void VistStudent(Student student); // è®¿é—®
    void vistTeacher(Teacher teacher); // è®¿é—®è€å¸ˆ
}

class Visitor1 implements Visitor{ // è®¿é—®è€…1 åˆ†åˆ«ç»Ÿè®¡å­¦ç”Ÿå’Œè€å¸ˆçš„å¹´é¾„æ€»å’Œ
    private int studentAgeSum = 0;
    private int teacherAgeSum = 0;

    public int getStudentAgeSum() {
        return studentAgeSum;
    }

    public int getTeacherAgeSum() {
        return teacherAgeSum;
    }

    @Override
    public void VistStudent(Student student) {
        System.out.println("è®¿é—®è€…1è®¿é—®å­¦ç”Ÿï¼š" + student.getName() + " å¹´é¾„ï¼š" + student.getAge());
        studentAgeSum += student.getAge();
    }

    @Override
    public void vistTeacher(Teacher teacher) {
        System.out.println("è®¿é—®è€…1è®¿é—®è€å¸ˆï¼š" + teacher.getName() + " å¹´é¾„ï¼š" + teacher.getAge());
        teacherAgeSum += teacher.getAge();
    }
}

class Visitor2 implements Visitor{ // è®¿é—®è€…2 åˆ†åˆ«æ±‚å‡º å­¦ç”Ÿçš„æœ€é«˜æˆç»© ä»¥åŠ è€å¸ˆçš„æœ€é«˜å·¥é¾„
    private int maxScore = -1;
    private int maxWorkYear = -1;

    public int getMaxScore() {
        return maxScore;
    }

    public int getMaxWorkYear() {
        return maxWorkYear;
    }

    @Override
    public void VistStudent(Student student) {
        System.out.println("è®¿é—®è€…2è®¿é—®å­¦ç”Ÿï¼š" + student.getName() + " æˆç»©ï¼š" + student.getScore());
        maxScore = Math.max(maxScore,student.getScore());
    }

    @Override
    public void vistTeacher(Teacher teacher) {
        System.out.println("è®¿é—®è€…2è®¿é—®è€å¸ˆï¼š" + teacher.getName() + " å·¥é¾„ï¼š" + teacher.getWorkYear());
        maxWorkYear = Math.max(maxWorkYear,teacher.getWorkYear());
    }
}

class PersonStructure{
    private List<Person> personList = new ArrayList<>();

    public PersonStructure(){
        personList.add(new Student("å¼ ä¸‰",20,70));
        personList.add(new Student("æå››",21,80));
        personList.add(new Student("ç‹äº”",22,90));

        personList.add(new Teacher("æè€å¸ˆ",26,3));
        personList.add(new Teacher("é™ˆè€å¸ˆ",27,4));
        personList.add(new Teacher("åˆ˜è€å¸ˆ",28,5));
    }

    public void Accept(Visitor visitor){
        for (Person person : personList) {
            person.Accept(visitor);
        }
    }
}

abstract class Person{
    private String name;
    private int age;

    public Person(String  name,int age){
        this.name = name;
        this.age = age;
    }

    public String getName(){
        return name;
    }

    public int getAge() {
        return age;
    }

    public abstract void Accept(Visitor visitor);
}

class Student extends Person{

    private int score;
    public Student(String name,int age,int score){
        super(name,age);
        this.score = score;
    }

    public int getScore(){
        return score;
    }

    @Override
    public void Accept(Visitor visitor) {
        visitor.VistStudent(this);
    }
}

class Teacher extends Person{
    private int workYear;
    public Teacher(String name,int age,int workYear){
        super(name,age);
        this.workYear = workYear;
    }

    public int getWorkYear(){
        return workYear;
    }

    @Override
    public void Accept(Visitor visitor) {
        visitor.vistTeacher(this);
    }
}
```
