---
title: çŠ¶æ€
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---


> å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹Žä¿®æ”¹äº†å®ƒçš„ç±»ã€‚

çŠ¶æ€æ¨¡å¼ï¼ˆStateï¼‰ç»å¸¸ç”¨åœ¨å¸¦æœ‰çŠ¶æ€çš„å¯¹è±¡ä¸­ã€‚

ä»€ä¹ˆæ˜¯çŠ¶æ€ï¼Ÿæˆ‘ä»¬ä»¥ QQ èŠå¤©ä¸ºä¾‹ï¼Œä¸€ä¸ªç”¨æˆ·çš„ QQ æœ‰å‡ ç§çŠ¶æ€ï¼š

- ç¦»çº¿çŠ¶æ€ï¼ˆå°šæœªç™»å½•ï¼‰ï¼›
- æ­£åœ¨ç™»å½•çŠ¶æ€ï¼›
- åœ¨çº¿çŠ¶æ€ï¼›
- å¿™çŠ¶æ€ï¼ˆæš‚æ—¶ç¦»å¼€ï¼‰ã€‚

å¦‚ä½•è¡¨ç¤ºçŠ¶æ€ï¼Ÿæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª `enum` å°±å¯ä»¥è¡¨ç¤ºä¸åŒçš„çŠ¶æ€ã€‚ä½†ä¸åŒçš„çŠ¶æ€éœ€è¦å¯¹åº”ä¸åŒçš„è¡Œä¸ºï¼Œæ¯”å¦‚æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼š

```java
if (state == ONLINE) {
    // é—ªçƒå›¾æ ‡
} else if (state == BUSY) {
    reply("çŽ°åœ¨å¿™ï¼Œç¨åŽå›žå¤");
} else if ...
```

çŠ¶æ€æ¨¡å¼çš„ç›®çš„æ˜¯ä¸ºäº†æŠŠä¸Šè¿°ä¸€å¤§ä¸² `if...else...` çš„é€»è¾‘ç»™åˆ†æ‹†åˆ°ä¸åŒçš„çŠ¶æ€ç±»ä¸­ï¼Œä½¿å¾—å°†æ¥å¢žåŠ çŠ¶æ€æ¯”è¾ƒå®¹æ˜“ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬è®¾è®¡ä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œå®ƒæœ‰ä¸¤ä¸ªçŠ¶æ€ï¼š

- æœªè¿žçº¿ï¼›
- å·²è¿žçº¿ã€‚

å¯¹äºŽæœªè¿žçº¿çŠ¶æ€ï¼Œæˆ‘ä»¬æ”¶åˆ°æ¶ˆæ¯ä¹Ÿä¸å›žå¤ï¼š

```java
public class DisconnectedState implements State {
    public String init() {
        return "Bye!";
    }

    public String reply(String input) {
        return "";
    }
}
```

å¯¹äºŽå·²è¿žçº¿çŠ¶æ€ï¼Œæˆ‘ä»¬å›žåº”æ”¶åˆ°çš„æ¶ˆæ¯ï¼š

```java
public class ConnectedState implements State {
    public String init() {
        return "Hello, I'm Bob.";
    }

    public String reply(String input) {
        if (input.endsWith("?")) {
            return "Yes." + input.substring(0, input.length() - 1) + "!";
        }
        if (input.endsWith(".")) {
            return input.substring(0, input.length() - 1) + "!";
        }
        return input.substring(0, input.length() - 1) + "?";
    }
}
```

çŠ¶æ€æ¨¡å¼çš„å…³é”®è®¾è®¡æ€æƒ³åœ¨äºŽçŠ¶æ€åˆ‡æ¢ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ª `BotContext` å®ŒæˆçŠ¶æ€åˆ‡æ¢ï¼š

```java
public class BotContext {
	private State state = new DisconnectedState();

	public String chat(String input) {
		if ("hello".equalsIgnoreCase(input)) {
            // æ”¶åˆ° hello åˆ‡æ¢åˆ°åœ¨çº¿çŠ¶æ€:
			state = new ConnectedState();
			return state.init();
		} else if ("bye".equalsIgnoreCase(input)) {
            /  æ”¶åˆ° bye åˆ‡æ¢åˆ°ç¦»çº¿çŠ¶æ€:
			state = new DisconnectedState();
			return state.init();
		}
		return state.reply(input);
	}
}
```

è¿™æ ·ï¼Œä¸€ä¸ªä»·å€¼åƒä¸‡çš„ AI èŠå¤©æœºå™¨äººå°±è¯žç”Ÿäº†ï¼š

```java
Scanner scanner = new Scanner(System.in);
BotContext bot = new BotContext();
for (;;) {
    System.out.print(">");
    String input = scanner.nextLine();
    String output = bot.chat(input);
    System.out.println(output.isEmpty() ? "(no reply)" : "<" + output);
}
```

è¯•è¯•æ•ˆæžœï¼š

```
> hello
< Hello, I'm Bob.
> Nice to meet you.
< Nice to meet you!
> Today is cold?
< Yes. Today is cold!
> bye
< Bye!
```

## ðŸ€ ç»ƒä¹ 

æ–°å¢ž BusyState çŠ¶æ€è¡¨ç¤ºå¿™ç¢Œ

## ðŸ€ å°ç»“

çŠ¶æ€æ¨¡å¼çš„è®¾è®¡æ€æƒ³æ˜¯æŠŠä¸åŒçŠ¶æ€çš„é€»è¾‘åˆ†ç¦»åˆ°ä¸åŒçš„çŠ¶æ€ç±»ä¸­ï¼Œä»Žè€Œä½¿å¾—å¢žåŠ æ–°çŠ¶æ€æ›´å®¹æ˜“ï¼›

çŠ¶æ€æ¨¡å¼çš„å®žçŽ°å…³é”®åœ¨äºŽçŠ¶æ€è½¬æ¢ã€‚ç®€å•çš„çŠ¶æ€è½¬æ¢å¯ä»¥ç›´æŽ¥ç”±è°ƒç”¨æ–¹æŒ‡å®šï¼Œå¤æ‚çš„çŠ¶æ€è½¬æ¢å¯ä»¥åœ¨å†…éƒ¨æ ¹æ®æ¡ä»¶è§¦å‘å®Œæˆã€‚







