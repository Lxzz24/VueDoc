---
title: è®°å½•ç±»*
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

ä½¿ç”¨ `String`ã€`Integer` ç­‰ç±»å‹çš„æ—¶å€™ï¼Œè¿™äº›ç±»å‹éƒ½æ˜¯ä¸å˜ç±»ï¼Œä¸€ä¸ªä¸å˜ç±»å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. å®šä¹‰ `class` æ—¶ä½¿ç”¨ `final`ï¼Œæ— æ³•æ´¾ç”Ÿå­ç±»ï¼›
2. æ¯ä¸ªå­—æ®µä½¿ç”¨ `final`ï¼Œä¿è¯åˆ›å»ºå®ä¾‹åæ— æ³•ä¿®æ”¹ä»»ä½•å­—æ®µã€‚

å‡è®¾æˆ‘ä»¬å¸Œæœ›å®šä¹‰ä¸€ä¸ª `Point` ç±»ï¼Œæœ‰ `x`ã€`y` ä¸¤ä¸ªå˜é‡ï¼ŒåŒæ—¶å®ƒæ˜¯ä¸€ä¸ªä¸å˜ç±»ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š

```java
public final class Point {
    private final int x;
    private final int y;

    public Point(int x, int y) {
        this.x = x;
        this.y = y;
    }

    public int x() {
        return this.x;
    }

    public int y() {
        return this.y;
    }
}
```

ä¸ºäº†ä¿è¯ä¸å˜ç±»çš„æ¯”è¾ƒï¼Œè¿˜éœ€è¦æ­£ç¡®é‡å†™ `equals()` å’Œ `hashCode()` æ–¹æ³•ï¼Œè¿™æ ·æ‰èƒ½åœ¨é›†åˆç±»ä¸­æ­£å¸¸ä½¿ç”¨ã€‚åç»­æˆ‘ä»¬ä¼šè¯¦ç»†è®²è§£æ­£ç¡®é‡å†™ `equals()` å’Œ `hashCode()`ï¼Œè¿™é‡Œæ¼”ç¤º `Point` ä¸å˜ç±»çš„å†™æ³•ç›®çš„æ˜¯ï¼Œè¿™äº›ä»£ç å†™èµ·æ¥éƒ½éå¸¸ç®€å•ï¼Œä½†æ˜¯å¾ˆç¹çã€‚

## ğŸ€ record

ä» Java 14 å¼€å§‹ï¼Œå¼•å…¥äº†æ–°çš„ `Record` ç±»ã€‚æˆ‘ä»¬å®šä¹‰ `Record` ç±»æ—¶ï¼Œä½¿ç”¨å…³é”®å­— `record` ã€‚æŠŠä¸Šè¿° `Point` ç±»æ”¹å†™ä¸º `Record` ç±»ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
// Record
public class Main {
    public static void main(String[] args) {
        Point p = new Point(123, 456);
        System.out.println(p.x());
        System.out.println(p.y());
        System.out.println(p);
    }
}

public record Point(int x, int y) {}
```

ä»”ç»†è§‚å¯Ÿ `Point` çš„å®šä¹‰ï¼š

```java
public record Point(int x, int y) {}
```

æŠŠä¸Šè¿°å®šä¹‰æ”¹å†™ä¸º `class`ï¼Œç›¸å½“äºä»¥ä¸‹ä»£ç ï¼š

```java
public final class Point extends Record {
    private final int x;
    private final int y;

    public Point(int x, int y) {
        this.x = x;
        this.y = y;
    }

    public int x() {
        return this.x;
    }

    public int y() {
        return this.y;
    }

    public String toString() {
        return String.format("Point[x=%s, y=%s]", x, y);
    }

    public boolean equals(Object o) {
        ...
    }
    public int hashCode() {
        ...
    }
}
```

é™¤äº†ç”¨ `final` ä¿®é¥° `class` ä»¥åŠæ¯ä¸ªå­—æ®µå¤–ï¼Œç¼–è¯‘å™¨è¿˜è‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºäº†æ„é€ æ–¹æ³•ï¼Œå’Œå­—æ®µååŒåçš„æ–¹æ³•ï¼Œä»¥åŠé‡å†™ `toString()`ã€`equals()` å’Œ `hashCode()` æ–¹æ³•ã€‚

æ¢å¥è¯è¯´ï¼Œ**_ä½¿ç”¨ `record` å…³é”®å­—ï¼Œå¯ä»¥ä¸€è¡Œå†™å‡ºä¸€ä¸ªä¸å˜ç±»_** ã€‚

å’Œ `enum` ç±»ä¼¼ï¼Œæˆ‘ä»¬è‡ªå·±ä¸èƒ½ç›´æ¥ä» `Record` æ´¾ç”Ÿï¼Œåªèƒ½é€šè¿‡ `record` å…³é”®å­—ç”±ç¼–è¯‘å™¨å®ç°ç»§æ‰¿ã€‚

## ğŸ€ æ„é€ æ–¹æ³•

ç¼–è¯‘å™¨é»˜è®¤æŒ‰ç…§ `record` å£°æ˜çš„å˜é‡é¡ºåºè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œå¹¶åœ¨æ–¹æ³•å†…ç»™å­—æ®µèµ‹å€¼ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬è¦æ£€æŸ¥å‚æ•°ï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ

å‡è®¾ `Point` ç±»çš„ `x`ã€`y` ä¸å…è®¸è´Ÿæ•°ï¼Œæˆ‘ä»¬å°±å¾—ç»™ `Point` çš„æ„é€ æ–¹æ³•åŠ ä¸Šæ£€æŸ¥é€»è¾‘ï¼š

```java
public record Point(int x, int y) {
    public Point {
        if (x < 0 || y < 0) {
            throw new IllegalArgumentException();
        }
    }
}
```

æ³¨æ„åˆ°æ–¹æ³• `public Point {...}` è¢«ç§°ä¸º Compact Constructor ï¼Œå®ƒçš„ç›®çš„æ˜¯è®©æˆ‘ä»¬ç¼–å†™æ£€æŸ¥é€»è¾‘ï¼Œç¼–è¯‘å™¨æœ€ç»ˆç”Ÿæˆçš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š

```java
public final class Point extends Record {
    public Point(int x, int y) {
        // è¿™æ˜¯æˆ‘ä»¬ç¼–å†™çš„ Compact Constructor:
        if (x < 0 || y < 0) {
            throw new IllegalArgumentException();
        }
        // è¿™æ˜¯ç¼–è¯‘å™¨ç»§ç»­ç”Ÿæˆçš„èµ‹å€¼ä»£ç :
        this.x = x;
        this.y = y;
    }
    ...
}
```

ä½œä¸º `record` çš„ `Point` ä»ç„¶å¯ä»¥æ·»åŠ é™æ€æ–¹æ³•ã€‚ä¸€ç§å¸¸ç”¨çš„é™æ€æ–¹æ³•æ˜¯ `of()` æ–¹æ³•ï¼Œç”¨æ¥åˆ›å»º `Point` ï¼š

```java
public record Point(int x, int y) {
    public static Point of() {
        return new Point(0, 0);
    }
    public static Point of(int x, int y) {
        return new Point(x, y);
    }
}
```

è¿™æ ·æˆ‘ä»¬å¯ä»¥å†™å‡ºæ›´ç®€æ´çš„ä»£ç ï¼š

```java
var z = Point.of();
var p = Point.of(123, 456);
```

## ğŸ€ å°ç»“

ä» Java 14 å¼€å§‹ï¼Œæä¾›æ–°çš„ `record` å…³é”®å­—ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®šä¹‰ Data Classï¼š

- ä½¿ç”¨ `record` å®šä¹‰çš„æ˜¯ä¸å˜ç±»ï¼›
- å¯ä»¥ç¼–å†™ Compact Constructor å¯¹å‚æ•°è¿›è¡ŒéªŒè¯ï¼›
- å¯ä»¥å®šä¹‰é™æ€æ–¹æ³•ã€‚
