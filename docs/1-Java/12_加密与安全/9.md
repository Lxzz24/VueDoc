---
title: ç­¾åç®—æ³•
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

æˆ‘ä»¬ä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•çš„æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªå…¬é’¥ - ç§é’¥å¯¹ï¼Œé€šå¸¸æ˜¯ç”¨å…¬é’¥åŠ å¯†ï¼Œç§é’¥è§£å¯†ã€‚

å¦‚æœä½¿ç”¨ç§é’¥åŠ å¯†ï¼Œå…¬é’¥è§£å¯†æ˜¯å¦å¯è¡Œå‘¢ï¼Ÿå®é™…ä¸Šæ˜¯å®Œå…¨å¯è¡Œçš„ã€‚

ä¸è¿‡æˆ‘ä»¬å†ä»”ç»†æƒ³ä¸€æƒ³ï¼Œç§é’¥æ˜¯ä¿å¯†çš„ï¼Œè€Œå…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œç”¨ç§é’¥åŠ å¯†ï¼Œé‚£ç›¸å½“äºæ‰€æœ‰äººéƒ½å¯ä»¥ç”¨å…¬é’¥è§£å¯†ã€‚è¿™ä¸ªåŠ å¯†æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ

è¿™ä¸ªåŠ å¯†çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœå°æ˜ç”¨è‡ªå·±çš„ç§é’¥åŠ å¯†äº†ä¸€æ¡æ¶ˆæ¯ï¼Œæ¯”å¦‚ ` å°æ˜å–œæ¬¢å°çº¢ `ï¼Œç„¶åä»–å…¬å¼€äº†åŠ å¯†æ¶ˆæ¯ï¼Œç”±äºä»»ä½•äººéƒ½å¯ä»¥ç”¨å°æ˜çš„å…¬é’¥è§£å¯†ï¼Œä»è€Œä½¿å¾—ä»»ä½•äººéƒ½å¯ä»¥ç¡®è®¤ ` å°æ˜å–œæ¬¢å°çº¢ ` è¿™æ¡æ¶ˆæ¯è‚¯å®šæ˜¯å°æ˜å‘å‡ºçš„ï¼Œå…¶ä»–äººä¸èƒ½ä¼ªé€ è¿™ä¸ªæ¶ˆæ¯ï¼Œå°æ˜ä¹Ÿä¸èƒ½æŠµèµ–è¿™æ¡æ¶ˆæ¯ä¸æ˜¯è‡ªå·±å†™çš„ã€‚

å› æ­¤ï¼Œç§é’¥åŠ å¯†å¾—åˆ°çš„å¯†æ–‡å®é™…ä¸Šå°±æ˜¯æ•°å­—ç­¾åï¼Œè¦éªŒè¯è¿™ä¸ªç­¾åæ˜¯å¦æ­£ç¡®ï¼Œåªèƒ½ç”¨ç§é’¥æŒæœ‰è€…çš„å…¬é’¥è¿›è¡Œè§£å¯†éªŒè¯ã€‚ä½¿ç”¨æ•°å­—ç­¾åçš„ç›®çš„æ˜¯ä¸ºäº†ç¡®è®¤æŸä¸ªä¿¡æ¯ç¡®å®æ˜¯ç”±æŸä¸ªå‘é€æ–¹å‘é€çš„ï¼Œä»»ä½•äººéƒ½ä¸å¯èƒ½ä¼ªé€ æ¶ˆæ¯ï¼Œå¹¶ä¸”ï¼Œå‘é€æ–¹ä¹Ÿä¸èƒ½æŠµèµ–ã€‚

åœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œç­¾åå®é™…ä¸Šå¹¶ä¸æ˜¯é’ˆå¯¹åŸå§‹æ¶ˆæ¯ï¼Œè€Œæ˜¯é’ˆå¯¹åŸå§‹æ¶ˆæ¯çš„å“ˆå¸Œè¿›è¡Œç­¾åï¼Œå³ï¼š

```java
signature = encrypt(privateKey, sha256(message))
```

å¯¹ç­¾åè¿›è¡ŒéªŒè¯å®é™…ä¸Šå°±æ˜¯ç”¨å…¬é’¥è§£å¯†ï¼š

```java
hash = decrypt(publicKey, signature)
```

ç„¶åæŠŠè§£å¯†åçš„å“ˆå¸Œä¸åŸå§‹æ¶ˆæ¯çš„å“ˆå¸Œè¿›è¡Œå¯¹æ¯”ã€‚

å› ä¸ºç”¨æˆ·æ€»æ˜¯ä½¿ç”¨è‡ªå·±çš„ç§é’¥è¿›è¡Œç­¾åï¼Œæ‰€ä»¥ï¼Œç§é’¥å°±ç›¸å½“äºç”¨æˆ·èº«ä»½ã€‚è€Œå…¬é’¥ç”¨æ¥ç»™å¤–éƒ¨éªŒè¯ç”¨æˆ·èº«ä»½ã€‚

å¸¸ç”¨æ•°å­—ç­¾åç®—æ³•æœ‰ï¼š

- MD5withRSA
- SHA1withRSA
- SHA256withRSA

å®ƒä»¬å®é™…ä¸Šå°±æ˜¯æŒ‡å®šæŸç§å“ˆå¸Œç®—æ³•è¿›è¡Œ RSA ç­¾åçš„æ–¹å¼ã€‚

```java
import java.math.BigInteger;
import java.nio.charset.StandardCharsets;
import java.security.*;
public class Main {
    public static void main(String[] args) throws GeneralSecurityException {
        // ç”ŸæˆRSAå…¬é’¥/ç§é’¥:
        KeyPairGenerator kpGen = KeyPairGenerator.getInstance("RSA");
        kpGen.initialize(1024);
        KeyPair kp = kpGen.generateKeyPair();
        PrivateKey sk = kp.getPrivate();
        PublicKey pk = kp.getPublic();

        // å¾…ç­¾åçš„æ¶ˆæ¯:
        byte[] message = "Hello, I am Bob!".getBytes(StandardCharsets.UTF_8);

        // ç”¨ç§é’¥ç­¾å:
        Signature s = Signature.getInstance("SHA1withRSA");
        s.initSign(sk);
        s.update(message);
        byte[] signed = s.sign();
        System.out.println(String.format("signature: %x", new BigInteger(1, signed)));

        // ç”¨å…¬é’¥éªŒè¯:
        Signature v = Signature.getInstance("SHA1withRSA");
        v.initVerify(pk);
        v.update(message);
        boolean valid = v.verify(signed);
        System.out.println("valid? " + valid);
    }
}
```


ä½¿ç”¨å…¶ä»–å…¬é’¥ï¼Œæˆ–è€…éªŒè¯ç­¾åçš„æ—¶å€™ä¿®æ”¹åŸå§‹ä¿¡æ¯ï¼Œéƒ½æ— æ³•éªŒè¯æˆåŠŸã€‚

## ğŸ€ DSA ç­¾å

é™¤äº† RSA å¯ä»¥ç­¾åå¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ DSA ç®—æ³•è¿›è¡Œç­¾åã€‚DSA æ˜¯ Digital Signature Algorithm çš„ç¼©å†™ï¼Œå®ƒä½¿ç”¨ ElGamal æ•°å­—ç­¾åç®—æ³•ã€‚

DSA åªèƒ½é…åˆ SHA ä½¿ç”¨ï¼Œå¸¸ç”¨çš„ç®—æ³•æœ‰ï¼š

- SHA1withDSA
- SHA256withDSA
- SHA512withDSA

å’Œ RSA æ•°å­—ç­¾åç›¸æ¯”ï¼ŒDSA çš„ä¼˜ç‚¹æ˜¯æ›´å¿«ã€‚

## ğŸ€ ECDSA ç­¾å

æ¤­åœ†æ›²çº¿ç­¾åç®—æ³• ECDSAï¼šElliptic Curve Digital Signature Algorithm ä¹Ÿæ˜¯ä¸€ç§å¸¸ç”¨çš„ç­¾åç®—æ³•ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯å¯ä»¥ä»ç§é’¥æ¨å‡ºå…¬é’¥ã€‚æ¯”ç‰¹å¸çš„ç­¾åç®—æ³•å°±é‡‡ç”¨äº† ECDSA ç®—æ³•ï¼Œä½¿ç”¨æ ‡å‡†æ¤­åœ†æ›²çº¿ secp256k1ã€‚BouncyCastle æä¾›äº† ECDSA çš„å®Œæ•´å®ç°ã€‚

## ğŸ€ ç»ƒä¹ 

```java
package com.itranswarp.learnjava;

import java.math.BigInteger;
import java.nio.charset.StandardCharsets;
import java.security.*;

public class Main {
	public static void main(String[] args) throws GeneralSecurityException {
		// ç”ŸæˆRSAå…¬é’¥/ç§é’¥:
		KeyPairGenerator kpGen = KeyPairGenerator.getInstance("RSA");
		kpGen.initialize(1024);
		KeyPair kp = kpGen.generateKeyPair();
		PrivateKey sk = kp.getPrivate();
		PublicKey pk = kp.getPublic();

		// å¾…ç­¾åçš„æ¶ˆæ¯:
		byte[] message = "Hello, I am Bob!".getBytes(StandardCharsets.UTF_8);

		// ç”¨ç§é’¥ç­¾å:
		Signature s = Signature.getInstance("SHA1withRSA");
		s.initSign(sk);
		s.update(message);
		byte[] signed = s.sign();
		System.out.println(String.format("signature: %x", new BigInteger(1, signed)));

		// ç”¨å…¬é’¥éªŒè¯:
		Signature v = Signature.getInstance("SHA1withRSA");
		v.initVerify(pk);
		v.update(message);
		boolean valid = v.verify(signed);
		System.out.println("valid? " + valid);
	}
}
```

## ğŸ€ å°ç»“

æ•°å­—ç­¾åå°±æ˜¯ç”¨å‘é€æ–¹çš„ç§é’¥å¯¹åŸå§‹æ•°æ®è¿›è¡Œç­¾åï¼Œåªæœ‰ç”¨å‘é€æ–¹å…¬é’¥æ‰èƒ½é€šè¿‡ç­¾åéªŒè¯ã€‚

æ•°å­—ç­¾åç”¨äºï¼š

- é˜²æ­¢ä¼ªé€ ï¼›
- é˜²æ­¢æŠµèµ–ï¼›
- æ£€æµ‹ç¯¡æ”¹ã€‚

å¸¸ç”¨çš„æ•°å­—ç­¾åç®—æ³•åŒ…æ‹¬ï¼šMD5withRSAï¼SHA1withRSAï¼SHA256withRSAï¼SHA1withDSAï¼SHA256withDSAï¼SHA512withDSAï¼ECDSA ç­‰ã€‚

