---
title: ä½¿ç”¨ Stack
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::


æ ˆï¼ˆStackï¼‰æ˜¯ä¸€ç§åè¿›å…ˆå‡ºï¼ˆLIFOï¼šLast In First Outï¼‰çš„æ•°æ®ç»“æ„ã€‚

ä»€ä¹ˆæ˜¯ LIFO å‘¢ï¼Ÿæˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ Queue çš„ç‰¹ç‚¹ FIFOï¼š

![20221123092327](assets/20221123092327.png)

æ‰€è°“ FIFOï¼Œæ˜¯æœ€å…ˆè¿›é˜Ÿåˆ—çš„å…ƒç´ ä¸€å®šæœ€æ—©å‡ºé˜Ÿåˆ—ï¼Œè€Œ LIFO æ˜¯æœ€åè¿› Stack çš„å…ƒç´ ä¸€å®šæœ€æ—©å‡º Stackã€‚å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿåªéœ€è¦æŠŠé˜Ÿåˆ—çš„ä¸€ç«¯å°æ­»ï¼š

![20221123092345](assets/20221123092345.png)

å› æ­¤ï¼ŒStack æ˜¯è¿™æ ·ä¸€ç§æ•°æ®ç»“æ„ï¼šåªèƒ½ä¸æ–­åœ°å¾€ Stack ä¸­å‹å…¥ï¼ˆpushï¼‰å…ƒç´ ï¼Œæœ€åè¿›å»çš„å¿…é¡»æœ€æ—©å¼¹å‡ºï¼ˆpopï¼‰æ¥ï¼š

![donuts-stack](assets/donuts-stack.png)

Stack åªæœ‰å…¥æ ˆå’Œå‡ºæ ˆçš„æ“ä½œï¼š

- æŠŠå…ƒç´ å‹æ ˆï¼špush(E)ï¼›
- æŠŠæ ˆé¡¶çš„å…ƒç´  â€œå¼¹å‡ºâ€ï¼špop()ï¼›
- å–æ ˆé¡¶å…ƒç´ ä½†ä¸å¼¹å‡ºï¼špeek()ã€‚


åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ç”¨ Deque å¯ä»¥å®ç° Stack çš„åŠŸèƒ½ï¼š

- æŠŠå…ƒç´ å‹æ ˆï¼špush(E)/addFirst(E)ï¼›
- æŠŠæ ˆé¡¶çš„å…ƒç´  â€œå¼¹å‡ºâ€ï¼špop()/removeFirst()ï¼›
- å–æ ˆé¡¶å…ƒç´ ä½†ä¸å¼¹å‡ºï¼špeek()/peekFirst()ã€‚


ä¸ºä»€ä¹ˆ Java çš„é›†åˆç±»æ²¡æœ‰å•ç‹¬çš„ Stack æ¥å£å‘¢ï¼Ÿå› ä¸ºæœ‰ä¸ªé—ç•™ç±»åå­—å°±å« Stackï¼Œå‡ºäºå…¼å®¹æ€§è€ƒè™‘ï¼Œæ‰€ä»¥æ²¡åŠæ³•åˆ›å»º Stack æ¥å£ï¼Œåªèƒ½ç”¨ Deque æ¥å£æ¥ â€œæ¨¡æ‹Ÿâ€ ä¸€ä¸ª Stack äº†ã€‚

å½“æˆ‘ä»¬æŠŠ Deque ä½œä¸º Stack ä½¿ç”¨æ—¶ï¼Œæ³¨æ„åªè°ƒç”¨ push()/pop()/peek() æ–¹æ³•ï¼Œä¸è¦è°ƒç”¨ addFirst()/removeFirst()/peekFirst() æ–¹æ³•ï¼Œè¿™æ ·ä»£ç æ›´åŠ æ¸…æ™°ã€‚



## ğŸ€ Stack çš„ä½œç”¨

Stack åœ¨è®¡ç®—æœºä¸­ä½¿ç”¨éå¸¸å¹¿æ³›ï¼ŒJVM åœ¨å¤„ç† Java æ–¹æ³•è°ƒç”¨çš„æ—¶å€™å°±ä¼šé€šè¿‡æ ˆè¿™ç§æ•°æ®ç»“æ„ç»´æŠ¤æ–¹æ³•è°ƒç”¨çš„å±‚æ¬¡ã€‚ä¾‹å¦‚ï¼š

```java
static void main(String[] args) {
    foo(123);
}

static String foo(x) {
    return "F-" + bar(x + 1);
}

static int bar(int x) {
    return x << 2;
}
```


JVM ä¼šåˆ›å»ºæ–¹æ³•è°ƒç”¨æ ˆï¼Œæ¯è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œå…ˆå°†å‚æ•°å‹æ ˆï¼Œç„¶åæ‰§è¡Œå¯¹åº”çš„æ–¹æ³•ï¼›å½“æ–¹æ³•è¿”å›æ—¶ï¼Œè¿”å›å€¼å‹æ ˆï¼Œè°ƒç”¨æ–¹æ³•é€šè¿‡å‡ºæ ˆæ“ä½œè·å¾—æ–¹æ³•è¿”å›å€¼ã€‚

å› ä¸ºæ–¹æ³•è°ƒç”¨æ ˆæœ‰å®¹é‡é™åˆ¶ï¼ŒåµŒå¥—è°ƒç”¨è¿‡å¤šä¼šé€ æˆæ ˆæº¢å‡ºï¼Œå³å¼•å‘ StackOverflowErrorï¼š

```java
// æµ‹è¯•æ— é™é€’å½’è°ƒç”¨
public class Main {
    public static void main(String[] args) {
        increase(1);
    }

    static int increase(int x) {
        return increase(x) + 1;
    }
}
```

æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ª Stack çš„ç”¨é€”ï¼šå¯¹æ•´æ•°è¿›è¡Œè¿›åˆ¶çš„è½¬æ¢å°±å¯ä»¥åˆ©ç”¨æ ˆã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦æŠŠä¸€ä¸ª int æ•´æ•° 12500 è½¬æ¢ä¸ºåå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼Œå¦‚ä½•å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Ÿ

é¦–å…ˆæˆ‘ä»¬å‡†å¤‡ä¸€ä¸ªç©ºæ ˆï¼š

![20221123092537](assets/20221123092537.png)

ç„¶åè®¡ç®— $12500 Ã· 16 = 781 â€¦ 4$ï¼Œä½™æ•°æ˜¯ 4ï¼ŒæŠŠä½™æ•° 4 å‹æ ˆï¼š

![20221123092553](assets/20221123092553.png)

ç„¶åè®¡ç®— $781 Ã· 16 = 48 â€¦ 13$ï¼Œä½™æ•°æ˜¯ 13ï¼Œ13 çš„åå…­è¿›åˆ¶ç”¨å­—æ¯ D è¡¨ç¤ºï¼ŒæŠŠä½™æ•° D å‹æ ˆï¼š

![20221123092610](assets/20221123092610.png)

ç„¶åè®¡ç®— $48 Ã· 16 = 3 â€¦ 0$ï¼Œä½™æ•°æ˜¯ 0ï¼ŒæŠŠä½™æ•° 0 å‹æ ˆï¼š

![20221123092625](assets/20221123092625.png)

æœ€åè®¡ç®— $3 Ã· 16 = 0 â€¦ 3$ï¼Œä½™æ•°æ˜¯ 3ï¼ŒæŠŠä½™æ•° 3 å‹æ ˆï¼š

![20221123092644](assets/20221123092644.png)

å½“å•†æ˜¯ 0 çš„æ—¶å€™ï¼Œè®¡ç®—ç»“æŸï¼Œæˆ‘ä»¬æŠŠæ ˆçš„æ‰€æœ‰å…ƒç´ ä¾æ¬¡å¼¹å‡ºï¼Œç»„æˆå­—ç¬¦ä¸² 30D4ï¼Œè¿™å°±æ˜¯åè¿›åˆ¶æ•´æ•° 12500 çš„åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²ã€‚


## ğŸ€ è®¡ç®—ä¸­ç¼€è¡¨è¾¾å¼

åœ¨ç¼–å†™ç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å¸¦æ‹¬å·çš„æ•°å­¦è¡¨è¾¾å¼å®é™…ä¸Šæ˜¯ä¸­ç¼€è¡¨è¾¾å¼ï¼Œå³è¿ç®—ç¬¦åœ¨ä¸­é—´ï¼Œä¾‹å¦‚ï¼š $1 + 2 * (9 - 5)$ ã€‚

ä½†æ˜¯è®¡ç®—æœºæ‰§è¡Œè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œå®ƒå¹¶ä¸èƒ½ç›´æ¥è®¡ç®—ä¸­ç¼€è¡¨è¾¾å¼ï¼Œè€Œæ˜¯é€šè¿‡ç¼–è¯‘å™¨æŠŠä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢ä¸ºåç¼€è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼š `1 2 9 5 - * +` ã€‚

è¿™ä¸ªç¼–è¯‘è¿‡ç¨‹å°±ä¼šç”¨åˆ°æ ˆã€‚æˆ‘ä»¬å…ˆè·³è¿‡ç¼–è¯‘è¿™ä¸€æ­¥ï¼ˆæ¶‰åŠè¿ç®—ä¼˜å…ˆçº§ï¼Œä»£ç æ¯”è¾ƒå¤æ‚ï¼‰ï¼Œçœ‹çœ‹å¦‚ä½•é€šè¿‡æ ˆè®¡ç®—åç¼€è¡¨è¾¾å¼ã€‚

è®¡ç®—åç¼€è¡¨è¾¾å¼ä¸è€ƒè™‘ä¼˜å…ˆçº§ï¼Œç›´æ¥ä»å·¦åˆ°å³ä¾æ¬¡è®¡ç®—ï¼Œå› æ­¤è®¡ç®—èµ·æ¥ç®€å•ã€‚é¦–å…ˆå‡†å¤‡ä¸€ä¸ªç©ºçš„æ ˆï¼š

![20221123092537](assets/20221123092537.png)

ç„¶åæˆ‘ä»¬ä¾æ¬¡æ‰«æåç¼€è¡¨è¾¾å¼ 1 2 9 5 - * +ï¼Œé‡åˆ°æ•°å­— 1ï¼Œå°±ç›´æ¥æ‰”åˆ°æ ˆé‡Œï¼š

![20221123092955](assets/20221123092955.png)

ç´§æ¥ç€ï¼Œé‡åˆ°æ•°å­— 2ï¼Œ9ï¼Œ5ï¼Œä¹Ÿæ‰”åˆ°æ ˆé‡Œï¼š

![20221123093015](assets/20221123093015.png)

æ¥ä¸‹æ¥é‡åˆ°å‡å·æ—¶ï¼Œå¼¹å‡ºæ ˆé¡¶çš„ä¸¤ä¸ªå…ƒç´ ï¼Œå¹¶è®¡ç®— $9-5=4$ï¼ŒæŠŠç»“æœ 4 å‹æ ˆï¼š

![20221123093037](assets/20221123093037.png)

æ¥ä¸‹æ¥é‡åˆ° * å·æ—¶ï¼Œå¼¹å‡ºæ ˆé¡¶çš„ä¸¤ä¸ªå…ƒç´ ï¼Œå¹¶è®¡ç®— $2*4=8$ï¼ŒæŠŠç»“æœ 8 å‹æ ˆï¼š

![20221123093057](assets/20221123093057.png)

æ¥ä¸‹æ¥é‡åˆ° + å·æ—¶ï¼Œå¼¹å‡ºæ ˆé¡¶çš„ä¸¤ä¸ªå…ƒç´ ï¼Œå¹¶è®¡ç®— $1+8=9$ï¼ŒæŠŠç»“æœ 9 å‹æ ˆï¼š

![20221123093112](assets/20221123093112.png)

æ‰«æç»“æŸåï¼Œæ²¡æœ‰æ›´å¤šçš„è®¡ç®—äº†ï¼Œå¼¹å‡ºæ ˆçš„å”¯ä¸€ä¸€ä¸ªå…ƒç´ ï¼Œå¾—åˆ°è®¡ç®—ç»“æœ 9ã€‚


## ğŸ€ ç»ƒä¹ 

è¯·åˆ©ç”¨ Stack æŠŠä¸€ä¸ªç»™å®šçš„æ•´æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼š

```java
// è½¬åå…­è¿›åˆ¶
import java.util.*;

public class Main {
    public static void main(String[] args) {
        String hex = toHex(12500);
        if (hex.equalsIgnoreCase("30D4")) {
            System.out.println("æµ‹è¯•é€šè¿‡");
        } else {
            System.out.println("æµ‹è¯•å¤±è´¥");
        }
    }

    static String toHex(int n) {
        return "";
    }
}
```

è¿›é˜¶ç»ƒä¹ ï¼š

è¯·åˆ©ç”¨ Stack æŠŠå­—ç¬¦ä¸²ä¸­ç¼€è¡¨è¾¾å¼ç¼–è¯‘ä¸ºåç¼€è¡¨è¾¾å¼ï¼Œç„¶åå†åˆ©ç”¨æ ˆæ‰§è¡Œåç¼€è¡¨è¾¾å¼è·å¾—è®¡ç®—ç»“æœï¼š

```java
// é«˜éš¾åº¦ç»ƒä¹ ï¼Œæ…é‡é€‰æ‹©ï¼
import java.util.*;

public class Main {
    public static void main(String[] args) {
        String exp = "1 + 2 * (9 - 5)";
        SuffixExpression se = compile(exp);
        int result = se.execute();
        System.out.println(exp + " = " + result + " " + (result == 1 + 2 * (9 - 5) ? "âœ“" : "âœ—"));
    }

    static SuffixExpression compile(String exp) {
        // TODO:
        return new SuffixExpression();
    }
}

class SuffixExpression {
    int execute() {
        // TODO:
        return 0;
    }
}
```


è¿›é˜¶ç»ƒä¹  2ï¼š

è¯·æŠŠå¸¦å˜é‡çš„ä¸­ç¼€è¡¨è¾¾å¼ç¼–è¯‘ä¸ºåç¼€è¡¨è¾¾å¼ï¼Œæ‰§è¡Œåç¼€è¡¨è¾¾å¼æ—¶ï¼Œä¼ å…¥å˜é‡çš„å€¼å¹¶è·å¾—è®¡ç®—ç»“æœï¼š

```java
// è¶…é«˜éš¾åº¦ç»ƒä¹ ï¼Œæ…é‡é€‰æ‹©ï¼
import java.util.*;

public class Main {
    public static void main(String[] args) {
        String exp = "x + 2 * (y - 5)";
        SuffixExpression se = compile(exp);
        Map<String, Integer> env = Map.of("x", 1, "y", 9);
        int result = se.execute(env);
        System.out.println(exp + " = " + result + " " + (result == 1 + 2 * (9 - 5) ? "âœ“" : "âœ—"));
    }

    static SuffixExpression compile(String exp) {
        // TODO:
        return new SuffixExpression();
    }
}

class SuffixExpression {
    int execute(Map<String, Integer> env) {
        // TODO:
        return 0;
    }
}
```


## ğŸ€ å°ç»“

1. æ ˆï¼ˆStackï¼‰æ˜¯ä¸€ç§åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰çš„æ•°æ®ç»“æ„ï¼Œæ“ä½œæ ˆçš„å…ƒç´ çš„æ–¹æ³•æœ‰ï¼š

- æŠŠå…ƒç´ å‹æ ˆï¼špush(E)ï¼›
- æŠŠæ ˆé¡¶çš„å…ƒç´  â€œå¼¹å‡ºâ€ï¼špop(E)ï¼›
- å–æ ˆé¡¶å…ƒç´ ä½†ä¸å¼¹å‡ºï¼špeek(E)ã€‚

2. åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ç”¨ Deque å¯ä»¥å®ç° Stack çš„åŠŸèƒ½ï¼Œæ³¨æ„åªè°ƒç”¨ push()/pop()/peek() æ–¹æ³•ï¼Œé¿å…è°ƒç”¨ Deque çš„å…¶ä»–æ–¹æ³•ã€‚

3. æœ€åï¼Œä¸è¦ä½¿ç”¨é—ç•™ç±» Stackã€‚

