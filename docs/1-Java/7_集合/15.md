---
title: ä½¿ç”¨ Collections
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::


Collections æ˜¯ JDK æä¾›çš„å·¥å…·ç±»ï¼ŒåŒæ ·ä½äº `java.util` åŒ…ä¸­ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—é™æ€æ–¹æ³•ï¼Œèƒ½æ›´æ–¹ä¾¿åœ°æ“ä½œå„ç§é›†åˆã€‚

> [!caution]
> æ³¨æ„ Collections ç»“å°¾å¤šäº†ä¸€ä¸ª sï¼Œä¸æ˜¯ Collectionï¼


æˆ‘ä»¬ä¸€èˆ¬çœ‹æ–¹æ³•åå’Œå‚æ•°å°±å¯ä»¥ç¡®è®¤ Collections æä¾›çš„è¯¥æ–¹æ³•çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä»¥ä¸‹é™æ€æ–¹æ³•ï¼š

```java
public static boolean addAll(Collection<? super T> c, T... elements) { ... }
```

`addAll()` æ–¹æ³•å¯ä»¥ç»™ä¸€ä¸ª Collection ç±»å‹çš„é›†åˆæ·»åŠ è‹¥å¹²å…ƒç´ ã€‚å› ä¸ºæ–¹æ³•ç­¾åæ˜¯ Collectionï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥ Listï¼ŒSet ç­‰å„ç§é›†åˆç±»å‹ã€‚


## ğŸ€ åˆ›å»ºç©ºé›†åˆ

Collections æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥åˆ›å»ºç©ºé›†åˆï¼š

- åˆ›å»ºç©º Listï¼š`List<T> emptyList()`
- åˆ›å»ºç©º Mapï¼š`Map<K, V> emptyMap()`
- åˆ›å»ºç©º Setï¼š`Set<T> emptySet()`

è¦æ³¨æ„åˆ°è¿”å›çš„ç©ºé›†åˆæ˜¯ä¸å¯å˜é›†åˆï¼Œæ— æ³•å‘å…¶ä¸­æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚

æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨å„ä¸ªé›†åˆæ¥å£æä¾›çš„ `of(T...)` æ–¹æ³•åˆ›å»ºç©ºé›†åˆã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹åˆ›å»ºç©º List çš„ä¸¤ä¸ªæ–¹æ³•æ˜¯ç­‰ä»·çš„ï¼š

```java
List<String> list1 = List.of();
List<String> list2 = Collections.emptyList();
```


## ğŸ€ åˆ›å»ºå•å…ƒç´ é›†åˆ

Collections æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå•å…ƒç´ é›†åˆï¼š

- åˆ›å»ºä¸€ä¸ªå…ƒç´ çš„ Listï¼š`List<T> singletonList(T o)`
- åˆ›å»ºä¸€ä¸ªå…ƒç´ çš„ Mapï¼š`Map<K, V> singletonMap(K key, V value)`
- åˆ›å»ºä¸€ä¸ªå…ƒç´ çš„ Setï¼š`Set<T> singleton(T o)`


è¦æ³¨æ„åˆ°è¿”å›çš„å•å…ƒç´ é›†åˆä¹Ÿæ˜¯ä¸å¯å˜é›†åˆï¼Œæ— æ³•å‘å…¶ä¸­æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚

æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨å„ä¸ªé›†åˆæ¥å£æä¾›çš„ `of(T...)` æ–¹æ³•åˆ›å»ºå•å…ƒç´ é›†åˆã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹åˆ›å»ºå•å…ƒç´  List çš„ä¸¤ä¸ªæ–¹æ³•æ˜¯ç­‰ä»·çš„ï¼š


```java
List<String> list1 = List.of("apple");
List<String> list2 = Collections.singletonList("apple");
```


å®é™…ä¸Šï¼Œä½¿ç”¨ `List.of(T...)` æ›´æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒæ—¢å¯ä»¥åˆ›å»ºç©ºé›†åˆï¼Œä¹Ÿå¯ä»¥åˆ›å»ºå•å…ƒç´ é›†åˆï¼Œè¿˜å¯ä»¥åˆ›å»ºä»»æ„ä¸ªå…ƒç´ çš„é›†åˆï¼š

```java
List<String> list1 = List.of(); // empty list
List<String> list2 = List.of("apple"); // 1 element
List<String> list3 = List.of("apple", "pear"); // 2 elements
List<String> list4 = List.of("apple", "pear", "orange"); // 3 elements
```


## ğŸ€ æ’åº

Collections å¯ä»¥å¯¹ List è¿›è¡Œæ’åºã€‚å› ä¸ºæ’åºä¼šç›´æ¥ä¿®æ”¹ List å…ƒç´ çš„ä½ç½®ï¼Œå› æ­¤å¿…é¡»ä¼ å…¥å¯å˜ Listï¼š


```java
import java.util.*;

public class Main {
    public static void main(String[] args) {
        List<String> list = new ArrayList<>();
        list.add("apple");
        list.add("pear");
        list.add("orange");
        // æ’åºå‰:
        System.out.println(list);
        Collections.sort(list);
        // æ’åºå:
        System.out.println(list);
    }
}
```



## ğŸ€ æ´—ç‰Œ

Collections æä¾›äº†æ´—ç‰Œç®—æ³•ï¼Œå³ä¼ å…¥ä¸€ä¸ªæœ‰åºçš„ Listï¼Œå¯ä»¥éšæœºæ‰“ä¹± List å†…éƒ¨å…ƒç´ çš„é¡ºåºï¼Œæ•ˆæœç›¸å½“äºè®©è®¡ç®—æœºæ´—ç‰Œï¼š

```java
import java.util.*;

public class Main {
    public static void main(String[] args) {
        List<Integer> list = new ArrayList<>();
        for (int i=0; i<10; i++) {
            list.add(i);
        }
        // æ´—ç‰Œå‰:
        System.out.println(list);
        Collections.shuffle(list);
        // æ´—ç‰Œå:
        System.out.println(list);
    }
}
```


## ğŸ€ ä¸å¯å˜é›†åˆ

Collections è¿˜æä¾›äº†ä¸€ç»„æ–¹æ³•æŠŠå¯å˜é›†åˆå°è£…æˆä¸å¯å˜é›†åˆï¼š

- å°è£…æˆä¸å¯å˜ Listï¼š`List<T> unmodifiableList(List<? extends T> list)`
- å°è£…æˆä¸å¯å˜ Setï¼š`Set<T> unmodifiableSet(Set<? extends T> set)`
- å°è£…æˆä¸å¯å˜ Mapï¼š`Map<K, V> unmodifiableMap(Map<? extends K, ? extends V> m)`

è¿™ç§å°è£…å®é™…ä¸Šæ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œæ‹¦æˆªæ‰æ‰€æœ‰ä¿®æ”¹æ–¹æ³•å®ç°çš„ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹æ•ˆæœï¼š

```java
import java.util.*;

public class Main {
    public static void main(String[] args) {
        List<String> mutable = new ArrayList<>();
        mutable.add("apple");
        mutable.add("pear");
        // å˜ä¸ºä¸å¯å˜é›†åˆ:
        List<String> immutable = Collections.unmodifiableList(mutable);
        immutable.add("orange"); // UnsupportedOperationException!
    }
}
```


ç„¶è€Œï¼Œç»§ç»­å¯¹åŸå§‹çš„å¯å˜ List è¿›è¡Œå¢åˆ æ˜¯å¯ä»¥çš„ï¼Œå¹¶ä¸”ï¼Œä¼šç›´æ¥å½±å“åˆ°å°è£…åçš„ â€œä¸å¯å˜â€ Listï¼š

```java
import java.util.*;

public class Main {
    public static void main(String[] args) {
        List<String> mutable = new ArrayList<>();
        mutable.add("apple");
        mutable.add("pear");
        // å˜ä¸ºä¸å¯å˜é›†åˆ:
        List<String> immutable = Collections.unmodifiableList(mutable);
        mutable.add("orange");
        System.out.println(immutable);
    }
}
```


å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›æŠŠä¸€ä¸ªå¯å˜ List å°è£…æˆä¸å¯å˜ Listï¼Œé‚£ä¹ˆï¼Œè¿”å›ä¸å¯å˜ List åï¼Œæœ€å¥½ç«‹åˆ»æ‰”æ‰å¯å˜ List çš„å¼•ç”¨ï¼Œè¿™æ ·å¯ä»¥ä¿è¯åç»­æ“ä½œä¸ä¼šæ„å¤–æ”¹å˜åŸå§‹å¯¹è±¡ï¼Œä»è€Œé€ æˆ â€œä¸å¯å˜â€ List å˜åŒ–äº†ï¼š

```java
import java.util.*;

public class Main {
    public static void main(String[] args) {
        List<String> mutable = new ArrayList<>();
        mutable.add("apple");
        mutable.add("pear");
        // å˜ä¸ºä¸å¯å˜é›†åˆ:
        List<String> immutable = Collections.unmodifiableList(mutable);
        // ç«‹åˆ»æ‰”æ‰mutableçš„å¼•ç”¨:
        mutable = null;
        System.out.println(immutable);
    }
}
```


## ğŸ€ çº¿ç¨‹å®‰å…¨é›†åˆ

Collections è¿˜æä¾›äº†ä¸€ç»„æ–¹æ³•ï¼Œå¯ä»¥æŠŠçº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆå˜ä¸ºçº¿ç¨‹å®‰å…¨çš„é›†åˆï¼š

- å˜ä¸ºçº¿ç¨‹å®‰å…¨çš„ Listï¼š`List<T> synchronizedList(List<T> list)`
- å˜ä¸ºçº¿ç¨‹å®‰å…¨çš„ Setï¼š`Set<T> synchronizedSet(Set<T> s)`
- å˜ä¸ºçº¿ç¨‹å®‰å…¨çš„ Mapï¼š`Map<K,V> synchronizedMap(Map<K,V> m)`

å¤šçº¿ç¨‹çš„æ¦‚å¿µæˆ‘ä»¬ä¼šåœ¨åé¢è®²ã€‚å› ä¸ºä» Java 5 å¼€å§‹ï¼Œå¼•å…¥äº†æ›´é«˜æ•ˆçš„å¹¶å‘é›†åˆç±»ï¼Œæ‰€ä»¥ä¸Šè¿°è¿™å‡ ä¸ªåŒæ­¥æ–¹æ³•å·²ç»æ²¡æœ‰ä»€ä¹ˆç”¨äº†ã€‚


## ğŸ€ å°ç»“

Collections ç±»æä¾›äº†ä¸€ç»„å·¥å…·æ–¹æ³•æ¥æ–¹ä¾¿ä½¿ç”¨é›†åˆç±»ï¼š

- åˆ›å»ºç©ºé›†åˆï¼›
- åˆ›å»ºå•å…ƒç´ é›†åˆï¼›
- åˆ›å»ºä¸å¯å˜é›†åˆï¼›
- æ’åºï¼æ´—ç‰Œç­‰æ“ä½œã€‚



