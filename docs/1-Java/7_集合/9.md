---
title: ä½¿ç”¨ Set
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

æˆ‘ä»¬çŸ¥é“ï¼Œ`Map` ç”¨äºå­˜å‚¨ key-value çš„æ˜ å°„ï¼Œå¯¹äºå……å½“ key çš„å¯¹è±¡ï¼Œæ˜¯ä¸èƒ½é‡å¤çš„ï¼Œå¹¶ä¸”ï¼Œä¸ä½†éœ€è¦æ­£ç¡®è¦†å†™ `equals()` æ–¹æ³•ï¼Œè¿˜è¦æ­£ç¡®è¦†å†™ `hashCode()` æ–¹æ³•ã€‚

å¦‚æœæˆ‘ä»¬åªéœ€è¦å­˜å‚¨ä¸é‡å¤çš„ key ï¼Œå¹¶ä¸éœ€è¦å­˜å‚¨æ˜ å°„çš„ valueï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ `Set` ã€‚

`Set` ç”¨äºå­˜å‚¨ä¸é‡å¤çš„å…ƒç´ é›†åˆï¼Œå®ƒä¸»è¦æä¾›ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š

- å°†å…ƒç´ æ·»åŠ è¿› `Set<E>` ï¼š `boolean add(E e)`
- å°†å…ƒç´ ä» `Set<E>` åˆ é™¤ï¼š `boolean remove(Object e)`
- åˆ¤æ–­æ˜¯å¦åŒ…å«å…ƒç´ ï¼š `boolean contains(Object e)`

æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªç®€å•çš„ä¾‹å­ï¼š

```java
import java.util.*;

public class Main {
    public static void main(String[] args) {
        Set<String> set = new HashSet<>();
        System.out.println(set.add("abc")); // true
        System.out.println(set.add("xyz")); // true
        System.out.println(set.add("xyz")); // falseï¼Œæ·»åŠ å¤±è´¥ï¼Œå› ä¸ºå…ƒç´ å·²å­˜åœ¨
        System.out.println(set.contains("xyz")); // trueï¼Œå…ƒç´ å­˜åœ¨
        System.out.println(set.contains("XYZ")); // falseï¼Œå…ƒç´ ä¸å­˜åœ¨
        System.out.println(set.remove("hello")); // falseï¼Œåˆ é™¤å¤±è´¥ï¼Œå› ä¸ºå…ƒç´ ä¸å­˜åœ¨
        System.out.println(set.size()); // 2ï¼Œä¸€å…±ä¸¤ä¸ªå…ƒç´ 
    }
}
```

`Set` å®é™…ä¸Šç›¸å½“äºåªå­˜å‚¨ key ã€ä¸å­˜å‚¨ value çš„ `Map` ã€‚æˆ‘ä»¬ç»å¸¸ç”¨ `Set` ç”¨äºå»é™¤é‡å¤å…ƒç´ ã€‚

å› ä¸ºæ”¾å…¥ `Set` çš„å…ƒç´ å’Œ `Map` çš„ key ç±»ä¼¼ï¼Œéƒ½è¦æ­£ç¡®å®ç° `equals()` å’Œ `hashCode()` æ–¹æ³•ï¼Œå¦åˆ™è¯¥å…ƒç´ æ— æ³•æ­£ç¡®åœ°æ”¾å…¥ `Set` ã€‚

æœ€å¸¸ç”¨çš„ `Set` å®ç°ç±»æ˜¯ `HashSet`ï¼Œå®é™…ä¸Šï¼Œ`HashSet` ä»…ä»…æ˜¯å¯¹ `HashMap` çš„ä¸€ä¸ªç®€å•å°è£…ï¼Œå®ƒçš„æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š

```java
public class HashSet<E> implements Set<E> {
    // æŒæœ‰ä¸€ä¸ª HashMap:
    private HashMap<E, Object> map = new HashMap<>();

    // æ”¾å…¥ HashMap çš„ value:
    private static final Object PRESENT = new Object();

    public boolean add(E e) {
        return map.put(e, PRESENT) == null;
    }

    public boolean contains(Object o) {
        return map.containsKey(o);
    }

    public boolean remove(Object o) {
        return map.remove(o) == PRESENT;
    }
}
```

`Set` æ¥å£å¹¶ä¸ä¿è¯æœ‰åºï¼Œè€Œ `SortedSet` æ¥å£åˆ™ä¿è¯å…ƒç´ æ˜¯æœ‰åºçš„ï¼š

- `HashSet` æ˜¯æ— åºçš„ï¼Œå› ä¸ºå®ƒå®ç°äº† `Set` æ¥å£ï¼Œå¹¶æ²¡æœ‰å®ç° `SortedSet` æ¥å£ï¼›
- `TreeSet` æ˜¯æœ‰åºçš„ï¼Œå› ä¸ºå®ƒå®ç°äº† `SortedSet` æ¥å£ã€‚

ç”¨ä¸€å¼ å›¾è¡¨ç¤ºï¼š

![20221122162710](assets/20221122162710.png)

æˆ‘ä»¬æ¥çœ‹ `HashSet` çš„è¾“å‡ºï¼š

```java
import java.util.*;
public class Main {
    public static void main(String[] args) {
        Set<String> set = new HashSet<>();
        set.add("apple");
        set.add("banana");
        set.add("pear");
        set.add("orange");
        for (String s : set) {
            System.out.println(s);
        }
    }
}
```

æ³¨æ„è¾“å‡ºçš„é¡ºåºæ—¢ä¸æ˜¯æ·»åŠ çš„é¡ºåºï¼Œä¹Ÿä¸æ˜¯ `String` æ’åºçš„é¡ºåºï¼Œåœ¨ä¸åŒç‰ˆæœ¬çš„ JDK ä¸­ï¼Œè¿™ä¸ªé¡ºåºä¹Ÿå¯èƒ½æ˜¯ä¸åŒçš„ã€‚

æŠŠ `HashSet` æ¢æˆ `TreeSet`ï¼Œåœ¨éå† `TreeSet` æ—¶ï¼Œè¾“å‡ºå°±æ˜¯æœ‰åºçš„ï¼Œè¿™ä¸ªé¡ºåºæ˜¯å…ƒç´ çš„æ’åºé¡ºåºï¼š

```java
import java.util.*;
public class Main {
    public static void main(String[] args) {
        Set<String> set = new TreeSet<>();
        set.add("apple");
        set.add("banana");
        set.add("pear");
        set.add("orange");
        for (String s : set) {
            System.out.println(s);
        }
    }
}
```

ä½¿ç”¨ `TreeSet` å’Œä½¿ç”¨ `TreeMap` çš„è¦æ±‚ä¸€æ ·ï¼Œæ·»åŠ çš„å…ƒç´ å¿…é¡»æ­£ç¡®å®ç° `Comparable` æ¥å£ï¼Œå¦‚æœæ²¡æœ‰å®ç° `Comparable` æ¥å£ï¼Œé‚£ä¹ˆåˆ›å»º `TreeSet` æ—¶å¿…é¡»ä¼ å…¥ä¸€ä¸ª `Comparator` å¯¹è±¡ã€‚

## ğŸ€ ç»ƒä¹ 

åœ¨èŠå¤©è½¯ä»¶ä¸­ï¼Œå‘é€æ–¹å‘é€æ¶ˆæ¯æ—¶ï¼Œé‡åˆ°ç½‘ç»œè¶…æ—¶åå°±ä¼šè‡ªåŠ¨é‡å‘ï¼Œå› æ­¤ï¼Œæ¥æ”¶æ–¹å¯èƒ½ä¼šæ”¶åˆ°é‡å¤çš„æ¶ˆæ¯ï¼Œåœ¨æ˜¾ç¤ºç»™ç”¨æˆ·çœ‹çš„æ—¶å€™ï¼Œéœ€è¦é¦–å…ˆå»é‡ã€‚è¯·ç»ƒä¹ ä½¿ç”¨ `Set` å»é™¤é‡å¤çš„æ¶ˆæ¯ï¼š

```java
import java.util.*;

public class Main {
    public static void main(String[] args) {
        List<Message> received = List.of(
            new Message(1, "Hello!"),
            new Message(2, "å‘å·¥èµ„äº†å—ï¼Ÿ"),
            new Message(2, "å‘å·¥èµ„äº†å—ï¼Ÿ"),
            new Message(3, "å»å“ªåƒé¥­ï¼Ÿ"),
            new Message(3, "å»å“ªåƒé¥­ï¼Ÿ"),
            new Message(4, "Bye")
        );
        List<Message> displayMessages = process(received);
        for (Message message : displayMessages) {
            System.out.println(message.text);
        }
    }

    static List<Message> process(List<Message> received) {
        // TODO: æŒ‰sequenceå»é™¤é‡å¤æ¶ˆæ¯
        return received;
    }
}

class Message {
    public final int sequence;
    public final String text;
    public Message(int sequence, String text) {
        this.sequence = sequence;
        this.text = text;
    }
}
```

## ğŸ€ å°ç»“

1. `Set` ç”¨äºå­˜å‚¨ä¸é‡å¤çš„å…ƒç´ é›†åˆï¼š
   - æ”¾å…¥ `HashSet` çš„å…ƒç´ ä¸ä½œä¸º `HashMap` çš„ key è¦æ±‚ç›¸åŒï¼›
   - æ”¾å…¥ `TreeSet` çš„å…ƒç´ ä¸ä½œä¸º `TreeMap` çš„ Key è¦æ±‚ç›¸åŒï¼›
2. åˆ©ç”¨ `Set` å¯ä»¥å»é™¤é‡å¤å…ƒç´ ï¼›
3. éå† `SortedSet` æŒ‰ç…§å…ƒç´ çš„æ’åºé¡ºåºéå†ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ’åºç®—æ³•ã€‚
