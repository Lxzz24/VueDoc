---
title: ä½¿ç”¨ Iterator
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::


Java çš„é›†åˆç±»éƒ½å¯ä»¥ä½¿ç”¨ for each å¾ªç¯ï¼ŒListã€Set å’Œ Queue ä¼šè¿­ä»£æ¯ä¸ªå…ƒç´ ï¼ŒMap ä¼šè¿­ä»£æ¯ä¸ª keyã€‚ä»¥ List ä¸ºä¾‹ï¼š

```java
List<String> list = List.of("Apple", "Orange", "Pear");
for (String s : list) {
    System.out.println(s);
}
```

å®é™…ä¸Šï¼ŒJava ç¼–è¯‘å™¨å¹¶ä¸çŸ¥é“å¦‚ä½•éå† Listã€‚ä¸Šè¿°ä»£ç èƒ½å¤Ÿç¼–è¯‘é€šè¿‡ï¼Œåªæ˜¯å› ä¸ºç¼–è¯‘å™¨æŠŠ for each å¾ªç¯é€šè¿‡ Iterator æ”¹å†™ä¸ºäº†æ™®é€šçš„ for å¾ªç¯ï¼š

```java
for (Iterator<String> it = list.iterator(); it.hasNext(); ) {
     String s = it.next();
     System.out.println(s);
}
```

æˆ‘ä»¬æŠŠè¿™ç§é€šè¿‡ Iterator å¯¹è±¡éå†é›†åˆçš„æ¨¡å¼ç§°ä¸ºè¿­ä»£å™¨ã€‚

ä½¿ç”¨è¿­ä»£å™¨çš„å¥½å¤„åœ¨äºï¼Œè°ƒç”¨æ–¹æ€»æ˜¯ä»¥ç»Ÿä¸€çš„æ–¹å¼éå†å„ç§é›†åˆç±»å‹ï¼Œè€Œä¸å¿…å…³å¿ƒå®ƒä»¬å†…éƒ¨çš„å­˜å‚¨ç»“æ„ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬è™½ç„¶çŸ¥é“ ArrayList åœ¨å†…éƒ¨æ˜¯ä»¥æ•°ç»„å½¢å¼å­˜å‚¨å…ƒç´ ï¼Œå¹¶ä¸”ï¼Œå®ƒè¿˜æä¾›äº† get(int) æ–¹æ³•ã€‚è™½ç„¶æˆ‘ä»¬å¯ä»¥ç”¨ for å¾ªç¯éå†ï¼š

```java
for (int i=0; i<list.size(); i++) {
    Object value = list.get(i);
}
```

ä½†æ˜¯è¿™æ ·ä¸€æ¥ï¼Œè°ƒç”¨æ–¹å°±å¿…é¡»çŸ¥é“é›†åˆçš„å†…éƒ¨å­˜å‚¨ç»“æ„ã€‚å¹¶ä¸”ï¼Œå¦‚æœæŠŠ ArrayList æ¢æˆ LinkedListï¼Œget(int) æ–¹æ³•è€—æ—¶ä¼šéšç€ index çš„å¢åŠ è€Œå¢åŠ ã€‚å¦‚æœæŠŠ ArrayList æ¢æˆ Setï¼Œä¸Šè¿°ä»£ç å°±æ— æ³•ç¼–è¯‘ï¼Œå› ä¸º Set å†…éƒ¨æ²¡æœ‰ç´¢å¼•ã€‚

ç”¨ Iterator éå†å°±æ²¡æœ‰ä¸Šè¿°é—®é¢˜ï¼Œå› ä¸º Iterator å¯¹è±¡æ˜¯é›†åˆå¯¹è±¡è‡ªå·±åœ¨å†…éƒ¨åˆ›å»ºçš„ï¼Œå®ƒè‡ªå·±çŸ¥é“å¦‚ä½•é«˜æ•ˆéå†å†…éƒ¨çš„æ•°æ®é›†åˆï¼Œè°ƒç”¨æ–¹åˆ™è·å¾—äº†ç»Ÿä¸€çš„ä»£ç ï¼Œç¼–è¯‘å™¨æ‰èƒ½æŠŠæ ‡å‡†çš„ for each å¾ªç¯è‡ªåŠ¨è½¬æ¢ä¸º Iterator éå†ã€‚

å¦‚æœæˆ‘ä»¬è‡ªå·±ç¼–å†™äº†ä¸€ä¸ªé›†åˆç±»ï¼Œæƒ³è¦ä½¿ç”¨ for each å¾ªç¯ï¼Œåªéœ€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š

- é›†åˆç±»å®ç° Iterable æ¥å£ï¼Œè¯¥æ¥å£è¦æ±‚è¿”å›ä¸€ä¸ª Iterator å¯¹è±¡ï¼›
- ç”¨ Iterator å¯¹è±¡è¿­ä»£é›†åˆå†…éƒ¨æ•°æ®ã€‚

è¿™é‡Œçš„å…³é”®åœ¨äºï¼Œé›†åˆç±»é€šè¿‡è°ƒç”¨ iterator() æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª Iterator å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¿…é¡»è‡ªå·±çŸ¥é“å¦‚ä½•éå†è¯¥é›†åˆã€‚

ä¸€ä¸ªç®€å•çš„ Iterator ç¤ºä¾‹å¦‚ä¸‹ï¼Œå®ƒæ€»æ˜¯ä»¥å€’åºéå†é›†åˆï¼š

```java
// Iterator
import java.util.*;

public class Main {
    public static void main(String[] args) {
        ReverseList<String> rlist = new ReverseList<>();
        rlist.add("Apple");
        rlist.add("Orange");
        rlist.add("Pear");
        for (String s : rlist) {
            System.out.println(s);
        }
    }
}

class ReverseList<T> implements Iterable<T> {

    private List<T> list = new ArrayList<>();

    public void add(T t) {
        list.add(t);
    }

    @Override
    public Iterator<T> iterator() {
        return new ReverseIterator(list.size());
    }

    class ReverseIterator implements Iterator<T> {
        int index;

        ReverseIterator(int index) {
            this.index = index;
        }

        @Override
        public boolean hasNext() {
            return index > 0;
        }

        @Override
        public T next() {
            index--;
            return ReverseList.this.list.get(index);
        }
    }
}
```

è™½ç„¶ ReverseList å’Œ ReverseIterator çš„å®ç°ç±»ç¨å¾®æ¯”è¾ƒå¤æ‚ï¼Œä½†æ˜¯ï¼Œæ³¨æ„åˆ°è¿™æ˜¯åº•å±‚é›†åˆåº“ï¼Œåªéœ€ç¼–å†™ä¸€æ¬¡ã€‚è€Œè°ƒç”¨æ–¹åˆ™å®Œå…¨æŒ‰ for each å¾ªç¯ç¼–å†™ä»£ç ï¼Œæ ¹æœ¬ä¸éœ€è¦çŸ¥é“é›†åˆå†…éƒ¨çš„å­˜å‚¨é€»è¾‘å’Œéå†é€»è¾‘ã€‚

åœ¨ç¼–å†™ Iterator çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥ç”¨ä¸€ä¸ªå†…éƒ¨ç±»æ¥å®ç° Iterator æ¥å£ï¼Œè¿™ä¸ªå†…éƒ¨ç±»å¯ä»¥ç›´æ¥è®¿é—®å¯¹åº”çš„å¤–éƒ¨ç±»çš„æ‰€æœ‰å­—æ®µå’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸Šè¿°ä»£ç ä¸­ï¼Œå†…éƒ¨ç±» ReverseIterator å¯ä»¥ç”¨ ReverseList.this è·å¾—å½“å‰å¤–éƒ¨ç±»çš„ this å¼•ç”¨ï¼Œç„¶åï¼Œé€šè¿‡è¿™ä¸ª this å¼•ç”¨å°±å¯ä»¥è®¿é—® ReverseList çš„æ‰€æœ‰å­—æ®µå’Œæ–¹æ³•ã€‚



## ğŸ€ å°ç»“

1. Iterator æ˜¯ä¸€ç§æŠ½è±¡çš„æ•°æ®è®¿é—®æ¨¡å‹ã€‚ä½¿ç”¨ Iterator æ¨¡å¼è¿›è¡Œè¿­ä»£çš„å¥½å¤„æœ‰ï¼š

   - å¯¹ä»»ä½•é›†åˆéƒ½é‡‡ç”¨åŒä¸€ç§è®¿é—®æ¨¡å‹ï¼›
   - è°ƒç”¨è€…å¯¹é›†åˆå†…éƒ¨ç»“æ„ä¸€æ— æ‰€çŸ¥ï¼›
   - é›†åˆç±»è¿”å›çš„ Iterator å¯¹è±¡çŸ¥é“å¦‚ä½•è¿­ä»£ã€‚

2. Java æä¾›äº†æ ‡å‡†çš„è¿­ä»£å™¨æ¨¡å‹ï¼Œå³é›†åˆç±»å®ç° java.util.Iterable æ¥å£ï¼Œè¿”å› java.util.Iterator å®ä¾‹ã€‚


