---
title: ä½¿ç”¨ SAX
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::


ä½¿ç”¨ DOM è§£æ XML çš„ä¼˜ç‚¹æ˜¯ç”¨èµ·æ¥çœäº‹ï¼Œä½†å®ƒçš„ä¸»è¦ç¼ºç‚¹æ˜¯å†…å­˜å ç”¨å¤ªå¤§ã€‚

å¦ä¸€ç§è§£æ XML çš„æ–¹å¼æ˜¯ SAXã€‚SAX æ˜¯ Simple API for XML çš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäºæµçš„è§£ææ–¹å¼ï¼Œè¾¹è¯»å– XML è¾¹è§£æï¼Œå¹¶ä»¥äº‹ä»¶å›è°ƒçš„æ–¹å¼è®©è°ƒç”¨è€…è·å–æ•°æ®ã€‚å› ä¸ºæ˜¯ä¸€è¾¹è¯»ä¸€è¾¹è§£æï¼Œæ‰€ä»¥æ— è®º XML æœ‰å¤šå¤§ï¼Œå ç”¨çš„å†…å­˜éƒ½å¾ˆå°ã€‚

SAX è§£æä¼šè§¦å‘ä¸€ç³»åˆ—äº‹ä»¶ï¼š

- startDocumentï¼šå¼€å§‹è¯»å– XML æ–‡æ¡£ï¼›
- startElementï¼šè¯»å–åˆ°äº†ä¸€ä¸ªå…ƒç´ ï¼Œä¾‹å¦‚ `<book>`ï¼›
- charactersï¼šè¯»å–åˆ°äº†å­—ç¬¦ï¼›
- endElementï¼šè¯»å–åˆ°äº†ä¸€ä¸ªç»“æŸçš„å…ƒç´ ï¼Œä¾‹å¦‚ `</book>`ï¼›
- endDocumentï¼šè¯»å– XML æ–‡æ¡£ç»“æŸã€‚

å¦‚æœæˆ‘ä»¬ç”¨ SAX API è§£æ XMLï¼ŒJava ä»£ç å¦‚ä¸‹ï¼š

```java
InputStream input = Main.class.getResourceAsStream("/book.xml");
SAXParserFactory spf = SAXParserFactory.newInstance();
SAXParser saxParser = spf.newSAXParser();
saxParser.parse(input, new MyHandler());
```

å…³é”®ä»£ç  `SAXParser.parse()` é™¤äº†éœ€è¦ä¼ å…¥ä¸€ä¸ª `InputStream` å¤–ï¼Œè¿˜éœ€è¦ä¼ å…¥ä¸€ä¸ªå›è°ƒå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡è¦ç»§æ‰¿è‡ª `DefaultHandler`ï¼š

```java
class MyHandler extends DefaultHandler {
    public void startDocument() throws SAXException {
        print("start document");
    }

    public void endDocument() throws SAXException {
        print("end document");
    }

    public void startElement(String uri, String localName, String qName, Attributes attributes) throws SAXException {
        print("start element:", localName, qName);
    }

    public void endElement(String uri, String localName, String qName) throws SAXException {
        print("end element:", localName, qName);
    }

    public void characters(char[] ch, int start, int length) throws SAXException {
        print("characters:", new String(ch, start, length));
    }

    public void error(SAXParseException e) throws SAXException {
        print("error:", e);
    }

    void print(Object... objs) {
        for (Object obj : objs) {
            System.out.print(obj);
            System.out.print(" ");
        }
        System.out.println();
    }
}
```

è¿è¡Œ SAX è§£æä»£ç ï¼Œå¯ä»¥æ‰“å°å‡ºä¸‹é¢çš„ç»“æœï¼š

```sh
start document
start element:  book
characters:

start element:  name
characters: Java æ ¸å¿ƒæŠ€æœ¯
end element:  name
characters:

start element:  author
...
```

å¦‚æœè¦è¯»å– `<name>` èŠ‚ç‚¹çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬å°±å¿…é¡»åœ¨è§£æè¿‡ç¨‹ä¸­æ ¹æ® `startElement()` å’Œ `endElement()` å®šä½å½“å‰æ­£åœ¨è¯»å–çš„èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨æ ˆç»“æ„ä¿å­˜ï¼Œæ¯é‡åˆ°ä¸€ä¸ª `startElement()` å…¥æ ˆï¼Œæ¯é‡åˆ°ä¸€ä¸ª `endElement()` å‡ºæ ˆï¼Œè¿™æ ·ï¼Œè¯»åˆ° `characters()` æ—¶æˆ‘ä»¬æ‰çŸ¥é“å½“å‰è¯»å–çš„æ–‡æœ¬æ˜¯å“ªä¸ªèŠ‚ç‚¹çš„ã€‚å¯è§ï¼Œä½¿ç”¨ SAX API ä»ç„¶æ¯”è¾ƒéº»çƒ¦ã€‚

## ğŸ€ ç»ƒä¹ 

ä½¿ç”¨ SAX è§£æ XML

## ğŸ€ å°ç»“

SAX æ˜¯ä¸€ç§æµå¼è§£æ XML çš„ APIï¼›

SAX é€šè¿‡äº‹ä»¶è§¦å‘ï¼Œè¯»å–é€Ÿåº¦å¿«ï¼Œæ¶ˆè€—å†…å­˜å°‘ï¼›

è°ƒç”¨æ–¹å¿…é¡»é€šè¿‡å›è°ƒæ–¹æ³•è·å¾—è§£æè¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚

