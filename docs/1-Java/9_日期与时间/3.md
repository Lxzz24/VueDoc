---
title: LocalDateTime
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::


## ğŸ€ ç®€ä»‹


ä» Java 8 å¼€å§‹ï¼Œ `java.time` åŒ…æä¾›äº†æ–°çš„æ—¥æœŸå’Œæ—¶é—´ API ï¼Œä¸»è¦æ¶‰åŠçš„ç±»å‹æœ‰ï¼š

- æœ¬åœ°æ—¥æœŸå’Œæ—¶é—´ï¼š `LocalDateTime` ï¼Œ `LocalDate` ï¼Œ `LocalTime` ï¼›
- å¸¦æ—¶åŒºçš„æ—¥æœŸå’Œæ—¶é—´ï¼š `ZonedDateTime` ï¼›
- æ—¶åˆ»ï¼š `Instant` ï¼›
- æ—¶åŒºï¼š `ZoneId` ï¼Œ `ZoneOffset` ï¼›
- æ—¶é—´é—´éš”ï¼š `Duration` ã€‚

ä»¥åŠä¸€å¥—æ–°çš„ç”¨äºå–ä»£ `SimpleDateFormat` çš„æ ¼å¼åŒ–ç±»å‹ `DateTimeFormatter` ã€‚

å’Œæ—§çš„ API ç›¸æ¯”ï¼Œæ–° API ä¸¥æ ¼åŒºåˆ†äº†æ—¶åˆ»ã€æœ¬åœ°æ—¥æœŸã€æœ¬åœ°æ—¶é—´å’Œå¸¦æ—¶åŒºçš„æ—¥æœŸæ—¶é—´ï¼Œå¹¶ä¸”ï¼Œå¯¹æ—¥æœŸå’Œæ—¶é—´è¿›è¡Œè¿ç®—æ›´åŠ æ–¹ä¾¿ã€‚

æ­¤å¤–ï¼Œæ–° API ä¿®æ­£äº†æ—§ API ä¸åˆç†çš„å¸¸é‡è®¾è®¡ï¼š

- `Month` çš„èŒƒå›´ç”¨ 1~12 è¡¨ç¤º 1 æœˆåˆ° 12 æœˆï¼›
- `Week` çš„èŒƒå›´ç”¨ 1~7 è¡¨ç¤ºå‘¨ä¸€åˆ°å‘¨æ—¥ã€‚

æœ€åï¼Œæ–° API çš„ç±»å‹å‡ ä¹å…¨éƒ¨æ˜¯ä¸å˜ç±»å‹ï¼ˆå’Œ String ç±»ä¼¼ï¼‰ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ä¸å¿…æ‹…å¿ƒè¢«ä¿®æ”¹ã€‚



## ğŸ€ LocalDateTime

æˆ‘ä»¬é¦–å…ˆæ¥çœ‹æœ€å¸¸ç”¨çš„ `LocalDateTime` ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªæœ¬åœ°æ—¥æœŸå’Œæ—¶é—´ï¼š

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        LocalDate d = LocalDate.now(); // å½“å‰æ—¥æœŸ
        LocalTime t = LocalTime.now(); // å½“å‰æ—¶é—´
        LocalDateTime dt = LocalDateTime.now(); // å½“å‰æ—¥æœŸå’Œæ—¶é—´
        System.out.println(d); // ä¸¥æ ¼æŒ‰ç…§ISO 8601æ ¼å¼æ‰“å°
        System.out.println(t); // ä¸¥æ ¼æŒ‰ç…§ISO 8601æ ¼å¼æ‰“å°
        System.out.println(dt); // ä¸¥æ ¼æŒ‰ç…§ISO 8601æ ¼å¼æ‰“å°
    }
}
```

æœ¬åœ°æ—¥æœŸå’Œæ—¶é—´é€šè¿‡ `now()` è·å–åˆ°çš„æ€»æ˜¯ä»¥å½“å‰é»˜è®¤æ—¶åŒºè¿”å›çš„ï¼Œå’Œæ—§ API ä¸åŒï¼Œ `LocalDateTime` ã€ `LocalDate` å’Œ `LocalTime` é»˜è®¤ä¸¥æ ¼æŒ‰ç…§ ISO 8601 è§„å®šçš„æ—¥æœŸå’Œæ—¶é—´æ ¼å¼è¿›è¡Œæ‰“å°ã€‚

ä¸Šè¿°ä»£ç å…¶å®æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œåœ¨è·å– 3 ä¸ªç±»å‹çš„æ—¶å€™ï¼Œç”±äºæ‰§è¡Œä¸€è¡Œä»£ç æ€»ä¼šæ¶ˆè€—ä¸€ç‚¹æ—¶é—´ï¼Œå› æ­¤ï¼Œ3 ä¸ªç±»å‹çš„æ—¥æœŸå’Œæ—¶é—´å¾ˆå¯èƒ½å¯¹ä¸ä¸Šï¼ˆæ—¶é—´çš„æ¯«ç§’æ•°åŸºæœ¬ä¸Šä¸åŒï¼‰ã€‚ä¸ºäº†ä¿è¯è·å–åˆ°åŒä¸€æ—¶åˆ»çš„æ—¥æœŸå’Œæ—¶é—´ï¼Œå¯ä»¥æ”¹å†™å¦‚ä¸‹ï¼š

```java
LocalDateTime dt = LocalDateTime.now(); // å½“å‰æ—¥æœŸå’Œæ—¶é—´
LocalDate d = dt.toLocalDate(); // è½¬æ¢åˆ°å½“å‰æ—¥æœŸ
LocalTime t = dt.toLocalTime(); // è½¬æ¢åˆ°å½“å‰æ—¶é—´
```

åè¿‡æ¥ï¼Œé€šè¿‡æŒ‡å®šçš„æ—¥æœŸå’Œæ—¶é—´åˆ›å»º `LocalDateTime` å¯ä»¥é€šè¿‡ `of()` æ–¹æ³•ï¼š


```java
// æŒ‡å®šæ—¥æœŸå’Œæ—¶é—´:
LocalDate d2 = LocalDate.of(2019, 11, 30); // 2019-11-30, æ³¨æ„ 11=11 æœˆ
LocalTime t2 = LocalTime.of(15, 16, 17); // 15:16:17
LocalDateTime dt2 = LocalDateTime.of(2019, 11, 30, 15, 16, 17);
LocalDateTime dt3 = LocalDateTime.of(d2, t2);
```

å› ä¸ºä¸¥æ ¼æŒ‰ç…§ ISO 8601 çš„æ ¼å¼ï¼Œå› æ­¤ï¼Œå°†å­—ç¬¦ä¸²è½¬æ¢ä¸º `LocalDateTime` å°±å¯ä»¥ä¼ å…¥æ ‡å‡†æ ¼å¼ï¼š

```java
LocalDateTime dt = LocalDateTime.parse("2019-11-19T15:16:17");
LocalDate d = LocalDate.parse("2019-11-19");
LocalTime t = LocalTime.parse("15:16:17");
```

æ³¨æ„ ISO 8601 è§„å®šçš„æ—¥æœŸå’Œæ—¶é—´åˆ†éš”ç¬¦æ˜¯ `T` ã€‚æ ‡å‡†æ ¼å¼å¦‚ä¸‹ï¼š

- æ—¥æœŸï¼š `yyyy-MM-dd`
- æ—¶é—´ï¼š `HH:mm:ss`
- å¸¦æ¯«ç§’çš„æ—¶é—´ï¼š `HH:mm:ss.SSS`
- æ—¥æœŸå’Œæ—¶é—´ï¼š `yyyy-MM-ddTHH:mm:ss`
- å¸¦æ¯«ç§’çš„æ—¥æœŸå’Œæ—¶é—´ï¼š `yyyy-MM-ddTHH:mm:ss.SSS`


## ğŸ€ DateTimeFormatter

å¦‚æœè¦è‡ªå®šä¹‰è¾“å‡ºçš„æ ¼å¼ï¼Œæˆ–è€…è¦æŠŠä¸€ä¸ªé ISO 8601 æ ¼å¼çš„å­—ç¬¦ä¸²è§£ææˆ `LocalDateTime` ï¼Œå¯ä»¥ä½¿ç”¨æ–°çš„ `DateTimeFormatter` ï¼š


```java
import java.time.*;
import java.time.format.*;

public class Main {
    public static void main(String[] args) {
        // è‡ªå®šä¹‰æ ¼å¼åŒ–:
        DateTimeFormatter dtf = DateTimeFormatter.ofPattern("yyyy/MM/dd HH:mm:ss");
        System.out.println(dtf.format(LocalDateTime.now()));

        // ç”¨è‡ªå®šä¹‰æ ¼å¼è§£æ:
        LocalDateTime dt2 = LocalDateTime.parse("2019/11/30 15:16:17", dtf);
        System.out.println(dt2);
    }
}
```

`LocalDateTime` æä¾›äº†å¯¹æ—¥æœŸå’Œæ—¶é—´è¿›è¡ŒåŠ å‡çš„éå¸¸ç®€å•çš„é“¾å¼è°ƒç”¨ï¼š

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        LocalDateTime dt = LocalDateTime.of(2019, 10, 26, 20, 30, 59);
        System.out.println(dt);
        // åŠ 5å¤©å‡3å°æ—¶:
        LocalDateTime dt2 = dt.plusDays(5).minusHours(3);
        System.out.println(dt2); // 2019-10-31T17:30:59
        // å‡1æœˆ:
        LocalDateTime dt3 = dt2.minusMonths(1);
        System.out.println(dt3); // 2019-09-30T17:30:59
    }
}
```


æ³¨æ„åˆ°æœˆä»½åŠ å‡ä¼šè‡ªåŠ¨è°ƒæ•´æ—¥æœŸï¼Œä¾‹å¦‚ä» 2019-10-31 å‡å» 1 ä¸ªæœˆå¾—åˆ°çš„ç»“æœæ˜¯ 2019-09-30 ï¼Œå› ä¸º 9 æœˆæ²¡æœ‰ 31 æ—¥ã€‚

å¯¹æ—¥æœŸå’Œæ—¶é—´è¿›è¡Œè°ƒæ•´åˆ™ä½¿ç”¨ `withXxx()` æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š `withHour(15)` ä¼šæŠŠ `10:11:12` å˜ä¸º `15:11:12` ï¼š

- è°ƒæ•´å¹´ï¼š `withYear()`
- è°ƒæ•´æœˆï¼š `withMonth()`
- è°ƒæ•´æ—¥ï¼š `withDayOfMonth()`
- è°ƒæ•´æ—¶ï¼š `withHour()`
- è°ƒæ•´åˆ†ï¼š `withMinute()`
- è°ƒæ•´ç§’ï¼š `withSecond()`


ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        LocalDateTime dt = LocalDateTime.of(2019, 10, 26, 20, 30, 59);
        System.out.println(dt);
        // æ—¥æœŸå˜ä¸º31æ—¥:
        LocalDateTime dt2 = dt.withDayOfMonth(31);
        System.out.println(dt2); // 2019-10-31T20:30:59
        // æœˆä»½å˜ä¸º9:
        LocalDateTime dt3 = dt2.withMonth(9);
        System.out.println(dt3); // 2019-09-30T20:30:59
    }
}
```


åŒæ ·æ³¨æ„åˆ°è°ƒæ•´æœˆä»½æ—¶ï¼Œä¼šç›¸åº”åœ°è°ƒæ•´æ—¥æœŸï¼Œå³æŠŠ 2019-10-31 çš„æœˆä»½è°ƒæ•´ä¸º 9 æ—¶ï¼Œæ—¥æœŸä¹Ÿè‡ªåŠ¨å˜ä¸º 30ã€‚

å®é™…ä¸Šï¼Œ `LocalDateTime` è¿˜æœ‰ä¸€ä¸ªé€šç”¨çš„ `with()` æ–¹æ³•å…è®¸æˆ‘ä»¬åšæ›´å¤æ‚çš„è¿ç®—ã€‚ä¾‹å¦‚ï¼š

```java
import java.time.*;
import java.time.temporal.*;

public class Main {
    public static void main(String[] args) {
        // æœ¬æœˆç¬¬ä¸€å¤©0:00æ—¶åˆ»:
        LocalDateTime firstDay = LocalDate.now().withDayOfMonth(1).atStartOfDay();
        System.out.println(firstDay);

        // æœ¬æœˆæœ€å1å¤©:
        LocalDate lastDay = LocalDate.now().with(TemporalAdjusters.lastDayOfMonth());
        System.out.println(lastDay);

        // ä¸‹æœˆç¬¬1å¤©:
        LocalDate nextMonthFirstDay = LocalDate.now().with(TemporalAdjusters.firstDayOfNextMonth());
        System.out.println(nextMonthFirstDay);

        // æœ¬æœˆç¬¬1ä¸ªå‘¨ä¸€:
        LocalDate firstWeekday = LocalDate.now().with(TemporalAdjusters.firstInMonth(DayOfWeek.MONDAY));
        System.out.println(firstWeekday);
    }
}
```

å¯¹äºè®¡ç®—æŸä¸ªæœˆç¬¬ 1 ä¸ªå‘¨æ—¥è¿™æ ·çš„é—®é¢˜ï¼Œæ–°çš„ API å¯ä»¥è½»æ¾å®Œæˆã€‚

è¦åˆ¤æ–­ä¸¤ä¸ª `LocalDateTime` çš„å…ˆåï¼Œå¯ä»¥ä½¿ç”¨ `isBefore()` ã€ `isAfter()` æ–¹æ³•ï¼Œå¯¹äº `LocalDate` å’Œ `LocalTime` ç±»ä¼¼ï¼š

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        LocalDateTime now = LocalDateTime.now();
        LocalDateTime target = LocalDateTime.of(2019, 11, 19, 8, 15, 0);
        System.out.println(now.isBefore(target));
        System.out.println(LocalDate.now().isBefore(LocalDate.of(2019, 11, 19)));
        System.out.println(LocalTime.now().isAfter(LocalTime.parse("08:15:00")));
    }
}
```


æ³¨æ„åˆ° `LocalDateTime` æ— æ³•ä¸æ—¶é—´æˆ³è¿›è¡Œè½¬æ¢ï¼Œå› ä¸º `LocalDateTime` æ²¡æœ‰æ—¶åŒºï¼Œæ— æ³•ç¡®å®šæŸä¸€æ—¶åˆ»ã€‚åé¢æˆ‘ä»¬è¦ä»‹ç»çš„ `ZonedDateTime` ç›¸å½“äº `LocalDateTime` åŠ æ—¶åŒºçš„ç»„åˆï¼Œå®ƒå…·æœ‰æ—¶åŒºï¼Œå¯ä»¥ä¸ `long` è¡¨ç¤ºçš„æ—¶é—´æˆ³è¿›è¡Œè½¬æ¢ã€‚



## ğŸ€ Duration å’Œ Period

`Duration` è¡¨ç¤ºä¸¤ä¸ªæ—¶åˆ»ä¹‹é—´çš„æ—¶é—´é—´éš”ã€‚å¦ä¸€ä¸ªç±»ä¼¼çš„ `Period` è¡¨ç¤ºä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°ï¼š

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        LocalDateTime start = LocalDateTime.of(2019, 11, 19, 8, 15, 0);
        LocalDateTime end = LocalDateTime.of(2020, 1, 9, 19, 25, 30);
        Duration d = Duration.between(start, end);
        System.out.println(d); // PT1235H10M30S

        Period p = LocalDate.of(2019, 11, 19).until(LocalDate.of(2020, 1, 9));
        System.out.println(p); // P1M21D
    }
}
```


æ³¨æ„åˆ°ä¸¤ä¸ª `LocalDateTime` ä¹‹é—´çš„å·®å€¼ä½¿ç”¨ `Duration` è¡¨ç¤ºï¼Œç±»ä¼¼ PT1235H10M30S ï¼Œè¡¨ç¤º 1235 å°æ—¶ 10 åˆ†é’Ÿ 30 ç§’ã€‚è€Œä¸¤ä¸ª `LocalDate` ä¹‹é—´çš„å·®å€¼ç”¨ `Period` è¡¨ç¤ºï¼Œç±»ä¼¼ P1M21D ï¼Œè¡¨ç¤º 1 ä¸ªæœˆ 21 å¤©ã€‚

`Duration` å’Œ `Period` çš„è¡¨ç¤ºæ–¹æ³•ä¹Ÿç¬¦åˆ ISO 8601 çš„æ ¼å¼ï¼Œå®ƒä»¥ `P...T...` çš„å½¢å¼è¡¨ç¤ºï¼Œ `P...T` ä¹‹é—´è¡¨ç¤ºæ—¥æœŸé—´éš”ï¼Œ `T` åé¢è¡¨ç¤ºæ—¶é—´é—´éš”ã€‚å¦‚æœæ˜¯ `PT...` çš„æ ¼å¼è¡¨ç¤ºä»…æœ‰æ—¶é—´é—´éš”ã€‚åˆ©ç”¨ `ofXxx()` æˆ–è€… `parse()` æ–¹æ³•ä¹Ÿå¯ä»¥ç›´æ¥åˆ›å»º `Duration` ï¼š


```java
Duration d1 = Duration.ofHours(10); // 10 hours
Duration d2 = Duration.parse("P1DT2H3M"); // 1 day, 2 hours, 3 minutes
```

æœ‰çš„ç«¥é‹å¯èƒ½å‘ç° Java 8 å¼•å…¥çš„ java.timeAPI ã€‚æ€ä¹ˆå’Œä¸€ä¸ªå¼€æºçš„ Joda Time å¾ˆåƒï¼Ÿéš¾é“ JDK ä¹Ÿå¼€å§‹æŠ„è¢­å¼€æºäº†ï¼Ÿå…¶å®æ­£æ˜¯å› ä¸ºå¼€æºçš„ Joda Time è®¾è®¡å¾ˆå¥½ï¼Œåº”ç”¨å¹¿æ³›ï¼Œæ‰€ä»¥ JDK å›¢é˜Ÿé‚€è¯· Joda Time çš„ä½œè€… Stephen Colebourne å…±åŒè®¾è®¡äº† java.timeAPI ã€‚



## ğŸ€ å°ç»“

- Java 8 å¼•å…¥äº†æ–°çš„æ—¥æœŸå’Œæ—¶é—´ API ï¼Œå®ƒä»¬æ˜¯ä¸å˜ç±»ï¼Œé»˜è®¤æŒ‰ ISO 8601 æ ‡å‡†æ ¼å¼åŒ–å’Œè§£æï¼›
- ä½¿ç”¨ `LocalDateTime` å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¯¹æ—¥æœŸå’Œæ—¶é—´è¿›è¡ŒåŠ å‡ï¼Œæˆ–è€…è°ƒæ•´æ—¥æœŸå’Œæ—¶é—´ï¼Œå®ƒæ€»æ˜¯è¿”å›æ–°å¯¹è±¡ï¼›
- ä½¿ç”¨ `isBefore()` å’Œ `isAfter()` å¯ä»¥åˆ¤æ–­æ—¥æœŸå’Œæ—¶é—´çš„å…ˆåï¼›
- ä½¿ç”¨ `Duration` å’Œ `Period` å¯ä»¥è¡¨ç¤ºä¸¤ä¸ªæ—¥æœŸå’Œæ—¶é—´çš„ â€œåŒºé—´é—´éš”â€ã€‚




