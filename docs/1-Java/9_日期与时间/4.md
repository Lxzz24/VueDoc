---
title: ZonedDateTime
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

`LocalDateTime` æ€»æ˜¯è¡¨ç¤ºæœ¬åœ°æ—¥æœŸå’Œæ—¶é—´ï¼Œè¦è¡¨ç¤ºä¸€ä¸ªå¸¦æ—¶åŒºçš„æ—¥æœŸå’Œæ—¶é—´ï¼Œæˆ‘ä»¬å°±éœ€è¦ `ZonedDateTime` ã€‚

å¯ä»¥ç®€å•åœ°æŠŠ `ZonedDateTime` ç†è§£æˆ `LocalDateTime` åŠ  `ZoneId`ã€‚`ZoneId` æ˜¯ `java.time` å¼•å…¥çš„æ–°çš„æ—¶åŒºç±»ï¼Œæ³¨æ„å’Œæ—§çš„ `java.util.TimeZone` åŒºåˆ«ã€‚

è¦åˆ›å»ºä¸€ä¸ª `ZonedDateTime` å¯¹è±¡ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯é€šè¿‡ `now()` æ–¹æ³•è¿”å›å½“å‰æ—¶é—´ï¼š

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        ZonedDateTime zbj = ZonedDateTime.now(); // é»˜è®¤æ—¶åŒº
        ZonedDateTime zny = ZonedDateTime.now(ZoneId.of("America/New_York")); // ç”¨æŒ‡å®šæ—¶åŒºè·å–å½“å‰æ—¶é—´
        System.out.println(zbj);
        System.out.println(zny);
    }
}
```

è§‚å¯Ÿæ‰“å°çš„ä¸¤ä¸ª `ZonedDateTime`ï¼Œå‘ç°å®ƒä»¬æ—¶åŒºä¸åŒï¼Œä½†è¡¨ç¤ºçš„æ—¶é—´éƒ½æ˜¯åŒä¸€æ—¶åˆ»ï¼ˆæ¯«ç§’æ•°ä¸åŒæ˜¯æ‰§è¡Œè¯­å¥æ—¶çš„æ—¶é—´å·®ï¼‰ï¼š

```
2019-09-15T20:58:18.786182+08:00[Asia/Shanghai]
2019-09-15T08:58:18.788860-04:00[America/New_York]
```

å¦ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡ç»™ä¸€ä¸ª `LocalDateTime` é™„åŠ ä¸€ä¸ª `ZoneId`ï¼Œå°±å¯ä»¥å˜æˆ `ZonedDateTime` ï¼š

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        LocalDateTime ldt = LocalDateTime.of(2019, 9, 15, 15, 16, 17);
        ZonedDateTime zbj = ldt.atZone(ZoneId.systemDefault());
        ZonedDateTime zny = ldt.atZone(ZoneId.of("America/New_York"));
        System.out.println(zbj);
        System.out.println(zny);
    }
}
```

ä»¥è¿™ç§æ–¹å¼åˆ›å»ºçš„ `ZonedDateTime`ï¼Œå®ƒçš„æ—¥æœŸå’Œæ—¶é—´ä¸ `LocalDateTime` ç›¸åŒï¼Œä½†é™„åŠ çš„æ—¶åŒºä¸åŒï¼Œå› æ­¤æ˜¯ä¸¤ä¸ªä¸åŒçš„æ—¶åˆ»ï¼š

```
2019-09-15T15:16:17+08:00[Asia/Shanghai]
2019-09-15T15:16:17-04:00[America/New_York]
```

## ğŸ€ æ—¶åŒºè½¬æ¢

è¦è½¬æ¢æ—¶åŒºï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ª `ZonedDateTime` å¯¹è±¡ï¼Œç„¶åï¼Œé€šè¿‡ `withZoneSameInstant()` å°†å…³è”æ—¶åŒºè½¬æ¢åˆ°å¦ä¸€ä¸ªæ—¶åŒºï¼Œè½¬æ¢åæ—¥æœŸå’Œæ—¶é—´éƒ½ä¼šç›¸åº”è°ƒæ•´ã€‚

ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•å°†åŒ—äº¬æ—¶é—´è½¬æ¢ä¸ºçº½çº¦æ—¶é—´ï¼š

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        // ä»¥ä¸­å›½æ—¶åŒºè·å–å½“å‰æ—¶é—´:
        ZonedDateTime zbj = ZonedDateTime.now(ZoneId.of("Asia/Shanghai"));
        // è½¬æ¢ä¸ºçº½çº¦æ—¶é—´:
        ZonedDateTime zny = zbj.withZoneSameInstant(ZoneId.of("America/New_York"));
        System.out.println(zbj);
        System.out.println(zny);
    }
}
```

è¦ç‰¹åˆ«æ³¨æ„ï¼Œæ—¶åŒºè½¬æ¢çš„æ—¶å€™ï¼Œç”±äºå¤ä»¤æ—¶çš„å­˜åœ¨ï¼Œä¸åŒçš„æ—¥æœŸè½¬æ¢çš„ç»“æœå¾ˆå¯èƒ½æ˜¯ä¸åŒçš„ã€‚è¿™æ˜¯åŒ—äº¬æ—¶é—´ 9 æœˆ 15 æ—¥çš„è½¬æ¢ç»“æœï¼š

```
2019-09-15T21:05:50.187697+08:00[Asia/Shanghai]
2019-09-15T09:05:50.187697-04:00[America/New_York]
```

è¿™æ˜¯åŒ—äº¬æ—¶é—´ 11 æœˆ 15 æ—¥çš„è½¬æ¢ç»“æœï¼š

```
2019-11-15T21:05:50.187697+08:00[Asia/Shanghai]
2019-11-15T08:05:50.187697-05:00[America/New_York]
```

ä¸¤æ¬¡è½¬æ¢åçš„çº½çº¦æ—¶é—´æœ‰ 1 å°æ—¶çš„å¤ä»¤æ—¶æ—¶å·®ã€‚

::: warning
æ¶‰åŠåˆ°æ—¶åŒºæ—¶ï¼Œåƒä¸‡ä¸è¦è‡ªå·±è®¡ç®—æ—¶å·®ï¼Œå¦åˆ™éš¾ä»¥æ­£ç¡®å¤„ç†å¤ä»¤æ—¶ã€‚

:::

æœ‰äº† `ZonedDateTime`ï¼Œå°†å…¶è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´å°±éå¸¸ç®€å•ï¼š

```
ZonedDateTime zdt = ...
LocalDateTime ldt = zdt.toLocalDateTime();
```

è½¬æ¢ä¸º LocalDateTime æ—¶ï¼Œç›´æ¥ä¸¢å¼ƒäº†æ—¶åŒºä¿¡æ¯ã€‚

## ğŸ€ ç»ƒä¹ 

æŸèˆªçº¿ä»åŒ—äº¬é£åˆ°çº½çº¦éœ€è¦ 13 å°æ—¶ 20 åˆ†é’Ÿï¼Œè¯·æ ¹æ®åŒ—äº¬èµ·é£æ—¥æœŸå’Œæ—¶é—´è®¡ç®—åˆ°è¾¾çº½çº¦çš„å½“åœ°æ—¥æœŸå’Œæ—¶é—´ã€‚

```java
import java.time.*;

public class Main {
    public static void main(String[] args) {
        LocalDateTime departureAtBeijing = LocalDateTime.of(2019, 9, 15, 13, 0, 0);
        int hours = 13;
        int minutes = 20;
        LocalDateTime arrivalAtNewYork = calculateArrivalAtNY(departureAtBeijing, hours, minutes);
        System.out.println(departureAtBeijing + " -> " + arrivalAtNewYork);
        // test:
        // å¤ä»¤æ—¶ç›¸å·® 12 å°æ—¶ï¼Œçº½çº¦ 11 æœˆä»½è¿›å…¥å†¬ä»¤æ—¶ï¼Œä¸Šæµ·ä¸çº½çº¦å†¬ä»¤æ—¶ç›¸å·® 13 ä¸ªå°æ—¶
        if (!LocalDateTime.of(2019, 10, 15, 14, 20, 0)
                .equals(calculateArrivalAtNY(LocalDateTime.of(2019, 10, 15, 13, 0, 0), 13, 20))) {
            System.err.println("æµ‹è¯•å¤±è´¥!");
        } else if (!LocalDateTime.of(2019, 11, 15, 13, 20, 0)
                .equals(calculateArrivalAtNY(LocalDateTime.of(2019, 11, 15, 13, 0, 0), 13, 20))) {
            System.err.println("æµ‹è¯•å¤±è´¥!");
        } else {
            System.out.println("æµ‹è¯•æˆåŠŸï¼");
        }
    }

    static LocalDateTime calculateArrivalAtNY(LocalDateTime bj, int h, int m) {
        ZonedDateTime zbj = bj.atZone(ZoneId.of("Asia/Shanghai"));
        ZonedDateTime zny = zbj.withZoneSameInstant(ZoneId.of("America/New_York"))
                               .plusHours(h).plusMinutes(m);
        return zny.toLocalDateTime();
    }
}
```

æç¤ºï¼š`ZonedDateTime` ä»ç„¶æä¾›äº† `plusDays()` ç­‰åŠ å‡æ“ä½œã€‚

## ğŸ€ å°ç»“

- `ZonedDateTime` æ˜¯å¸¦æ—¶åŒºçš„æ—¥æœŸå’Œæ—¶é—´ï¼Œå¯ç”¨äºæ—¶åŒºè½¬æ¢ï¼›

- `ZonedDateTime` å’Œ `LocalDateTime` å¯ä»¥ç›¸äº’è½¬æ¢ã€‚
