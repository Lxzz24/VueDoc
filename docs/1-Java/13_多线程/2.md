---
title: åˆ›å»ºæ–°çº¿ç¨‹
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

Java è¯­è¨€å†…ç½®äº†å¤šçº¿ç¨‹æ”¯æŒã€‚å½“ Java ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯å¯åŠ¨äº†ä¸€ä¸ª JVM è¿›ç¨‹ï¼Œç„¶åï¼Œ JVM å¯åŠ¨ä¸»çº¿ç¨‹æ¥æ‰§è¡Œ `main()` æ–¹æ³•ã€‚åœ¨ `main()` æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆå¯ä»¥å¯åŠ¨å…¶ä»–çº¿ç¨‹ã€‚

è¦åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹éå¸¸å®¹æ˜“ï¼Œæˆ‘ä»¬éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ª `Thread` å®ä¾‹ï¼Œç„¶åè°ƒç”¨å®ƒçš„ `start()` æ–¹æ³•ï¼š


```java
public class Main {
    public static void main(String[] args) {
        Thread t = new Thread();
        t.start(); // å¯åŠ¨æ–°çº¿ç¨‹
    }
}
```


ä½†æ˜¯è¿™ä¸ªçº¿ç¨‹å¯åŠ¨åå®é™…ä¸Šä»€ä¹ˆä¹Ÿä¸åšå°±ç«‹åˆ»ç»“æŸäº†ã€‚

æˆ‘ä»¬å¸Œæœ› ***æ–°çº¿ç¨‹èƒ½æ‰§è¡ŒæŒ‡å®šçš„ä»£ç *** ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š

- æ–¹æ³•ä¸€ï¼šä» `Thread` æ´¾ç”Ÿä¸€ä¸ªè‡ªå®šä¹‰ç±»ï¼Œç„¶åé‡å†™ `run()` æ–¹æ³•ï¼š

```java
public class Main {
    public static void main(String[] args) {
        Thread t = new MyThread();
        t.start(); // å¯åŠ¨æ–°çº¿ç¨‹
    }
}

class MyThread extends Thread {
    @Override
    public void run() {
        System.out.println("start new thread!");
    }
}
```

æ‰§è¡Œä¸Šè¿°ä»£ç ï¼Œæ³¨æ„åˆ° `start()` æ–¹æ³•ä¼šåœ¨å†…éƒ¨è‡ªåŠ¨è°ƒç”¨å®ä¾‹çš„ `run()` æ–¹æ³•ã€‚

- æ–¹æ³•äºŒï¼šåˆ›å»º `Thread` å®ä¾‹æ—¶ï¼Œä¼ å…¥ä¸€ä¸ª `Runnable` å®ä¾‹ï¼š

```java
public class Main {
    public static void main(String[] args) {
        Thread t = new Thread(new MyRunnable());
        t.start(); // å¯åŠ¨æ–°çº¿ç¨‹
    }
}

class MyRunnable implements Runnable {
    @Override
    public void run() {
        System.out.println("start new thread!");
    }
}
```

æˆ–è€…ç”¨ Java 8 å¼•å…¥çš„ lambda è¯­æ³•è¿›ä¸€æ­¥ç®€å†™ä¸ºï¼š

```java
public class Main {
    public static void main(String[] args) {
        Thread t = new Thread(() -> {
            System.out.println("start new thread!");
        });
        t.start(); // å¯åŠ¨æ–°çº¿ç¨‹
    }
}
```


æœ‰ç«¥é‹ä¼šé—®ï¼Œä½¿ç”¨çº¿ç¨‹æ‰§è¡Œçš„æ‰“å°è¯­å¥ï¼Œå’Œç›´æ¥åœ¨ `main()` æ–¹æ³•æ‰§è¡Œæœ‰åŒºåˆ«å—ï¼Ÿ

åŒºåˆ«å¤§äº†å»äº†ã€‚æˆ‘ä»¬çœ‹ä»¥ä¸‹ä»£ç ï¼š

```java
public class Main {
    public static void main(String[] args) {
        System.out.println("main start...");
        Thread t = new Thread() {
            public void run() {
                System.out.println("thread run...");
                System.out.println("thread end.");
            }
        };
        t.start();
        System.out.println("main end...");
    }
}
```

![20220627152848](assets/20220627152848.png)


æˆ‘ä»¬ç”¨è“è‰²è¡¨ç¤ºä¸»çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯ `main` çº¿ç¨‹ï¼Œ `main` çº¿ç¨‹æ‰§è¡Œçš„ä»£ç æœ‰ 4 è¡Œï¼Œé¦–å…ˆæ‰“å° `main start` ï¼Œç„¶ååˆ›å»º `Thread` å¯¹è±¡ï¼Œç´§æ¥ç€è°ƒç”¨ `start()` å¯åŠ¨æ–°çº¿ç¨‹ã€‚å½“ `start()` æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œ JVM å°±åˆ›å»ºäº†ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œæˆ‘ä»¬é€šè¿‡å®ä¾‹å˜é‡ `t` æ¥è¡¨ç¤ºè¿™ä¸ªæ–°çº¿ç¨‹å¯¹è±¡ï¼Œå¹¶å¼€å§‹æ‰§è¡Œã€‚

æ¥ç€ï¼Œ `main` çº¿ç¨‹ç»§ç»­æ‰§è¡Œæ‰“å° `main end` è¯­å¥ï¼Œè€Œ `t` çº¿ç¨‹åœ¨ `main` çº¿ç¨‹æ‰§è¡Œçš„åŒæ—¶ä¼šå¹¶å‘æ‰§è¡Œï¼Œæ‰“å° `thread run` å’Œ `thread end` è¯­å¥ã€‚

å½“ `run()` æ–¹æ³•ç»“æŸæ—¶ï¼Œæ–°çº¿ç¨‹å°±ç»“æŸäº†ã€‚è€Œ `main()` æ–¹æ³•ç»“æŸæ—¶ï¼Œä¸»çº¿ç¨‹ä¹Ÿç»“æŸäº†ã€‚

æˆ‘ä»¬å†æ¥çœ‹çº¿ç¨‹çš„ ***æ‰§è¡Œé¡ºåº*** ï¼š

1. `main` çº¿ç¨‹è‚¯å®šæ˜¯å…ˆæ‰“å° `main start` ï¼Œå†æ‰“å° `main end` ï¼›
2. `t` çº¿ç¨‹è‚¯å®šæ˜¯å…ˆæ‰“å° `thread run` ï¼Œå†æ‰“å° `thread end` ã€‚

ä½†æ˜¯ï¼Œé™¤äº†å¯ä»¥è‚¯å®šï¼Œ `main start` ä¼šå…ˆæ‰“å°å¤–ï¼Œ `main end` æ‰“å°åœ¨ `thread run` ä¹‹å‰ã€ `thread end` ä¹‹åæˆ–è€…ä¹‹é—´ï¼Œéƒ½æ— æ³•ç¡®å®šã€‚å› ä¸ºä» `t` çº¿ç¨‹å¼€å§‹è¿è¡Œä»¥åï¼Œä¸¤ä¸ªçº¿ç¨‹å°±å¼€å§‹åŒæ—¶è¿è¡Œäº†ï¼Œå¹¶ä¸”ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œç¨‹åºæœ¬èº«æ— æ³•ç¡®å®šçº¿ç¨‹çš„è°ƒåº¦é¡ºåºã€‚

è¦æ¨¡æ‹Ÿå¹¶å‘æ‰§è¡Œçš„æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çº¿ç¨‹ä¸­è°ƒç”¨ `Thread.sleep()` ï¼Œå¼ºè¿«å½“å‰çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼š

```java
public class Main {
    public static void main(String[] args) {
        System.out.println("main start...");
        Thread t = new Thread() {
            public void run() {
                System.out.println("thread run...");
                try {
                    Thread.sleep(10);
                } catch (InterruptedException e) {}
                System.out.println("thread end.");
            }
        };
        t.start();
        try {
            Thread.sleep(20);
        } catch (InterruptedException e) {}
        System.out.println("main end...");
    }
}
```

`sleep()` ä¼ å…¥çš„å‚æ•°æ˜¯æ¯«ç§’ã€‚è°ƒæ•´æš‚åœæ—¶é—´çš„å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° `main` çº¿ç¨‹å’Œ `t` çº¿ç¨‹æ‰§è¡Œçš„å…ˆåé¡ºåºã€‚

è¦ç‰¹åˆ«æ³¨æ„ï¼šç›´æ¥è°ƒç”¨ `Thread` å®ä¾‹çš„ `run()` æ–¹æ³•æ˜¯æ— æ•ˆçš„ï¼š

```java
public class Main {
    public static void main(String[] args) {
        Thread t = new MyThread();
        t.run();
    }
}

class MyThread extends Thread {
    public void run() {
        System.out.println("hello");
    }
}
```

ç›´æ¥è°ƒç”¨ `run()` æ–¹æ³•ï¼Œç›¸å½“äºè°ƒç”¨äº†ä¸€ä¸ªæ™®é€šçš„ Java æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹å¹¶æ²¡æœ‰ä»»ä½•æ”¹å˜ï¼Œä¹Ÿä¸ä¼šå¯åŠ¨æ–°çº¿ç¨‹ã€‚ä¸Šè¿°ä»£ç å®é™…ä¸Šæ˜¯åœ¨ `main()` æ–¹æ³•å†…éƒ¨åˆè°ƒç”¨äº† `run()` æ–¹æ³•ï¼Œæ‰“å° `hello` è¯­å¥æ˜¯åœ¨ `main` çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œæ²¡æœ‰ä»»ä½•æ–°çº¿ç¨‹è¢«åˆ›å»ºã€‚

å¿…é¡»è°ƒç”¨ `Thread` å®ä¾‹çš„ `start()` æ–¹æ³•æ‰èƒ½å¯åŠ¨æ–°çº¿ç¨‹ï¼Œå¦‚æœæˆ‘ä»¬æŸ¥çœ‹ `Thread` ç±»çš„æºä»£ç ï¼Œä¼šçœ‹åˆ° `start()` æ–¹æ³•å†…éƒ¨è°ƒç”¨äº†ä¸€ä¸ª `private native void start0()` æ–¹æ³•ï¼Œ `native` ä¿®é¥°ç¬¦è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•æ˜¯ç”± JVM è™šæ‹Ÿæœºå†…éƒ¨çš„ C ä»£ç å®ç°çš„ï¼Œä¸æ˜¯ç”± Java ä»£ç å®ç°çš„ã€‚


## ğŸ€ çº¿ç¨‹çš„ä¼˜å…ˆçº§

å¯ä»¥å¯¹çº¿ç¨‹è®¾å®šä¼˜å…ˆçº§ï¼Œè®¾å®šä¼˜å…ˆçº§çš„æ–¹æ³•æ˜¯ï¼š

```java
Thread.setPriority(int n) // 1~10, é»˜è®¤å€¼ 5
```

ä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹è¢«æ“ä½œç³»ç»Ÿè°ƒåº¦çš„ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œæ“ä½œç³»ç»Ÿå¯¹é«˜ä¼˜å…ˆçº§çº¿ç¨‹å¯èƒ½è°ƒåº¦æ›´é¢‘ç¹ï¼Œä½†æˆ‘ä»¬å†³ä¸èƒ½é€šè¿‡è®¾ç½®ä¼˜å…ˆçº§æ¥ç¡®ä¿é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä¸€å®šä¼šå…ˆæ‰§è¡Œã€‚



## ğŸ€ ç»ƒä¹ 

åˆ›å»ºæ–°çº¿ç¨‹

```java
package com.itranswarp.learnjava;

public class Main {

	public static void main(String[] args) {
		new Thread1().start();
		new Thread2().start();
		for (int i = 0; i < 100; i++) {
			System.out.println("main: running...");
			try {
				Thread.sleep(1);
			} catch (InterruptedException e) {
			}
		}
	}

}

class Thread1 extends Thread {

	public void run() {
		for (int i = 0; i < 100; i++) {
			System.out.println("Thread-1: running...");
			try {
				Thread.sleep(1);
			} catch (InterruptedException e) {
			}
		}
	}
}

class Thread2 extends Thread {

	public void run() {
		for (int i = 0; i < 100; i++) {
			System.out.println("Thread-2: running...");
			try {
				Thread.sleep(1);
			} catch (InterruptedException e) {
			}
		}
	}
}
```


## ğŸ€ å°ç»“

- Java ç”¨ `Thread` å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹ï¼Œé€šè¿‡è°ƒç”¨ `start()` å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹ï¼›
- ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åªèƒ½è°ƒç”¨ä¸€æ¬¡ `start()` æ–¹æ³•ï¼›
- çº¿ç¨‹çš„æ‰§è¡Œä»£ç å†™åœ¨ `run()` æ–¹æ³•ä¸­ï¼›
- çº¿ç¨‹è°ƒåº¦ç”±æ“ä½œç³»ç»Ÿå†³å®šï¼Œç¨‹åºæœ¬èº«æ— æ³•å†³å®šè°ƒåº¦é¡ºåºï¼›
- `Thread.sleep()` å¯ä»¥æŠŠå½“å‰çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ã€‚



