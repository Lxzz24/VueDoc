---
title: OutputStream
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

å’Œ InputStream ç›¸åï¼ŒOutputStream æ˜¯ Java æ ‡å‡†åº“æä¾›çš„æœ€åŸºæœ¬çš„è¾“å‡ºæµã€‚

å’Œ InputStream ç±»ä¼¼ï¼ŒOutputStream ä¹Ÿæ˜¯æŠ½è±¡ç±»ï¼Œå®ƒæ˜¯æ‰€æœ‰è¾“å‡ºæµçš„è¶…ç±»ã€‚è¿™ä¸ªæŠ½è±¡ç±»å®šä¹‰çš„ä¸€ä¸ªæœ€é‡è¦çš„æ–¹æ³•å°±æ˜¯ void write(int b)ï¼Œç­¾åå¦‚ä¸‹ï¼š

```java
public abstract void write(int b) throws IOException;
```

è¿™ä¸ªæ–¹æ³•ä¼šå†™å…¥ä¸€ä¸ªå­—èŠ‚åˆ°è¾“å‡ºæµã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ä¼ å…¥çš„æ˜¯ int å‚æ•°ï¼Œä½†åªä¼šå†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå³åªå†™å…¥ int æœ€ä½ 8 ä½è¡¨ç¤ºå­—èŠ‚çš„éƒ¨åˆ†ï¼ˆç›¸å½“äº b & 0xffï¼‰ã€‚

å’Œ InputStream ç±»ä¼¼ï¼ŒOutputStream ä¹Ÿæä¾›äº† close() æ–¹æ³•å…³é—­è¾“å‡ºæµï¼Œä»¥ä¾¿é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚è¦ç‰¹åˆ«æ³¨æ„ï¼šOutputStream è¿˜æä¾›äº†ä¸€ä¸ª flush() æ–¹æ³•ï¼Œå®ƒçš„ç›®çš„æ˜¯å°†ç¼“å†²åŒºçš„å†…å®¹çœŸæ­£è¾“å‡ºåˆ°ç›®çš„åœ°ã€‚

ä¸ºä»€ä¹ˆè¦æœ‰ flush()ï¼Ÿå› ä¸ºå‘ç£ç›˜ã€ç½‘ç»œå†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œå‡ºäºæ•ˆç‡çš„è€ƒè™‘ï¼Œæ“ä½œç³»ç»Ÿå¹¶ä¸æ˜¯è¾“å‡ºä¸€ä¸ªå­—èŠ‚å°±ç«‹åˆ»å†™å…¥åˆ°æ–‡ä»¶æˆ–è€…å‘é€åˆ°ç½‘ç»œï¼Œè€Œæ˜¯æŠŠè¾“å‡ºçš„å­—èŠ‚å…ˆæ”¾åˆ°å†…å­˜çš„ä¸€ä¸ªç¼“å†²åŒºé‡Œï¼ˆæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª byte[] æ•°ç»„ï¼‰ï¼Œç­‰åˆ°ç¼“å†²åŒºå†™æ»¡äº†ï¼Œå†ä¸€æ¬¡æ€§å†™å…¥æ–‡ä»¶æˆ–è€…ç½‘ç»œã€‚å¯¹äºå¾ˆå¤š IO è®¾å¤‡æ¥è¯´ï¼Œä¸€æ¬¡å†™ä¸€ä¸ªå­—èŠ‚å’Œä¸€æ¬¡å†™ 1000 ä¸ªå­—èŠ‚ï¼ŒèŠ±è´¹çš„æ—¶é—´å‡ ä¹æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œæ‰€ä»¥ OutputStream æœ‰ä¸ª flush() æ–¹æ³•ï¼Œèƒ½å¼ºåˆ¶æŠŠç¼“å†²åŒºå†…å®¹è¾“å‡ºã€‚

é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦è°ƒç”¨è¿™ä¸ª flush() æ–¹æ³•ï¼Œå› ä¸ºç¼“å†²åŒºå†™æ»¡äº† OutputStream ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒï¼Œå¹¶ä¸”ï¼Œåœ¨è°ƒç”¨ close() æ–¹æ³•å…³é—­ OutputStream ä¹‹å‰ï¼Œä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨ flush() æ–¹æ³•ã€‚

ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨è°ƒç”¨ flush() æ–¹æ³•ã€‚ä¸¾ä¸ªæ —å­ï¼š

å°æ˜æ­£åœ¨å¼€å‘ä¸€æ¬¾åœ¨çº¿èŠå¤©è½¯ä»¶ï¼Œå½“ç”¨æˆ·è¾“å…¥ä¸€å¥è¯åï¼Œå°±é€šè¿‡ OutputStream çš„ write() æ–¹æ³•å†™å…¥ç½‘ç»œæµã€‚å°æ˜æµ‹è¯•çš„æ—¶å€™å‘ç°ï¼Œå‘é€æ–¹è¾“å…¥åï¼Œæ¥æ”¶æ–¹æ ¹æœ¬æ”¶ä¸åˆ°ä»»ä½•ä¿¡æ¯ï¼Œæ€ä¹ˆè‚¥å››ï¼Ÿ

åŸå› å°±åœ¨äºå†™å…¥ç½‘ç»œæµæ˜¯å…ˆå†™å…¥å†…å­˜ç¼“å†²åŒºï¼Œç­‰ç¼“å†²åŒºæ»¡äº†æ‰ä¼šä¸€æ¬¡æ€§å‘é€åˆ°ç½‘ç»œã€‚å¦‚æœç¼“å†²åŒºå¤§å°æ˜¯ 4Kï¼Œåˆ™å‘é€æ–¹è¦æ•²å‡ åƒä¸ªå­—ç¬¦åï¼Œæ“ä½œç³»ç»Ÿæ‰ä¼šæŠŠç¼“å†²åŒºçš„å†…å®¹å‘é€å‡ºå»ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ¥æ”¶æ–¹ä¼šä¸€æ¬¡æ€§æ”¶åˆ°å¤§é‡æ¶ˆæ¯ã€‚

è§£å†³åŠæ³•å°±æ˜¯æ¯è¾“å…¥ä¸€å¥è¯åï¼Œç«‹åˆ»è°ƒç”¨ flush()ï¼Œä¸ç®¡å½“å‰ç¼“å†²åŒºæ˜¯å¦å·²æ»¡ï¼Œå¼ºè¿«æ“ä½œç³»ç»ŸæŠŠç¼“å†²åŒºçš„å†…å®¹ç«‹åˆ»å‘é€å‡ºå»ã€‚

å®é™…ä¸Šï¼ŒInputStream ä¹Ÿæœ‰ç¼“å†²åŒºã€‚ä¾‹å¦‚ï¼Œä» FileInputStream è¯»å–ä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¾€å¾€ä¼šä¸€æ¬¡æ€§è¯»å–è‹¥å¹²å­—èŠ‚åˆ°ç¼“å†²åŒºï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æœªè¯»çš„ç¼“å†²åŒºã€‚ç„¶åï¼Œæ¯æ¬¡æˆ‘ä»¬è°ƒç”¨ int read() è¯»å–ä¸‹ä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿”å›ç¼“å†²åŒºçš„ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œé¿å…æ¯æ¬¡è¯»ä¸€ä¸ªå­—èŠ‚éƒ½å¯¼è‡´ IO æ“ä½œã€‚å½“ç¼“å†²åŒºå…¨éƒ¨è¯»å®Œåç»§ç»­è°ƒç”¨ read()ï¼Œåˆ™ä¼šè§¦å‘æ“ä½œç³»ç»Ÿçš„ä¸‹ä¸€æ¬¡è¯»å–å¹¶å†æ¬¡å¡«æ»¡ç¼“å†²åŒºã€‚

## ğŸ€ FileOutputStream

æˆ‘ä»¬ä»¥ FileOutputStream ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å°†è‹¥å¹²ä¸ªå­—èŠ‚å†™å…¥æ–‡ä»¶æµï¼š

```java
public void writeFile() throws IOException {
    OutputStream output = new FileOutputStream("out/readme.txt");
    output.write(72); // H
    output.write(101); // e
    output.write(108); // l
    output.write(108); // l
    output.write(111); // o
    output.close();
}
```

æ¯æ¬¡å†™å…¥ä¸€ä¸ªå­—èŠ‚éå¸¸éº»çƒ¦ï¼Œæ›´å¸¸è§çš„æ–¹æ³•æ˜¯ä¸€æ¬¡æ€§å†™å…¥è‹¥å¹²å­—èŠ‚ã€‚è¿™æ—¶ï¼Œå¯ä»¥ç”¨ OutputStream æä¾›çš„é‡è½½æ–¹æ³• void write(byte[]) æ¥å®ç°ï¼š

```java
public void writeFile() throws IOException {
    OutputStream output = new FileOutputStream("out/readme.txt");
    output.write("Hello".getBytes("UTF-8")); // Hello
    output.close();
}
```

å’Œ InputStream ä¸€æ ·ï¼Œä¸Šè¿°ä»£ç æ²¡æœ‰è€ƒè™‘åˆ°åœ¨å‘ç”Ÿå¼‚å¸¸çš„æƒ…å†µä¸‹å¦‚ä½•æ­£ç¡®åœ°å…³é—­èµ„æºã€‚å†™å…¥è¿‡ç¨‹ä¹Ÿä¼šç»å¸¸å‘ç”Ÿ IO é”™è¯¯ï¼Œä¾‹å¦‚ï¼Œç£ç›˜å·²æ»¡ï¼Œæ— æƒé™å†™å…¥ç­‰ç­‰ã€‚æˆ‘ä»¬éœ€è¦ç”¨ try(resource) æ¥ä¿è¯ OutputStream åœ¨æ— è®ºæ˜¯å¦å‘ç”Ÿ IO é”™è¯¯çš„æ—¶å€™éƒ½èƒ½å¤Ÿæ­£ç¡®åœ°å…³é—­ï¼š

```java
public void writeFile() throws IOException {
    try (OutputStream output = new FileOutputStream("out/readme.txt")) {
        output.write("Hello".getBytes("UTF-8")); // Hello
    } // ç¼–è¯‘å™¨åœ¨æ­¤è‡ªåŠ¨ä¸ºæˆ‘ä»¬å†™å…¥ finally å¹¶è°ƒç”¨ close()
}
```

## ğŸ€ é˜»å¡

å’Œ InputStream ä¸€æ ·ï¼ŒOutputStream çš„ write() æ–¹æ³•ä¹Ÿæ˜¯é˜»å¡çš„ã€‚

## ğŸ€ OutputStream å®ç°ç±»

ç”¨ FileOutputStream å¯ä»¥ä»æ–‡ä»¶è·å–è¾“å‡ºæµï¼Œè¿™æ˜¯ OutputStream å¸¸ç”¨çš„ä¸€ä¸ªå®ç°ç±»ã€‚æ­¤å¤–ï¼ŒByteArrayOutputStream å¯ä»¥åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ª OutputStreamï¼š

```java
import java.io.*;

public class Main {
    public static void main(String[] args) throws IOException {
        byte[] data;
        try (ByteArrayOutputStream output = new ByteArrayOutputStream()) {
            output.write("Hello ".getBytes("UTF-8"));
            output.write("world!".getBytes("UTF-8"));
            data = output.toByteArray();
        }
        System.out.println(new String(data, "UTF-8"));
    }
}
```

ByteArrayOutputStream å®é™…ä¸Šæ˜¯æŠŠä¸€ä¸ª byte[] æ•°ç»„åœ¨å†…å­˜ä¸­å˜æˆä¸€ä¸ª OutputStreamï¼Œè™½ç„¶å®é™…åº”ç”¨ä¸å¤šï¼Œä½†æµ‹è¯•çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨å®ƒæ¥æ„é€ ä¸€ä¸ª OutputStreamã€‚

åŒæ—¶æ“ä½œå¤šä¸ª AutoCloseable èµ„æºæ—¶ï¼Œåœ¨ try(resource) { ... } è¯­å¥ä¸­å¯ä»¥åŒæ—¶å†™å‡ºå¤šä¸ªèµ„æºï¼Œç”¨; éš”å¼€ã€‚ä¾‹å¦‚ï¼ŒåŒæ—¶è¯»å†™ä¸¤ä¸ªæ–‡ä»¶ï¼š

```java
// è¯»å– input.txtï¼Œå†™å…¥ output.txt:
try (InputStream input = new FileInputStream("input.txt");
     OutputStream output = new FileOutputStream("output.txt"))
{
    input.transferTo(output); // transferTo çš„ä½œç”¨æ˜¯?
}
```

## ğŸ€ ç»ƒä¹ 

è¯·åˆ©ç”¨ InputStream å’Œ OutputStreamï¼Œç¼–å†™ä¸€ä¸ªå¤åˆ¶æ–‡ä»¶çš„ç¨‹åºï¼Œå®ƒå¯ä»¥å¸¦å‚æ•°è¿è¡Œï¼š

java CopyFile.java source.txt copy.txt

```java
import java.io.IOException;

public class CopyFile {

	public static void main(String[] args) throws IOException {
		if (args.length != 2) {
			System.err.println("Usage:\n  java CopyFile.java <source> <target>");
			System.exit(1);
		}
		copy(args[0], args[1]);
	}

	static void copy(String source, String target) throws IOException {
		// å‹æƒ…æç¤ºï¼šæµ‹è¯•æ—¶è¯·ä½¿ç”¨æ— å…³ç´§è¦çš„æ–‡ä»¶
		// TODO:
	}
}
```

## ğŸ€ å°ç»“

Java æ ‡å‡†åº“çš„ java.io.OutputStream å®šä¹‰äº†æ‰€æœ‰è¾“å‡ºæµçš„è¶…ç±»ï¼š

- FileOutputStream å®ç°äº†æ–‡ä»¶æµè¾“å‡ºï¼›
- ByteArrayOutputStream åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªå­—èŠ‚æµè¾“å‡ºã€‚

æŸäº›æƒ…å†µä¸‹éœ€è¦æ‰‹åŠ¨è°ƒç”¨ OutputStream çš„ flush() æ–¹æ³•æ¥å¼ºåˆ¶è¾“å‡ºç¼“å†²åŒºã€‚

æ€»æ˜¯ä½¿ç”¨ try(resource) æ¥ä¿è¯ OutputStream æ­£ç¡®å…³é—­ã€‚
