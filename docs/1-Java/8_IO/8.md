---
title: Reader
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::


Reader æ˜¯ Java çš„ IO åº“æä¾›çš„å¦ä¸€ä¸ªè¾“å…¥æµæ¥å£ã€‚å’Œ InputStream çš„åŒºåˆ«æ˜¯ï¼ŒInputStream æ˜¯ä¸€ä¸ªå­—èŠ‚æµï¼Œå³ä»¥ byte ä¸ºå•ä½è¯»å–ï¼Œè€Œ Reader æ˜¯ä¸€ä¸ªå­—ç¬¦æµï¼Œå³ä»¥ char ä¸ºå•ä½è¯»å–ï¼š

| InputStream | Reader | 
| -- | -- |  
| å­—èŠ‚æµï¼Œä»¥ byte ä¸ºå•ä½ | å­—ç¬¦æµï¼Œä»¥ char ä¸ºå•ä½ | 
| è¯»å–å­—èŠ‚ï¼ˆ-1ï¼Œ0~255ï¼‰ï¼šint read() | è¯»å–å­—ç¬¦ï¼ˆ-1ï¼Œ0~65535ï¼‰ï¼šint read() | 
| è¯»åˆ°å­—èŠ‚æ•°ç»„ï¼šint read(byte[] b) | è¯»åˆ°å­—ç¬¦æ•°ç»„ï¼šint read(char[] c) | 


java.io.Reader æ˜¯æ‰€æœ‰å­—ç¬¦è¾“å…¥æµçš„è¶…ç±»ï¼Œå®ƒæœ€ä¸»è¦çš„æ–¹æ³•æ˜¯ï¼š

```java
public int read() throws IOException;
```

è¿™ä¸ªæ–¹æ³•è¯»å–å­—ç¬¦æµçš„ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶è¿”å›å­—ç¬¦è¡¨ç¤ºçš„ intï¼ŒèŒƒå›´æ˜¯ 0~65535ã€‚å¦‚æœå·²è¯»åˆ°æœ«å°¾ï¼Œè¿”å› - 1ã€‚

## ğŸ€ FileReader

FileReader æ˜¯ Reader çš„ä¸€ä¸ªå­ç±»ï¼Œå®ƒå¯ä»¥æ‰“å¼€æ–‡ä»¶å¹¶è·å– Readerã€‚ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•å®Œæ•´åœ°è¯»å–ä¸€ä¸ª FileReader çš„æ‰€æœ‰å­—ç¬¦ï¼š


```java
public void readFile() throws IOException {
    // åˆ›å»ºä¸€ä¸ª FileReader å¯¹è±¡:
    Reader reader = new FileReader("src/readme.txt"); // å­—ç¬¦ç¼–ç æ˜¯???
    for (;;) {
        int n = reader.read(); // åå¤è°ƒç”¨ read() æ–¹æ³•ï¼Œç›´åˆ°è¿”å› - 1
        if (n == -1) {
            break;
        }
        System.out.println((char)n); // æ‰“å° char
    }
    reader.close(); // å…³é—­æµ
}
```

å¦‚æœæˆ‘ä»¬è¯»å–ä¸€ä¸ªçº¯ ASCII ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ï¼Œä¸Šè¿°ä»£ç å·¥ä½œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†å¦‚æœæ–‡ä»¶ä¸­åŒ…å«ä¸­æ–‡ï¼Œå°±ä¼šå‡ºç°ä¹±ç ï¼Œå› ä¸º FileReader é»˜è®¤çš„ç¼–ç ä¸ç³»ç»Ÿç›¸å…³ï¼Œä¾‹å¦‚ï¼ŒWindows ç³»ç»Ÿçš„é»˜è®¤ç¼–ç å¯èƒ½æ˜¯ GBKï¼Œæ‰“å¼€ä¸€ä¸ª UTF-8 ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶å°±ä¼šå‡ºç°ä¹±ç ã€‚

è¦é¿å…ä¹±ç é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»º FileReader æ—¶æŒ‡å®šç¼–ç ï¼š


```java
Reader reader = new FileReader("src/readme.txt", StandardCharsets.UTF_8);
```


å’Œ InputStream ç±»ä¼¼ï¼ŒReader ä¹Ÿæ˜¯ä¸€ç§èµ„æºï¼Œéœ€è¦ä¿è¯å‡ºé”™çš„æ—¶å€™ä¹Ÿèƒ½æ­£ç¡®å…³é—­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨ try (resource) æ¥ä¿è¯ Reader åœ¨æ— è®ºæœ‰æ²¡æœ‰ IO é”™è¯¯çš„æ—¶å€™éƒ½èƒ½å¤Ÿæ­£ç¡®åœ°å…³é—­ï¼š


```java
try (Reader reader = new FileReader("src/readme.txt", StandardCharsets.UTF_8) {
    // TODO
}
```

Reader è¿˜æä¾›äº†ä¸€æ¬¡æ€§è¯»å–è‹¥å¹²å­—ç¬¦å¹¶å¡«å……åˆ° char[] æ•°ç»„çš„æ–¹æ³•ï¼š

```java
public int read(char[] c) throws IOException
```

å®ƒè¿”å›å®é™…è¯»å…¥çš„å­—ç¬¦ä¸ªæ•°ï¼Œæœ€å¤§ä¸è¶…è¿‡ char[] æ•°ç»„çš„é•¿åº¦ã€‚è¿”å› - 1 è¡¨ç¤ºæµç»“æŸã€‚

åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè®¾ç½®ä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶åï¼Œæ¯æ¬¡å°½å¯èƒ½åœ°å¡«å……ç¼“å†²åŒºï¼š

```java
public void readFile() throws IOException {
    try (Reader reader = new FileReader("src/readme.txt", StandardCharsets.UTF_8)) {
        char[] buffer = new char[1000];
        int n;
        while ((n = reader.read(buffer)) != -1) {
            System.out.println("read" + n + "chars.");
        }
    }
}
```


## ğŸ€ CharArrayReader

CharArrayReader å¯ä»¥åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ª Readerï¼Œå®ƒçš„ä½œç”¨å®é™…ä¸Šæ˜¯æŠŠä¸€ä¸ª char[] æ•°ç»„å˜æˆä¸€ä¸ª Readerï¼Œè¿™å’Œ ByteArrayInputStream éå¸¸ç±»ä¼¼ï¼š


```java
try (Reader reader = new CharArrayReader("Hello".toCharArray())) {
}
```


## ğŸ€ StringReader

StringReader å¯ä»¥ç›´æ¥æŠŠ String ä½œä¸ºæ•°æ®æºï¼Œå®ƒå’Œ CharArrayReader å‡ ä¹ä¸€æ ·ï¼š

```java
try (Reader reader = new StringReader("Hello")) {
}
```

## ğŸ€ InputStreamReader

Reader å’Œ InputStream æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ

é™¤äº†ç‰¹æ®Šçš„ CharArrayReader å’Œ StringReaderï¼Œæ™®é€šçš„ Reader å®é™…ä¸Šæ˜¯åŸºäº InputStream æ„é€ çš„ï¼Œå› ä¸º Reader éœ€è¦ä» InputStream ä¸­è¯»å…¥å­—èŠ‚æµï¼ˆbyteï¼‰ï¼Œç„¶åï¼Œæ ¹æ®ç¼–ç è®¾ç½®ï¼Œå†è½¬æ¢ä¸º char å°±å¯ä»¥å®ç°å­—ç¬¦æµã€‚å¦‚æœæˆ‘ä»¬æŸ¥çœ‹ FileReader çš„æºç ï¼Œå®ƒåœ¨å†…éƒ¨å®é™…ä¸ŠæŒæœ‰ä¸€ä¸ª FileInputStreamã€‚

æ—¢ç„¶ Reader æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŸºäº InputStream çš„ byte åˆ° char çš„è½¬æ¢å™¨ï¼Œé‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ª InputStreamï¼Œæƒ³æŠŠå®ƒè½¬æ¢ä¸º Readerï¼Œæ˜¯å®Œå…¨å¯è¡Œçš„ã€‚InputStreamReader å°±æ˜¯è¿™æ ·ä¸€ä¸ªè½¬æ¢å™¨ï¼Œå®ƒå¯ä»¥æŠŠä»»ä½• InputStream è½¬æ¢ä¸º Readerã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```java
// æŒæœ‰ InputStream:
InputStream input = new FileInputStream("src/readme.txt");
// å˜æ¢ä¸º Reader:
Reader reader = new InputStreamReader(input, "UTF-8");
```

æ„é€  InputStreamReader æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥ InputStreamï¼Œè¿˜éœ€è¦æŒ‡å®šç¼–ç ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª Reader å¯¹è±¡ã€‚ä¸Šè¿°ä»£ç å¯ä»¥é€šè¿‡ try (resource) æ›´ç®€æ´åœ°æ”¹å†™å¦‚ä¸‹ï¼š


```java
try (Reader reader = new InputStreamReader(new FileInputStream("src/readme.txt"), "UTF-8")) {
    // TODO:
}
```

ä¸Šè¿°ä»£ç å®é™…ä¸Šå°±æ˜¯ FileReader çš„ä¸€ç§å®ç°æ–¹å¼ã€‚

ä½¿ç”¨ try (resource) ç»“æ„æ—¶ï¼Œå½“æˆ‘ä»¬å…³é—­ Reader æ—¶ï¼Œå®ƒä¼šåœ¨å†…éƒ¨è‡ªåŠ¨è°ƒç”¨ InputStream çš„ close() æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œåªéœ€è¦å…³é—­æœ€å¤–å±‚çš„ Reader å¯¹è±¡å³å¯ã€‚

 
> [!tip]
> ä½¿ç”¨ InputStreamReaderï¼Œå¯ä»¥æŠŠä¸€ä¸ª InputStream è½¬æ¢æˆä¸€ä¸ª Readerã€‚


## ğŸ€ å°ç»“

Reader å®šä¹‰äº†æ‰€æœ‰å­—ç¬¦è¾“å…¥æµçš„è¶…ç±»ï¼š

- FileReader å®ç°äº†æ–‡ä»¶å­—ç¬¦æµè¾“å…¥ï¼Œä½¿ç”¨æ—¶éœ€è¦æŒ‡å®šç¼–ç ï¼›
- CharArrayReader å’Œ StringReader å¯ä»¥åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªå­—ç¬¦æµè¾“å…¥ã€‚

Reader æ˜¯åŸºäº InputStream æ„é€ çš„ï¼šå¯ä»¥é€šè¿‡ InputStreamReader åœ¨æŒ‡å®šç¼–ç çš„åŒæ—¶å°†ä»»ä½• InputStream è½¬æ¢ä¸º Readerã€‚

æ€»æ˜¯ä½¿ç”¨ try (resource) ä¿è¯ Reader æ­£ç¡®å…³é—­ã€‚


