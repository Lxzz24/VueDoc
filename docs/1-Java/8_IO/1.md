---
title: File å¯¹è±¡
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æ˜¯éžå¸¸é‡è¦çš„å­˜å‚¨æ–¹å¼ã€‚Java çš„æ ‡å‡†åº“ `java.io` æä¾›äº† File å¯¹è±¡æ¥æ“ä½œæ–‡ä»¶å’Œç›®å½•ã€‚

è¦æž„é€ ä¸€ä¸ª File å¯¹è±¡ï¼Œéœ€è¦ä¼ å…¥æ–‡ä»¶è·¯å¾„ï¼š

```java
import java.io.*;
public class Main {
    public static void main(String[] args) {
        File f = new File("C:\\Windows\\notepad.exe");
        System.out.println(f);
    }
}
```

æž„é€  File å¯¹è±¡æ—¶ï¼Œæ—¢å¯ä»¥ä¼ å…¥ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ç›¸å¯¹è·¯å¾„ã€‚

ç»å¯¹è·¯å¾„æ˜¯ä»¥æ ¹ç›®å½•å¼€å¤´çš„å®Œæ•´è·¯å¾„ï¼Œä¾‹å¦‚ï¼š

```java
File f = new File("C:\\Windows\\notepad.exe");
// MacOS å½“å‰è·¯å¾„ï¼š"/Users/lxzz24/Documents/Development/testCode/project_self"
// ç»å¯¹è·¯å¾„ï¼š "/Users/lxzz24/Documents/Development/testCode/project_self/src/com/lxzz/io/hello.txt"
// ç›¸å¯¹è·¯å¾„ï¼š src/com/lxzz/io/hello.txt
```

- æ³¨æ„ Windows å¹³å°ä½¿ç”¨ `\` ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ï¼Œåœ¨ Java å­—ç¬¦ä¸²ä¸­éœ€è¦ç”¨ `\\` è¡¨ç¤ºä¸€ä¸ª `\`ã€‚
- Linux / MacOS å¹³å°ä½¿ç”¨ `/` ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ï¼š

```java
File f = new File("/usr/bin/javac");
```

ä¼ å…¥ç›¸å¯¹è·¯å¾„æ—¶ï¼Œç›¸å¯¹è·¯å¾„å‰é¢åŠ ä¸Šå½“å‰ç›®å½•å°±æ˜¯ç»å¯¹è·¯å¾„ï¼š

```java
// å‡è®¾å½“å‰ç›®å½•æ˜¯ C:\Docs
File f1 = new File("sub\\javac"); // ç»å¯¹è·¯å¾„æ˜¯ C:\Docs\sub\javac
File f3 = new File(".\\sub\\javac"); // ç»å¯¹è·¯å¾„æ˜¯ C:\Docs\sub\javac
File f3 = new File("..\\sub\\javac"); // ç»å¯¹è·¯å¾„æ˜¯ C:\sub\javac
```

å¯ä»¥ç”¨ `.` è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ`..` è¡¨ç¤ºä¸Šçº§ç›®å½•ã€‚

File å¯¹è±¡æœ‰ 3 ç§å½¢å¼è¡¨ç¤ºçš„è·¯å¾„ï¼Œä¸€ç§æ˜¯ `getPath()`ï¼Œè¿”å›žæž„é€ æ–¹æ³•ä¼ å…¥çš„è·¯å¾„ï¼Œä¸€ç§æ˜¯ `getAbsolutePath()`ï¼Œè¿”å›žç»å¯¹è·¯å¾„ï¼Œä¸€ç§æ˜¯ `getCanonicalPath`ï¼Œå®ƒå’Œç»å¯¹è·¯å¾„ç±»ä¼¼ï¼Œä½†æ˜¯è¿”å›žçš„æ˜¯è§„èŒƒè·¯å¾„ã€‚

ä»€ä¹ˆæ˜¯è§„èŒƒè·¯å¾„ï¼Ÿæˆ‘ä»¬çœ‹ä»¥ä¸‹ä»£ç ï¼š

```java
import java.io.*;
public class Main {
    public static void main(String[] args) throws IOException {
        File f = new File("..");
        System.out.println(f.getPath());
        System.out.println(f.getAbsolutePath());
        System.out.println(f.getCanonicalPath());
    }
}
```

ç»å¯¹è·¯å¾„å¯ä»¥è¡¨ç¤ºæˆ `C:\Windows\System32\..\notepad.exe`ï¼Œè€Œè§„èŒƒè·¯å¾„å°±æ˜¯æŠŠ `.` å’Œ `..` è½¬æ¢æˆæ ‡å‡†çš„ç»å¯¹è·¯å¾„åŽçš„è·¯å¾„ï¼š`C:\Windows\notepad.exe`ã€‚

å› ä¸º `Windows` å’Œ `Linux` çš„è·¯å¾„åˆ†éš”ç¬¦ä¸åŒï¼ŒFile å¯¹è±¡æœ‰ä¸€ä¸ªé™æ€å˜é‡ç”¨äºŽè¡¨ç¤ºå½“å‰å¹³å°çš„ç³»ç»Ÿåˆ†éš”ç¬¦ï¼š

```java
System.out.println(File.separator); // æ ¹æ®å½“å‰å¹³å°æ‰“å° "\" æˆ– "/"
```

## ðŸ€ æ–‡ä»¶å’Œç›®å½•

File å¯¹è±¡ _æ—¢å¯ä»¥è¡¨ç¤ºæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºç›®å½•_ã€‚ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼Œæž„é€ ä¸€ä¸ª File å¯¹è±¡ï¼Œå³ä½¿ä¼ å…¥çš„æ–‡ä»¶æˆ–ç›®å½•ä¸å­˜åœ¨ï¼Œä»£ç ä¹Ÿä¸ä¼šå‡ºé”™ï¼Œå› ä¸ºæž„é€ ä¸€ä¸ª File å¯¹è±¡ï¼Œå¹¶ä¸ä¼šå¯¼è‡´ä»»ä½•ç£ç›˜æ“ä½œã€‚åªæœ‰å½“æˆ‘ä»¬è°ƒç”¨ File å¯¹è±¡çš„æŸäº›æ–¹æ³•çš„æ—¶å€™ï¼Œæ‰çœŸæ­£è¿›è¡Œç£ç›˜æ“ä½œã€‚

ä¾‹å¦‚ï¼Œè°ƒç”¨ `isFile()`ï¼Œåˆ¤æ–­è¯¥ File å¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶ï¼Œè°ƒç”¨ `isDirectory()`ï¼Œåˆ¤æ–­è¯¥ File å¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼š

```java
import java.io.*;
public class Main {
    public static void main(String[] args) throws IOException {
        File f1 = new File("C:\\Windows");
        File f2 = new File("C:\\Windows\\notepad.exe");
        File f3 = new File("C:\\Windows\\nothing");
        System.out.println(f1.isFile());
        System.out.println(f1.isDirectory());
        System.out.println(f2.isFile());
        System.out.println(f2.isDirectory());
        System.out.println(f3.isFile());
        System.out.println(f3.isDirectory());
    }
}
```

ç”¨ File å¯¹è±¡èŽ·å–åˆ°ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥åˆ¤æ–­æ–‡ä»¶çš„æƒé™å’Œå¤§å°ï¼š

- `boolean canRead()`ï¼šæ˜¯å¦å¯è¯»ï¼›
- `boolean canWrite()`ï¼šæ˜¯å¦å¯å†™ï¼›
- `boolean canExecute()`ï¼šæ˜¯å¦å¯æ‰§è¡Œï¼›
- `long length()`ï¼šæ–‡ä»¶å­—èŠ‚å¤§å°ã€‚

å¯¹ç›®å½•è€Œè¨€ï¼Œæ˜¯å¦å¯æ‰§è¡Œè¡¨ç¤ºèƒ½å¦åˆ—å‡ºå®ƒåŒ…å«çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚

## ðŸ€ åˆ›å»ºå’Œåˆ é™¤æ–‡ä»¶

å½“ File å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡ `createNewFile()` åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œç”¨ `delete()` åˆ é™¤è¯¥æ–‡ä»¶ï¼š

```java
File file = new File("/path/to/file");
if (file.createNewFile()) {
    // æ–‡ä»¶åˆ›å»ºæˆåŠŸ:
    // TODO:
    if (file.delete()) {
        // åˆ é™¤æ–‡ä»¶æˆåŠŸ:
    }
}
```

æœ‰äº›æ—¶å€™ï¼Œç¨‹åºéœ€è¦è¯»å†™ä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼ŒFile å¯¹è±¡æä¾›äº† `createTempFile()` æ¥åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œä»¥åŠ `deleteOnExit()` åœ¨ JVM é€€å‡ºæ—¶è‡ªåŠ¨åˆ é™¤è¯¥æ–‡ä»¶ã€‚

```java
import java.io.*;
public class Main {
    public static void main(String[] args) throws IOException {
        File f = File.createTempFile("tmp-", ".txt"); // æä¾›ä¸´æ—¶æ–‡ä»¶çš„å‰ç¼€å’ŒåŽç¼€
        f.deleteOnExit(); // JVM é€€å‡ºæ—¶è‡ªåŠ¨åˆ é™¤
        System.out.println(f.isFile());
        System.out.println(f.getAbsolutePath());
    }
}
```

## ðŸ€ éåŽ†æ–‡ä»¶å’Œç›®å½•

å½“ File å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªç›®å½•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `list()` å’Œ `listFiles()` åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•åã€‚`listFiles()` æä¾›äº†ä¸€ç³»åˆ—é‡è½½æ–¹æ³•ï¼Œå¯ä»¥è¿‡æ»¤ä¸æƒ³è¦çš„æ–‡ä»¶å’Œç›®å½•ï¼š

```java
import java.io.*;
public class Main {
    public static void main(String[] args) throws IOException {
        File f = new File("C:\\Windows");
        File[] fs1 = f.listFiles(); // åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•
        printFiles(fs1);
        File[] fs2 = f.listFiles(new FilenameFilter() { // ä»…åˆ—å‡º .exe æ–‡ä»¶
            public boolean accept(File dir, String name) {
                return name.endsWith(".exe"); // è¿”å›ž true è¡¨ç¤ºæŽ¥å—è¯¥æ–‡ä»¶
            }
        });
        printFiles(fs2);
    }

    static void printFiles(File[] files) {
        System.out.println("==========");
        if (files != null) {
            for (File f : files) {
                System.out.println(f);
            }
        }
        System.out.println("==========");
    }
}
```

å’Œæ–‡ä»¶æ“ä½œç±»ä¼¼ï¼ŒFile å¯¹è±¡å¦‚æžœè¡¨ç¤ºä¸€ä¸ªç›®å½•ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•åˆ›å»ºå’Œåˆ é™¤ç›®å½•ï¼š

- `boolean mkdir()`ï¼šåˆ›å»ºå½“å‰ File å¯¹è±¡è¡¨ç¤ºçš„ç›®å½•ï¼›
- `boolean mkdirs()`ï¼šåˆ›å»ºå½“å‰ File å¯¹è±¡è¡¨ç¤ºçš„ç›®å½•ï¼Œå¹¶åœ¨å¿…è¦æ—¶å°†ä¸å­˜åœ¨çš„çˆ¶ç›®å½•ä¹Ÿåˆ›å»ºå‡ºæ¥ï¼›
- `boolean delete()`ï¼šåˆ é™¤å½“å‰ File å¯¹è±¡è¡¨ç¤ºçš„ç›®å½•ï¼Œå½“å‰ç›®å½•å¿…é¡»ä¸ºç©ºæ‰èƒ½åˆ é™¤æˆåŠŸã€‚

## ðŸ€ Path

Java æ ‡å‡†åº“è¿˜æä¾›äº†ä¸€ä¸ª Path å¯¹è±¡ï¼Œå®ƒä½äºŽ `java.nio.file` åŒ…ã€‚Path å¯¹è±¡å’Œ File å¯¹è±¡ç±»ä¼¼ï¼Œä½†æ“ä½œæ›´åŠ ç®€å•ï¼š

```java
import java.io.*;
import java.nio.file.*;

public class Main {
    public static void main(String[] args) throws IOException {
        Path p1 = Paths.get(".", "project", "study"); // æž„é€ ä¸€ä¸ª Path å¯¹è±¡
        System.out.println(p1);
        Path p2 = p1.toAbsolutePath(); // è½¬æ¢ä¸ºç»å¯¹è·¯å¾„
        System.out.println(p2);
        Path p3 = p2.normalize(); // è½¬æ¢ä¸ºè§„èŒƒè·¯å¾„
        System.out.println(p3);
        File f = p3.toFile(); // è½¬æ¢ä¸ºFileå¯¹è±¡
        System.out.println(f);
        for (Path p : Paths.get("..").toAbsolutePath()) { // å¯ä»¥ç›´æŽ¥éåŽ†Path
            System.out.println("  " + p);
        }
    }
}
```

å¦‚æžœéœ€è¦å¯¹ç›®å½•è¿›è¡Œå¤æ‚çš„æ‹¼æŽ¥ã€éåŽ†ç­‰æ“ä½œï¼Œä½¿ç”¨ Path å¯¹è±¡æ›´æ–¹ä¾¿ã€‚

## ðŸ€ ç»ƒä¹ 

::: code-tabs

@tab æ‰“å°ç›®å½•

```java {9,25-27}
// è¯·åˆ©ç”¨ File å¯¹è±¡åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶ï¼Œå¹¶æŒ‰å±‚æ¬¡æ‰“å°ã€‚
public class FileTest {
    public static void main(String[] args) throws IOException {
        File currentDir = new File("./test2024/src/com/lxzz/softdesign");
        listDir(currentDir.getCanonicalFile());
    }

    // æ ‡è®°å½“å‰å±‚çº§è¾ƒæŒ‡å®šç›®å½•çš„æ·±åº¦
    static int deepth = 0;

    static void listDir(File dir) {
        // TODO: é€’å½’æ‰“å°æ‰€æœ‰æ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹çš„å†…å®¹
        File[] fs = dir.listFiles();

        for (File f : fs) {
            // å­ç›®å½•å’Œæ–‡ä»¶è¾ƒä¸Šçº§ç›®å½•ç¼©è¿› 1 ä¸ªåˆ¶è¡¨ç¬¦
            if (deepth > 0) {
                for (int i = 0; i < deepth; i++) {
                    System.out.print("\t");
                }
            }
            // å¦‚æžœæ˜¯ç›®å½•ï¼Œåˆ™é€’å½’æ‰“å°å­ç›®å½•
            if (f.isDirectory()) {
                System.out.println("âŒ„ " + f.getName());
                deepth++;
                listDir(f);
                deepth--;
            } else { // å¦‚æžœæ˜¯æ–‡ä»¶ï¼Œåˆ™æ‰“å°æ–‡ä»¶å
                System.out.println("|----" + f.getName());
            }
        }
    }
}
```

@tab è¾“å‡º

```
âŒ„ behavior
	|----InterpreterPattern.java
âŒ„ algo
	|----NQueen.java
âŒ„ create
	|----SimpleFactory.java
	|----AbstractFactory.java
	|----BuilderTest.java
	|----test.java
	|----FactoryMethod.java
âŒ„ structure
	|----LinkList.java
	|----KMPTest.java
	|----StringTest.java
	|----LinkListTest.java
```

:::

![](./assets/image-20240605223958194.png =200x)

## ðŸ€ å°ç»“

Java æ ‡å‡†åº“çš„ `java.io.File` å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½•ï¼š

- åˆ›å»º File å¯¹è±¡æœ¬èº«ä¸æ¶‰åŠ IO æ“ä½œï¼›
- å¯ä»¥èŽ·å–è·¯å¾„ï¼ç»å¯¹è·¯å¾„ï¼è§„èŒƒè·¯å¾„ï¼š`getPath()` / `getAbsolutePath()` / `getCanonicalPath()`ï¼›
- å¯ä»¥èŽ·å–ç›®å½•çš„æ–‡ä»¶å’Œå­ç›®å½•ï¼š`list()` / `listFiles()`ï¼›
- å¯ä»¥åˆ›å»ºæˆ–åˆ é™¤æ–‡ä»¶å’Œç›®å½•ã€‚
