---
title: è¯»å– classpath èµ„æº
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

å¾ˆå¤š Java ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œéƒ½éœ€è¦è¯»å–é…ç½®æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œä»ä¸€ä¸ª `.properties` æ–‡ä»¶ä¸­è¯»å–é…ç½®ï¼š

```java
String conf = "C:\\conf\\default.properties";
try (InputStream input = new FileInputStream(conf)) {
    // TODO:
}
```

è¿™æ®µä»£ç è¦æ­£å¸¸æ‰§è¡Œï¼Œå¿…é¡»åœ¨ C ç›˜åˆ›å»º conf ç›®å½•ï¼Œç„¶ååœ¨ç›®å½•é‡Œåˆ›å»º `default.properties` æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œåœ¨ Linux ç³»ç»Ÿä¸Šï¼Œè·¯å¾„å’Œ Windows çš„åˆä¸ä¸€æ ·ã€‚

å› æ­¤ï¼Œä»ç£ç›˜çš„å›ºå®šç›®å½•è¯»å–é…ç½®æ–‡ä»¶ï¼Œä¸æ˜¯ä¸€ä¸ªå¥½çš„åŠæ³•ã€‚

æœ‰æ²¡æœ‰è·¯å¾„æ— å…³çš„è¯»å–æ–‡ä»¶çš„æ–¹å¼å‘¢ï¼Ÿ

æˆ‘ä»¬çŸ¥é“ï¼ŒJava å­˜æ”¾ `.class` çš„ç›®å½•æˆ– jar åŒ…ä¹Ÿå¯ä»¥åŒ…å«ä»»æ„å…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š

- é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ `.properties` ï¼›
- å›¾ç‰‡æ–‡ä»¶ï¼Œä¾‹å¦‚ `.jpg` ï¼›
- æ–‡æœ¬æ–‡ä»¶ï¼Œä¾‹å¦‚ `.txt` ï¼Œ`.csv` ï¼›
- ...

ä» classpath è¯»å–æ–‡ä»¶å°±å¯ä»¥é¿å…ä¸åŒç¯å¢ƒä¸‹æ–‡ä»¶è·¯å¾„ä¸ä¸€è‡´çš„é—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬æŠŠ `default.properties` æ–‡ä»¶æ”¾åˆ° classpath ä¸­ï¼Œå°±ä¸ç”¨å…³å¿ƒå®ƒçš„å®é™…å­˜æ”¾è·¯å¾„ã€‚

åœ¨ classpath ä¸­çš„èµ„æºæ–‡ä»¶ï¼Œè·¯å¾„æ€»æ˜¯ä»¥ `ï¼` å¼€å¤´ï¼Œæˆ‘ä»¬å…ˆè·å–å½“å‰çš„ Class å¯¹è±¡ï¼Œç„¶åè°ƒç”¨ `getResourceAsStream()` å°±å¯ä»¥ç›´æ¥ä» classpath è¯»å–ä»»æ„çš„èµ„æºæ–‡ä»¶ï¼š

```java
try (InputStream input = getClass().getResourceAsStream("/default.properties")) {
    // TODO:
}
```

è°ƒç”¨ `getResourceAsStream()` éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœèµ„æºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå®ƒå°†è¿”å› `null`ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥è¿”å›çš„ InputStream æ˜¯å¦ä¸º `null`ï¼Œå¦‚æœä¸º `null`ï¼Œè¡¨ç¤ºèµ„æºæ–‡ä»¶åœ¨ classpath ä¸­æ²¡æœ‰æ‰¾åˆ°ï¼š

```java
try (InputStream input = getClass().getResourceAsStream("/default.properties")) {
    if (input != null) {
        // TODO:
    }
}
```

å¦‚æœæˆ‘ä»¬æŠŠé»˜è®¤çš„é…ç½®æ”¾åˆ° jar åŒ…ä¸­ï¼Œå†ä»å¤–éƒ¨æ–‡ä»¶ç³»ç»Ÿè¯»å–ä¸€ä¸ªå¯é€‰çš„é…ç½®æ–‡ä»¶ï¼Œå°±å¯ä»¥åšåˆ°æ—¢æœ‰é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œåˆå¯ä»¥è®©ç”¨æˆ·è‡ªå·±ä¿®æ”¹é…ç½®ï¼š

```java
Properties props = new Properties();
props.load(inputStreamFromClassPath("/default.properties"));
props.load(inputStreamFromFile("./conf.properties"));
```

è¿™æ ·è¯»å–é…ç½®æ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºå¯åŠ¨å°±æ›´åŠ çµæ´»ã€‚

## ğŸ€ å°ç»“

- æŠŠèµ„æºå­˜å‚¨åœ¨ classpath ä¸­å¯ä»¥é¿å…æ–‡ä»¶è·¯å¾„ä¾èµ–ï¼›

- Class å¯¹è±¡çš„ `getResourceAsStream()` å¯ä»¥ä» classpath ä¸­è¯»å–æŒ‡å®šèµ„æºï¼›

- æ ¹æ® classpath è¯»å–èµ„æºæ—¶ï¼Œéœ€è¦æ£€æŸ¥è¿”å›çš„ InputStream æ˜¯å¦ä¸º `null`ã€‚
