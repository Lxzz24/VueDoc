---
title: ä½¿ç”¨ SLF4J å’Œ Logback
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

å‰é¢ä»‹ç»äº† Commons Logging å’Œ Log4j è¿™ä¸€å¯¹å¥½åŸºå‹ï¼Œå®ƒä»¬ä¸€ä¸ªè´Ÿè´£å……å½“æ—¥å¿— APIï¼Œä¸€ä¸ªè´Ÿè´£å®ç°æ—¥å¿—åº•å±‚ï¼Œæ­é…ä½¿ç”¨éå¸¸ä¾¿äºå¼€å‘ã€‚

æœ‰çš„ç«¥é‹å¯èƒ½è¿˜å¬è¯´è¿‡ SLF4J å’Œ Logbackã€‚è¿™ä¸¤ä¸ªä¸œä¸œçœ‹ä¸Šå»ä¹Ÿåƒæ—¥å¿—ï¼Œå®ƒä»¬åˆæ˜¯å•¥ï¼Ÿ

å…¶å® SLF4J ç±»ä¼¼äº Commons Loggingï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ—¥å¿—æ¥å£ï¼Œè€Œ Logback ç±»ä¼¼äº Log4jï¼Œæ˜¯ä¸€ä¸ªæ—¥å¿—çš„å®ç°ã€‚

ä¸ºä»€ä¹ˆæœ‰äº† Commons Logging å’Œ Log4jï¼Œåˆä¼šè¹¦å‡ºæ¥ SLF4J å’Œ Logbackï¼Ÿè¿™æ˜¯å› ä¸º Java æœ‰ç€éå¸¸æ‚ ä¹…çš„å¼€æºå†å²ï¼Œä¸ä½† OpenJDK æœ¬èº«æ˜¯å¼€æºçš„ï¼Œè€Œä¸”æˆ‘ä»¬ç”¨åˆ°çš„ç¬¬ä¸‰æ–¹åº“ï¼Œå‡ ä¹å…¨éƒ¨éƒ½æ˜¯å¼€æºçš„ã€‚å¼€æºç”Ÿæ€ä¸°å¯Œçš„ä¸€ä¸ªç‰¹å®šå°±æ˜¯ï¼ŒåŒä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥æ‰¾åˆ°è‹¥å¹²ç§äº’ç›¸ç«äº‰çš„å¼€æºåº“ã€‚

å› ä¸ºå¯¹ Commons Logging çš„æ¥å£ä¸æ»¡æ„ï¼Œæœ‰äººå°±æäº† SLF4Jã€‚å› ä¸ºå¯¹ Log4j çš„æ€§èƒ½ä¸æ»¡æ„ï¼Œæœ‰äººå°±æäº† Logbackã€‚

æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ SLF4J å¯¹ Commons Logging çš„æ¥å£æœ‰ä½•æ”¹è¿›ã€‚åœ¨ Commons Logging ä¸­ï¼Œæˆ‘ä»¬è¦æ‰“å°æ—¥å¿—ï¼Œæœ‰æ—¶å€™å¾—è¿™ä¹ˆå†™ï¼š

```java
int score = 99;
p.setScore(score);
log.info("Set score" + score + "for Person" + p.getName() + "ok.");
```

æ‹¼å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªéå¸¸éº»çƒ¦çš„äº‹æƒ…ï¼Œæ‰€ä»¥ SLF4J çš„æ—¥å¿—æ¥å£æ”¹è¿›æˆè¿™æ ·äº†ï¼š

```java
int score = 99;
p.setScore(score);
logger.info("Set score {} for Person {} ok.", score, p.getName());
```

æˆ‘ä»¬é çŒœä¹Ÿèƒ½çŒœå‡ºæ¥ï¼ŒSLF4J çš„æ—¥å¿—æ¥å£ä¼ å…¥çš„æ˜¯ä¸€ä¸ªå¸¦å ä½ç¬¦çš„å­—ç¬¦ä¸²ï¼Œç”¨åé¢çš„å˜é‡è‡ªåŠ¨æ›¿æ¢å ä½ç¬¦ï¼Œæ‰€ä»¥çœ‹èµ·æ¥æ›´åŠ è‡ªç„¶ã€‚

å¦‚ä½•ä½¿ç”¨ SLF4J ï¼Ÿå®ƒçš„æ¥å£å®é™…ä¸Šå’Œ Commons Logging å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼š

```java
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

class Main {
    final Logger logger = LoggerFactory.getLogger(getClass());
}
```

å¯¹æ¯”ä¸€ä¸‹ Commons Logging å’Œ SLF4J çš„æ¥å£ï¼š

![](assets/20220624163032.png)

ä¸åŒä¹‹å¤„å°±æ˜¯ Log å˜æˆäº† Loggerï¼ŒLogFactory å˜æˆäº† LoggerFactoryã€‚

ä½¿ç”¨ SLF4J å’Œ Logback å’Œå‰é¢è®²åˆ°çš„ä½¿ç”¨ Commons Logging åŠ  Log4j æ˜¯ç±»ä¼¼çš„ï¼Œå…ˆåˆ†åˆ«ä¸‹è½½ [SLF4J](https://www.slf4j.org/download.html) å’Œ [Logback](https://logback.qos.ch/download.html) ï¼Œç„¶åæŠŠä»¥ä¸‹ jar åŒ…æ”¾åˆ° classpath ä¸‹ï¼š

- slf4j-api-1.7.x.jar
- logback-classic-1.2.x.jar
- logback-core-1.2.x.jar

ç„¶åä½¿ç”¨ SLF4J çš„ Logger å’Œ LoggerFactory å³å¯ã€‚å’Œ Log4j ç±»ä¼¼ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¸€ä¸ª Logback çš„é…ç½®æ–‡ä»¶ï¼ŒæŠŠ `logback.xml` æ”¾åˆ° classpath ä¸‹ï¼Œé…ç½®å¦‚ä¸‹ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>

	<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
		</encoder>
	</appender>

	<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
		<encoder>
			<pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
			<charset>utf-8</charset>
		</encoder>
		<file>log/output.log</file>
		<rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">
			<fileNamePattern>log/output.log.%i</fileNamePattern>
		</rollingPolicy>
		<triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">
			<MaxFileSize>1MB</MaxFileSize>
		</triggeringPolicy>
	</appender>

	<root level="INFO">
		<appender-ref ref="CONSOLE" />
		<appender-ref ref="FILE" />
	</root>
</configuration>
```

è¿è¡Œå³å¯è·å¾—ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºï¼š

```
13:15:25.328 [main] INFO  com.itranswarp.learnjava.Main - Start process...
```

ä»ç›®å‰çš„è¶‹åŠ¿æ¥çœ‹ï¼Œè¶Šæ¥è¶Šå¤šçš„å¼€æºé¡¹ç›®ä» Commons Logging åŠ  Log4j è½¬å‘äº† SLF4J åŠ  Logbackã€‚

## ğŸ€ ç»ƒä¹ 

æ ¹æ®é…ç½®æ–‡ä»¶ï¼Œè§‚å¯Ÿ Logback å†™å…¥çš„æ—¥å¿—æ–‡ä»¶ã€‚

```java
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.io.UnsupportedEncodingException;

public class SLF4JTest {
    static final Logger logger = LoggerFactory.getLogger(SLF4JTest.class);

    public static void main(String[] args) {
        logger.info("Start process {}...", SLF4JTest.class.getName());
        try {
            "".getBytes("invalidCharsetName");
        } catch (UnsupportedEncodingException e) {
            // TODO: ä½¿ç”¨logger.error(String, Throwable)æ‰“å°å¼‚å¸¸
            logger.error("invalid charset name", e);
        }
        logger.info("Process end.");
    }
}
```

```
16:44:56.564 [main] INFO  javase.test.d.work.SLF4JTest - Start process javase.test.d.work.SLF4JTest...
16:44:56.571 [main] ERROR javase.test.d.work.SLF4JTest - invalid charset name
java.io.UnsupportedEncodingException: invalidCharsetName
	at java.base/java.lang.String.lookupCharset(String.java:819)
	at java.base/java.lang.String.getBytes(String.java:1763)
	at javase.test.d.work.SLF4JTest.main(SLF4JTest.java:15)
16:44:56.571 [main] INFO  javase.test.d.work.SLF4JTest - Process end.
```

## ğŸ€ å°ç»“

- SLF4J å’Œ Logback å¯ä»¥å–ä»£ Commons Logging å’Œ Log4jï¼›
- å§‹ç»ˆä½¿ç”¨ SLF4J çš„æ¥å£å†™å…¥æ—¥å¿—ï¼Œä½¿ç”¨ Logback åªéœ€è¦é…ç½®ï¼Œä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚
