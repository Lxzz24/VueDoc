---
title: Java çš„å¼‚å¸¸
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::


åœ¨è®¡ç®—æœºç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ€»æ˜¯ä¼šå‡ºç°å„ç§å„æ ·çš„é”™è¯¯ã€‚

æœ‰ä¸€äº›é”™è¯¯æ˜¯ç”¨æˆ·é€ æˆçš„ï¼Œæ¯”å¦‚ï¼Œå¸Œæœ›ç”¨æˆ·è¾“å…¥ä¸€ä¸ª `int` ç±»å‹çš„å¹´é¾„ï¼Œä½†æ˜¯ç”¨æˆ·çš„è¾“å…¥æ˜¯ `abc` ï¼š

```java
// å‡è®¾ç”¨æˆ·è¾“å…¥äº† abcï¼š
String s = "abc";
int n = Integer.parseInt(s); // NumberFormatException!
```

ç¨‹åºæƒ³è¦è¯»å†™æŸä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œä½†æ˜¯ç”¨æˆ·å·²ç»æŠŠå®ƒåˆ é™¤äº†ï¼š

```java
// ç”¨æˆ·åˆ é™¤äº†è¯¥æ–‡ä»¶ï¼š
String t = readFile("C:\\abc.txt"); // FileNotFoundException!
```

è¿˜æœ‰ä¸€äº›é”™è¯¯æ˜¯éšæœºå‡ºç°ï¼Œå¹¶ä¸”æ°¸è¿œä¸å¯èƒ½é¿å…çš„ã€‚æ¯”å¦‚ï¼š

- ç½‘ç»œçªç„¶æ–­äº†ï¼Œè¿æ¥ä¸åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼›
- å†…å­˜è€—å°½ï¼Œç¨‹åºå´©æºƒäº†ï¼›
- ç”¨æˆ·ç‚¹ â€œæ‰“å°â€ï¼Œä½†æ ¹æœ¬æ²¡æœ‰æ‰“å°æœºï¼›
- â€¦â€¦

æ‰€ä»¥ï¼Œä¸€ä¸ªå¥å£®çš„ç¨‹åºå¿…é¡»å¤„ç†å„ç§å„æ ·çš„é”™è¯¯ã€‚

æ‰€è°“é”™è¯¯ï¼Œå°±æ˜¯ç¨‹åºè°ƒç”¨æŸä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå¦‚æœå¤±è´¥äº†ï¼Œå°±è¡¨ç¤ºå‡ºé”™ã€‚


## ğŸ€ è°ƒç”¨æ–¹å¦‚ä½•è·çŸ¥è°ƒç”¨å¤±è´¥çš„ä¿¡æ¯ï¼Ÿ

æœ‰ä¸¤ç§æ–¹æ³•ï¼š

### æ–¹æ³•ä¸€

<u>==çº¦å®šè¿”å›é”™è¯¯ç ==</u>

ä¾‹å¦‚ï¼Œå¤„ç†ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœè¿”å› `0` ï¼Œè¡¨ç¤ºæˆåŠŸï¼Œè¿”å›å…¶ä»–æ•´æ•°ï¼Œè¡¨ç¤ºçº¦å®šçš„é”™è¯¯ç ï¼š

```java
int code = processFile("C:\\test.txt");
if (code == 0) {
    // ok:
} else {
    // error:
    switch (code) {
    case 1:
        // file not found:
    case 2:
        // no read permission:
    default:
        // unknown error:
    }
}
```

å› ä¸ºä½¿ç”¨ `int` ç±»å‹çš„é”™è¯¯ç ï¼Œæƒ³è¦å¤„ç†å°±éå¸¸éº»çƒ¦ã€‚è¿™ç§æ–¹å¼å¸¸è§äºåº•å±‚ C å‡½æ•°ã€‚



### æ–¹æ³•äºŒ 

<u>==åœ¨è¯­è¨€å±‚é¢ä¸Šæä¾›ä¸€ä¸ªå¼‚å¸¸å¤„ç†æœºåˆ¶==</u>

Java å†…ç½®äº†ä¸€å¥—å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œæ€»æ˜¯ä½¿ç”¨å¼‚å¸¸æ¥è¡¨ç¤ºé”™è¯¯ã€‚

å¼‚å¸¸æ˜¯ä¸€ç§ `class` ï¼Œå› æ­¤å®ƒæœ¬èº«å¸¦æœ‰ç±»å‹ä¿¡æ¯ã€‚å¼‚å¸¸å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æŠ›å‡ºï¼Œä½†åªéœ€è¦åœ¨ä¸Šå±‚æ•è·ï¼Œè¿™æ ·å°±å’Œæ–¹æ³•è°ƒç”¨åˆ†ç¦»äº†ï¼š

```java
try {
    String s = processFile(â€œC:\\test.txtâ€);
    // ok:
} catch (FileNotFoundException e) {
    // file not found:
} catch (SecurityException e) {
    // no read permission:
} catch (IOException e) {
    // io error:
} catch (Exception e) {
    // other error:
}
```

å› ä¸º Java çš„å¼‚å¸¸æ˜¯ classï¼Œå®ƒçš„ç»§æ‰¿å…³ç³»å¦‚ä¸‹ï¼š

![](assets/20220621222130.png)

ä»ç»§æ‰¿å…³ç³»å¯çŸ¥ï¼š `Throwable` æ˜¯å¼‚å¸¸ä½“ç³»çš„æ ¹ï¼Œå®ƒç»§æ‰¿è‡ª `Object` ã€‚ `Throwable` æœ‰ä¸¤ä¸ªä½“ç³»ï¼š `Error` å’Œ `Exception` ï¼Œ `Error` è¡¨ç¤º ==ä¸¥é‡çš„é”™è¯¯== ï¼Œç¨‹åºå¯¹æ­¤ä¸€èˆ¬æ— èƒ½ä¸ºåŠ›ï¼Œä¾‹å¦‚ï¼š

- `OutOfMemoryError` ï¼šå†…å­˜è€—å°½
- `NoClassDefFoundError` ï¼šæ— æ³•åŠ è½½æŸä¸ª Class
- `StackOverflowError` ï¼šæ ˆæº¢å‡º


è€Œ `Exception` åˆ™æ˜¯è¿è¡Œæ—¶çš„é”™è¯¯ï¼Œå®ƒ ==**å¯ä»¥è¢«æ•è·å¹¶å¤„ç†**==ã€‚

æŸäº›å¼‚å¸¸æ˜¯åº”ç”¨ç¨‹åºé€»è¾‘å¤„ç†çš„ä¸€éƒ¨åˆ†ï¼Œåº”è¯¥æ•è·å¹¶å¤„ç†ã€‚ä¾‹å¦‚ï¼š

- `NumberFormatException` ï¼šæ•°å€¼ç±»å‹çš„æ ¼å¼é”™è¯¯
- `FileNotFoundException` ï¼šæœªæ‰¾åˆ°æ–‡ä»¶
- `SocketException` ï¼šè¯»å–ç½‘ç»œå¤±è´¥


è¿˜æœ‰ä¸€äº›å¼‚å¸¸æ˜¯ç¨‹åºé€»è¾‘ç¼–å†™ä¸å¯¹é€ æˆçš„ï¼Œåº”è¯¥ä¿®å¤ç¨‹åºæœ¬èº«ã€‚ä¾‹å¦‚ï¼š

- `NullPointerException` ï¼šå¯¹æŸä¸ª `null` çš„å¯¹è±¡è°ƒç”¨æ–¹æ³•æˆ–å­—æ®µ
- `IndexOutOfBoundsException` ï¼šæ•°ç»„ç´¢å¼•è¶Šç•Œ


`Exception` åˆåˆ†ä¸ºä¸¤å¤§ç±»ï¼š

1. `RuntimeException` ä»¥åŠå®ƒçš„å­ç±»ï¼›
2. é `RuntimeException` ï¼ˆåŒ…æ‹¬ `IOException` ã€ `ReflectiveOperationException` ç­‰ç­‰ï¼‰


Java è§„å®šï¼š

- å¿…é¡»æ•è·çš„å¼‚å¸¸ï¼ŒåŒ…æ‹¬ `Exception` åŠå…¶å­ç±»ï¼Œä½†ä¸åŒ…æ‹¬ `RuntimeException` åŠå…¶å­ç±»ï¼Œè¿™ç§ç±»å‹çš„å¼‚å¸¸ç§°ä¸º Checked Exception ã€‚
- ä¸éœ€è¦æ•è·çš„å¼‚å¸¸ï¼ŒåŒ…æ‹¬ Error åŠå…¶å­ç±»ï¼ŒRuntimeException åŠå…¶å­ç±»ã€‚

> [!caution]
> ç¼–è¯‘å™¨å¯¹ `RuntimeException` åŠå…¶å­ç±»ä¸åšå¼ºåˆ¶æ•è·è¦æ±‚ï¼Œä¸æ˜¯æŒ‡åº”ç”¨ç¨‹åºæœ¬èº«ä¸åº”è¯¥æ•è·å¹¶å¤„ç† `RuntimeException` ã€‚æ˜¯å¦éœ€è¦æ•è·ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚


## ğŸ€ æ•è·å¼‚å¸¸

æ•è·å¼‚å¸¸ä½¿ç”¨ `try ... catch` è¯­å¥ï¼ŒæŠŠå¯èƒ½å‘ç”Ÿå¼‚å¸¸çš„ä»£ç æ”¾åˆ° `try {...}` ä¸­ï¼Œç„¶åä½¿ç”¨ `catch` æ•è·å¯¹åº”çš„ `Exception` åŠå…¶å­ç±»ï¼š

```java
import java.io.UnsupportedEncodingException;
import java.util.Arrays;
public class Main {
    public static void main(String[] args) {
        byte[] bs = toGBK("ä¸­æ–‡");
        System.out.println(Arrays.toString(bs));
    }

    static byte[] toGBK(String s) {
        try {
            // ç”¨æŒ‡å®šç¼–ç è½¬æ¢ String ä¸º byte[]:
            return s.getBytes("GBK");
        } catch (UnsupportedEncodingException e) {
            // å¦‚æœç³»ç»Ÿä¸æ”¯æŒ GBK ç¼–ç ï¼Œä¼šæ•è·åˆ° UnsupportedEncodingException:
            System.out.println(e); // æ‰“å°å¼‚å¸¸ä¿¡æ¯
            return s.getBytes(); // å°è¯•ä½¿ç”¨ç”¨é»˜è®¤ç¼–ç 
        }
    }
}
```


å¦‚æœæˆ‘ä»¬ä¸æ•è· `UnsupportedEncodingException` ï¼Œä¼šå‡ºç°ç¼–è¯‘å¤±è´¥çš„é—®é¢˜ï¼š

```java
import java.io.UnsupportedEncodingException;
import java.util.Arrays;
public class Main {
    public static void main(String[] args) {
        byte[] bs = toGBK("ä¸­æ–‡");
        System.out.println(Arrays.toString(bs));
    }

    static byte[] toGBK(String s) {
        return s.getBytes("GBK");
    }
}
```


ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œé”™è¯¯ä¿¡æ¯ç±»ä¼¼ï¼š`unreported exception UnsupportedEncodingException; must be caught or declared to be thrown` ï¼Œå¹¶ä¸”å‡†ç¡®åœ°æŒ‡å‡ºéœ€è¦æ•è·çš„è¯­å¥æ˜¯ `return s.getBytes("GBK");` ã€‚æ„æ€æ˜¯è¯´ï¼Œåƒ `UnsupportedEncodingException` è¿™æ ·çš„ Checked Exception ï¼Œå¿…é¡»è¢«æ•è·ã€‚


è¿™æ˜¯å› ä¸º `String.getBytes(String)` æ–¹æ³•å®šä¹‰æ˜¯ï¼š


```java
public byte[] getBytes(String charsetName) throws UnsupportedEncodingException {
    ...
}
```

åœ¨æ–¹æ³•å®šä¹‰çš„æ—¶å€™ï¼Œä½¿ç”¨ `throws Xxx` è¡¨ç¤ºè¯¥æ–¹æ³•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚è°ƒç”¨æ–¹åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œå¿…é¡»å¼ºåˆ¶æ•è·è¿™äº›å¼‚å¸¸ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚

åœ¨ `toGBK()` æ–¹æ³•ä¸­ï¼Œå› ä¸ºè°ƒç”¨äº† `String.getBytes(String)` æ–¹æ³•ï¼Œå°±å¿…é¡»æ•è· `UnsupportedEncodingException` ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸æ•è·å®ƒï¼Œè€Œæ˜¯åœ¨æ–¹æ³•å®šä¹‰å¤„ç”¨ `throws` è¡¨ç¤º `toGBK()` æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡º `UnsupportedEncodingException` ï¼Œå°±å¯ä»¥è®© `toGBK()` æ–¹æ³•é€šè¿‡ç¼–è¯‘å™¨æ£€æŸ¥ï¼š


```java
// try...catch
import java.io.UnsupportedEncodingException;
import java.util.Arrays;
public class Main {
    public static void main(String[] args) {
        byte[] bs = toGBK("ä¸­æ–‡");
        System.out.println(Arrays.toString(bs));
    }

    static byte[] toGBK(String s) throws UnsupportedEncodingException {
        return s.getBytes("GBK");
    }
}
```


ä¸Šè¿°ä»£ç ä»ç„¶ä¼šå¾—åˆ°ç¼–è¯‘é”™è¯¯ï¼Œä½†è¿™ä¸€æ¬¡ï¼Œç¼–è¯‘å™¨æç¤ºçš„ä¸æ˜¯è°ƒç”¨ `return s.getBytes("GBK");` çš„é—®é¢˜ï¼Œè€Œæ˜¯ `byte[] bs = toGBK("ä¸­æ–‡");` ã€‚å› ä¸ºåœ¨ `main()` æ–¹æ³•ä¸­ï¼Œè°ƒç”¨ `toGBK()` ï¼Œæ²¡æœ‰æ•è·å®ƒå£°æ˜çš„å¯èƒ½æŠ›å‡ºçš„ `UnsupportedEncodingException` ã€‚

ä¿®å¤æ–¹æ³•æ˜¯åœ¨ `main()` æ–¹æ³•ä¸­æ•è·å¼‚å¸¸å¹¶å¤„ç†ï¼š


```java
// try...catch
import java.io.UnsupportedEncodingException;
import java.util.Arrays;
public class Main {
    public static void main(String[] args) {
        try {
            byte[] bs = toGBK("ä¸­æ–‡");
            System.out.println(Arrays.toString(bs));
        } catch (UnsupportedEncodingException e) {
            System.out.println(e);
        }
    }

    static byte[] toGBK(String s) throws UnsupportedEncodingException {
        // ç”¨æŒ‡å®šç¼–ç è½¬æ¢ String ä¸º byte[]:
        return s.getBytes("GBK");
    }
}
```


å¯è§ï¼Œåªè¦æ˜¯æ–¹æ³•å£°æ˜çš„ Checked Exception ï¼Œä¸åœ¨è°ƒç”¨å±‚æ•è·ï¼Œä¹Ÿå¿…é¡»åœ¨æ›´é«˜çš„è°ƒç”¨å±‚æ•è·ã€‚æ‰€æœ‰æœªæ•è·çš„å¼‚å¸¸ï¼Œæœ€ç»ˆä¹Ÿå¿…é¡»åœ¨ `main()` æ–¹æ³•ä¸­æ•è·ï¼Œä¸ä¼šå‡ºç°æ¼å†™ `try` çš„æƒ…å†µã€‚è¿™æ˜¯ç”±ç¼–è¯‘å™¨ä¿è¯çš„ã€‚ `main()` æ–¹æ³•ä¹Ÿæ˜¯æœ€åæ•è· `Exception` çš„æœºä¼šã€‚

å¦‚æœæ˜¯æµ‹è¯•ä»£ç ï¼Œä¸Šé¢çš„å†™æ³•å°±ç•¥æ˜¾éº»çƒ¦ã€‚å¦‚æœä¸æƒ³å†™ä»»ä½• `try` ä»£ç ï¼Œå¯ä»¥ç›´æ¥æŠŠ `main()` æ–¹æ³•å®šä¹‰ä¸º `throws Exception` ï¼š


```java
import java.io.UnsupportedEncodingException;
import java.util.Arrays;
public class Main {
    public static void main(String[] args) throws Exception {
        byte[] bs = toGBK("ä¸­æ–‡");
        System.out.println(Arrays.toString(bs));
    }

    static byte[] toGBK(String s) throws UnsupportedEncodingException {
        // ç”¨æŒ‡å®šç¼–ç è½¬æ¢ String ä¸º byte[]:
        return s.getBytes("GBK");
    }
}
```


å› ä¸º `main()` æ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡º `Exception` ï¼Œä¹Ÿå°±å£°æ˜äº†å¯èƒ½æŠ›å‡ºæ‰€æœ‰çš„ `Exception` ï¼Œå› æ­¤åœ¨å†…éƒ¨å°±æ— éœ€æ•è·äº†ã€‚ä»£ä»·å°±æ˜¯ä¸€æ—¦å‘ç”Ÿå¼‚å¸¸ï¼Œç¨‹åºä¼šç«‹åˆ»é€€å‡ºã€‚

è¿˜æœ‰ä¸€äº›ç«¥é‹å–œæ¬¢åœ¨ `toGBK()` å†…éƒ¨ â€œæ¶ˆåŒ–â€ å¼‚å¸¸ï¼š


```java
static byte[] toGBK(String s) {
    try {
        return s.getBytes("GBK");
    } catch (UnsupportedEncodingException e) {
        // ä»€ä¹ˆä¹Ÿä¸å¹²
    }
    return null;
}
```

è¿™ç§æ•è·åä¸å¤„ç†çš„æ–¹å¼æ˜¯éå¸¸ä¸å¥½çš„ï¼Œå³ä½¿çœŸçš„ä»€ä¹ˆä¹Ÿåšä¸äº†ï¼Œä¹Ÿè¦å…ˆæŠŠå¼‚å¸¸è®°å½•ä¸‹æ¥ï¼š


```java
static byte[] toGBK(String s) {
    try {
        return s.getBytes("GBK");
    } catch (UnsupportedEncodingException e) {
        // å…ˆè®°ä¸‹æ¥å†è¯´:
        e.printStackTrace();
    }
    return null;
}
```

æ‰€æœ‰å¼‚å¸¸éƒ½å¯ä»¥è°ƒç”¨ `printStackTrace()` æ–¹æ³•æ‰“å°å¼‚å¸¸æ ˆï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•æœ‰ç”¨çš„å¿«é€Ÿæ‰“å°å¼‚å¸¸çš„æ–¹æ³•ã€‚

## ğŸ€ å°ç»“

- Java ä½¿ç”¨å¼‚å¸¸æ¥è¡¨ç¤ºé”™è¯¯ï¼Œå¹¶é€šè¿‡ `try ... catch` æ•è·å¼‚å¸¸ï¼›
- Java çš„å¼‚å¸¸æ˜¯ `class` ï¼Œå¹¶ä¸”ä» `Throwable` ç»§æ‰¿ï¼›
- `Error` æ˜¯æ— éœ€æ•è·çš„ä¸¥é‡é”™è¯¯ï¼Œ `Exception` æ˜¯åº”è¯¥æ•è·çš„å¯å¤„ç†çš„é”™è¯¯ï¼›
- `RuntimeException` æ— éœ€å¼ºåˆ¶æ•è·ï¼Œé `RuntimeException` ï¼ˆChecked Exceptionï¼‰éœ€å¼ºåˆ¶æ•è·ï¼Œæˆ–è€…ç”¨ `throws` å£°æ˜ï¼›
- **ä¸æ¨èæ•è·äº†å¼‚å¸¸ä½†ä¸è¿›è¡Œä»»ä½•å¤„ç†ã€‚**



