---
title: NullPointerException
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

## ğŸ€ RuntimeException

åœ¨æ‰€æœ‰çš„ `RuntimeException` å¼‚å¸¸ä¸­ï¼ŒJava ç¨‹åºå‘˜æœ€ç†Ÿæ‚‰çš„ææ€•å°±æ˜¯ `NullPointerException` äº†ã€‚

`NullPointerException` å³ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œä¿—ç§° NPEã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸º `null`ï¼Œè°ƒç”¨å…¶æ–¹æ³•æˆ–è®¿é—®å…¶å­—æ®µå°±ä¼šäº§ç”Ÿ `NullPointerException`ï¼Œè¿™ä¸ªå¼‚å¸¸é€šå¸¸æ˜¯ç”± JVM æŠ›å‡ºçš„ï¼Œä¾‹å¦‚ï¼š

```java
public class Main {
    public static void main(String[] args) {
        String s = null;
        System.out.println(s.toLowerCase());
    }
}
```

æŒ‡é’ˆè¿™ä¸ªæ¦‚å¿µå®é™…ä¸Šæºè‡ª C è¯­è¨€ï¼ŒJava è¯­è¨€ä¸­å¹¶æ— æŒ‡é’ˆã€‚æˆ‘ä»¬å®šä¹‰çš„å˜é‡å®é™…ä¸Šæ˜¯å¼•ç”¨ï¼ŒNull Pointer æ›´ç¡®åˆ‡åœ°è¯´æ˜¯ Null Reference ï¼Œä¸è¿‡ä¸¤è€…åŒºåˆ«ä¸å¤§ã€‚

## ğŸ€ å¤„ç† NullPointerException

å¦‚æœé‡åˆ° `NullPointerException`ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿé¦–å…ˆï¼Œå¿…é¡»æ˜ç¡®ï¼Œ**_`NullPointerException` æ˜¯ä¸€ç§ä»£ç é€»è¾‘é”™è¯¯_** ï¼Œé‡åˆ° `NullPointerException`ï¼Œéµå¾ªåŸåˆ™æ˜¯æ—©æš´éœ²ï¼Œæ—©ä¿®å¤ï¼Œ**ä¸¥ç¦ä½¿ç”¨ `catch` æ¥éšè—è¿™ç§ç¼–ç é”™è¯¯** ï¼š

```java
// é”™è¯¯ç¤ºä¾‹: æ•è· NullPointerException
try {
    transferMoney(from, to, amount);
} catch (NullPointerException e) {
}
```

å¥½çš„ç¼–ç ä¹ æƒ¯å¯ä»¥æå¤§åœ°é™ä½ `NullPointerException` çš„äº§ç”Ÿï¼Œä¾‹å¦‚ï¼š

- _æˆå‘˜å˜é‡åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–_ ï¼š

```java
public class Person {
    private String name = "";
}
```

ä½¿ç”¨ç©ºå­—ç¬¦ä¸² `""` è€Œä¸æ˜¯é»˜è®¤çš„ `null` å¯é¿å…å¾ˆå¤š `NullPointerException`ï¼Œç¼–å†™ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œç”¨ç©ºå­—ç¬¦ä¸² `""` è¡¨ç¤ºæœªå¡«å†™æ¯” `null` å®‰å…¨å¾—å¤šã€‚

- _è¿”å›ç©ºå­—ç¬¦ä¸² `""`ã€ç©ºæ•°ç»„è€Œä¸æ˜¯ `null`_ ï¼š

```java
public String[] readLinesFromFile(String file) {
    if (getFileSize(file) == 0) {
        // è¿”å›ç©ºæ•°ç»„è€Œä¸æ˜¯ null:
        return new String[0];
    }
    ...
}
```

è¿™æ ·å¯ä»¥ä½¿å¾—è°ƒç”¨æ–¹æ— éœ€æ£€æŸ¥ç»“æœæ˜¯å¦ä¸º `null` ã€‚

å¦‚æœè°ƒç”¨æ–¹ä¸€å®šè¦æ ¹æ® `null` åˆ¤æ–­ï¼Œæ¯”å¦‚è¿”å› `null` è¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè€ƒè™‘è¿”å› `Optional<T>` ï¼š

```java
public Optional<String> readFromFile(String file) {
    if (!fileExist(file)) {
        return Optional.empty();
    }
    ...
}
```

è¿™æ ·è°ƒç”¨æ–¹å¿…é¡»é€šè¿‡ `Optional.isPresent()` åˆ¤æ–­æ˜¯å¦æœ‰ç»“æœã€‚

## ğŸ€ å®šä½ NullPointerException

å¦‚æœäº§ç”Ÿäº† `NullPointerException`ï¼Œä¾‹å¦‚ï¼Œè°ƒç”¨ `a.b.c.x()` æ—¶äº§ç”Ÿäº† `NullPointerException`ï¼ŒåŸå› å¯èƒ½æ˜¯ï¼š

- `a` æ˜¯ `null` ï¼›
- `a.b` æ˜¯ `null` ï¼›
- `a.b.c` æ˜¯ `null` ï¼›

ç¡®å®šåˆ°åº•æ˜¯å“ªä¸ªå¯¹è±¡æ˜¯ `null` ä»¥å‰åªèƒ½æ‰“å°è¿™æ ·çš„æ—¥å¿—ï¼š

```
System.out.println(a);
System.out.println(a.b);
System.out.println(a.b.c);
```

ä» Java 14 å¼€å§‹ï¼Œå¦‚æœäº§ç”Ÿäº† `NullPointerException`ï¼ŒJVM å¯ä»¥ç»™å‡ºè¯¦ç»†çš„ä¿¡æ¯å‘Šè¯‰æˆ‘ä»¬ `null` å¯¹è±¡åˆ°åº•æ˜¯è°ã€‚æˆ‘ä»¬æ¥çœ‹ä¾‹å­ï¼š

```java
public class Main {
    public static void main(String[] args) {
        Person p = new Person();
        System.out.println(p.address.city.toLowerCase());
    }
}

class Person {
    String[] name = new String[2];
    Address address = new Address();
}

class Address {
    String city;
    String street;
    String zipcode;
}
```

å¯ä»¥åœ¨ `NullPointerException` çš„è¯¦ç»†ä¿¡æ¯ä¸­çœ‹åˆ°ç±»ä¼¼ `... because "<local1>.address.city" is null`ï¼Œæ„æ€æ˜¯ `city` å­—æ®µä¸º `null`ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¿«é€Ÿå®šä½é—®é¢˜æ‰€åœ¨ã€‚

è¿™ç§å¢å¼ºçš„ `NullPointerException` è¯¦ç»†ä¿¡æ¯æ˜¯ Java 14 æ–°å¢çš„åŠŸèƒ½ã€‚

## ğŸ€ å°ç»“

`NullPointerException` æ˜¯ Java ä»£ç å¸¸è§çš„é€»è¾‘é”™è¯¯ï¼Œåº”å½“æ—©æš´éœ²ï¼Œæ—©ä¿®å¤ï¼›

å¯ä»¥å¯ç”¨ Java 14 çš„å¢å¼ºå¼‚å¸¸ä¿¡æ¯æ¥æŸ¥çœ‹ `NullPointerException` çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚
