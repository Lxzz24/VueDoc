---
title: æ•è·å¼‚å¸¸
sidebarDepth: 1
category: Java æ•™ç¨‹
tag: Java
---

::: details ç›®å½•
[[toc]]
:::

åœ¨ Java ä¸­ï¼Œå‡¡æ˜¯å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„è¯­å¥ï¼Œéƒ½å¯ä»¥ç”¨ `try ... catch` æ•è·ã€‚æŠŠå¯èƒ½å‘ç”Ÿå¼‚å¸¸çš„è¯­å¥æ”¾åœ¨ `try { ... }` ä¸­ï¼Œç„¶åä½¿ç”¨ `catch` æ•è·å¯¹åº”çš„ `Exception` åŠå…¶å­ç±»ã€‚

## ğŸ€ å¤š catch è¯­å¥

å¯ä»¥ä½¿ç”¨å¤šä¸ª `catch` è¯­å¥ï¼Œæ¯ä¸ª `catch` åˆ†åˆ«æ•è·å¯¹åº”çš„ `Exception` åŠå…¶å­ç±»ã€‚JVM åœ¨æ•è·åˆ°å¼‚å¸¸åï¼Œä¼šä»ä¸Šåˆ°ä¸‹åŒ¹é… `catch` è¯­å¥ï¼ŒåŒ¹é…åˆ°æŸä¸ª `catch` åï¼Œæ‰§è¡Œ `catch` ä»£ç å—ï¼Œç„¶å**ä¸å†**ç»§ç»­åŒ¹é…ã€‚

ç®€å•åœ°è¯´å°±æ˜¯ï¼š **_å¤šä¸ª `catch` è¯­å¥åªæœ‰ä¸€ä¸ªèƒ½è¢«æ‰§è¡Œã€‚_** ä¾‹å¦‚ï¼š

```java
public static void main(String[] args) {
    try {
        process1();
        process2();
        process3();
    } catch (IOException e) {
        System.out.println(e);
    } catch (NumberFormatException e) {
        System.out.println(e);
    }
}
```

å­˜åœ¨å¤šä¸ª `catch` çš„æ—¶å€™ï¼Œ`catch` çš„é¡ºåºéå¸¸é‡è¦ï¼š **_å­ç±»å¿…é¡»å†™åœ¨å‰é¢ã€‚_** ä¾‹å¦‚ï¼š

```java
public static void main(String[] args) {
    try {
        process1();
        process2();
        process3();
    } catch (IOException e) {
        System.out.println("IO error");
    } catch (UnsupportedEncodingException e) { // æ°¸è¿œæ•è·ä¸åˆ°
        System.out.println("Bad encoding");
    }
}
```

å¯¹äºä¸Šé¢çš„ä»£ç ï¼Œ`UnsupportedEncodingException` å¼‚å¸¸æ˜¯æ°¸è¿œæ•è·ä¸åˆ°çš„ï¼Œå› ä¸ºå®ƒæ˜¯ `IOException` çš„å­ç±»ã€‚å½“æŠ›å‡º `UnsupportedEncodingException` å¼‚å¸¸æ—¶ï¼Œä¼šè¢« `catch (IOException e) { ... }` æ•è·å¹¶æ‰§è¡Œã€‚

å› æ­¤ï¼Œæ­£ç¡®çš„å†™æ³•æ˜¯æŠŠå­ç±»æ”¾åˆ°å‰é¢ï¼š

```java
public static void main(String[] args) {
    try {
        process1();
        process2();
        process3();
    } catch (UnsupportedEncodingException e) {
        System.out.println("Bad encoding");
    } catch (IOException e) {
        System.out.println("IO error");
    }
}
```

## ğŸ€ finally è¯­å¥

æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸å‘ç”Ÿï¼Œå¦‚æœæˆ‘ä»¬éƒ½å¸Œæœ›æ‰§è¡Œä¸€äº›è¯­å¥ï¼Œä¾‹å¦‚æ¸…ç†å·¥ä½œï¼Œæ€ä¹ˆå†™ï¼Ÿ

å¯ä»¥æŠŠæ‰§è¡Œè¯­å¥å†™è‹¥å¹²éï¼šæ­£å¸¸æ‰§è¡Œçš„æ”¾åˆ° `try` ä¸­ï¼Œæ¯ä¸ª `catch` å†å†™ä¸€éã€‚ä¾‹å¦‚ï¼š

```java
public static void main(String[] args) {
    try {
        process1();
        process2();
        process3();
        System.out.println("END");
    } catch (UnsupportedEncodingException e) {
        System.out.println("Bad encoding");
        System.out.println("END");
    } catch (IOException e) {
        System.out.println("IO error");
        System.out.println("END");
    }
}
```

ä¸Šè¿°ä»£ç æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œ `System.out.println("END");` è¿™æ¡è¯­å¥ã€‚

é‚£ä¹ˆå¦‚ä½•æ¶ˆé™¤è¿™äº›é‡å¤çš„ä»£ç ï¼ŸJava çš„ `try ... catch` æœºåˆ¶è¿˜æä¾›äº† `finally` è¯­å¥ï¼Œ`finally` è¯­å¥å—ä¿è¯æœ‰æ— é”™è¯¯éƒ½ä¼šæ‰§è¡Œã€‚ä¸Šè¿°ä»£ç å¯ä»¥æ”¹å†™å¦‚ä¸‹ï¼š

```java
public static void main(String[] args) {
    try {
        process1();
        process2();
        process3();
    } catch (UnsupportedEncodingException e) {
        System.out.println("Bad encoding");
    } catch (IOException e) {
        System.out.println("IO error");
    } finally {
        System.out.println("END");
    }
}
```

æ³¨æ„ `finally` æœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š

1. `finally` è¯­å¥ä¸æ˜¯å¿…é¡»çš„ï¼Œå¯å†™å¯ä¸å†™ï¼›
2. `finally` æ€»æ˜¯æœ€åæ‰§è¡Œã€‚

å¦‚æœæ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ï¼Œå°±æ­£å¸¸æ‰§è¡Œ `try { ... }` è¯­å¥å—ï¼Œç„¶åæ‰§è¡Œ `finally` ã€‚å¦‚æœå‘ç”Ÿäº†å¼‚å¸¸ï¼Œå°±ä¸­æ–­æ‰§è¡Œ `try { ... }` è¯­å¥å—ï¼Œç„¶åè·³è½¬æ‰§è¡ŒåŒ¹é…çš„ `catch` è¯­å¥å—ï¼Œæœ€åæ‰§è¡Œ `finally` ã€‚

å¯è§ï¼Œ`finally` æ˜¯ç”¨æ¥ä¿è¯ä¸€äº›ä»£ç å¿…é¡»æ‰§è¡Œçš„ã€‚

æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥æ²¡æœ‰ `catch`ï¼Œåªä½¿ç”¨ `try ... finally` ç»“æ„ã€‚ä¾‹å¦‚ï¼š

```java
void process(String file) throws IOException {
    try {
        ...
    } finally {
        System.out.println("END");
    }
}
```

å› ä¸ºæ–¹æ³•å£°æ˜äº†å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ‰€ä»¥å¯ä»¥ä¸å†™ `catch` ã€‚

## ğŸ€ æ•è·å¤šç§å¼‚å¸¸

å¦‚æœæŸäº›å¼‚å¸¸çš„å¤„ç†é€»è¾‘ç›¸åŒï¼Œä½†æ˜¯å¼‚å¸¸æœ¬èº«ä¸å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œé‚£ä¹ˆå°±å¾—ç¼–å†™å¤šæ¡ `catch` å­å¥ï¼š

```java
public static void main(String[] args) {
    try {
        process1();
        process2();
        process3();
    } catch (IOException e) {
        System.out.println("Bad input");
    } catch (NumberFormatException e) {
        System.out.println("Bad input");
    } catch (Exception e) {
        System.out.println("Unknown error");
    }
}
```

å› ä¸ºå¤„ç† `IOException` å’Œ `NumberFormatException` çš„ä»£ç æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä¸¤ç”¨ `|` åˆå¹¶åˆ°ä¸€èµ·ï¼š

```java
public static void main(String[] args) {
    try {
        process1();
        process2();
        process3();
    } catch (IOException | NumberFormatException e) { // IOException æˆ– NumberFormatException
        System.out.println("Bad input");
    } catch (Exception e) {
        System.out.println("Unknown error");
    }
}
```

## ğŸ€ ç»ƒä¹ 

ç”¨ `try ... catch` æ•è·å¼‚å¸¸å¹¶å¤„ç†ã€‚

```java
public class TryCatchTest {
    public static void main(String[] args) {

        //ç»ƒä¹ ï¼šç”¨ try ... catch æ•è·å¼‚å¸¸å¹¶å¤„ç†
        String a = "12";
        String b = "x9";

        // TODO: æ•è·å¼‚å¸¸å¹¶å¤„ç†
        try {
            int c = stringToInt(a);
            int d = stringToInt(b);
            System.out.println(c * d);
        }catch (NumberFormatException e){
            System.out.println(e);
        }finally {
            System.out.println("End");
        }
    }

    static int stringToInt(String s) {
        return Integer.parseInt(s);
    }
}
```

## ğŸ€ å°ç»“

ä½¿ç”¨ `try ... catch ... finally` æ—¶ï¼š

- å¤šä¸ª `catch` è¯­å¥çš„åŒ¹é…é¡ºåºéå¸¸é‡è¦ï¼Œå­ç±»å¿…é¡»æ”¾åœ¨å‰é¢ï¼›
- `finally` è¯­å¥ä¿è¯äº†æœ‰æ— å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œï¼Œå®ƒæ˜¯å¯é€‰çš„ï¼›
- ä¸€ä¸ª `catch` è¯­å¥ä¹Ÿå¯ä»¥åŒ¹é…å¤šä¸ªéç»§æ‰¿å…³ç³»çš„å¼‚å¸¸ã€‚
