import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as c,c as l,a as n,b as a,w as t,d as u,e as p}from"./app-CvlAI_tu.js";const i="/VueDoc/assets/l-20231128143540172-DmC0FsFm.jpeg",k={},r={class:"hint-container details"},d=n("summary",null,"ç›®å½•",-1),m={class:"table-of-contents"},v=u('<p>å¯¹ç§°åŠ å¯†ç®—æ³•å°±æ˜¯ä¼ ç»Ÿçš„ç”¨ä¸€ä¸ªå¯†ç è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„ WinZIP å’Œ WinRAR å¯¹å‹ç¼©åŒ…çš„åŠ å¯†å’Œè§£å¯†ï¼Œå°±æ˜¯ä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•ï¼š</p><figure><img src="'+i+`" alt="winrar" tabindex="0" loading="lazy"><figcaption>winrar</figcaption></figure><p>ä»ç¨‹åºçš„è§’åº¦çœ‹ï¼Œæ‰€è°“åŠ å¯†ï¼Œå°±æ˜¯è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥æ”¶å¯†ç å’Œæ˜æ–‡ï¼Œç„¶åè¾“å‡ºå¯†æ–‡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>secret <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è€Œè§£å¯†åˆ™ç›¸åï¼Œå®ƒæ¥æ”¶å¯†ç å’Œå¯†æ–‡ï¼Œç„¶åè¾“å‡ºæ˜æ–‡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>plain <span class="token operator">=</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œå¸¸ç”¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼š</p><table><thead><tr><th style="text-align:left;">ç®—æ³•</th><th style="text-align:left;">å¯†é’¥é•¿åº¦</th><th style="text-align:left;">å·¥ä½œæ¨¡å¼</th><th style="text-align:left;">å¡«å……æ¨¡å¼</th></tr></thead><tbody><tr><td style="text-align:left;">DES</td><td style="text-align:left;">56/64</td><td style="text-align:left;">ECB/CBC/PCBC/CTR/...</td><td style="text-align:left;">NoPadding/PKCS5Padding/...</td></tr><tr><td style="text-align:left;">AES</td><td style="text-align:left;">128/192/256</td><td style="text-align:left;">ECB/CBC/PCBC/CTR/...</td><td style="text-align:left;">NoPadding/PKCS5Padding/PKCS7Padding/...</td></tr><tr><td style="text-align:left;">IDEA</td><td style="text-align:left;">128</td><td style="text-align:left;">ECB</td><td style="text-align:left;">PKCS5Padding/PKCS7Padding/...</td></tr></tbody></table><p>å¯†é’¥é•¿åº¦ç›´æ¥å†³å®šåŠ å¯†å¼ºåº¦ï¼Œè€Œå·¥ä½œæ¨¡å¼å’Œå¡«å……æ¨¡å¼å¯ä»¥çœ‹æˆæ˜¯å¯¹ç§°åŠ å¯†ç®—æ³•çš„å‚æ•°å’Œæ ¼å¼é€‰æ‹©ã€‚Java æ ‡å‡†åº“æä¾›çš„ç®—æ³•å®ç°å¹¶ä¸åŒ…æ‹¬æ‰€æœ‰çš„å·¥ä½œæ¨¡å¼å’Œæ‰€æœ‰å¡«å……æ¨¡å¼ï¼Œä½†æ˜¯é€šå¸¸æˆ‘ä»¬åªéœ€è¦æŒ‘é€‰å¸¸ç”¨çš„ä½¿ç”¨å°±å¯ä»¥äº†ã€‚</p><p>æœ€åæ³¨æ„ï¼ŒDES ç®—æ³•ç”±äºå¯†é’¥è¿‡çŸ­ï¼Œå¯ä»¥åœ¨çŸ­æ—¶é—´å†…è¢«æš´åŠ›ç ´è§£ï¼Œæ‰€ä»¥ç°åœ¨å·²ç»ä¸å®‰å…¨äº†ã€‚</p><h2 id="ğŸ€-ä½¿ç”¨-aes-åŠ å¯†" tabindex="-1"><a class="header-anchor" href="#ğŸ€-ä½¿ç”¨-aes-åŠ å¯†" aria-hidden="true">#</a> ğŸ€ ä½¿ç”¨ AES åŠ å¯†</h2><p>AES ç®—æ³•æ˜¯ç›®å‰åº”ç”¨æœ€å¹¿æ³›çš„åŠ å¯†ç®—æ³•ã€‚æˆ‘ä»¬å…ˆç”¨ ECB æ¨¡å¼åŠ å¯†å¹¶è§£å¯†ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// åŸæ–‡:</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Message:&quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 128 ä½å¯†é’¥ = 16 bytes Key:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key <span class="token operator">=</span> <span class="token string">&quot;1234567890abcdef&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ å¯†:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encrypted <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Encrypted:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§£å¯†:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decrypted <span class="token operator">=</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> encrypted<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Decrypted:&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åŠ å¯†:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;AES/ECB/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKey</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&quot;AES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è§£å¯†:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;AES/ECB/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKey</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&quot;AES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Java æ ‡å‡†åº“æä¾›çš„å¯¹ç§°åŠ å¯†æ¥å£éå¸¸ç®€å•ï¼Œä½¿ç”¨æ—¶æŒ‰ä»¥ä¸‹æ­¥éª¤ç¼–å†™ä»£ç ï¼š</p><ol><li>æ ¹æ®ç®—æ³•åç§° / å·¥ä½œæ¨¡å¼ / å¡«å……æ¨¡å¼è·å– Cipher å®ä¾‹ï¼›</li><li>æ ¹æ®ç®—æ³•åç§°åˆå§‹åŒ–ä¸€ä¸ª SecretKey å®ä¾‹ï¼Œå¯†é’¥å¿…é¡»æ˜¯æŒ‡å®šé•¿åº¦ï¼›</li><li>ä½¿ç”¨ SecretKey åˆå§‹åŒ– Cipher å®ä¾‹ï¼Œå¹¶è®¾ç½®åŠ å¯†æˆ–è§£å¯†æ¨¡å¼ï¼›</li><li>ä¼ å…¥æ˜æ–‡æˆ–å¯†æ–‡ï¼Œè·å¾—å¯†æ–‡æˆ–æ˜æ–‡ã€‚</li></ol><p>ECB æ¨¡å¼æ˜¯æœ€ç®€å•çš„ AES åŠ å¯†æ¨¡å¼ï¼Œå®ƒåªéœ€è¦ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å¯†é’¥ï¼Œå›ºå®šçš„æ˜æ–‡ä¼šç”Ÿæˆå›ºå®šçš„å¯†æ–‡ï¼Œè¿™ç§ä¸€å¯¹ä¸€çš„åŠ å¯†æ–¹å¼ä¼šå¯¼è‡´å®‰å…¨æ€§é™ä½ï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯é€šè¿‡ CBC æ¨¡å¼ï¼Œå®ƒéœ€è¦ä¸€ä¸ªéšæœºæ•°ä½œä¸º IV å‚æ•°ï¼Œè¿™æ ·å¯¹äºåŒä¸€ä»½æ˜æ–‡ï¼Œæ¯æ¬¡ç”Ÿæˆçš„å¯†æ–‡éƒ½ä¸åŒï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// åŸæ–‡:</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Message:&quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 256 ä½å¯†é’¥ = 32 bytes Key:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key <span class="token operator">=</span> <span class="token string">&quot;1234567890abcdef1234567890abcdef&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ å¯†:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encrypted <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Encrypted:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§£å¯†:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decrypted <span class="token operator">=</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> encrypted<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Decrypted:&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åŠ å¯†:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;AES/CBC/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&quot;AES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// CBC æ¨¡å¼éœ€è¦ç”Ÿæˆä¸€ä¸ª 16 bytes çš„ initialization vector:</span>
        <span class="token class-name">SecureRandom</span> sr <span class="token operator">=</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">.</span><span class="token function">getInstanceStrong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> iv <span class="token operator">=</span> sr<span class="token punctuation">.</span><span class="token function">generateSeed</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IvParameterSpec</span> ivps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IvParameterSpec</span><span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> keySpec<span class="token punctuation">,</span> ivps<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// IV ä¸éœ€è¦ä¿å¯†ï¼ŒæŠŠ IV å’Œå¯†æ–‡ä¸€èµ·è¿”å›:</span>
        <span class="token keyword">return</span> <span class="token function">join</span><span class="token punctuation">(</span>iv<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è§£å¯†:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token comment">// æŠŠ input åˆ†å‰²æˆ IV å’Œå¯†æ–‡:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> iv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>input<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> iv<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§£å¯†:</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;AES/CBC/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token string">&quot;AES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IvParameterSpec</span> ivps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IvParameterSpec</span><span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> keySpec<span class="token punctuation">,</span> ivps<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bs1<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bs2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>bs1<span class="token punctuation">.</span>length <span class="token operator">+</span> bs2<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>bs1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> bs1<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>bs2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> r<span class="token punctuation">,</span> bs1<span class="token punctuation">.</span>length<span class="token punctuation">,</span> bs2<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> r<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ CBC æ¨¡å¼ä¸‹ï¼Œéœ€è¦ä¸€ä¸ªéšæœºç”Ÿæˆçš„ 16 å­—èŠ‚ IV å‚æ•°ï¼Œå¿…é¡»ä½¿ç”¨ <code>SecureRandom</code> ç”Ÿæˆã€‚å› ä¸ºå¤šäº†ä¸€ä¸ª <code>IvParameterSpec</code> å®ä¾‹ï¼Œå› æ­¤ï¼Œåˆå§‹åŒ–æ–¹æ³•éœ€è¦è°ƒç”¨ <code>Cipher</code> çš„ä¸€ä¸ªé‡è½½æ–¹æ³•å¹¶ä¼ å…¥ <code>IvParameterSpec</code>ã€‚</p><p>è§‚å¯Ÿè¾“å‡ºï¼Œå¯ä»¥å‘ç°æ¯æ¬¡ç”Ÿæˆçš„ IV ä¸åŒï¼Œå¯†æ–‡ä¹Ÿä¸åŒã€‚</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>å¯¹ç§°åŠ å¯†ç®—æ³•ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œå¸¸ç”¨ç®—æ³•æœ‰ DESã€AES å’Œ IDEA ç­‰ï¼›</p><p>å¯†é’¥é•¿åº¦ç”±ç®—æ³•è®¾è®¡å†³å®šï¼ŒAES çš„å¯†é’¥é•¿åº¦æ˜¯ 128/192/256 ä½ï¼›</p><p>ä½¿ç”¨å¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦æŒ‡å®šç®—æ³•åç§°ã€å·¥ä½œæ¨¡å¼å’Œå¡«å……æ¨¡å¼ã€‚</p>`,23);function y(b,g){const s=o("router-link");return c(),l("div",null,[n("details",r,[d,n("nav",m,[n("ul",null,[n("li",null,[a(s,{to:"#ğŸ€-ä½¿ç”¨-aes-åŠ å¯†"},{default:t(()=>[p("ğŸ€ ä½¿ç”¨ AES åŠ å¯†")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å°ç»“"},{default:t(()=>[p("ğŸ€ å°ç»“")]),_:1})])])])]),v])}const f=e(k,[["render",y],["__file","5.html.vue"]]);export{f as default};
