import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as c,o,c as l,a as n,b as a,w as t,d as i,e as p}from"./app-CvlAI_tu.js";const u={},k={class:"hint-container details"},r=n("summary",null,"ç›®å½•",-1),d={class:"table-of-contents"},m=i(`<p>ä» DH ç®—æ³•æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå…¬é’¥ - ç§é’¥ç»„æˆçš„å¯†é’¥å¯¹æ˜¯éå¸¸æœ‰ç”¨çš„åŠ å¯†æ–¹å¼ï¼Œå› ä¸ºå…¬é’¥æ˜¯å¯ä»¥å…¬å¼€çš„ï¼Œè€Œç§é’¥æ˜¯å®Œå…¨ä¿å¯†çš„ï¼Œç”±æ­¤å¥ å®šäº†éå¯¹ç§°åŠ å¯†çš„åŸºç¡€ã€‚</p><p>éå¯¹ç§°åŠ å¯†å°±æ˜¯åŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„ä¸æ˜¯ç›¸åŒçš„å¯†é’¥ï¼šåªæœ‰åŒä¸€ä¸ªå…¬é’¥ - ç§é’¥å¯¹æ‰èƒ½æ­£å¸¸åŠ è§£å¯†ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœå°æ˜è¦åŠ å¯†ä¸€ä¸ªæ–‡ä»¶å‘é€ç»™å°çº¢ï¼Œä»–åº”è¯¥é¦–å…ˆå‘å°çº¢ç´¢å–å¥¹çš„å…¬é’¥ï¼Œç„¶åï¼Œä»–ç”¨å°çº¢çš„å…¬é’¥åŠ å¯†ï¼ŒæŠŠåŠ å¯†æ–‡ä»¶å‘é€ç»™å°çº¢ï¼Œæ­¤æ–‡ä»¶åªèƒ½ç”±å°çº¢çš„ç§é’¥è§£å¼€ï¼Œå› ä¸ºå°çº¢çš„ç§é’¥åœ¨å¥¹è‡ªå·±æ‰‹é‡Œï¼Œæ‰€ä»¥ï¼Œé™¤äº†å°çº¢ï¼Œæ²¡æœ‰ä»»ä½•äººèƒ½è§£å¼€æ­¤æ–‡ä»¶ã€‚</p><p>éå¯¹ç§°åŠ å¯†çš„å…¸å‹ç®—æ³•å°±æ˜¯ RSA ç®—æ³•ï¼Œå®ƒæ˜¯ç”± Ron Rivestï¼ŒAdi Shamirï¼ŒLeonard Adleman è¿™ä¸‰ä¸ªå“¥ä»¬ä¸€èµ·å‘æ˜çš„ï¼Œæ‰€ä»¥ç”¨ä»–ä»¬ä»¨çš„å§“çš„é¦–å­—æ¯ç¼©å†™è¡¨ç¤ºã€‚</p><p>éå¯¹ç§°åŠ å¯†ç›¸æ¯”å¯¹ç§°åŠ å¯†çš„æ˜¾è‘—ä¼˜ç‚¹åœ¨äºï¼Œå¯¹ç§°åŠ å¯†éœ€è¦åå•†å¯†é’¥ï¼Œè€Œéå¯¹ç§°åŠ å¯†å¯ä»¥å®‰å…¨åœ°å…¬å¼€å„è‡ªçš„å…¬é’¥ï¼Œåœ¨ N ä¸ªäººä¹‹é—´é€šä¿¡çš„æ—¶å€™ï¼šä½¿ç”¨éå¯¹ç§°åŠ å¯†åªéœ€è¦ N ä¸ªå¯†é’¥å¯¹ï¼Œæ¯ä¸ªäººåªç®¡ç†è‡ªå·±çš„å¯†é’¥å¯¹ã€‚è€Œä½¿ç”¨å¯¹ç§°åŠ å¯†éœ€è¦åˆ™éœ€è¦ <code>N*(N-1)/2</code> ä¸ªå¯†é’¥ï¼Œå› æ­¤æ¯ä¸ªäººéœ€è¦ç®¡ç† <code>N-1</code> ä¸ªå¯†é’¥ï¼Œå¯†é’¥ç®¡ç†éš¾åº¦å¤§ï¼Œè€Œä¸”éå¸¸å®¹æ˜“æ³„æ¼ã€‚</p><p>æ—¢ç„¶éå¯¹ç§°åŠ å¯†è¿™ä¹ˆå¥½ï¼Œé‚£æˆ‘ä»¬æŠ›å¼ƒå¯¹ç§°åŠ å¯†ï¼Œå®Œå…¨ä½¿ç”¨éå¯¹ç§°åŠ å¯†è¡Œä¸è¡Œï¼Ÿä¹Ÿä¸è¡Œã€‚å› ä¸ºéå¯¹ç§°åŠ å¯†çš„ç¼ºç‚¹å°±æ˜¯è¿ç®—é€Ÿåº¦éå¸¸æ…¢ï¼Œæ¯”å¯¹ç§°åŠ å¯†è¦æ…¢å¾ˆå¤šã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œéå¯¹ç§°åŠ å¯†æ€»æ˜¯å’Œå¯¹ç§°åŠ å¯†ä¸€èµ·ä½¿ç”¨ã€‚å‡è®¾å°æ˜éœ€è¦ç»™å°çº¢éœ€è¦ä¼ è¾“åŠ å¯†æ–‡ä»¶ï¼Œä»–ä¿©é¦–å…ˆäº¤æ¢äº†å„è‡ªçš„å…¬é’¥ï¼Œç„¶åï¼š</p><ol><li>å°æ˜ç”Ÿæˆä¸€ä¸ªéšæœºçš„ AES å£ä»¤ï¼Œç„¶åç”¨å°çº¢çš„å…¬é’¥é€šè¿‡ RSA åŠ å¯†è¿™ä¸ªå£ä»¤ï¼Œå¹¶å‘ç»™å°çº¢ï¼›</li><li>å°çº¢ç”¨è‡ªå·±çš„ RSA ç§é’¥è§£å¯†å¾—åˆ° AES å£ä»¤ï¼›</li><li>åŒæ–¹ä½¿ç”¨è¿™ä¸ªå…±äº«çš„ AES å£ä»¤ç”¨ AES åŠ å¯†é€šä¿¡ã€‚</li></ol><p>å¯è§éå¯¹ç§°åŠ å¯†å®é™…ä¸Šåº”ç”¨åœ¨ç¬¬ä¸€æ­¥ï¼Œå³åŠ å¯† â€œAES å£ä»¤â€ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­å¸¸ç”¨çš„ HTTPS åè®®çš„åšæ³•ï¼Œå³æµè§ˆå™¨å’ŒæœåŠ¡å™¨å…ˆé€šè¿‡ RSA äº¤æ¢ AES å£ä»¤ï¼Œæ¥ä¸‹æ¥åŒæ–¹é€šä¿¡å®é™…ä¸Šé‡‡ç”¨çš„æ˜¯é€Ÿåº¦è¾ƒå¿«çš„ AES å¯¹ç§°åŠ å¯†ï¼Œè€Œä¸æ˜¯ç¼“æ…¢çš„ RSA éå¯¹ç§°åŠ å¯†ã€‚</p><p>Java æ ‡å‡†åº“æä¾›äº† RSA ç®—æ³•çš„å®ç°ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigInteger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">Cipher</span></span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ˜æ–‡:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plain <span class="token operator">=</span> <span class="token string">&quot;Hello, encrypt use RSA&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ›å»ºå…¬é’¥ï¼ç§é’¥å¯¹:</span>
        <span class="token class-name">Person</span> alice <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç”¨ Alice çš„å…¬é’¥åŠ å¯†:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pk <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;public key: %x&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encrypted <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;encrypted: %x&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> encrypted<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç”¨ Alice çš„ç§é’¥è§£å¯†:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sk <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">getPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;private key: %x&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> sk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decrypted <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token comment">// ç§é’¥:</span>
    <span class="token class-name">PrivateKey</span> sk<span class="token punctuation">;</span>
    <span class="token comment">// å…¬é’¥:</span>
    <span class="token class-name">PublicKey</span> pk<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token comment">// ç”Ÿæˆå…¬é’¥ï¼ç§é’¥å¯¹:</span>
        <span class="token class-name">KeyPairGenerator</span> kpGen <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;RSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        kpGen<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KeyPair</span> kp <span class="token operator">=</span> kpGen<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sk <span class="token operator">=</span> kp<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pk <span class="token operator">=</span> kp<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æŠŠç§é’¥å¯¼å‡ºä¸ºå­—èŠ‚</span>
    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sk<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æŠŠå…¬é’¥å¯¼å‡ºä¸ºå­—èŠ‚</span>
    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pk<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç”¨å…¬é’¥åŠ å¯†:</span>
    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;RSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pk<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç”¨ç§é’¥è§£å¯†:</span>
    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;RSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sk<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>RSA çš„å…¬é’¥å’Œç§é’¥éƒ½å¯ä»¥é€šè¿‡ <code>getEncoded()</code> æ–¹æ³•è·å¾—ä»¥ <code>byte[]</code> è¡¨ç¤ºçš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶æ ¹æ®éœ€è¦ä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚è¦ä» <code>byte[]</code> æ•°ç»„æ¢å¤å…¬é’¥æˆ–ç§é’¥ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pkData <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> skData <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token class-name">KeyFactory</span> kf <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;RSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ¢å¤å…¬é’¥:</span>
<span class="token class-name">X509EncodedKeySpec</span> pkSpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>pkData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PublicKey</span> pk <span class="token operator">=</span> kf<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>pkSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ¢å¤ç§é’¥:</span>
<span class="token class-name">PKCS8EncodedKeySpec</span> skSpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">(</span>skData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PrivateKey</span> sk <span class="token operator">=</span> kf<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span>skSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ RSA ç®—æ³•ä¸ºä¾‹ï¼Œå®ƒçš„å¯†é’¥æœ‰ 256/512/1024/2048/4096 ç­‰ä¸åŒçš„é•¿åº¦ã€‚é•¿åº¦è¶Šé•¿ï¼Œå¯†ç å¼ºåº¦è¶Šå¤§ï¼Œå½“ç„¶è®¡ç®—é€Ÿåº¦ä¹Ÿè¶Šæ…¢ã€‚</p><p>å¦‚æœä¿®æ”¹å¾…åŠ å¯†çš„ <code>byte[]</code> æ•°æ®çš„å¤§å°ï¼Œå¯ä»¥å‘ç°ï¼Œä½¿ç”¨ 512bit çš„ RSA åŠ å¯†æ—¶ï¼Œæ˜æ–‡é•¿åº¦ä¸èƒ½è¶…è¿‡ 53 å­—èŠ‚ï¼Œä½¿ç”¨ 1024bit çš„ RSA åŠ å¯†æ—¶ï¼Œæ˜æ–‡é•¿åº¦ä¸èƒ½è¶…è¿‡ 117 å­—èŠ‚ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨ RSA çš„æ—¶å€™ï¼Œæ€»æ˜¯é…åˆ AES ä¸€èµ·ä½¿ç”¨ï¼Œå³ç”¨ AES åŠ å¯†ä»»æ„é•¿åº¦çš„æ˜æ–‡ï¼Œç”¨ RSA åŠ å¯† AES å£ä»¤ã€‚</p><p>æ­¤å¤–ï¼Œåªä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•ä¸èƒ½é˜²æ­¢ä¸­é—´äººæ”»å‡»ã€‚</p><h2 id="ğŸ€-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç»ƒä¹ " aria-hidden="true">#</a> ğŸ€ ç»ƒä¹ </h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itranswarp<span class="token punctuation">.</span>learnjava</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigInteger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">Cipher</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
		<span class="token comment">// æ˜æ–‡:</span>
		<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plain <span class="token operator">=</span> <span class="token string">&quot;Helloï¼Œä½¿ç”¨ RSA éå¯¹ç§°åŠ å¯†ç®—æ³•å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// åˆ›å»ºå…¬é’¥ï¼ç§é’¥å¯¹:</span>
		<span class="token class-name">Person</span> alice <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// ç”¨ Alice çš„å…¬é’¥åŠ å¯†:</span>
		<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pk <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;public key: %x&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encrypted <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;encrypted: %x&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> encrypted<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// ç”¨ Alice çš„ç§é’¥è§£å¯†:</span>
		<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sk <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">getPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;private key: %x&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> sk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decrypted <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
	<span class="token class-name">String</span> name<span class="token punctuation">;</span>
	<span class="token comment">// ç§é’¥:</span>
	<span class="token class-name">PrivateKey</span> sk<span class="token punctuation">;</span>
	<span class="token comment">// å…¬é’¥:</span>
	<span class="token class-name">PublicKey</span> pk<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
		<span class="token comment">// ç”Ÿæˆå…¬é’¥ï¼ç§é’¥å¯¹:</span>
		<span class="token class-name">KeyPairGenerator</span> kpGen <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;RSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		kpGen<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">KeyPair</span> kp <span class="token operator">=</span> kpGen<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>sk <span class="token operator">=</span> kp<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>pk <span class="token operator">=</span> kp<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// æŠŠç§é’¥å¯¼å‡ºä¸ºå­—èŠ‚</span>
	<span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sk<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// æŠŠå…¬é’¥å¯¼å‡ºä¸ºå­—èŠ‚</span>
	<span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pk<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ç”¨å…¬é’¥åŠ å¯†:</span>
	<span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
		<span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;RSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pk<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ç”¨ç§é’¥è§£å¯†:</span>
	<span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
		<span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;RSA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sk<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>éå¯¹ç§°åŠ å¯†å°±æ˜¯åŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„ä¸æ˜¯ç›¸åŒçš„å¯†é’¥ï¼Œåªæœ‰åŒä¸€ä¸ªå…¬é’¥ - ç§é’¥å¯¹æ‰èƒ½æ­£å¸¸åŠ è§£å¯†ï¼›</p><p>åªä½¿ç”¨éå¯¹ç§°åŠ å¯†ç®—æ³•ä¸èƒ½é˜²æ­¢ä¸­é—´äººæ”»å‡»ã€‚</p>`,21);function v(b,y){const s=c("router-link");return o(),l("div",null,[n("details",k,[r,n("nav",d,[n("ul",null,[n("li",null,[a(s,{to:"#ğŸ€-ç»ƒä¹ "},{default:t(()=>[p("ğŸ€ ç»ƒä¹ ")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å°ç»“"},{default:t(()=>[p("ğŸ€ å°ç»“")]),_:1})])])])]),m])}const f=e(u,[["render",v],["__file","8.html.vue"]]);export{f as default};
