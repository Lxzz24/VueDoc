import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as e,o as t,c as p,a as n,b as c,w as o,d as l,e as i}from"./app-CvlAI_tu.js";const u={},d={class:"hint-container details"},r=n("summary",null,"ç›®å½•",-1),k={class:"table-of-contents"},m=l(`<p>å‰é¢æˆ‘ä»¬è®²äº†å„ç§é”çš„å®ç°ï¼Œæœ¬è´¨ä¸Šé”çš„ç›®çš„æ˜¯ä¿æŠ¤ä¸€ç§å—é™èµ„æºï¼Œä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®ï¼ˆReentrantLockï¼‰ï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å†™å…¥ï¼ˆReadWriteLockï¼‰ã€‚</p><p>è¿˜æœ‰ä¸€ç§å—é™èµ„æºï¼Œå®ƒéœ€è¦ä¿è¯åŒä¸€æ—¶åˆ»æœ€å¤šæœ‰ N ä¸ªçº¿ç¨‹èƒ½è®¿é—®ï¼Œæ¯”å¦‚åŒä¸€æ—¶åˆ»æœ€å¤šåˆ›å»º 100 ä¸ªæ•°æ®åº“è¿æ¥ï¼Œæœ€å¤šå…è®¸ 10 ä¸ªç”¨æˆ·ä¸‹è½½ç­‰ã€‚</p><p>è¿™ç§é™åˆ¶æ•°é‡çš„é”ï¼Œå¦‚æœç”¨ Lock æ•°ç»„æ¥å®ç°ï¼Œå°±å¤ªéº»çƒ¦äº†ã€‚</p><p>è¿™ç§æƒ…å†µå°±å¯ä»¥ä½¿ç”¨ <code>Semaphore</code>ï¼Œä¾‹å¦‚ï¼Œæœ€å¤šå…è®¸ 3 ä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccessLimitControl</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä»»æ„æ—¶åˆ»ä»…å…è®¸æœ€å¤š 3 ä¸ªçº¿ç¨‹è·å–è®¸å¯:</span>
    <span class="token keyword">final</span> <span class="token class-name">Semaphore</span> semaphore <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Semaphore</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">access</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¦‚æœè¶…è¿‡äº†è®¸å¯æ•°é‡, å…¶ä»–çº¿ç¨‹å°†åœ¨æ­¤ç­‰å¾…:</span>
        semaphore<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// TODO:</span>
            <span class="token keyword">return</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            semaphore<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ <code>Semaphore</code> å…ˆè°ƒç”¨ <code>acquire()</code> è·å–ï¼Œç„¶åé€šè¿‡ <code>try ... finally</code> ä¿è¯åœ¨ <code>finally</code> ä¸­é‡Šæ”¾ã€‚</p><p>è°ƒç”¨ <code>acquire()</code> å¯èƒ½ä¼šè¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>tryAcquire()</code> æŒ‡å®šç­‰å¾…æ—¶é—´ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>semaphore<span class="token punctuation">.</span><span class="token function">tryAcquire</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æŒ‡å®šç­‰å¾…æ—¶é—´ 3 ç§’å†…è·å–åˆ°è®¸å¯:</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO:</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        semaphore<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Semaphore</code> æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªä¿¡å·è®¡æ•°å™¨ï¼Œç”¨äºé™åˆ¶åŒä¸€æ—¶é—´çš„æœ€å¤§è®¿é—®æ•°é‡ã€‚</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>å¦‚æœè¦å¯¹æŸä¸€å—é™èµ„æºè¿›è¡Œé™æµè®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨ <code>Semaphore</code>ï¼Œä¿è¯åŒä¸€æ—¶é—´æœ€å¤š N ä¸ªçº¿ç¨‹è®¿é—®å—é™èµ„æºã€‚</p>`,11);function v(b,h){const s=e("router-link");return t(),p("div",null,[n("details",d,[r,n("nav",k,[n("ul",null,[n("li",null,[c(s,{to:"#ğŸ€-å°ç»“"},{default:o(()=>[i("ğŸ€ å°ç»“")]),_:1})])])])]),m])}const y=a(u,[["render",v],["__file","14.html.vue"]]);export{y as default};
