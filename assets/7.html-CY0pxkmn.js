import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as e,o as p,c as t,a as n,b as c,w as o,d as i,e as l}from"./app-CvlAI_tu.js";const u={},d={class:"hint-container details"},k=n("summary",null,"ç›®å½•",-1),r={class:"table-of-contents"},v=i(`<p>æˆ‘ä»¬çŸ¥é“ Java ç¨‹åºä¾é  <code>synchronized</code> å¯¹çº¿ç¨‹è¿›è¡ŒåŒæ­¥ï¼Œä½¿ç”¨ <code>synchronized</code> çš„æ—¶å€™ï¼Œé”ä½çš„æ˜¯å“ªä¸ªå¯¹è±¡éå¸¸é‡è¦ã€‚</p><p>è®©çº¿ç¨‹è‡ªå·±é€‰æ‹©é”å¯¹è±¡å¾€å¾€ä¼šä½¿å¾—ä»£ç é€»è¾‘æ··ä¹±ï¼Œä¹Ÿä¸åˆ©äºå°è£…ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯æŠŠ <code>synchronized</code> é€»è¾‘å°è£…èµ·æ¥ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªè®¡æ•°å™¨å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dec</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count <span class="token operator">-=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ä¸€æ¥ï¼Œçº¿ç¨‹è°ƒç”¨ <code>add()</code>ã€<code>dec()</code> æ–¹æ³•æ—¶ï¼Œå®ƒä¸å¿…å…³å¿ƒåŒæ­¥é€»è¾‘ï¼Œå› ä¸º <code>synchronized</code> ä»£ç å—åœ¨ <code>add()</code>ã€<code>dec()</code> æ–¹æ³•å†…éƒ¨ã€‚å¹¶ä¸”ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œ<code>synchronized</code> é”ä½çš„å¯¹è±¡æ˜¯ <code>this</code>ï¼Œå³å½“å‰å®ä¾‹ï¼Œè¿™åˆä½¿å¾—åˆ›å»ºå¤šä¸ª <code>Counter</code> å®ä¾‹çš„æ—¶å€™ï¼Œå®ƒä»¬ä¹‹é—´äº’ä¸å½±å“ï¼Œå¯ä»¥å¹¶å‘æ‰§è¡Œï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">var</span> c1 <span class="token operator">=</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c2 <span class="token operator">=</span> <span class="token class-name">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¯¹ c1 è¿›è¡Œæ“ä½œçš„çº¿ç¨‹:</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    c1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    c1<span class="token punctuation">.</span><span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¯¹ c2 è¿›è¡Œæ“ä½œçš„çº¿ç¨‹:</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    c2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    c2<span class="token punctuation">.</span><span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œå¯¹äº <code>Counter</code> ç±»ï¼Œå¤šçº¿ç¨‹å¯ä»¥æ­£ç¡®è°ƒç”¨ã€‚</p><p>å¦‚æœä¸€ä¸ªç±»è¢«è®¾è®¡ä¸ºå…è®¸å¤šçº¿ç¨‹æ­£ç¡®è®¿é—®ï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸ªç±»å°±æ˜¯ â€œçº¿ç¨‹å®‰å…¨â€ çš„ï¼ˆthread-safeï¼‰ï¼Œä¸Šé¢çš„ <code>Counter</code> ç±»å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚Java æ ‡å‡†åº“çš„ <code>java.lang.StringBuffer</code> ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>è¿˜æœ‰ä¸€äº›ä¸å˜ç±»ï¼Œä¾‹å¦‚ <code>String</code>ï¼Œ<code>Integer</code>ï¼Œ<code>LocalDate</code>ï¼Œå®ƒä»¬çš„æ‰€æœ‰æˆå‘˜å˜é‡éƒ½æ˜¯ <code>final</code>ï¼Œå¤šçº¿ç¨‹åŒæ—¶è®¿é—®æ—¶åªèƒ½è¯»ä¸èƒ½å†™ï¼Œè¿™äº›ä¸å˜ç±»ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>æœ€åï¼Œç±»ä¼¼ <code>Math</code> è¿™äº›åªæä¾›é™æ€æ–¹æ³•ï¼Œæ²¡æœ‰æˆå‘˜å˜é‡çš„ç±»ï¼Œä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>é™¤äº†ä¸Šè¿°å‡ ç§å°‘æ•°æƒ…å†µï¼Œå¤§éƒ¨åˆ†ç±»ï¼Œä¾‹å¦‚ <code>ArrayList</code>ï¼Œéƒ½æ˜¯éçº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨å¤šçº¿ç¨‹ä¸­ä¿®æ”¹å®ƒä»¬ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½åªè¯»å–ï¼Œä¸å†™å…¥ï¼Œé‚£ä¹ˆ <code>ArrayList</code> æ˜¯å¯ä»¥å®‰å…¨åœ°åœ¨çº¿ç¨‹é—´å…±äº«çš„ã€‚</p><p>æ²¡æœ‰ç‰¹æ®Šè¯´æ˜æ—¶ï¼Œä¸€ä¸ªç±»é»˜è®¤æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>æˆ‘ä»¬å†è§‚å¯Ÿ <code>Counter</code> çš„ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“æˆ‘ä»¬é”ä½çš„æ˜¯ <code>this</code> å®ä¾‹æ—¶ï¼Œå®é™…ä¸Šå¯ä»¥ç”¨ <code>synchronized</code> ä¿®é¥°è¿™ä¸ªæ–¹æ³•ã€‚ä¸‹é¢ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// é”ä½ this</span>
        count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment">// è§£é”</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// é”ä½ this</span>
    count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">// è§£é”</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› æ­¤ï¼Œç”¨ <code>synchronized</code> ä¿®é¥°çš„æ–¹æ³•å°±æ˜¯åŒæ­¥æ–¹æ³•ï¼Œå®ƒè¡¨ç¤ºæ•´ä¸ªæ–¹æ³•éƒ½å¿…é¡»ç”¨ <code>this</code> å®ä¾‹åŠ é”ã€‚</p><p>æˆ‘ä»¬å†æ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœå¯¹ä¸€ä¸ªé™æ€æ–¹æ³•æ·»åŠ  <code>synchronized</code> ä¿®é¥°ç¬¦ï¼Œå®ƒé”ä½çš„æ˜¯å“ªä¸ªå¯¹è±¡ï¼Ÿ</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äº <code>static</code> æ–¹æ³•ï¼Œæ˜¯æ²¡æœ‰ <code>this</code> å®ä¾‹çš„ï¼Œå› ä¸º <code>static</code> æ–¹æ³•æ˜¯é’ˆå¯¹ç±»è€Œä¸æ˜¯å®ä¾‹ã€‚ä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°ä»»ä½•ä¸€ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªç”± JVM è‡ªåŠ¨åˆ›å»ºçš„ <code>Class</code> å®ä¾‹ï¼Œå› æ­¤ï¼Œå¯¹ <code>static</code> æ–¹æ³•æ·»åŠ  <code>synchronized</code>ï¼Œé”ä½çš„æ˜¯è¯¥ç±»çš„ <code>Class</code> å®ä¾‹ã€‚ä¸Šè¿° <code>synchronized static</code> æ–¹æ³•å®é™…ä¸Šç›¸å½“äºï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Counter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å†è€ƒå¯Ÿ <code>Counter</code> çš„ <code>get()</code> æ–¹æ³•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®ƒæ²¡æœ‰åŒæ­¥ï¼Œå› ä¸ºè¯»ä¸€ä¸ª <code>int</code> å˜é‡ä¸éœ€è¦åŒæ­¥ã€‚</p><p>ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬æŠŠä»£ç ç¨å¾®æ”¹ä¸€ä¸‹ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«ä¸¤ä¸ª <code>int</code> çš„å¯¹è±¡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> first<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> last<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Pair</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Pair</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        p<span class="token punctuation">.</span>first <span class="token operator">=</span> first<span class="token punctuation">;</span>
        p<span class="token punctuation">.</span>last <span class="token operator">=</span> last<span class="token punctuation">;</span>
        <span class="token keyword">return</span> p<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°±å¿…é¡»è¦åŒæ­¥äº†ã€‚</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>ç”¨ <code>synchronized</code> ä¿®é¥°æ–¹æ³•å¯ä»¥æŠŠæ•´ä¸ªæ–¹æ³•å˜ä¸ºåŒæ­¥ä»£ç å—ï¼Œ<code>synchronized</code> æ–¹æ³•åŠ é”å¯¹è±¡æ˜¯ <code>this</code>ï¼›</p><p>é€šè¿‡åˆç†çš„è®¾è®¡å’Œæ•°æ®å°è£…å¯ä»¥è®©ä¸€ä¸ªç±»å˜ä¸º â€œçº¿ç¨‹å®‰å…¨â€ï¼›</p><p>ä¸€ä¸ªç±»æ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œé»˜è®¤ä¸æ˜¯ thread-safeï¼›</p><p>å¤šçº¿ç¨‹èƒ½å¦å®‰å…¨è®¿é—®æŸä¸ªéçº¿ç¨‹å®‰å…¨çš„å®ä¾‹ï¼Œéœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚</p>`,31);function m(b,y){const s=e("router-link");return p(),t("div",null,[n("details",d,[k,n("nav",r,[n("ul",null,[n("li",null,[c(s,{to:"#ğŸ€-å°ç»“"},{default:o(()=>[l("ğŸ€ å°ç»“")]),_:1})])])])]),v])}const g=a(u,[["render",m],["__file","7.html.vue"]]);export{g as default};
