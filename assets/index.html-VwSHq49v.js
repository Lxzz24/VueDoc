import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,d as e}from"./app-CvlAI_tu.js";const t="/VueDoc/assets/image-20231221110213602-DIgq8i-z.png",p="/VueDoc/assets/image-20231221110303664-CfVO1A8p.png",o="/VueDoc/assets/image-20231221110335063-BMHn1Xlv.png",c={},l=e('<p>åœ¨ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ Web åº”ç”¨ç¨‹åºä¸­ï¼Œé€šå¸¸éƒ½æœ‰å¾ˆå¤š URL æ˜ å°„ï¼Œå¯¹åº”çš„ï¼Œä¹Ÿä¼šæœ‰å¤šä¸ª Servlet æ¥å¤„ç† URLã€‚</p><p>æˆ‘ä»¬è€ƒå¯Ÿè¿™æ ·ä¸€ä¸ªè®ºå›åº”ç”¨ç¨‹åºï¼š</p><figure><img src="'+t+`" alt="image-20231221110213602" tabindex="0" loading="lazy"><figcaption>image-20231221110213602</figcaption></figure><p>å„ä¸ª Servlet è®¾è®¡åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ul><li>IndexServletï¼šæµè§ˆå¸–å­ï¼›</li><li>SignInServletï¼šç™»å½•ï¼›</li><li>SignOutServletï¼šç™»å‡ºï¼›</li><li>ProfileServletï¼šä¿®æ”¹ç”¨æˆ·èµ„æ–™ï¼›</li><li>PostServletï¼šå‘å¸–ï¼›</li><li>ReplyServletï¼šå›å¤ã€‚</li></ul><p>å…¶ä¸­ï¼ŒProfileServletã€PostServlet å’Œ ReplyServlet éƒ½éœ€è¦ç”¨æˆ·ç™»å½•åæ‰èƒ½æ“ä½œï¼Œå¦åˆ™ï¼Œåº”å½“ç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠåˆ¤æ–­ç™»å½•çš„é€»è¾‘å†™åˆ°è¿™ 3 ä¸ª Servlet ä¸­ï¼Œä½†æ˜¯ï¼ŒåŒæ ·çš„é€»è¾‘é‡å¤ 3 æ¬¡æ²¡æœ‰å¿…è¦ï¼Œå¹¶ä¸”ï¼Œå¦‚æœåç»­ç»§ç»­åŠ  Servlet å¹¶ä¸”ä¹Ÿéœ€è¦éªŒè¯ç™»å½•æ—¶ï¼Œè¿˜éœ€è¦ç»§ç»­é‡å¤è¿™ä¸ªæ£€æŸ¥é€»è¾‘ã€‚</p><p>ä¸ºäº†æŠŠä¸€äº›å…¬ç”¨é€»è¾‘ä»å„ä¸ª Servlet ä¸­æŠ½ç¦»å‡ºæ¥ï¼ŒJavaEE çš„ Servlet è§„èŒƒè¿˜æä¾›äº†ä¸€ç§ Filter ç»„ä»¶ï¼Œå³è¿‡æ»¤å™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼Œåœ¨ HTTP è¯·æ±‚åˆ°è¾¾ Servlet ä¹‹å‰ï¼Œå¯ä»¥è¢«ä¸€ä¸ªæˆ–å¤šä¸ª Filter é¢„å¤„ç†ï¼Œç±»ä¼¼æ‰“å°æ—¥å¿—ã€ç™»å½•æ£€æŸ¥ç­‰é€»è¾‘ï¼Œå®Œå…¨å¯ä»¥æ”¾åˆ° Filter ä¸­ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæœ€ç®€å•çš„ EncodingFilterï¼Œå®ƒå¼ºåˆ¶æŠŠè¾“å…¥å’Œè¾“å‡ºçš„ç¼–ç è®¾ç½®ä¸º UTF-8ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">&quot;/*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EncodingFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;EncodingFilter:doFilter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–å†™ Filter æ—¶ï¼Œå¿…é¡»å®ç° <code>Filter</code> æ¥å£ï¼Œåœ¨ <code>doFilter()</code> æ–¹æ³•å†…éƒ¨ï¼Œè¦ç»§ç»­å¤„ç†è¯·æ±‚ï¼Œå¿…é¡»è°ƒç”¨ <code>chain.doFilter()</code>ã€‚æœ€åï¼Œç”¨ <code>@WebFilter</code> æ³¨è§£æ ‡æ³¨è¯¥ Filter éœ€è¦è¿‡æ»¤çš„ URLã€‚è¿™é‡Œçš„ <code>/*</code> è¡¨ç¤ºæ‰€æœ‰è·¯å¾„ã€‚</p><p>æ·»åŠ äº† Filter ä¹‹åï¼Œæ•´ä¸ªè¯·æ±‚çš„å¤„ç†æ¶æ„å¦‚ä¸‹ï¼š</p><figure><img src="`+p+`" alt="image-20231221110303664" tabindex="0" loading="lazy"><figcaption>image-20231221110303664</figcaption></figure><p>è¿˜å¯ä»¥ç»§ç»­æ·»åŠ å…¶ä»– Filterï¼Œä¾‹å¦‚ LogFilterï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span><span class="token string">&quot;/*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;LogFilter: process&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤šä¸ª Filter ä¼šç»„æˆä¸€ä¸ªé“¾ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½è¢«é“¾ä¸Šçš„ Filter ä¾æ¬¡å¤„ç†ï¼š</p><figure><img src="`+o+`" alt="image-20231221110335063" tabindex="0" loading="lazy"><figcaption>image-20231221110335063</figcaption></figure><p>æœ‰äº›ç»†å¿ƒçš„ç«¥é‹ä¼šé—®ï¼Œæœ‰å¤šä¸ª Filter çš„æ—¶å€™ï¼ŒFilter çš„é¡ºåºå¦‚ä½•æŒ‡å®šï¼Ÿå¤šä¸ª Filter æŒ‰ä¸åŒé¡ºåºå¤„ç†ä¼šé€ æˆå¤„ç†ç»“æœä¸åŒå—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ Filter çš„é¡ºåºç¡®å®å¯¹å¤„ç†çš„ç»“æœæœ‰å½±å“ã€‚ä½†é—æ†¾çš„æ˜¯ï¼ŒServlet è§„èŒƒå¹¶æ²¡æœ‰å¯¹ <code>@WebFilter</code> æ³¨è§£æ ‡æ³¨çš„ Filter è§„å®šé¡ºåºã€‚å¦‚æœä¸€å®šè¦ç»™æ¯ä¸ª Filter æŒ‡å®šé¡ºåºï¼Œå°±å¿…é¡»åœ¨ <code>web.xml</code> æ–‡ä»¶ä¸­å¯¹è¿™äº› Filter å†é…ç½®ä¸€éã€‚</p><p>æ³¨æ„åˆ°ä¸Šè¿°ä¸¤ä¸ª Filter çš„è¿‡æ»¤è·¯å¾„éƒ½æ˜¯ <code>/*</code>ï¼Œå³å®ƒä»¬ä¼šå¯¹æ‰€æœ‰è¯·æ±‚è¿›è¡Œè¿‡æ»¤ã€‚ä¹Ÿå¯ä»¥ç¼–å†™åªå¯¹ç‰¹å®šè·¯å¾„è¿›è¡Œè¿‡æ»¤çš„ Filterï¼Œä¾‹å¦‚ <code>AuthFilter</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span><span class="token string">&quot;/user/*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;AuthFilter: check authentication&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HttpServletRequest</span> req <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> request<span class="token punctuation">;</span>
        <span class="token class-name">HttpServletResponse</span> resp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">)</span> response<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æœªç™»å½•ï¼Œè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ:</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;AuthFilter: not signin!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            resp<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span><span class="token string">&quot;/signin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// å·²ç™»å½•ï¼Œç»§ç»­å¤„ç†:</span>
            chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„åˆ° <code>AuthFilter</code> åªè¿‡æ»¤ä»¥ <code>/user/</code> å¼€å¤´çš„è·¯å¾„ï¼Œå› æ­¤ï¼š</p><ul><li>å¦‚æœä¸€ä¸ªè¯·æ±‚è·¯å¾„ç±»ä¼¼ <code>/user/profile</code>ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«ä¸Šè¿° 3 ä¸ª Filter ä¾æ¬¡å¤„ç†ï¼›</li><li>å¦‚æœä¸€ä¸ªè¯·æ±‚è·¯å¾„ç±»ä¼¼ <code>/test</code>ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«ä¸Šè¿° 2 ä¸ª Filter ä¾æ¬¡å¤„ç†ï¼ˆä¸ä¼šè¢« AuthFilter å¤„ç†ï¼‰ã€‚</li></ul><p>å†æ³¨æ„è§‚å¯Ÿ <code>AuthFilter</code>ï¼Œå½“ç”¨æˆ·æ²¡æœ‰ç™»å½•æ—¶ï¼Œåœ¨ <code>AuthFilter</code> å†…éƒ¨ï¼Œç›´æ¥è°ƒç”¨ <code>resp.sendRedirect()</code> å‘é€é‡å®šå‘ï¼Œä¸”æ²¡æœ‰è°ƒç”¨ <code>chain.doFilter()</code>ï¼Œå› æ­¤ï¼Œå½“ç”¨æˆ·æ²¡æœ‰ç™»å½•æ—¶ï¼Œè¯·æ±‚åˆ°è¾¾ <code>AuthFilter</code> åï¼Œä¸å†ç»§ç»­å¤„ç†ï¼Œå³åç»­çš„ Filter å’Œä»»ä½• Servlet éƒ½æ²¡æœ‰æœºä¼šå¤„ç†è¯¥è¯·æ±‚äº†ã€‚</p><p>å¯è§ï¼ŒFilter å¯ä»¥æœ‰é’ˆå¯¹æ€§åœ°æ‹¦æˆªæˆ–è€…æ”¾è¡Œ HTTP è¯·æ±‚ã€‚</p><p>å¦‚æœä¸€ä¸ª Filter åœ¨å½“å‰è¯·æ±‚ä¸­ç”Ÿæ•ˆï¼Œä½†ä»€ä¹ˆéƒ½æ²¡æœ‰åšï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span><span class="token string">&quot;/*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‚£ä¹ˆï¼Œç”¨æˆ·å°†çœ‹åˆ°ä¸€ä¸ªç©ºç™½é¡µï¼Œå› ä¸ºè¯·æ±‚æ²¡æœ‰ç»§ç»­å¤„ç†ï¼Œé»˜è®¤å“åº”æ˜¯ 200 + ç©ºç™½è¾“å‡ºã€‚</p><div class="hint-container caution"><p class="hint-container-title">è­¦å‘Š</p><p>å¦‚æœ Filter è¦ä½¿è¯·æ±‚ç»§ç»­è¢«å¤„ç†ï¼Œå°±ä¸€å®šè¦è°ƒç”¨ chain.doFilter()ï¼</p></div><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä¸Šä¸€èŠ‚ä»‹ç»çš„ MVC æ¨¡å¼ï¼Œå³ä¸€ä¸ªç»Ÿä¸€çš„ <code>DispatcherServlet</code> å…¥å£ï¼ŒåŠ ä¸Šå¤šä¸ª Controllerï¼Œè¿™ç§æ¨¡å¼ä¸‹ Filter ä»ç„¶æ˜¯æ­£å¸¸å·¥ä½œçš„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¤„ç† <code>/user/*</code> çš„ Filter å®é™…ä¸Šä½œç”¨äºé‚£äº›å¤„ç† <code>/user/</code> å¼€å¤´çš„ Controller æ–¹æ³•ä¹‹å‰ã€‚</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>Filter æ˜¯ä¸€ç§å¯¹ HTTP è¯·æ±‚è¿›è¡Œé¢„å¤„ç†çš„ç»„ä»¶ï¼Œå®ƒå¯ä»¥æ„æˆä¸€ä¸ªå¤„ç†é“¾ï¼Œä½¿å¾—å…¬å…±å¤„ç†ä»£ç èƒ½é›†ä¸­åˆ°ä¸€èµ·ï¼›</p><p>Filter é€‚ç”¨äºæ—¥å¿—ã€ç™»å½•æ£€æŸ¥ã€å…¨å±€è®¾ç½®ç­‰ï¼›</p><p>è®¾è®¡åˆç†çš„ URL æ˜ å°„å¯ä»¥è®© Filter é“¾æ›´æ¸…æ™°ã€‚</p>`,34),i=[l];function u(r,k){return s(),a("div",null,i)}const m=n(c,[["render",u],["__file","index.html.vue"]]);export{m as default};
