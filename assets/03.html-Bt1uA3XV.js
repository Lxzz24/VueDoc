import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as t,o as p,c as l,a as i,e as s,b as o,w as c,d as n}from"./app-CvlAI_tu.js";const r="/VueDoc/assets/image-20191027131011438-CtAKk1E_.png",u="/VueDoc/assets/image-20191027165331804-CAEidjNx.png",d={},m=n(`<p>å¯¹äºç³»ç»Ÿç®¡ç†è€…ï¼ˆrootï¼‰è€Œè¨€ï¼Œç£ç›˜ç®¡ç†æ˜¯éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œå°¤å…¶æ˜¯è¿‘æ¥ç£ç›˜å·²ç»æ¸æ¸è¢«å½“æˆæ˜¯æ¶ˆè€—å“äº†ã€‚</p><p>æƒ³è¦åœ¨ç³»ç»Ÿé‡Œé¢æ–°å¢ä¸€é¢—ç£ç›˜æ—¶ï¼Œåº”è¯¥åšçš„æœ‰ï¼š</p><ol><li>å¯¹ç£ç›˜è¿›è¡Œåˆ†åŒºï¼Œå»ºç«‹å¯ç”¨çš„ partition</li><li>å¯¹è¯¥ partition è¿›è¡Œæ ¼å¼åŒ–ï¼ˆformatï¼‰ï¼Œå»ºç«‹ç³»ç»Ÿå¯ç”¨çš„ filesystem</li><li>å¯é€‰ï¼šå¯¹åˆšåˆšå»ºç«‹å¥½çš„ filesystem è¿›è¡Œæ£€æŸ¥</li><li>åœ¨ linux ç³»ç»Ÿä¸Šï¼Œå»ºç«‹æŒ‚è½½ç‚¹ï¼ˆç›®å½•ï¼‰ï¼Œå¹¶å°†å®ƒæŒ‚è½½ä¸Šæ¥</li></ol><p>å½“ç„¶åœ¨ä¸Šè¿°æ­¥éª¤ä¸­æœ‰å¾ˆå¤šç»†è‡´çš„éœ€è¦è€ƒè™‘ï¼Œæ¯”å¦‚ç£ç›˜åˆ†åŒºæ§½ï¼ˆpartitionï¼‰éœ€è¦å¤šå¤§ï¼Ÿæ˜¯å¦éœ€è¦åŠ å…¥ jounal çš„åŠŸèƒ½ï¼Ÿinode ä¸ block çš„æ•°é‡åº”è¯¥å¦‚ä½•åˆ’åˆ†ç­‰ã€‚</p><p>ä½†æ˜¯è¿™äº›é—®é¢˜çš„å†³å®šï¼Œéƒ½éœ€è¦ä¸ä½ çš„ä¸»æœºç”¨é€”æ¥è€ƒè™‘çš„ï¼Œå› æ­¤åœ¨æœ¬èŠ‚ï¼Œè®²è§£å‡ ä¸ªå…¥é—¨æ“ä½œï¼Œå…¶ä»–çš„è‡ªå·±å»å®æˆ˜äº†è§£</p><h2 id="ğŸ€-è§‚å¯Ÿç£ç›˜åˆ†åŒºçŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#ğŸ€-è§‚å¯Ÿç£ç›˜åˆ†åŒºçŠ¶æ€" aria-hidden="true">#</a> ğŸ€ è§‚å¯Ÿç£ç›˜åˆ†åŒºçŠ¶æ€</h2><p>ç£ç›˜åˆ†åŒºä¸»è¦æœ‰ MBR å’Œ GPT ä¸¤ç§æ ¼å¼ï¼Œæ”¯æŒçš„å·¥å…·ä¸ä¸€æ ·ï¼ˆåç»­è®²è§£çš„ parted éƒ½æ”¯æŒï¼‰ï¼Œ ä¹ æƒ¯ä½¿ç”¨çš„æ˜¯ fdisk ã€gdisk æ¥å¤„ç†åˆ†åŒºã€‚</p><h3 id="lsblk-åˆ—å‡ºç³»ç»Ÿä¸Šæ‰€æœ‰ç£ç›˜åˆ—è¡¨" tabindex="-1"><a class="header-anchor" href="#lsblk-åˆ—å‡ºç³»ç»Ÿä¸Šæ‰€æœ‰ç£ç›˜åˆ—è¡¨" aria-hidden="true">#</a> lsblk åˆ—å‡ºç³»ç»Ÿä¸Šæ‰€æœ‰ç£ç›˜åˆ—è¡¨</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>lsblk <span class="token punctuation">[</span>-dfipt<span class="token punctuation">]</span> <span class="token punctuation">[</span>device<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>dï¼šä»…åˆ—å‡ºç£ç›˜æœ¬èº«ï¼Œå¹¶ä¸ä¼šåˆ—å‡ºè¯¥ç£ç›˜çš„åˆ†åŒºæ•°æ®</li><li>fï¼šåŒæ—¶åˆ—å‡ºè¯¥ç£ç›˜å†…çš„æ–‡ä»¶ç³»ç»Ÿåç§°</li><li>iï¼šä½¿ç”¨ ASCII çš„çº¿æ®µè¾“å‡ºï¼Œä¸è¦ä½¿ç”¨å¤æ‚çš„ç¼–ç ï¼ˆåœ¨æŸäº›ç¯å¢ƒä¸‹å¾ˆæœ‰ç”¨ï¼‰</li><li>mï¼šåŒæ—¶è¾“å‡ºè¯¥è£…ç½®åœ¨ /dev ä¸‹çš„æƒé™æ•°æ®ï¼ˆrwxï¼‰</li><li>pï¼šåˆ—å‡ºè¯¥è£…ç½®çš„å®Œæ•´æ–‡ä»¶åï¼Œè€Œä¸æ˜¯ä»…åˆ—å‡ºæœ€åçš„åå­—</li><li>tï¼šåˆ—å‡ºè¯¥ç£ç›˜è£…ç½®çš„è¯¦ç»†æ•°æ®ï¼ŒåŒ…æ‹¬ç£ç›˜é˜Ÿåˆ—æœºåˆ¶ã€é¢„è¯»å†™çš„æ•°æ®é‡å¤§å°ç­‰</li></ul><p>å®è·µç»ƒä¹ </p><p>åˆ—å‡ºæœ¬ç³»ç»Ÿä¸‹çš„æ‰€æœ‰ç£ç›˜ä¸ç£ç›˜å†…çš„åˆ†åŒºä¿¡æ¯</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>mrcode@study ~<span class="token punctuation">]</span>$ lsblk
NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda               <span class="token number">8</span>:0    <span class="token number">0</span> <span class="token number">40</span>.8G  <span class="token number">0</span> disk 				<span class="token comment"># è¿™æ˜¯ä¸€æ•´é¢—ç£ç›˜</span>
â”œâ”€sda1            <span class="token number">8</span>:1    <span class="token number">0</span>    2M  <span class="token number">0</span> part
â”œâ”€sda2            <span class="token number">8</span>:2    <span class="token number">0</span>    1G  <span class="token number">0</span> part /boot
â””â”€sda3            <span class="token number">8</span>:3    <span class="token number">0</span>   30G  <span class="token number">0</span> part 				<span class="token comment"># åœ¨ sda3 å†…çš„å…¶ä»–çš„æ–‡ä»¶ç³»ç»Ÿ</span>
  â”œâ”€centos-root <span class="token number">253</span>:0    <span class="token number">0</span>   10G  <span class="token number">0</span> lvm  /
  â”œâ”€centos-swap <span class="token number">253</span>:1    <span class="token number">0</span>    1G  <span class="token number">0</span> lvm  <span class="token punctuation">[</span>SWAP<span class="token punctuation">]</span>
  â””â”€centos-home <span class="token number">253</span>:2    <span class="token number">0</span>    5G  <span class="token number">0</span> lvm  /home
sdb               <span class="token number">8</span>:16   <span class="token number">0</span>    2G  <span class="token number">0</span> disk
sr0              <span class="token number">11</span>:0    <span class="token number">1</span> <span class="token number">73</span>.6M  <span class="token number">0</span> rom
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»è¾“å‡ºæ¥çœ‹ï¼Œä¸»è¦æœ‰ sda ã€sdbã€sr0 è£…ç½®ï¼Œè€Œ sda ä¸‹é¢åˆåˆ†äº† 3 ä¸ªåˆ†åŒºï¼Œå…¶ä¸­ sda3 è¿˜æœ‰ LVM äº§ç”Ÿçš„æ–‡ä»¶ç³»ç»Ÿ</p><ul><li>NAMEï¼šè£…ç½®æ–‡ä»¶åï¼Œä¼šçœç•¥ /dev ç­‰å‰å¯¼ç›®å½•</li><li>MAJ:MINï¼šå…¶å®æ ¸å¿ƒè®¤è¯†çš„è£…ç½®éƒ½æ˜¯é€šè¿‡è¿™ä¸¤ä¸ªä»£ç æ¥ç†Ÿæ‚‰çš„ï¼Œåˆ†åˆ«æ˜¯ï¼š<code>ä¸»è¦:æ¬¡è¦</code> è£…ç½®</li><li>RMï¼šæ˜¯å¦ä¸ºé¢—æ‹†å¸è£…ç½®ï¼ˆremovable deviceï¼‰ã€‚å¦‚å…‰ç›˜ã€USB ç£ç›˜ç­‰</li><li>SIZEï¼šå®¹é‡</li><li>ROï¼šæ˜¯å¦ä¸ºåªè¯»</li><li>TYPEï¼šç£ç›˜ diskã€åˆ†åŒºæ§½ partitionã€åªè¯»å­˜å‚¨å™¨ rom</li><li>MOUTPOINTï¼šæŒ‚è½½ç‚¹</li></ul><p>åˆ—å‡º /dev/sda (å‰é¢å·²ç»è¯´è¿‡äº†ï¼Œä½¿ç”¨è™šæ‹Ÿæœºä¸åŒï¼Œç£ç›˜é‡Œé¢æ²¡æœ‰ vda çš„ï¼Œæˆ‘çš„æ˜¯ sda å“¦) è£…ç½®å†…çš„æ‰€æœ‰æ•°æ®çš„å®Œæ•´æ–‡ä»¶å</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># lsblk -ip /dev/sda</span>
NAME                        MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
/dev/sda                      <span class="token number">8</span>:0    <span class="token number">0</span> <span class="token number">40</span>.8G  <span class="token number">0</span> disk
<span class="token operator">|</span>-/dev/sda1                   <span class="token number">8</span>:1    <span class="token number">0</span>    2M  <span class="token number">0</span> part
<span class="token operator">|</span>-/dev/sda2                   <span class="token number">8</span>:2    <span class="token number">0</span>    1G  <span class="token number">0</span> part /boot
<span class="token variable"><span class="token variable">\`</span>-/dev/sda3                   <span class="token number">8</span>:3    <span class="token number">0</span>   30G  <span class="token number">0</span> part
  <span class="token operator">|</span>-/dev/mapper/centos-root <span class="token number">253</span>:0    <span class="token number">0</span>   10G  <span class="token number">0</span> lvm  /
  <span class="token operator">|</span>-/dev/mapper/centos-swap <span class="token number">253</span>:1    <span class="token number">0</span>    1G  <span class="token number">0</span> lvm  <span class="token punctuation">[</span>SWAP<span class="token punctuation">]</span>
  <span class="token variable">\`</span></span>-/dev/mapper/centos-home <span class="token number">253</span>:2    <span class="token number">0</span>    5G  <span class="token number">0</span> lvm  /home
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ—å‡ºè£…ç½®çš„-uuid-ç­‰å‚æ•°" tabindex="-1"><a class="header-anchor" href="#åˆ—å‡ºè£…ç½®çš„-uuid-ç­‰å‚æ•°" aria-hidden="true">#</a> åˆ—å‡ºè£…ç½®çš„ UUID ç­‰å‚æ•°</h3><p>ä½¿ç”¨ <code>lsblk -f</code> å¯ä»¥åˆ—å‡ºæ¥ UUID çš„æ•°æ®ï¼Œä¸è¿‡ä¹ æƒ¯ä½¿ç”¨ blkid æ¥æ‰¾å‡ºè£…ç½®çš„ UUIDï¼Œå¯ä»¥ç”¨æ¥ä½œä¸ºæŒ‚è½½æˆ–åˆ™æ˜¯ä½¿ç”¨è¿™ä¸ªè£…ç½®/æ–‡ä»¶ç³»ç»Ÿç”¨</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># lsblk -f</span>
NAME            FSTYPE    LABEL           UUID                                   MOUNTPOINT
sda                                                                              
â”œâ”€sda1                                                                           
â”œâ”€sda2          xfs                       13d0663f-4cbd-412d-aa9f-975eb18da590   /boot
â””â”€sda3          LVM2_memb                 cksKYp-dPYj-CCPQ-Qxpq-m6rE-bhcL-84NkM3
  â”œâ”€centos-root xfs                       7b220a88-4e13-4869-9aa9-87031303f3e1   /
  â”œâ”€centos-swap swap                      0576b616-9606-434b-91c6-b99cbba5597d   <span class="token punctuation">[</span>SWAP<span class="token punctuation">]</span>
  â””â”€centos-home xfs                       d475b892-bcde-4c97-99da-497f3ff7163c   /home
sdb                                                                              
sr0             iso9660   VBox_GAs_6.0.10 <span class="token number">2019</span>-07-12-09-13-14-35   

<span class="token comment"># æ˜¾ç¤ºæ ¼å¼ä¸ä¸€æ ·ï¼Œè¿˜å¤šäº†åˆ†åŒºçš„ UUIDï¼Œæ„Ÿè§‰ä¸Šé¢çš„å°‘äº†ä¸€ä¸ª dsa1 çš„å‘¢ï¼Ÿ</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># blkid</span>
/dev/sda1: <span class="token assign-left variable">PARTUUID</span><span class="token operator">=</span><span class="token string">&quot;bf674a46-65e1-43b1-a348-ac2c06c25293&quot;</span>
/dev/sda2: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;13d0663f-4cbd-412d-aa9f-975eb18da590&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;xfs&quot;</span> <span class="token assign-left variable">PARTUUID</span><span class="token operator">=</span><span class="token string">&quot;783703d8-96cb-48fa-bfdb-853e7a0b1581&quot;</span>
/dev/sda3: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;cksKYp-dPYj-CCPQ-Qxpq-m6rE-bhcL-84NkM3&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;LVM2_member&quot;</span> <span class="token assign-left variable">PARTUUID</span><span class="token operator">=</span><span class="token string">&quot;cb3c0557-b7a5-493c-bab0-250a62a11099&quot;</span>
/dev/sr0: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;2019-07-12-09-13-14-35&quot;</span> <span class="token assign-left variable">LABEL</span><span class="token operator">=</span><span class="token string">&quot;VBox_GAs_6.0.10&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;iso9660&quot;</span>
/dev/mapper/centos-root: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;7b220a88-4e13-4869-9aa9-87031303f3e1&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;xfs&quot;</span>
/dev/mapper/centos-swap: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;0576b616-9606-434b-91c6-b99cbba5597d&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;swap&quot;</span>
/dev/mapper/centos-home: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;d475b892-bcde-4c97-99da-497f3ff7163c&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;xfs&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="parted-åˆ—å‡ºç£ç›˜çš„åˆ†åŒºè¡¨ç±»å‹ä¸åˆ†åŒºä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#parted-åˆ—å‡ºç£ç›˜çš„åˆ†åŒºè¡¨ç±»å‹ä¸åˆ†åŒºä¿¡æ¯" aria-hidden="true">#</a> parted åˆ—å‡ºç£ç›˜çš„åˆ†åŒºè¡¨ç±»å‹ä¸åˆ†åŒºä¿¡æ¯</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># è¯­æ³•ï¼šparted device_name print</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># parted /dev/sda print</span>
Model: ATA VBOX HARDDISK <span class="token punctuation">(</span>scsi<span class="token punctuation">)</span>										<span class="token comment"># ç£ç›˜æ¨¡å—åç§°ï¼ˆå‚å•†ï¼‰</span>
Disk /dev/sda: <span class="token number">43</span>.8GB															<span class="token comment"># ç£ç›˜çš„æ€»å®¹é‡</span>
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: 512B/512B					<span class="token comment"># ç£ç›˜çš„æ¯ä¸ªé€»è¾‘/ç‰©ç†æ‰‡åŒºå®¹é‡</span>
Partition Table: gpt						<span class="token comment"># åˆ†åŒºæ ¼å¼</span>
Disk Flags: pmbr_boot

<span class="token comment"># ä¸‹é¢æ˜¯åˆ†åŒºä¿¡æ¯</span>
Number  Start   End     Size    File system  Name  æ ‡å¿—
 <span class="token number">1</span>      1049kB  3146kB  2097kB                     bios_grub
 <span class="token number">2</span>      3146kB  1077MB  1074MB  xfs
 <span class="token number">3</span>      1077MB  <span class="token number">33</span>.3GB  <span class="token number">32</span>.2GB                     lvm

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ€-ç£ç›˜åˆ†åŒº-gdiskã€fdisk" tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç£ç›˜åˆ†åŒº-gdiskã€fdisk" aria-hidden="true">#</a> ğŸ€ ç£ç›˜åˆ†åŒºï¼šgdiskã€fdisk</h2><ul><li>MBRï¼šä½¿ç”¨ fdisk åˆ†åŒº</li><li>GPTï¼šä½¿ç”¨ gdisk åˆ†åŒº</li></ul><p>ä¸¤ä¸ªå·¥å…·ä½¿ç”¨ç›¸ä¼¼ï¼Œé€šè¿‡å†…éƒ¨çš„è¯´æ˜æ¥æ“ä½œï¼Œä¸éœ€è¦æ­»è®°ç¡¬èƒŒã€‚åˆšåˆšé€šè¿‡ parted æŒ‡ä»¤è¾“å‡ºçš„ç»“æœå¾—çŸ¥ sda è¿™ä¸ªç£ç›˜æ˜¯ GPT åˆ†åŒºï¼Œæ‰€ä»¥ä¸‹é¢çš„ä½¿ç”¨ gdisk æ¥æ“ä½œ</p><h3 id="gdisk" tabindex="-1"><a class="header-anchor" href="#gdisk" aria-hidden="true">#</a> gdisk</h3><p>è¯­æ³•å¾ˆç®€å•</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>gdisk è£…ç½®åç§°
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¾‹ï¼šè§‚å¯Ÿ /dev/sda ç£ç›˜çš„åˆ†åŒºä¸ç›¸å…³æ•°æ®</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># gdisk /dev/sda</span>
GPT <span class="token function">fdisk</span> <span class="token punctuation">(</span>gdisk<span class="token punctuation">)</span> version <span class="token number">0.8</span>.10

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present
<span class="token comment"># æ‰¾åˆ°äº† GPT çš„åˆ†åŒºè¡¨</span>
Found valid GPT with protective MBR<span class="token punctuation">;</span> using GPT.

Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: ?  <span class="token comment"># ç­‰å¾…ä½ è¾“å…¥æŒ‡ä»¤ï¼Œå¯ä»¥è¾“å…¥é—®å·æ˜¾ç¤ºè¯´æ˜</span>
b       back up GPT data to a <span class="token function">file</span>
c       change a partition<span class="token string">&#39;s name
d       delete a partition		# åˆ é™¤åˆ†åŒº
i       show detailed information on a partition
l       list known partition types
n       add a new partition		# å¢åŠ åˆ†åŒº
o       create a new empty GUID partition table (GPT)
p       print the partition table # æ‰“å°åˆ†åŒºè¡¨ï¼ˆå¸¸ç”¨ï¼‰
q       quit without saving changes # ä¸å­˜å‚¨åˆ†åŒºå°±ç›´æ¥ç¦»å¼€ gdisk
r       recovery and transformation options (experts only)
s       sort partitions
t       change a partition&#39;</span>s <span class="token builtin class-name">type</span> code
<span class="token function">v</span>       verify disk
w       <span class="token function">write</span> table to disk and <span class="token builtin class-name">exit</span>	<span class="token comment"># å­˜å‚¨åˆ†åŒºæ“ä½œåç¦»å¼€ gdisk</span>
x       extra functionality <span class="token punctuation">(</span>experts only<span class="token punctuation">)</span>
?       print this menu

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†æ¥å›é¡¾ä¸‹æ­¥éª¤ï¼š</p><ol><li>ä½¿ç”¨ lsblk æˆ– blkid æ‰¾åˆ°ç£ç›˜</li><li>ä½¿ç”¨ parted /dev/xxx print æ¥æ‰¾å‡ºå†…éƒ¨çš„åˆ†è¡¨è¡¨ç±»å‹</li><li>ä½¿ç”¨ gdisk æˆ– fdisk æ¥æ“ä½œ</li></ol><p>é€šè¿‡ä¸Šé¢çš„å¸®åŠ©ï¼Œæœ‰ä¸¤ä¸ªé‡è¦ä¿¡æ¯ï¼šæŒ‡ä»¤ q å’Œ wï¼Œåœ¨ gdisk é‡Œé¢æ‰§è¡Œçš„æ“ä½œï¼Œ<strong>åªæœ‰ä½¿ç”¨è¿™ä¸¤ä¸ªæŒ‡ä»¤åæ‰ä¼šç”Ÿæ•ˆ</strong>ï¼Œ ä½¿ç”¨ q é€€å‡ºä¸ç”Ÿæ•ˆï¼Œä½¿ç”¨ w ç”Ÿæ•ˆå¹¶ç¦»å¼€ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: p		<span class="token comment"># è¾“å‡ºç›®å‰ç£ç›˜çš„çŠ¶æ€</span>
Disk /dev/sda: <span class="token number">85491712</span> sectors, <span class="token number">40.8</span> GiB				<span class="token comment"># ç£ç›˜æ–‡ä»¶åã€æ‰‡åŒºæ•°é‡ã€æ€»å®¹é‡</span>
Logical sector size: <span class="token number">512</span> bytes									<span class="token comment"># å•ä¸€æ‰‡åŒºå¤§å°ä¸º 512 bytes</span>
Disk identifier <span class="token punctuation">(</span>GUID<span class="token punctuation">)</span>: 67038DBF-B66A-4D0F-92B2-BFBF0744CD1D	<span class="token comment"># ç£ç›˜çš„ GPTæ ‡è¯†ç¬¦</span>
Partition table holds up to <span class="token number">128</span> entries
First usable sector is <span class="token number">34</span>, last usable sector is <span class="token number">85491678</span>
Partitions will be aligned on <span class="token number">2048</span>-sector boundaries
Total <span class="token function">free</span> space is <span class="token number">20467645</span> sectors <span class="token punctuation">(</span><span class="token number">9.8</span> GiB<span class="token punctuation">)</span>

<span class="token comment"># ä¸‹é¢æ˜¯åˆ†åŒºä¿¡æ¯</span>
<span class="token comment"># åˆ†åŒºç¼–å· å¼€å§‹æ‰‡åŒºå·ç 			 ç»“æŸæ‰‡åŒºå·ç     å®¹é‡å¤§å°</span>
Number  Start <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>    End <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>  Size       Code  Name
   <span class="token number">1</span>            <span class="token number">2048</span>            <span class="token number">6143</span>   <span class="token number">2.0</span> MiB     EF02  
   <span class="token number">2</span>            <span class="token number">6144</span>         <span class="token number">2103295</span>   <span class="token number">1024.0</span> MiB  0700  
   <span class="token number">3</span>         <span class="token number">2103296</span>        <span class="token number">65026047</span>   <span class="token number">30.0</span> GiB    8E00
<span class="token comment"># è¿™é‡Œçš„ Code linux ä¸º 8300ï¼Œswap ä¸º 8200ï¼Œä¸è¿‡åªæ˜¯ä¸€ä¸ªæç¤ºï¼Œä¸è§å¾—çœŸçš„ä»£è¡¨æ­¤åˆ†åŒºæ§½å†…çš„æ–‡ä»¶ç³»ç»Ÿ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šè¡¨å¯ä»¥å‘ç°å‡ ä»¶äº‹æƒ…ï¼š</p><ul><li><p>æ•´é¢—ç£ç›˜è¿˜å¯ä»¥è¿›è¡Œé¢å¤–çš„åˆ†åŒº</p><p>æœ€å¤§æ‰‡åŒºä¸º 85491712 ä¸ªï¼Œä¸‹é¢ä¸‰ä¸ªåˆ†åŒºè¡¨ï¼ˆç¬¬ä¸‰ä¸ªï¼‰ç»“æŸæ‰‡åŒºä¸º 65026047ï¼Œ åœ¨ä¸Šé¢ä¿¡æ¯ä¸­ä¹Ÿæç¤ºäº†ç©ºé—²çš„æ‰‡åŒº <code>20467645 sectors (9.8 GiB)</code></p></li><li><p>åˆ†åŒºæ§½çš„è®¾è®¡ä¸­ï¼Œæ–°åˆ†åŒºé€šå¸¸é€‰ç”¨ä¸Šä¸€ä¸ªåˆ†åŒºçš„ç»“æŸæ‰‡åŒºå·ç æ•°åŠ  1 ä½œä¸ºèµ·å§‹æ‰‡åŒºå·ç </p></li></ul><div class="hint-container warning"><p class="hint-container-title">æ³¨æ„</p><p>æ³¨æ„ä¸è¦åœ¨ MBR åˆ†åŒºä¸Šä½¿ç”¨ gdiskï¼Œå¦‚æœæŒ‡ä»¤æŒ‰é”™ï¼Œææ€•åˆ†åŒºè®°å½•ä¼šæŒ‚æ‰ï¼Œ å¦å¤–åœ¨ gdisk ä¸­æ“ä½œï¼Œç¦»å¼€çš„æ—¶å€™è®°å¾—æŒ‰ q ï¼Œä¸è¦æŒ‰ w å°±ä¸ä¼šç”Ÿæ•ˆ</p></div><h3 id="ç”¨-gdisk-æ–°å¢åˆ†åŒºæ§½" tabindex="-1"><a class="header-anchor" href="#ç”¨-gdisk-æ–°å¢åˆ†åŒºæ§½" aria-hidden="true">#</a> ç”¨ gdisk æ–°å¢åˆ†åŒºæ§½</h3><p>æœ€å¼€å§‹å®‰è£…çš„æ—¶å€™å°±é¢„ç•™äº†ä¸€å—å®¹é‡æ¥åšç»ƒä¹ ï¼Œåœ¨ä¸Šé¢ä¹Ÿçœ‹åˆ°äº†è¿˜å‰©ä½™ 9.8 G çš„ç©ºä½™å®¹é‡ï¼Œå‡è®¾æœ‰å¦‚ä¸‹çš„åˆ†åŒºéœ€æ±‚ï¼š</p><ul><li>1 GB çš„ xfs æ–‡ä»¶ç³»ç»Ÿï¼ˆlinuxï¼‰</li><li>1 GB çš„ vfat æ–‡ä»¶ç³»ç»Ÿï¼ˆwindowsï¼‰</li><li>0.5 GB çš„ swap ï¼ˆlinux swapï¼‰</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># gdisk /dev/sda</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: p
Number  Start <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>    End <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>  Size       Code  Name
   <span class="token number">1</span>            <span class="token number">2048</span>            <span class="token number">6143</span>   <span class="token number">2.0</span> MiB     EF02  
   <span class="token number">2</span>            <span class="token number">6144</span>         <span class="token number">2103295</span>   <span class="token number">1024.0</span> MiB  0700  
   <span class="token number">3</span>         <span class="token number">2103296</span>        <span class="token number">65026047</span>   <span class="token number">30.0</span> GiB    8E00
<span class="token comment"># æ‰“å°åˆ†åŒºä¿¡æ¯ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ‰¾åˆ°æœ€åä¸€ä¸ª sector çš„å·ç ï¼Œè¿™é‡Œæ˜¯ 65026047</span>
<span class="token comment"># ä½¿ç”¨æŒ‡ä»¤ n å¢åŠ ç‰©ç†åˆ†åŒº</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: n
Partition number <span class="token punctuation">(</span><span class="token number">4</span>-128, default <span class="token number">4</span><span class="token punctuation">)</span>: <span class="token number">4</span>  <span class="token comment"># åˆ†åŒºå·ç ï¼Œè¿™é‡Œé»˜è®¤å°±æ˜¯ 4ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æŒ‰å›è½¦</span>
First sector <span class="token punctuation">(</span><span class="token number">34</span>-85491678, default <span class="token operator">=</span> <span class="token number">65026048</span><span class="token punctuation">)</span> or <span class="token punctuation">{</span>+-<span class="token punctuation">}</span>size<span class="token punctuation">{</span>KMGTP<span class="token punctuation">}</span>: <span class="token comment"># ç¬¬ä¸€ä¸ªæ‰‡åŒºå·ç ï¼ŒåŒæ ·æœ‰é»˜è®¤çš„</span>
Last sector <span class="token punctuation">(</span><span class="token number">65026048</span>-85491678, default <span class="token operator">=</span> <span class="token number">85491678</span><span class="token punctuation">)</span> or <span class="token punctuation">{</span>+-<span class="token punctuation">}</span>size<span class="token punctuation">{</span>KMGTP<span class="token punctuation">}</span>: +1G  <span class="token comment"># ç»“æŸæ‰‡åŒºå·ç </span>
<span class="token comment"># ä¸Šé¢æœ‰é»˜è®¤çš„å€¼ï¼Œä¸éœ€è¦æˆ‘ä»¬è‡ªå·±è®¡ç®—æ‰‡åŒºæ•°é‡ï¼Œä½¿ç”¨ +- KMGTP ç­‰å•ä½å®¹é‡æ–¹å¼æ¥å®¹é‡</span>

<span class="token comment"># é€‰æ‹©æœªæ¥è¯¥åˆ†åŒºæ§½é¢„è®¡ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿï¼Œé¢„è®¾çš„éƒ½æ˜¯ linux æ–‡ä»¶ç³»ç»Ÿçš„ 8300</span>
Current <span class="token builtin class-name">type</span> is <span class="token string">&#39;Linux filesystem&#39;</span>
Hex code or GUID <span class="token punctuation">(</span>L to show codes, Enter <span class="token operator">=</span> <span class="token number">8300</span><span class="token punctuation">)</span>:
Changed <span class="token builtin class-name">type</span> of partition to <span class="token string">&#39;Linux filesystem&#39;</span>

<span class="token comment"># å†æ¬¡æ‰“å°ï¼Œå°±å‘ç°å¤šäº†åˆšåˆšåˆ†å‡ºæ¥çš„åˆ†åŒºä¿¡æ¯</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: p
Disk /dev/sda: <span class="token number">85491712</span> sectors, <span class="token number">40.8</span> GiB
Logical sector size: <span class="token number">512</span> bytes
Disk identifier <span class="token punctuation">(</span>GUID<span class="token punctuation">)</span>: 67038DBF-B66A-4D0F-92B2-BFBF0744CD1D
Partition table holds up to <span class="token number">128</span> entries
First usable sector is <span class="token number">34</span>, last usable sector is <span class="token number">85491678</span>
Partitions will be aligned on <span class="token number">2048</span>-sector boundaries
Total <span class="token function">free</span> space is <span class="token number">18370493</span> sectors <span class="token punctuation">(</span><span class="token number">8.8</span> GiB<span class="token punctuation">)</span>

Number  Start <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>    End <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>  Size       Code  Name
   <span class="token number">1</span>            <span class="token number">2048</span>            <span class="token number">6143</span>   <span class="token number">2.0</span> MiB     EF02  
   <span class="token number">2</span>            <span class="token number">6144</span>         <span class="token number">2103295</span>   <span class="token number">1024.0</span> MiB  0700  
   <span class="token number">3</span>         <span class="token number">2103296</span>        <span class="token number">65026047</span>   <span class="token number">30.0</span> GiB    8E00  
   <span class="token number">4</span>        <span class="token number">65026048</span>        <span class="token number">67123199</span>   <span class="token number">1024.0</span> MiB  <span class="token number">8300</span>  Linux filesystem

é‚£ä¹ˆåé¢ä¸¤ä¸ªåŒºçš„åˆ†åŒºç»§ç»­ï¼Œè®°å¾—æ¯æ¬¡åˆ†åŒºå®Œå°±æ‰“å°ä¸‹ä¿¡æ¯ï¼ŒæŸ¥çœ‹æ˜¯å¦æ­£ç¡®

Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: n
Partition number <span class="token punctuation">(</span><span class="token number">5</span>-128, default <span class="token number">5</span><span class="token punctuation">)</span>:
First sector <span class="token punctuation">(</span><span class="token number">34</span>-85491678, default <span class="token operator">=</span> <span class="token number">67123200</span><span class="token punctuation">)</span> or <span class="token punctuation">{</span>+-<span class="token punctuation">}</span>size<span class="token punctuation">{</span>KMGTP<span class="token punctuation">}</span>:
Last sector <span class="token punctuation">(</span><span class="token number">67123200</span>-85491678, default <span class="token operator">=</span> <span class="token number">85491678</span><span class="token punctuation">)</span> or <span class="token punctuation">{</span>+-<span class="token punctuation">}</span>size<span class="token punctuation">{</span>KMGTP<span class="token punctuation">}</span>: +1G
Current <span class="token builtin class-name">type</span> is <span class="token string">&#39;Linux filesystem&#39;</span>
Hex code or GUID <span class="token punctuation">(</span>L to show codes, Enter <span class="token operator">=</span> <span class="token number">8300</span><span class="token punctuation">)</span>: 0700  <span class="token comment"># 0700 ä¸º windows æ–‡ä»¶ç³»ç»Ÿ</span>
Changed <span class="token builtin class-name">type</span> of partition to <span class="token string">&#39;Microsoft basic data&#39;</span>

Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: n
Partition number <span class="token punctuation">(</span><span class="token number">6</span>-128, default <span class="token number">6</span><span class="token punctuation">)</span>:
First sector <span class="token punctuation">(</span><span class="token number">34</span>-85491678, default <span class="token operator">=</span> <span class="token number">69220352</span><span class="token punctuation">)</span> or <span class="token punctuation">{</span>+-<span class="token punctuation">}</span>size<span class="token punctuation">{</span>KMGTP<span class="token punctuation">}</span>:
Last sector <span class="token punctuation">(</span><span class="token number">69220352</span>-85491678, default <span class="token operator">=</span> <span class="token number">85491678</span><span class="token punctuation">)</span> or <span class="token punctuation">{</span>+-<span class="token punctuation">}</span>size<span class="token punctuation">{</span>KMGTP<span class="token punctuation">}</span>: +500M
Current <span class="token builtin class-name">type</span> is <span class="token string">&#39;Linux filesystem&#39;</span>
Hex code or GUID <span class="token punctuation">(</span>L to show codes, Enter <span class="token operator">=</span> <span class="token number">8300</span><span class="token punctuation">)</span>: <span class="token number">8200</span>  <span class="token comment"># linux swap</span>
Changed <span class="token builtin class-name">type</span> of partition to <span class="token string">&#39;Linux swap&#39;</span>

<span class="token comment"># æœ€ååˆ†åŒºå®Œæˆåçš„åˆ†åŒºä¿¡æ¯å¦‚ä¸‹</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: n
<span class="token punctuation">..</span>.
Number  Start <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>    End <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>  Size       Code  Name
   <span class="token number">1</span>            <span class="token number">2048</span>            <span class="token number">6143</span>   <span class="token number">2.0</span> MiB     EF02  
   <span class="token number">2</span>            <span class="token number">6144</span>         <span class="token number">2103295</span>   <span class="token number">1024.0</span> MiB  0700  
   <span class="token number">3</span>         <span class="token number">2103296</span>        <span class="token number">65026047</span>   <span class="token number">30.0</span> GiB    8E00  
   <span class="token number">4</span>        <span class="token number">65026048</span>        <span class="token number">67123199</span>   <span class="token number">1024.0</span> MiB  <span class="token number">8300</span>  Linux filesystem
   <span class="token number">5</span>        <span class="token number">67123200</span>        <span class="token number">69220351</span>   <span class="token number">1024.0</span> MiB  0700  Microsoft basic data
   <span class="token number">6</span>        <span class="token number">69220352</span>        <span class="token number">70244351</span>   <span class="token number">500.0</span> MiB   <span class="token number">8200</span>  Linux swap

<span class="token comment"># åˆ†åŒºçš„æ—¶å€™éœ€è¦ä½¿ç”¨åˆ° codeï¼Œä¸Šé¢æœ‰å¯¹åº”çš„ code æ•°å€¼äº†</span>
<span class="token comment"># å¦‚æœå¿˜è®°æˆ–åˆ™ä¸çŸ¥é“ï¼Œå¯ä»¥ä½¿ç”¨ l å‘½ä»¤æ¥æ˜¾ç¤ºæ‰€æœ‰çš„ code å€¼</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: l
0700 Microsoft basic data  0c01 Microsoft reserved    <span class="token number">2700</span> Windows RE          
<span class="token number">3000</span> ONIE boot             <span class="token number">3001</span> ONIE config           <span class="token number">4100</span> PowerPC PReP boot  
<span class="token punctuation">..</span>.

<span class="token comment"># æœ€åä½¿ç”¨ w å‘½ä»¤å†™å…¥ç£ç›˜åˆ†åŒºè¡¨</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: w

Final checks complete. About to <span class="token function">write</span> GPT data. THIS WILL OVERWRITE EXISTING
PARTITIONS<span class="token operator">!</span><span class="token operator">!</span>

Do you want to proceed? <span class="token punctuation">(</span>Y/N<span class="token punctuation">)</span>: y
OK<span class="token punctuation">;</span> writing new GUID partition table <span class="token punctuation">(</span>GPT<span class="token punctuation">)</span> to /dev/sda.
Warning: The kernel is still using the old partition table.
The new table will be used at the next reboot.
The operation has completed successfully.

<span class="token comment"># ç­‰ä½ è¾“å…¥ y ç¡®è®¤ä¹‹åï¼Œå¼€å§‹æ‰§è¡Œï¼Œä¸Šé¢çš„è­¦å‘Šä¿¡æ¯ç¿»è¯‘å¦‚ä¸‹</span>
è­¦å‘Šï¼šå†…æ ¸ä»åœ¨ä½¿ç”¨æ—§çš„åˆ†åŒºè¡¨ã€‚
æ–°è¡¨å°†åœ¨ä¸‹æ¬¡é‡æ–°å¯åŠ¨æ—¶ä½¿ç”¨ã€‚
æ“ä½œå·²æˆåŠŸå®Œæˆã€‚

<span class="token comment"># æŸ¥çœ‹ä¿¡æ¯ï¼Œå‘ç°åˆ†åŒºä¸­è¿˜æ²¡æœ‰å‡ºç° sda4ã€5ã€6 ï¼Œè¿™æ˜¯å› ä¸ºæ ¸å¿ƒè¿˜æ²¡æœ‰æ›´æ–°</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># cat /proc/partitions</span>
major minor  <span class="token comment">#blocks  name</span>

   <span class="token number">8</span>        <span class="token number">0</span>   <span class="token number">42745856</span> sda
   <span class="token number">8</span>        <span class="token number">1</span>       <span class="token number">2048</span> sda1
   <span class="token number">8</span>        <span class="token number">2</span>    <span class="token number">1048576</span> sda2
   <span class="token number">8</span>        <span class="token number">3</span>   <span class="token number">31461376</span> sda3
   <span class="token number">8</span>       <span class="token number">16</span>    <span class="token number">2097152</span> sdb
  <span class="token number">11</span>        <span class="token number">0</span>      <span class="token number">75354</span> sr0
 <span class="token number">253</span>        <span class="token number">0</span>   <span class="token number">10485760</span> dm-0
 <span class="token number">253</span>        <span class="token number">1</span>    <span class="token number">1048576</span> dm-1
 <span class="token number">253</span>        <span class="token number">2</span>    <span class="token number">5242880</span> dm-2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹äºè­¦å‘Šå†…æ ¸æœªç”Ÿæ•ˆï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼æ¥å¤„ç†ï¼Œç¬¬ä¸€ç§å°±æ˜¯é‡æ–°å¯åŠ¨ï¼Œå¦ä¸€ç§å°±æ˜¯é€šè¿‡ partprobe æŒ‡ä»¤æ¥å¤„ç†</p><h3 id="partprobe-æ›´æ–°-linux-æ ¸å¿ƒçš„åˆ†åŒºè¡¨ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#partprobe-æ›´æ–°-linux-æ ¸å¿ƒçš„åˆ†åŒºè¡¨ä¿¡æ¯" aria-hidden="true">#</a> partprobe æ›´æ–° Linux æ ¸å¿ƒçš„åˆ†åŒºè¡¨ä¿¡æ¯</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># -s è¾“å‡ºä¿¡æ¯ï¼Œä¸åŠ åˆ™ä¸ä¼šè¾“å‡ºä»»ä½•ä¿¡æ¯</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># partprobe -s</span>
/dev/sda: gpt partitions <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span>
Warning: æ— æ³•ä»¥è¯»å†™æ–¹å¼æ‰“å¼€ /dev/sr0 <span class="token punctuation">(</span>åªè¯»æ–‡ä»¶ç³»ç»Ÿ<span class="token punctuation">)</span>ã€‚/dev/sr0 å·²æŒ‰ç…§åªè¯»æ–¹å¼æ‰“å¼€ã€‚

<span class="token comment"># æŸ¥çœ‹ç£ç›˜çŠ¶æ€ï¼Œå‘ç°å‡ºç°äº† 4ã€5ã€6 åˆ†åŒº</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># lsblk /dev/sda</span>
NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda               <span class="token number">8</span>:0    <span class="token number">0</span> <span class="token number">40</span>.8G  <span class="token number">0</span> disk 
â”œâ”€sda1            <span class="token number">8</span>:1    <span class="token number">0</span>    2M  <span class="token number">0</span> part 
â”œâ”€sda2            <span class="token number">8</span>:2    <span class="token number">0</span>    1G  <span class="token number">0</span> part /boot
â”œâ”€sda3            <span class="token number">8</span>:3    <span class="token number">0</span>   30G  <span class="token number">0</span> part 
â”‚ â”œâ”€centos-root <span class="token number">253</span>:0    <span class="token number">0</span>   10G  <span class="token number">0</span> lvm  /
â”‚ â”œâ”€centos-swap <span class="token number">253</span>:1    <span class="token number">0</span>    1G  <span class="token number">0</span> lvm  <span class="token punctuation">[</span>SWAP<span class="token punctuation">]</span>
â”‚ â””â”€centos-home <span class="token number">253</span>:2    <span class="token number">0</span>    5G  <span class="token number">0</span> lvm  /home
â”œâ”€sda4            <span class="token number">8</span>:4    <span class="token number">0</span>    1G  <span class="token number">0</span> part 
â”œâ”€sda5            <span class="token number">8</span>:5    <span class="token number">0</span>    1G  <span class="token number">0</span> part 
â””â”€sda6            <span class="token number">8</span>:6    <span class="token number">0</span>  500M  <span class="token number">0</span> part 

<span class="token comment"># æŸ¥çœ‹åˆ†åŒºè®°å½•ï¼Œä¹Ÿå‡ºç°äº† 4ã€5ã€6</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># cat /proc/partitions </span>
major minor  <span class="token comment">#blocks  name</span>

   <span class="token number">8</span>        <span class="token number">0</span>   <span class="token number">42745856</span> sda
   <span class="token number">8</span>        <span class="token number">1</span>       <span class="token number">2048</span> sda1
   <span class="token number">8</span>        <span class="token number">2</span>    <span class="token number">1048576</span> sda2
   <span class="token number">8</span>        <span class="token number">3</span>   <span class="token number">31461376</span> sda3
   <span class="token number">8</span>        <span class="token number">4</span>    <span class="token number">1048576</span> sda4
   <span class="token number">8</span>        <span class="token number">5</span>    <span class="token number">1048576</span> sda5
   <span class="token number">8</span>        <span class="token number">6</span>     <span class="token number">512000</span> sda6
   <span class="token number">8</span>       <span class="token number">16</span>    <span class="token number">2097152</span> sdb
  <span class="token number">11</span>        <span class="token number">0</span>      <span class="token number">75354</span> sr0
 <span class="token number">253</span>        <span class="token number">0</span>   <span class="token number">10485760</span> dm-0
 <span class="token number">253</span>        <span class="token number">1</span>    <span class="token number">1048576</span> dm-1
 <span class="token number">253</span>        <span class="token number">2</span>    <span class="token number">5242880</span> dm-2

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç”¨-gdisk-åˆ é™¤ä¸€ä¸ªåˆ†åŒºæ§½" tabindex="-1"><a class="header-anchor" href="#ç”¨-gdisk-åˆ é™¤ä¸€ä¸ªåˆ†åŒºæ§½" aria-hidden="true">#</a> ç”¨ gdisk åˆ é™¤ä¸€ä¸ªåˆ†åŒºæ§½</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># gdisk /dev/sda</span>
GPT <span class="token function">fdisk</span> <span class="token punctuation">(</span>gdisk<span class="token punctuation">)</span> version <span class="token number">0.8</span>.10

Partition table scan:
  MBR: protective
  BSD: not present
  APM: not present
  GPT: present

Found valid GPT with protective MBR<span class="token punctuation">;</span> using GPT.

<span class="token comment"># æŸ¥çœ‹åˆ†åŒºä¿¡æ¯</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: p
Disk /dev/sda: <span class="token number">85491712</span> sectors, <span class="token number">40.8</span> GiB
Logical sector size: <span class="token number">512</span> bytes
Disk identifier <span class="token punctuation">(</span>GUID<span class="token punctuation">)</span>: 67038DBF-B66A-4D0F-92B2-BFBF0744CD1D
Partition table holds up to <span class="token number">128</span> entries
First usable sector is <span class="token number">34</span>, last usable sector is <span class="token number">85491678</span>
Partitions will be aligned on <span class="token number">2048</span>-sector boundaries
Total <span class="token function">free</span> space is <span class="token number">15249341</span> sectors <span class="token punctuation">(</span><span class="token number">7.3</span> GiB<span class="token punctuation">)</span>

Number  Start <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>    End <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>  Size       Code  Name
   <span class="token number">1</span>            <span class="token number">2048</span>            <span class="token number">6143</span>   <span class="token number">2.0</span> MiB     EF02  
   <span class="token number">2</span>            <span class="token number">6144</span>         <span class="token number">2103295</span>   <span class="token number">1024.0</span> MiB  0700  
   <span class="token number">3</span>         <span class="token number">2103296</span>        <span class="token number">65026047</span>   <span class="token number">30.0</span> GiB    8E00  
   <span class="token number">4</span>        <span class="token number">65026048</span>        <span class="token number">67123199</span>   <span class="token number">1024.0</span> MiB  <span class="token number">8300</span>  Linux filesystem
   <span class="token number">5</span>        <span class="token number">67123200</span>        <span class="token number">69220351</span>   <span class="token number">1024.0</span> MiB  0700  Microsoft basic data
   <span class="token number">6</span>        <span class="token number">69220352</span>        <span class="token number">70244351</span>   <span class="token number">500.0</span> MiB   <span class="token number">8200</span>  Linux swap

<span class="token comment"># åˆ é™¤ç¬¬ 6 ä¸ªåˆ†åŒº</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: d
Partition number <span class="token punctuation">(</span><span class="token number">1</span>-6<span class="token punctuation">)</span>: <span class="token number">6</span>

<span class="token comment"># å†æ¬¡æŸ¥çœ‹ï¼Œå‘ç° 6 ä¸åœ¨äº†</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: p
Disk /dev/sda: <span class="token number">85491712</span> sectors, <span class="token number">40.8</span> GiB
Logical sector size: <span class="token number">512</span> bytes
Disk identifier <span class="token punctuation">(</span>GUID<span class="token punctuation">)</span>: 67038DBF-B66A-4D0F-92B2-BFBF0744CD1D
Partition table holds up to <span class="token number">128</span> entries
First usable sector is <span class="token number">34</span>, last usable sector is <span class="token number">85491678</span>
Partitions will be aligned on <span class="token number">2048</span>-sector boundaries
Total <span class="token function">free</span> space is <span class="token number">16273341</span> sectors <span class="token punctuation">(</span><span class="token number">7.8</span> GiB<span class="token punctuation">)</span>

Number  Start <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>    End <span class="token punctuation">(</span>sector<span class="token punctuation">)</span>  Size       Code  Name
   <span class="token number">1</span>            <span class="token number">2048</span>            <span class="token number">6143</span>   <span class="token number">2.0</span> MiB     EF02  
   <span class="token number">2</span>            <span class="token number">6144</span>         <span class="token number">2103295</span>   <span class="token number">1024.0</span> MiB  0700  
   <span class="token number">3</span>         <span class="token number">2103296</span>        <span class="token number">65026047</span>   <span class="token number">30.0</span> GiB    8E00  
   <span class="token number">4</span>        <span class="token number">65026048</span>        <span class="token number">67123199</span>   <span class="token number">1024.0</span> MiB  <span class="token number">8300</span>  Linux filesystem
   <span class="token number">5</span>        <span class="token number">67123200</span>        <span class="token number">69220351</span>   <span class="token number">1024.0</span> MiB  0700  Microsoft basic data

<span class="token comment"># å†™å…¥å¹¶ç¦»å¼€</span>
Command <span class="token punctuation">(</span>? <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: w

Final checks complete. About to <span class="token function">write</span> GPT data. THIS WILL OVERWRITE EXISTING
PARTITIONS<span class="token operator">!</span><span class="token operator">!</span>

Do you want to proceed? <span class="token punctuation">(</span>Y/N<span class="token punctuation">)</span>: y
OK<span class="token punctuation">;</span> writing new GUID partition table <span class="token punctuation">(</span>GPT<span class="token punctuation">)</span> to /dev/sda.
Warning: The kernel is still using the old partition table.
The new table will be used at the next reboot.
The operation has completed successfully.

<span class="token comment"># æŸ¥çœ‹ç£ç›˜çŠ¶æ€ï¼Œå‘ç° sda6 è¿˜å­˜åœ¨ï¼Œåªæ˜¯å› ä¸ºæ²¡æœ‰æ›´æ–°æ ¸å¿ƒåˆ†åŒºè¡¨å¯¼è‡´çš„</span>
<span class="token comment"># ä½¿ç”¨å‘½ä»¤ partprobe -s æ›´æ–°ä¸‹å†æŸ¥çœ‹å°±æ²¡æœ‰äº†</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># lsblk</span>
NAME            MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda               <span class="token number">8</span>:0    <span class="token number">0</span> <span class="token number">40</span>.8G  <span class="token number">0</span> disk 
â”œâ”€sda1            <span class="token number">8</span>:1    <span class="token number">0</span>    2M  <span class="token number">0</span> part 
â”œâ”€sda2            <span class="token number">8</span>:2    <span class="token number">0</span>    1G  <span class="token number">0</span> part /boot
â”œâ”€sda3            <span class="token number">8</span>:3    <span class="token number">0</span>   30G  <span class="token number">0</span> part 
â”‚ â”œâ”€centos-root <span class="token number">253</span>:0    <span class="token number">0</span>   10G  <span class="token number">0</span> lvm  /
â”‚ â”œâ”€centos-swap <span class="token number">253</span>:1    <span class="token number">0</span>    1G  <span class="token number">0</span> lvm  <span class="token punctuation">[</span>SWAP<span class="token punctuation">]</span>
â”‚ â””â”€centos-home <span class="token number">253</span>:2    <span class="token number">0</span>    5G  <span class="token number">0</span> lvm  /home
â”œâ”€sda4            <span class="token number">8</span>:4    <span class="token number">0</span>    1G  <span class="token number">0</span> part 
â”œâ”€sda5            <span class="token number">8</span>:5    <span class="token number">0</span>    1G  <span class="token number">0</span> part 
â””â”€sda6            <span class="token number">8</span>:6    <span class="token number">0</span>  500M  <span class="token number">0</span> part 
sdb               <span class="token number">8</span>:16   <span class="token number">0</span>    2G  <span class="token number">0</span> disk 
sr0              <span class="token number">11</span>:0    <span class="token number">1</span> <span class="token number">73</span>.6M  <span class="token number">0</span> rom  

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸è¦å»å¤„ç†ä¸€ä¸ª <strong>æ­£åœ¨ä½¿ç”¨ä¸­çš„åˆ†åŒºæ§½</strong> ã€‚ä¾‹å¦‚ï¼šç°åœ¨å·²ç»ä½¿ç”¨äº† /dev/sda5ï¼Œ å¿…é¡»å…ˆå°† /dev/sda5 å…ˆ <strong>å¸è½½</strong> ï¼Œå¦åˆ™ç›´æ¥åˆ é™¤è¯¥åˆ†åŒºçš„è¯ï¼Œè™½ç„¶ç£ç›˜ä¼šå†™å…¥æ­£ç¡®çš„åˆ†åŒºä¿¡æ¯ï¼Œ ä½†æ˜¯æ ¸å¿ƒä¼šæ— æ³•æ›´æ–°åˆ†åŒºè¡¨çš„ä¿¡æ¯ã€‚</p><p>æ€»ä¹‹ï¼šåƒä¸‡ä¸è¦å¤„ç†æ­£åœ¨æ´»åŠ¨çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå…ˆå¸è½½åå†å¤„ç†</p><h3 id="fdisk" tabindex="-1"><a class="header-anchor" href="#fdisk" aria-hidden="true">#</a> fdisk</h3><p>è™½ç„¶ MBR åœ¨æœªæ¥å¯èƒ½ä¼šæ…¢æ…¢æ·˜æ±°ï¼Œä½†æ˜¯å¦‚æœæ°å·§ä½ é‡åˆ°äº†å‘¢ï¼Œä½¿ç”¨æ–¹å¼ä¸ gdisk ç±»ä¼¼ï¼Œä¸‹é¢åˆ—å‡ºæŒ‡ä»¤å¸®åŠ©æ–‡æ¡£</p><figure><img src="`+r+`" alt="image-20191027131011438" tabindex="0" loading="lazy"><figcaption>image-20191027131011438</figcaption></figure><h2 id="ğŸ€-ç£ç›˜æ ¼å¼åŒ–-å»ºç«‹æ–‡ä»¶ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç£ç›˜æ ¼å¼åŒ–-å»ºç«‹æ–‡ä»¶ç³»ç»Ÿ" aria-hidden="true">#</a> ğŸ€ ç£ç›˜æ ¼å¼åŒ–ï¼ˆå»ºç«‹æ–‡ä»¶ç³»ç»Ÿï¼‰</h2><p>åˆ†åŒºå®Œæˆä¹‹åéœ€è¦è¿›è¡Œæ ¼å¼åŒ–æ‰èƒ½ä½¿ç”¨ç£ç›˜ï¼Œå¯ä»¥ä½¿ç”¨æŒ‡ä»¤ã€Œmake filesystemï¼Œmkfsã€ï¼Œè¯¥æŒ‡ä»¤æ˜¯ä¸€ä¸ªç»¼åˆæŒ‡ä»¤ï¼Œå›å»è°ƒç”¨æ­£ç¡®çš„ç³»ç»Ÿæ ¼å¼åŒ–å·¥å…·è½¯ä»¶ã€‚å› ä¸º CentOS 7 ä½¿ç”¨ xfs ä½œä¸ºé¢„è®¾æ–‡ä»¶ç³»ç»Ÿï¼Œä¸‹é¢å…ˆä»‹ç» mkfs.xfs ï¼Œå†ä»‹ç»æ–°ä¸€ä»£çš„ mkfs.ext4ï¼Œæœ€åå†èŠ mkfs è¿™ä¸ªç»¼åˆæŒ‡ä»¤</p><h3 id="xfs-æ–‡ä»¶ç³»ç»Ÿ-mkfs-xfs" tabindex="-1"><a class="header-anchor" href="#xfs-æ–‡ä»¶ç³»ç»Ÿ-mkfs-xfs" aria-hidden="true">#</a> XFS æ–‡ä»¶ç³»ç»Ÿ mkfs.xfs</h3><p>å¸¸å¬åˆ°çš„æ ¼å¼åŒ–å…¶å®åº”è¯¥ç§°ä¸ºã€Œå»ºç«‹æ–‡ä»¶ç³»ç»Ÿï¼ˆmake filesystemï¼‰ã€ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mkfs.xfs <span class="token punctuation">[</span>-b bsize<span class="token punctuation">]</span><span class="token punctuation">[</span>-d parms<span class="token punctuation">]</span><span class="token punctuation">[</span>-i parms<span class="token punctuation">]</span><span class="token punctuation">[</span>-l parms<span class="token punctuation">]</span><span class="token punctuation">[</span>-L parms<span class="token punctuation">]</span><span class="token punctuation">[</span>-f<span class="token punctuation">]</span><span class="token punctuation">[</span>-r parms<span class="token punctuation">]</span> è®¾å¤‡åç§°
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é€‰é¡¹ä¸å‚æ•°ï¼šä¸‹é¢æè¿°å…³äºå•ä½çš„è¯´æ˜ï¼Œæ²¡æœ‰åŠ å•ä½åˆ™ä¸º bytesï¼Œå¯ä»¥ç”¨ kã€mã€gã€tã€p ç­‰æ¥è§£é‡Šï¼Œç‰¹æ®Šçš„ä¸º s å•ä½ï¼ŒæŒ‡çš„æ˜¯ sector çš„ä¸ªæ•°</p><ul><li><p>bï¼šåé¢æ¥ block å®¹é‡ï¼Œå¯ç”± 512 åˆ° 64kï¼Œä¸è¿‡æœ€å¤§å®¹é‡é™åˆ¶ä¸º Linux çš„ 4k</p></li><li><p>dï¼šåé¢æ¥ data section çš„ç›¸å…³å‚æ•°ï¼Œä¸»è¦çš„å€¼æœ‰ï¼š</p><ul><li><p>agcount=æ•°å€¼ï¼šè®¾ç½®éœ€è¦å‡ ä¸ªå­˜å‚¨ç¾¤ç»„ï¼ˆAGï¼‰ï¼Œé€šå¸¸ä¸ CPU æœ‰å…³</p></li><li><p>agsize=æ•°å€¼ï¼šæ¯ä¸ª AG è®¾ç½®ä¸ºå¤šå°‘å®¹é‡ï¼Œé€šå¸¸ agcount/agsize åªé€‰ä¸€ä¸ªè®¾ç½®å³å¯</p></li><li><p>fileï¼šæ ¼å¼çš„çš„è£…ç½®æ˜¯ä¸ªæ–‡ä»¶è€Œä¸æ˜¯ä¸ªè£…ç½®ï¼ˆä¾‹å¦‚è™šæ‹Ÿç£ç›˜ï¼‰</p></li><li><p>size=æ•°å€¼ï¼šdata section çš„æ•°é‡ï¼Œä½ å¯ä¸å°†å…¨éƒ¨çš„å®¹é‡ç”¨å®Œçš„æ„æ€</p></li><li><p>su=æ•°å€¼ï¼šå½“æœ‰ RAID æ—¶ï¼Œå“ªä¸ª stripe æ•°å€¼ï¼Œä¸ä¸‹é¢çš„ sw æ­é…ä½¿ç”¨</p></li><li><p>sw=æ•°å€¼ï¼šå½“æœ‰ RAID æ—¶ï¼Œç”¨äºå­˜å‚¨çš„ç£ç›˜æ•°é‡ï¼ˆéœ€æ‰£é™¤å¤‡ä»½ç¢Ÿä¸å¤‡ç”¨ç¢Ÿï¼‰</p></li><li><p>sunit-æ•°å€¼ï¼šä¸ su ç±»å‹ï¼Œä¸è¿‡å•ä½ä½¿ç”¨çš„æ˜¯ã€Œå‡ ä¸ª sectorï¼ˆ512byteså¤§å°ï¼‰ã€</p></li><li><p>swidth=æ•°å€¼ï¼šsu<em>sw çš„å€¼ï¼Œä½†æ˜¯ä»¥ã€Œå‡ ä¸ª sector</em>ï¼ˆ512bytes å¤§å°ï¼‰ã€æ¥è®¾ç½®</p></li></ul></li><li><p>fï¼šå¦‚æœè£…ç½®å†…å·²ç»æœ‰æ–‡ä»¶ç³»ç»Ÿï¼Œåˆ™éœ€è¦ä½¿ç”¨è¯¥å‚æ•°æ¥å¼ºåˆ¶æ ¼å¼åŒ–</p></li><li><p>iï¼šä¸ inode æœ‰è¾ƒç›¸å…³çš„è®¾ç½®ï¼Œä¸»è¦çš„è®¾ç½®å€¼æœ‰ï¼š</p><ul><li>size=æ•°å€¼ï¼šæœ€å°æ˜¯ 256bytesï¼Œæœ€å¤§æ˜¯ 2kï¼Œä¸€èˆ¬ä¿ç•™ 256 è¶³å¤Ÿä½¿ç”¨äº†</li><li>internal=[0|1]ï¼šlog è£…ç½®æ˜¯å¦ä¸ºå†…å»ºï¼Ÿé¢„è®¾ä¸º 1 å†…å»ºï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å¤–ç½®çš„ï¼Œé…ç½®ä¸‹é¢çš„å‚æ•°</li><li>logdev=deviceï¼šæŒ‡å®š log è£…ç½®åœ¨å“ªä¸ªè£…ç½®ä¸Š</li><li>size=æ•°å€¼ï¼šæŒ‡å®šè¿™å—ç™»å½•åŒºçš„å®¹é‡ï¼Œé€šå¸¸æœ€å°éœ€è¦ 512 ä¸ª blockï¼Œå¤§çº¦ 2M ä»¥ä¸Š</li></ul></li><li><p>Lï¼šæŒ‡å®šè¯¥æ–‡ä»¶ç³»ç»Ÿçš„è¡¨å¤´åç§° Label name</p></li><li><p>rï¼šæŒ‡å®š realtime section çš„ç›¸å…³è®¾ç½®ï¼Œå¸¸è§çš„æœ‰</p><ul><li>extsize=æ•°å€¼ï¼šå°±æ˜¯é‚£ä¸ªé‡è¦çš„ extent æ•°å€¼ï¼Œä¸€èˆ¬ä¸éœ€è¦è®¾ç½®ï¼Œæ‹…å¿§ RAID æ—¶ï¼Œæœ€å¥½è®¾ç½®ä¸ swidth ç›¸åŒçš„æ•°å€¼ï¼Œæœ€å°ä¸º 4k ï¼Œæœ€å¤§ä¸º 1G</li></ul></li></ul><p>å®è·µç»ƒä¹ </p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å°†å‰é¢åˆ†åŒºå‡ºæ¥çš„ /dev/sda4 æ ¼å¼åŒ–ä¸º xfs æ–‡ä»¶ç³»ç»Ÿ</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkfs.xfs /dev/sda4</span>
meta-data<span class="token operator">=</span>/dev/sda4              <span class="token assign-left variable">isize</span><span class="token operator">=</span><span class="token number">512</span>    <span class="token assign-left variable">agcount</span><span class="token operator">=</span><span class="token number">4</span>, <span class="token assign-left variable">agsize</span><span class="token operator">=</span><span class="token number">65536</span> blks
         <span class="token operator">=</span>                       <span class="token assign-left variable">sectsz</span><span class="token operator">=</span><span class="token number">512</span>   <span class="token assign-left variable">attr</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">projid32bit</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">crc</span><span class="token operator">=</span><span class="token number">1</span>        <span class="token assign-left variable">finobt</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">sparse</span><span class="token operator">=</span><span class="token number">0</span>
data     <span class="token operator">=</span>                       <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">262144</span>, <span class="token assign-left variable">imaxpct</span><span class="token operator">=</span><span class="token number">25</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">sunit</span><span class="token operator">=</span><span class="token number">0</span>      <span class="token assign-left variable">swidth</span><span class="token operator">=</span><span class="token number">0</span> blks
naming   <span class="token operator">=</span>version <span class="token number">2</span>              <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   ascii-ci<span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">ftype</span><span class="token operator">=</span><span class="token number">1</span>
log      <span class="token operator">=</span>internal log           <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">2560</span>, <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token number">2</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">sectsz</span><span class="token operator">=</span><span class="token number">512</span>   <span class="token assign-left variable">sunit</span><span class="token operator">=</span><span class="token number">0</span> blks, lazy-count<span class="token operator">=</span><span class="token number">1</span>
realtime <span class="token operator">=</span>none                   <span class="token assign-left variable">extsz</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">rtextents</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token comment"># å¾ˆå¿«å°±æ ¼å¼åŒ–å®Œæˆäº†ï¼Œä¸åŠ ä»»ä½•å‚æ•°ä½¿ç”¨çš„æ˜¯é»˜è®¤å€¼ï¼Œè¾ƒé‡è¦çš„æ˜¯ inode ä¸ block çš„æ•°å€¼</span>
<span class="token comment"># isize å°±æ˜¯ inodeçš„å¤§å°ï¼Œbsize å°±æ˜¯ block çš„å¤§å°</span>

<span class="token comment"># æŸ¥çœ‹ä¿¡æ¯ï¼Œç¡®å®šä¸º xfs äº†</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># blkid /dev/sda4</span>
/dev/sda4: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;4079b244-7ef8-47eb-85d0-1d634c8c703f&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;xfs&quot;</span> <span class="token assign-left variable">PARTLABEL</span><span class="token operator">=</span><span class="token string">&quot;Linux filesystem&quot;</span> <span class="token assign-left variable">PARTUUID</span><span class="token operator">=</span><span class="token string">&quot;3819b115-2ab8-4fb6-8425-bb2ff8e797b7&quot;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€èˆ¬ä½¿ç”¨é»˜è®¤çš„ xfs æ–‡ä»¶ç³»ç»Ÿå‚æ•°æ¥æ ¼å¼åŒ–å³å¯ï¼Œå¦‚æœæœ‰å…¶ä»–é¢å¤–çš„å®šåˆ¶åˆ™éœ€è¦æ·»åŠ å¯¹åº”çš„å‚æ•°æ¥è®¾ç½®ã€‚æ¯”å¦‚ï¼šå› ä¸º xfs å¯ä»¥ä½¿ç”¨å¤šä¸ªæ•°æ®æµæ¥è¯»å†™ç³»ç»Ÿï¼Œå¢åŠ é€Ÿåº¦ï¼Œå› æ­¤å“ªä¸ª agcount å¯ä»¥è·Ÿ CPU çš„æ ¸å¿ƒæ•°é‡æ¥åšæ­é…ã€‚æ¯”å¦‚æœåŠ¡å™¨æœ‰ä¸€é¢— 4 æ ¸å¿ƒ 8 çº¿ç¨‹çš„ CPUï¼Œå…¶å®å°±ç›¸å½“äºæ˜¯ 8 æ ¸å¿ƒäº†ï¼Œå¯ä»¥è®¾ç½®ä¸º 8</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># æ‰¾å‡ºç³»ç»Ÿçš„ CPU æ•°é‡ï¼Œå¹¶è®¾ç½® agcount æ•°é‡</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># grep &#39;processor&#39; /proc/cpuinfo</span>
processor       <span class="token builtin class-name">:</span> <span class="token number">0</span>
<span class="token comment"># è¿™é‡Œåªæœ‰ä¸€ä¸ª processorï¼Œåˆ™è¡¨ç¤ºåªæœ‰ä¸€é¢— CPU</span>

<span class="token comment"># ä½¿ç”¨ -f ï¼ˆå‰é¢å·²ç»æ ¼å¼åŒ–æœ‰æ–‡ä»¶ç³»ç»Ÿäº†ï¼Œå¼ºåˆ¶ï¼‰-d æŒ‡å®š agcount æ•°å€¼</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkfs.xfs -f -d agcount=1 /dev/sda4</span>
meta-data<span class="token operator">=</span>/dev/sda4              <span class="token assign-left variable">isize</span><span class="token operator">=</span><span class="token number">512</span>    <span class="token assign-left variable">agcount</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">agsize</span><span class="token operator">=</span><span class="token number">262144</span> blks
         <span class="token operator">=</span>                       <span class="token assign-left variable">sectsz</span><span class="token operator">=</span><span class="token number">512</span>   <span class="token assign-left variable">attr</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">projid32bit</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">crc</span><span class="token operator">=</span><span class="token number">1</span>        <span class="token assign-left variable">finobt</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">sparse</span><span class="token operator">=</span><span class="token number">0</span>
data     <span class="token operator">=</span>                       <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">262144</span>, <span class="token assign-left variable">imaxpct</span><span class="token operator">=</span><span class="token number">25</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">sunit</span><span class="token operator">=</span><span class="token number">0</span>      <span class="token assign-left variable">swidth</span><span class="token operator">=</span><span class="token number">0</span> blks
naming   <span class="token operator">=</span>version <span class="token number">2</span>              <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   ascii-ci<span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">ftype</span><span class="token operator">=</span><span class="token number">1</span>
log      <span class="token operator">=</span>internal log           <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">2560</span>, <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token number">2</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">sectsz</span><span class="token operator">=</span><span class="token number">512</span>   <span class="token assign-left variable">sunit</span><span class="token operator">=</span><span class="token number">0</span> blks, lazy-count<span class="token operator">=</span><span class="token number">1</span>
realtime <span class="token operator">=</span>none                   <span class="token assign-left variable">extsz</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">rtextents</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token comment"># ä¸è¿‡ï¼šç¬”è€…å‘ç°ï¼Œé»˜è®¤çš„ agcount=4 è€Œä¸æ˜¯æŒ‰ç…§ cpu æ•°é‡æ¥çš„</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xfs-æ–‡ä»¶ç³»ç»Ÿ-for-raid-æ•ˆèƒ½ä¼˜åŒ–-optional" tabindex="-1"><a class="header-anchor" href="#xfs-æ–‡ä»¶ç³»ç»Ÿ-for-raid-æ•ˆèƒ½ä¼˜åŒ–-optional" aria-hidden="true">#</a> XFS æ–‡ä»¶ç³»ç»Ÿ for RAID æ•ˆèƒ½ä¼˜åŒ–ï¼ˆOptionalï¼‰</h3><p>åœ¨åç»­ä¼šè°ˆåˆ°ã€Œè¿›é˜¶æ–‡ä»¶ç³»ç»Ÿçš„è®¾ç½®ã€ï¼Œå…¶ä¸­å°±æœ‰ç£ç›˜é˜µåˆ—ï¼Œæ˜¯å¤šé¢—ç£ç›˜ç»„æˆä¸€é¢—å¤§ç£ç›˜çš„æ„æ€ï¼Œåˆ©ç”¨åŒæ­¥å†™å…¥åˆ°è¿™äº›ç£ç›˜çš„æŠ€æœ¯ï¼Œä¸ä½†å¯ä»¥åŠ å¿«è¯»å†™é€Ÿåº¦ï¼Œè¿˜å¯ä»¥è®©æŸä¸€é¢—ç£ç›˜åæ‰æ—¶ï¼Œæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿè¿˜æ˜¯å¼€æºæŒç»­è¿ä½œçš„çŠ¶æ€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å®¹é”™</p><p>åŸºæœ¬ä¸Šï¼Œç£ç›˜é˜µåˆ— RAID å°±æ˜¯é€šè¿‡å°†æ–‡ä»¶å…ˆç»†åˆ†ä¸ºæ•°ä¸ªå°å‹çš„åˆ†åŒºåŒºå—ï¼ˆstripeï¼‰åï¼Œå°†ä»–ä»¬åˆ†åˆ«æ”¾åˆ°ç£ç›˜é˜µåˆ—é‡Œé¢çš„æ‰€æœ‰ç£ç›˜ï¼Œæ‰€ä»¥ä¸€ä¸ªæ–‡ä»¶æ˜¯è¢«åŒæ—¶å†™å…¥åˆ°å¤šä¸ªç£ç›˜ä¸­å»çš„ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç£ç›˜é˜µåˆ—é«˜æ•ˆè¯»å–çš„åŸå› ä¹‹ä¸€ï¼‰ã€‚ä¸ºäº†æ–‡ä»¶æ•°æ®çš„å®‰å…¨ï¼Œåœ¨è¿™äº›ç£ç›˜ä¸­è¿˜ä¼šè§„åˆ’å¤„ä¸€éƒ¨åˆ†ä½œä¸ºå¤‡ä»½ç£ç›˜ï¼ˆparity diskï¼‰ï¼Œä»¥åŠå¯èƒ½ä¼šä¿ç•™ä¸€ä¸ªä»¥ä¸Šçš„å¤‡ç”¨ç£ç›˜ï¼ˆspare diskï¼‰ï¼Œè¿™äº›åŒºå—åŸºæœ¬ä¸Šä¼šå ç”¨æ‰ç£ç›˜é˜µåˆ—çš„æ€»å®¹é‡ï¼Œä½†æ˜¯å¯¹äºæ•°æ®æ¥è¯´æ¯”è¾ƒæœ‰ä¿éšœ</p><p>åˆ†åŒºåŒºå— stripe çš„æ•°å€¼å¤§å¤šä»‹äº 4k åˆ° 1m ä¹‹é—´ï¼Œè¿™ä¸ä½ çš„ç£ç›˜é˜µåˆ—å¡æ”¯æŒçš„é¡¹ç›®æœ‰å…³ã€‚stripe ä¸ä½ çš„æ–‡ä»¶æ•°æ®å®¹é‡ä»¥åŠæ•ˆèƒ½ç›¸å…³æ€§è¾ƒé«˜ã€‚å½“ç”¨äºå¤§å‹æ–‡ä»¶æ—¶ï¼Œä¸€èˆ¬å»ºè®® stripe å¯ä»¥è®¾ç½®å¤§ä¸€ç‚¹ï¼Œè¿™æ ·ç£ç›˜é˜µåˆ—è¯»å†™é¢‘ç‡ä¼šé™ä½ï¼Œæ•ˆèƒ½ä¼šæå‡ã€‚å¦‚æœæ˜¯ç”¨äºç³»ç»Ÿï¼Œé‚£ä¹ˆå°æ–‡ä»¶æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œstripe å»ºè®®å¤§çº¦åœ¨ 64K å·¦å³å¯èƒ½ä¼šæ›´å¥½ã€‚ä¸è¿‡ï¼Œè¿™äº›å‚æ•°æœ€å¥½ç»è¿‡æµ‹è¯•ä¹‹åçœ‹æ˜¯å¦èƒ½è¾¾åˆ°é¢„æœŸæ•ˆæœå†è°ƒæ•´ã€‚æ›´è¯¦ç»†çš„ä¿¡æ¯åœ¨åç»­å†è®²è§£</p><p>ã€Œç£ç›˜é˜µåˆ—ç« èŠ‚ã€åœ¨åç»­å­¦å®Œï¼Œå†å›è¿‡å¤´æ¥çœ‹è¯¥ç« èŠ‚ã€‚</p><p>æ–‡ä»¶ç³»ç»Ÿçš„è¯»å†™è¦èƒ½å¤Ÿæœ‰ä¼˜åŒ–ï¼Œæœ€å¥½èƒ½å¤Ÿæ­é…ç£ç›˜é˜µåˆ—çš„å‚æ•°æ¥è®¾è®¡ï¼›æå‰å…ˆåœ¨æ–‡ä»¶ç³»ç»Ÿå°±å°† stripe è§„åˆ’å¥½ï¼Œå“ªäº¤ç»™ RAID å»å­˜å–æ—¶ï¼Œå®ƒå°±æ— éœ€é‡å¤è¿›è¡Œæ–‡ä»¶çš„ stripe è¿‡ç¨‹ï¼Œæ•ˆèƒ½ä¼šæ›´å¥½ï¼Œåœ¨æ ¼å¼åŒ–æ—¶ï¼Œä¼˜åŒ–æ•ˆèƒ½ä¸å“ªäº›æœ‰å…³ç³»å‘¢ï¼Ÿä¸‹é¢æ¨¡æ‹Ÿä¸€ä¸ªç¯å¢ƒï¼š</p><ul><li>CPU 2 æ ¸å¿ƒï¼Œæ‰€ä»¥è®¾ç½® agcount ä¸º 2</li><li>å½“åˆè®¾ç½® RAID çš„ stripe æŒ‡å®šä¸º 256k ï¼Œå› æ­¤ su æœ€å¥½è®¾ç½®ä¸º 256k</li><li>è®¾ç½®çš„ç£ç›˜é˜µåˆ—æœ‰ 8 é¢—ï¼Œå› ä¸ºæ˜¯ RAID5 çš„è®¾ç½®ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ª parityï¼ˆå¤‡ä»½ç¢Ÿï¼‰å› æ­¤æŒ‡å®š sw ä¸º 7</li><li>ç”±ä¸Šè¿°æ•°æ®å¯ä»¥å‘ç°æ•°æ®å®½åº¦ swidth åº”è¯¥ä¸º 256k * 7 = 1792kï¼Œå¯ä»¥è®¾ç½® extsize ä¸º 1792k</li></ul><p>è¿™é‡Œä»…å¿«é€Ÿçš„ä½¿ç”¨ mkfs.xfs çš„å‚æ•°æ¥å¤„ç†æ ¼å¼åŒ–åŠ¨ä½œï¼ˆç›¸å…³ç£ç›˜é˜µåˆ—è¦æ±‚çš„æ•°é‡ç­‰ï¼Œè¯·è‡ªè¡Œç™¾åº¦ï¼‰</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkfs.xfs -f -d agcount=2,su=256k,sw=7 -r extsize=1792k /dev/sda4</span>
meta-data<span class="token operator">=</span>/dev/sda4              <span class="token assign-left variable">isize</span><span class="token operator">=</span><span class="token number">512</span>    <span class="token assign-left variable">agcount</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">agsize</span><span class="token operator">=</span><span class="token number">131072</span> blks
         <span class="token operator">=</span>                       <span class="token assign-left variable">sectsz</span><span class="token operator">=</span><span class="token number">512</span>   <span class="token assign-left variable">attr</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">projid32bit</span><span class="token operator">=</span><span class="token number">1</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">crc</span><span class="token operator">=</span><span class="token number">1</span>        <span class="token assign-left variable">finobt</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">sparse</span><span class="token operator">=</span><span class="token number">0</span>
data     <span class="token operator">=</span>                       <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">262144</span>, <span class="token assign-left variable">imaxpct</span><span class="token operator">=</span><span class="token number">25</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">sunit</span><span class="token operator">=</span><span class="token number">64</span>     <span class="token assign-left variable">swidth</span><span class="token operator">=</span><span class="token number">448</span> blks
naming   <span class="token operator">=</span>version <span class="token number">2</span>              <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   ascii-ci<span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">ftype</span><span class="token operator">=</span><span class="token number">1</span>
log      <span class="token operator">=</span>internal log           <span class="token assign-left variable">bsize</span><span class="token operator">=</span><span class="token number">4096</span>   <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">2560</span>, <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token number">2</span>
         <span class="token operator">=</span>                       <span class="token assign-left variable">sectsz</span><span class="token operator">=</span><span class="token number">512</span>   <span class="token assign-left variable">sunit</span><span class="token operator">=</span><span class="token number">64</span> blks, lazy-count<span class="token operator">=</span><span class="token number">1</span>
realtime <span class="token operator">=</span>none                   <span class="token assign-left variable">extsz</span><span class="token operator">=</span><span class="token number">1835008</span> <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token assign-left variable">rtextents</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token comment"># å…³æ³¨ agcountã€sunitã€swidthã€extsz çš„å€¼</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»è¾“å‡ºç»“æœæ¥çœ‹ï¼Œagcount æ²¡æœ‰é—®é¢˜</p><ul><li>agcountï¼šæ²¡æœ‰é—®é¢˜</li><li>sunitï¼š64 ä¸ª blockï¼Œ64 * 4096ï¼ˆå•ä¸ªblock å®¹é‡ï¼‰=256Kï¼ˆä¹Ÿå°±æ˜¯ su çš„æ•°å€¼ï¼‰</li><li>swidthï¼š448 * 4k = 1792kï¼ˆextsize çš„æ•°å€¼ï¼‰</li></ul><p>å¦‚æœ sunit ä¸ swidth ç›´æ¥å¥—ç”¨åœ¨ mkfs.xfs ä¸­çš„è¯ï¼Œå°±éœ€è¦æ³¨æ„äº†ï¼Œå› ä¸ºæŒ‡ä»¤ä¸­çš„è¿™ä¸¤ä¸ªå‚æ•°ç”¨çš„æ˜¯ã€Œå‡ ä¸ª 512bytes çš„ sector æ•°é‡</p><ul><li>sunitï¼š256k/(512byte*1024)=512 ä¸ª sector</li><li>Swidthï¼š7 ä¸ªç£ç›˜ * sunit = 7 * 512 = 3584 ä¸ª sector</li></ul><p>æ‰€ä»¥æŒ‡ä»¤å°±éœ€è¦å˜æˆä¸‹é¢è¿™æ ·äº†</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mkfs.xfs <span class="token parameter variable">-f</span> <span class="token parameter variable">-d</span> <span class="token assign-left variable">agcount</span><span class="token operator">=</span><span class="token number">2</span>,sunit<span class="token operator">=</span><span class="token number">512</span>,swidth<span class="token operator">=</span><span class="token number">3584</span> <span class="token parameter variable">-r</span> <span class="token assign-left variable">extsize</span><span class="token operator">=</span>1792k /dev/sda4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="ext4-æ–‡ä»¶ç³»ç»Ÿ-mkfs-ext4" tabindex="-1"><a class="header-anchor" href="#ext4-æ–‡ä»¶ç³»ç»Ÿ-mkfs-ext4" aria-hidden="true">#</a> EXT4 æ–‡ä»¶ç³»ç»Ÿ mkfs.ext4</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mkfs.ext4 <span class="token punctuation">[</span>-b size<span class="token punctuation">]</span><span class="token punctuation">[</span>-L label<span class="token punctuation">]</span> è£…ç½®åç§°

- bï¼šè®¾ç½® block çš„å¤§å°ï¼Œæœ‰ 1kã€2kã€4k çš„å®¹é‡
- Lï¼šè£…ç½®è¡¨å¤´åç§°
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®è·µç»ƒä¹ </p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å°† /dev/sda5 æ ¼å¼åŒ–ä¸º ext4 æ–‡ä»¶ç³»ç»Ÿ</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkfs.ext4 /dev/sda5</span>
<span class="token function">mke2fs</span> <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
æ–‡ä»¶ç³»ç»Ÿæ ‡ç­¾<span class="token operator">=</span>
OS type: Linux
å—å¤§å°<span class="token operator">=</span><span class="token number">4096</span> <span class="token punctuation">(</span>log<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>		<span class="token comment"># æ¯ä¸€ä¸ª block å¤§å°</span>
åˆ†å—å¤§å°<span class="token operator">=</span><span class="token number">4096</span> <span class="token punctuation">(</span>log<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token assign-left variable">Stride</span><span class="token operator">=</span><span class="token number">0</span> blocks, Stripe <span class="token assign-left variable">width</span><span class="token operator">=</span><span class="token number">0</span> blocks	<span class="token comment"># ä¸ RAID ç›¸å…³æ€§è¾ƒé«˜</span>
<span class="token number">65536</span> inodes, <span class="token number">262144</span> blocks		<span class="token comment"># æ€»è®¡ inodeã€block æ•°é‡</span>
<span class="token number">13107</span> blocks <span class="token punctuation">(</span><span class="token number">5.00</span>%<span class="token punctuation">)</span> reserved <span class="token keyword">for</span> the super user
ç¬¬ä¸€ä¸ªæ•°æ®å—<span class="token operator">=</span><span class="token number">0</span>
Maximum filesystem <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">268435456</span>
<span class="token number">8</span> block <span class="token function">groups</span>		<span class="token comment"># å…±æœ‰ 8 ä¸ª block groups</span>
<span class="token number">32768</span> blocks per group, <span class="token number">32768</span> fragments per group
<span class="token number">8192</span> inodes per group
Superblock backups stored on blocks: 
        <span class="token number">32768</span>, <span class="token number">98304</span>, <span class="token number">163840</span>, <span class="token number">229376</span>

Allocating group tables: å®Œæˆ                            
æ­£åœ¨å†™å…¥inodeè¡¨: å®Œæˆ                            
Creating journal <span class="token punctuation">(</span><span class="token number">8192</span> blocks<span class="token punctuation">)</span>: å®Œæˆ
Writing superblocks and filesystem accounting information: å®Œæˆ

<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># dumpe2fs -h /dev/sda5</span>
dumpe2fs <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
Filesystem volume name:   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
Last mounted on:          <span class="token operator">&lt;</span>not available<span class="token operator">&gt;</span>
Filesystem UUID:          939ac781-62e4-48a9-a4c5-d804e0f0ee52
Filesystem magic number:  0xEF53
Filesystem revision <span class="token comment">#:    1 (dynamic)</span>
Filesystem features:      has_journal ext_attr resize_inode dir_index filetype extent 64bit flex_bg sparse_super large_file huge_file uninit_bg dir_nlink extra_isize
Filesystem flags:         signed_directory_hash 
Default <span class="token function">mount</span> options:    user_xattr acl
Filesystem state:         clean
Errors behavior:          Continue
Filesystem OS type:       Linux
Inode count:              <span class="token number">65536</span>
Block count:              <span class="token number">262144</span>
Reserved block count:     <span class="token number">13107</span>
Free blocks:              <span class="token number">249189</span>
Free blocks:              <span class="token number">249189</span>
Free inodes:              <span class="token number">65525</span>
First block:              <span class="token number">0</span>
Block size:               <span class="token number">4096</span>
Fragment size:            <span class="token number">4096</span>
Group descriptor size:    <span class="token number">64</span>
Reserved GDT blocks:      <span class="token number">127</span>
Blocks per group:         <span class="token number">32768</span>
Fragments per group:      <span class="token number">32768</span>
Inodes per group:         <span class="token number">8192</span>
Inode blocks per group:   <span class="token number">512</span>
Flex block group size:    <span class="token number">16</span>
Filesystem created:       Tue Oct <span class="token number">22</span> 08:51:57 <span class="token number">2019</span>
Last <span class="token function">mount</span> time:          n/a
Last <span class="token function">write</span> time:          Tue Oct <span class="token number">22</span> 08:51:57 <span class="token number">2019</span>
Mount count:              <span class="token number">0</span>
Maximum <span class="token function">mount</span> count:      <span class="token parameter variable">-1</span>
Last checked:             Tue Oct <span class="token number">22</span> 08:51:57 <span class="token number">2019</span>
Check interval:           <span class="token number">0</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>none<span class="token operator">&gt;</span><span class="token punctuation">)</span>
Lifetime writes:          <span class="token number">33</span> MB
Reserved blocks uid:      <span class="token number">0</span> <span class="token punctuation">(</span>user root<span class="token punctuation">)</span>
Reserved blocks gid:      <span class="token number">0</span> <span class="token punctuation">(</span>group root<span class="token punctuation">)</span>
First inode:              <span class="token number">11</span>
Inode size:               <span class="token number">256</span>
Required extra isize:     <span class="token number">28</span>
Desired extra isize:      <span class="token number">28</span>
Journal inode:            <span class="token number">8</span>
Default directory hash:   half_md4
Directory Hash Seed:      9f6434c1-738d-47e2-ae2c-bc766c2198cd
Journal backup:           inode blocks
Journal features:         <span class="token punctuation">(</span>none<span class="token punctuation">)</span>
æ—¥å¿—å¤§å°:             32M
Journal length:           <span class="token number">8192</span>
Journal sequence:         0x00000001
Journal start:            <span class="token number">0</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,81),b=n(`<h3 id="å…¶ä»–æ–‡ä»¶ç³»ç»Ÿ-mkfs" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–æ–‡ä»¶ç³»ç»Ÿ-mkfs" aria-hidden="true">#</a> å…¶ä»–æ–‡ä»¶ç³»ç»Ÿ mkfs</h3><p>mkfs æ˜¯ä¸€ä¸ªç»¼åˆæŒ‡ä»¤ï¼Œå½“ä½¿ç”¨ <code>mkfs -t xfs</code> æŒ‡ä»¤æ—¶ï¼Œå…¶å®ä¼šå»æ‰¾ mkfs.xfs ç›¸å…³å‚æ•°ç»™æˆ‘ä»¬ä½¿ç”¨ã€‚å¦‚æœè¿˜æƒ³çŸ¥é“è¯¥å‘½ä»¤æ”¯æŒå“ªäº›æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨ tab çš„è¡¥å…¨æ¥æ˜¾ç¤º</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkfs [tab*2]</span>
<span class="token function">mkfs</span>         mkfs.cramfs  mkfs.ext3    mkfs.fat     mkfs.msdos   mkfs.xfs
mkfs.btrfs   mkfs.ext2    mkfs.ext4    mkfs.minix   mkfs.vfat 

<span class="token comment"># è¿™é‡Œçœ‹åˆ°è¿™ä¹ˆå¤šçš„æ”¯æŒæ ¼å¼ï¼Œå¦‚æœå°†åˆšæ‰çš„ /dev/sda5 æ ¼å¼åŒ–ä¸º vfat å¯ä»¥è¿™æ ·åš</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkfs -t vfat /dev/sda5 </span>
mkfs.fat <span class="token number">3.0</span>.20 <span class="token punctuation">(</span><span class="token number">12</span> Jun <span class="token number">2013</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># blkid /dev/sda5</span>
/dev/sda5: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;4DA6-A982&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;vfat&quot;</span> <span class="token assign-left variable">PARTLABEL</span><span class="token operator">=</span><span class="token string">&quot;Microsoft basic data&quot;</span> <span class="token assign-left variable">PARTUUID</span><span class="token operator">=</span><span class="token string">&quot;9cffc784-99a3-40f6-8e5f-0c71b3bb7f05&quot;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ€-æ–‡ä»¶ç³»ç»Ÿæ£€éªŒ" tabindex="-1"><a class="header-anchor" href="#ğŸ€-æ–‡ä»¶ç³»ç»Ÿæ£€éªŒ" aria-hidden="true">#</a> ğŸ€ æ–‡ä»¶ç³»ç»Ÿæ£€éªŒ</h2><p>å½“æ–‡ä»¶ç³»ç»Ÿå‡ºç°é—®é¢˜æ˜¯ï¼Œå¦‚ç¡¬ä»¶ã€è½¯ä»¶ã€ç¡¬ä»¶ç­‰é—®é¢˜ç­‰å®•æœºæ—¶ã€‚ç°åœ¨æˆ‘ä»¬çŸ¥é“æ–‡ä»¶ç³»ç»Ÿè¿ä½œæ—¶ä¼šæœ‰ç£ç›˜ä¸å†…å­˜æ•°æ®å¼‚æ­¥çš„çŠ¶å†µå‘ç”Ÿï¼Œå› æ­¤åœ¨å®•æœºæ—¶å¯èƒ½å¯¼è‡´æ–‡ä»¶ç³»ç»Ÿçš„é”™ä¹±ã€‚</p><p>ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæ•‘æ´çš„æŒ‡ä»¤ä¸å¤ªä¸€æ ·ï¼Œè¿™é‡Œä¸»è¦é’ˆå¯¹ xfsã€ext4 ä¸¤ä¸ªä¸»æµçš„æ¥è®²è§£</p><h3 id="xfs-repair-å¤„ç†-xfs-æ–‡ä»¶ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#xfs-repair-å¤„ç†-xfs-æ–‡ä»¶ç³»ç»Ÿ" aria-hidden="true">#</a> xfs_repair å¤„ç† XFS æ–‡ä»¶ç³»ç»Ÿ</h3><p>å½“æœ‰ xfs æ–‡ä»¶ç³»ç»Ÿé”™ä¹±æ‰éœ€è¦ä½¿ç”¨è¯¥å‘½ä»¤</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>xfs_repair <span class="token punctuation">[</span>-fnd<span class="token punctuation">]</span> è£…ç½®å

- fï¼šåé¢çš„è£…ç½®æ˜¯ä¸ªæ–‡ä»¶ï¼ˆå¦‚è™šæ‹Ÿç¡¬ç›˜ï¼‰è€Œä¸æ˜¯å®ä½“çŠ¶æ€
- nï¼šå•çº¯æ£€æŸ¥å¹¶ä¸ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿçš„ä»»ä½•æ•°æ®
- dï¼šé€šå¸¸ç”¨åœ¨å•äººç»´æŠ¤æ¨¡å¼ä¸‹ï¼Œé’ˆå¯¹æ ¹ç›®å½•è¿›è¡Œæ£€æŸ¥ä¸ä¿®å¤çš„åŠ¨ä½œï¼Œå¾ˆå±é™©ï¼ä¸è¦éšä¾¿ä½¿ç”¨
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®è·µç»ƒä¹ </p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>æ£€æŸ¥ /dev/sda4 çš„æ–‡ä»¶ç³»ç»Ÿ
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># xfs_repair /dev/sda4</span>
Phase <span class="token number">1</span> - <span class="token function">find</span> and verify superblock<span class="token punctuation">..</span>.
Phase <span class="token number">2</span> - using internal log
        - zero log<span class="token punctuation">..</span>.
        - scan filesystem freespace and inode maps<span class="token punctuation">..</span>.
        - found root inode chunk
Phase <span class="token number">3</span> - <span class="token keyword">for</span> each AG<span class="token punctuation">..</span>.
        - scan and <span class="token function">clear</span> agi unlinked lists<span class="token punctuation">..</span>.
        - process known inodes and perform inode discovery<span class="token punctuation">..</span>.
        - agno <span class="token operator">=</span> <span class="token number">0</span>
        - agno <span class="token operator">=</span> <span class="token number">1</span>
        - process newly discovered inodes<span class="token punctuation">..</span>.
Phase <span class="token number">4</span> - check <span class="token keyword">for</span> duplicate blocks<span class="token punctuation">..</span>.
        - setting up duplicate extent list<span class="token punctuation">..</span>.
        - check <span class="token keyword">for</span> inodes claiming duplicate blocks<span class="token punctuation">..</span>.
        - agno <span class="token operator">=</span> <span class="token number">0</span>
        - agno <span class="token operator">=</span> <span class="token number">1</span>
Phase <span class="token number">5</span> - rebuild AG headers and trees<span class="token punctuation">..</span>.
        - reset superblock<span class="token punctuation">..</span>.
Phase <span class="token number">6</span> - check inode connectivity<span class="token punctuation">..</span>.
        - resetting contents of realtime bitmap and summary inodes
        - traversing filesystem <span class="token punctuation">..</span>.
        - traversal finished <span class="token punctuation">..</span>.
        - moving disconnected inodes to lost+found <span class="token punctuation">..</span>.
Phase <span class="token number">7</span> - verify and correct <span class="token function">link</span> counts<span class="token punctuation">..</span>.
<span class="token keyword">done</span>
<span class="token comment"># å…±æœ‰ 7 ä¸ªé‡è¦çš„æ£€æŸ¥æµç¨‹ï¼Œè¯¦ç»†çš„æµç¨‹ä»‹ç»å¯ä»¥ man xfs_repair æŸ¥çœ‹</span>

<span class="token comment"># æ£€æŸ¥ä¸‹ç³»ç»ŸåŸæœ¬å°±æœ‰çš„ /dev/centos/home æ–‡ä»¶ç³»ç»Ÿ</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># xfs_repair /dev/centos/home </span>
xfs_repair: /dev/centos/home contains a mounted filesystem
xfs_repair: /dev/centos/home contains a mounted and writable filesystem

fatal error -- couldn&#39;t initialize XFS library

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>xfs_repair å¯ä»¥æ£€æŸ¥æˆ–ä¿®å¤æ–‡ä»¶ç³»ç»Ÿï¼Œå› ä¸ºä¿®å¤å·¥ä½œæ˜¯ä¸ªå¾ˆåºå¤§çš„ä»»åŠ¡ï¼Œä¸å…è®¸å·²æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥ä¸Šé¢ä¼šæç¤º <code>xfs_repair /dev/centos/home</code> æ˜¯ä¸€ä¸ªå·²æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆéœ€è¦å¸è½½åå†å¤„ç†ï¼‰ã€‚</p><p>Linux ç³»ç»Ÿè¿˜æœ‰ä¸ªæ ¹ç›®å½•è£…ç½®æ— æ³•è¢«å¸è½½ï¼Œè¦å¯¹æ ¹ç›®å½•æ•‘æ´æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªå°±æ˜¯å•äººæ•‘æ´æ¨¡å¼æ¥å¤„ç†äº†ï¼Œä½¿ç”¨å‚æ•° <code>-d</code> è¿›å…¥ã€‚è®°å¾—å¾ˆå±é™©è¿™ä¸ªæŒ‡ä»¤ï¼</p><h3 id="fsck-ext4-å¤„ç†-ext4-æ–‡ä»¶ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#fsck-ext4-å¤„ç†-ext4-æ–‡ä»¶ç³»ç»Ÿ" aria-hidden="true">#</a> fsck.ext4 å¤„ç† ext4 æ–‡ä»¶ç³»ç»Ÿ</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>fsck.ext4 <span class="token punctuation">[</span>-pf<span class="token punctuation">]</span><span class="token punctuation">[</span>-b superblock<span class="token punctuation">]</span> è£…ç½®åç§°
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>pï¼šå½“æ–‡ä»¶ç³»ç»Ÿåœ¨ä¿®å¤æ—¶ï¼Œè‹¥æœ‰éœ€è¦å›å¤ y çš„åŠ¨ä½œæ—¶ï¼Œè‡ªåŠ¨å›å¤ y æ¥ç»§ç»­è¿›è¡Œä¿®å¤åŠ¨ä½œ</li><li>fï¼šå¼ºåˆ¶æ£€æŸ¥ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœ fsck æ²¡æœ‰å‘ç°ä»»ä½• unclean çš„æ——æ ‡ï¼Œä¸ä¼šä¸»åŠ¨è¿›å…¥ç»†éƒ¨æ£€æŸ¥çš„ï¼Œå¯ä»¥é€šè¿‡ -f å‚æ•°å¼ºåˆ¶æ£€æŸ¥</li><li>Dï¼šé’ˆå¯¹è¯¥æ–‡ä»¶ç³»ç»Ÿä¸‹çš„ç›®å½•è¿›è¡Œä¼˜åŒ–é…ç½®</li><li>bï¼šåé¢æ¥ superblock çš„ä½ç½®ã€‚ä¸€èˆ¬æ¥è¯´è¯¥é€‰é¡¹ç”¨ä¸åˆ°ï¼Œä½†æ˜¯å¦‚æœ superblock å› æ•…æŸåæ—¶ï¼Œé€šè¿‡è¯¥å‚æ•°å³å¯åˆ©ç”¨æ–‡ä»¶ç³»ç»Ÿå†…å¤‡ä»½çš„ superblock æ¥å°è¯•æ•‘æ´ã€‚ä¸€èˆ¬æ¥è¯´ superblock å¤‡ä»½åœ¨ï¼š 1k block æ”¾åœ¨ 8193ã€2k block æ”¾åœ¨16384ã€4k block æ”¾åœ¨ 32786</li></ul><p>å®è·µç»ƒä¹ </p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># æ‰¾å‡ºåˆšåˆšå»ºç«‹çš„ /dev/sda5 çš„å¦ä¸€å— superblockï¼Œå¹¶æ£€æŸ¥å®ƒ</span>
<span class="token comment"># å‘ç°æŠ¥é”™äº†ï¼Œè¿™ä¸ªæ˜¯å‰é¢ç»ƒä¹ æ ¼å¼åŒ–æˆé ext ç³»ç»Ÿäº†ï¼Œè¿™é‡Œéœ€è¦æ ¼å¼åŒ–å›æ¥</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># dumpe2fs -h /dev/sda5 | grep &#39;Blocks per group&#39;</span>
dumpe2fs <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
dumpe2fs: Bad magic number <span class="token keyword">in</span> super-block å½“å°è¯•æ‰“å¼€ /dev/sda5 æ—¶
<span class="token comment"># æ ¼å¼å› ext4</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkfs.ext4 /dev/sda5</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># dumpe2fs -h /dev/sda5 | grep &#39;Blocks per group&#39;</span>
dumpe2fs <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
Blocks per group:         <span class="token number">32768</span>
<span class="token comment"># çœ‹èµ·æ¥æ¯ä¸ª block ç¾¤ç»„ä¼šæœ‰ 32768 ä¸ª blockï¼Œå› æ­¤ç¬¬äºŒä¸ª superblock åº”è¯¥å°±åœ¨ 32768 ä¸Š</span>
<span class="token comment"># å› ä¸º block å·ç ä¸º 0 å·å¼€å§‹</span>

<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># fsck.ext4 -b 32768 /dev/sda5</span>
e2fsck <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
/dev/sda5 was not cleanly unmounted, å¼ºåˆ¶æ£€æŸ¥.
ç¬¬ä¸€æ­¥: æ£€æŸ¥inode,å—,å’Œå¤§å°
åˆ é™¤ inode <span class="token number">1577</span> has zero dtime.  å¤„ç†<span class="token operator">&lt;</span>y<span class="token operator">&gt;</span>? æ˜¯
ç¬¬äºŒæ­¥: æ£€æŸ¥ç›®å½•ç»“æ„
ç¬¬3æ­¥: æ£€æŸ¥ç›®å½•è¿æ¥æ€§
Pass <span class="token number">4</span>: Checking reference counts
ç¬¬5æ­¥: æ£€æŸ¥ç°‡æ¦‚è¦ä¿¡æ¯

/dev/sda5: ***** æ–‡ä»¶ç³»ç»Ÿå·²ä¿®æ”¹ *****  <span class="token comment"># æ–‡ä»¶ç³»ç»Ÿè¢«ä¿®æ”¹è¿‡ï¼Œæ‰€ä»¥å‡ºç°äº†è­¦å‘Š</span>
/dev/sda5: <span class="token number">11</span>/65536 files <span class="token punctuation">(</span><span class="token number">0.0</span>% non-contiguous<span class="token punctuation">)</span>, <span class="token number">12955</span>/262144 blocks

<span class="token comment"># å¦‚æœæ²¡æœ‰æ£€æŸ¥åˆ°é—®é¢˜ï¼Œåˆ™ä¸ä¼šå¼ºåˆ¶æ£€æŸ¥</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># fsck.ext4 /dev/sda5</span>
e2fsck <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
/dev/sda5: clean, <span class="token number">11</span>/65536 files, <span class="token number">12955</span>/262144 blocks
<span class="token comment"># -f å‚æ•°å¼ºåˆ¶æ£€æŸ¥</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># fsck.ext4 -f /dev/sda5</span>
e2fsck <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
ç¬¬ä¸€æ­¥: æ£€æŸ¥inode,å—,å’Œå¤§å°
ç¬¬äºŒæ­¥: æ£€æŸ¥ç›®å½•ç»“æ„
ç¬¬3æ­¥: æ£€æŸ¥ç›®å½•è¿æ¥æ€§
Pass <span class="token number">4</span>: Checking reference counts
ç¬¬5æ­¥: æ£€æŸ¥ç°‡æ¦‚è¦ä¿¡æ¯
/dev/sda5: <span class="token number">11</span>/65536 files <span class="token punctuation">(</span><span class="token number">0.0</span>% non-contiguous<span class="token punctuation">)</span>, <span class="token number">12955</span>/262144 blocks

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>xfs_repair sæˆ– fsck.ext4 éƒ½æ˜¯ç”¨æ¥æ£€æŸ¥ä¸ä¿®æ­£æ–‡ä»¶ç³»ç»Ÿé”™è¯¯çš„æŒ‡ä»¤ã€‚æ³¨æ„ï¼šé€šå¸¸åªæœ‰èº«ä¸º root ä¸”ä½ çš„æ–‡ä»¶ç³»ç»Ÿæœ‰é—®é¢˜çš„æ—¶å€™æ‰ä½¿ç”¨è¯¥æŒ‡ä»¤ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸è¦ä½¿ç”¨ï¼Œå¯èƒ½ä¼šé€ æˆå¯¹ç³»ç»Ÿçš„å±å®³ã€‚é€šå¸¸ä½¿ç”¨çš„æ—¶å€™ï¼Œéƒ½æ˜¯ç³»ç»Ÿå‡ºç°äº†æå¤§çš„é—®é¢˜ï¼Œå¯¼è‡´åœ¨ linux å¼€æœºçš„æ—¶å€™å¾—è¿›å…¥å•äººå•æœºæ¨¡å¼ä¸‹è¿›è¡Œç»´æŠ¤çš„è¡Œä¸ºæ—¶ï¼Œæ‰å¿…é¡»ä½¿ç”¨æ­¤æŒ‡ä»¤</p><p>å¦å¤–ï¼Œå¦‚æœæ€€ç–‘åˆšæ ¼å¼åŒ–çš„ç£ç›˜æœ‰é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¿™äº›æŒ‡ä»¤æ¥æ£€æŸ¥ï¼Œæ­¤å¤–è¿™äº›æŒ‡ä»¤åœ¨æ‰«æç£ç›˜æ—¶ï¼Œå¯èƒ½ä¼šé€ æˆéƒ¨åˆ† filesystem çš„ä¿®è®¢ï¼Œæ‰€ä»¥ï¼šæ‰§è¡Œ xfs_repairã€fsck.ext4 æ—¶ï¼Œè¢«æ£€æŸ¥çš„ partition ä¸èƒ½æŒ‚è½½åˆ°ç³»ç»Ÿä¸Šï¼Œéœ€è¦å…ˆå¸è½½</p><h2 id="ğŸ€-æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ä¸å¸è½½" tabindex="-1"><a class="header-anchor" href="#ğŸ€-æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ä¸å¸è½½" aria-hidden="true">#</a> ğŸ€ æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ä¸å¸è½½</h2><p>å‰é¢æåˆ°è¿‡æŒ‚è½½ç‚¹æ˜¯ç›®å½•ï¼Œç›®å½•æ˜¯è¿›å…¥ç£ç›˜åˆ†åŒºæ§½ï¼ˆå…¶å®æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼‰çš„å…¥å£ã€‚åœ¨æŒ‚è½½å‰éœ€è¦ç¡®å®šå‡ ä»¶äº‹æƒ…ï¼š</p><ul><li><p>å•ä¸€æ–‡ä»¶ç³»ç»Ÿä¸åº”è¯¥è¢«é‡å¤æŒ‚è½½åœ¨ä¸åŒçš„æŒ‚è½½ç‚¹ï¼ˆç›®å½•ï¼‰ä¸­</p></li><li><p>å•ä¸€ç›®å½•ä¸åº”è¯¥é‡å¤æŒ‚è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿ</p></li><li><p>è¦ä½œä¸ºæŒ‚è½½ç‚¹çš„ç›®å½•ï¼Œç†è®ºä¸Šéƒ½æ˜¯ç©ºç›®å½•æ‰æ˜¯</p><p>å¦‚æœä¸æ˜¯ç©ºç›®å½•ï¼ŒæŒ‚è½½ä¹‹åï¼ŒåŸæ¥ç›®å½•ä¸‹çš„å†…å®¹ä¼šæš‚æ—¶æ¶ˆå¤±ï¼Œç­‰å¾…åˆ†åŒºè¢«å¸è½½ä¹‹åæ‰ä¼šæ˜¾ç¤ºå‡ºæ¥</p></li></ul><p>åœ¨ linux ç³»ç»Ÿä¸Šéœ€è¦ä½¿ç”¨ mount æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤å¾ˆéš¾ï¼Œè¿™é‡Œç®€å•å­¦ä¸€ç‚¹</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mount</span> <span class="token parameter variable">-a</span>
<span class="token function">mount</span> <span class="token punctuation">[</span>-l<span class="token punctuation">]</span>
<span class="token function">mount</span> <span class="token punctuation">[</span>-t æ–‡ä»¶ç³»ç»Ÿ<span class="token punctuation">]</span> <span class="token assign-left variable">LABEL</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span> æŒ‚è½½ç‚¹
<span class="token function">mount</span> <span class="token punctuation">[</span>-t æ–‡ä»¶ç³»ç»Ÿ<span class="token punctuation">]</span> <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&#39;&#39;</span> æŒ‚è½½ç‚¹
<span class="token function">mount</span> <span class="token punctuation">[</span>-t æ–‡ä»¶ç³»ç»Ÿ<span class="token punctuation">]</span> è£…ç½®æ–‡ä»¶å<span class="token operator">=</span><span class="token string">&#39;&#39;</span> æŒ‚è½½ç‚¹
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>aï¼šæŒ‰ç…§é…ç½®æ–‡ä»¶ /etc/fstab çš„æ•°æ®å°†æ‰€æœ‰æœªæŒ‚è½½çš„ç£ç›˜éƒ½æŒ‚è½½ä¸Šæ¥</li><li>lï¼šå•çº¯çš„è¾“å…¥ mount ä¼šæ˜¾ç¤ºç›®å‰æŒ‚è½½çš„ä¿¡æ¯ã€‚åŠ ä¸Š -l å¯å¢åˆ— Label åç§°</li><li>tï¼šå¯ä»¥åŠ ä¸Šæ–‡ä»¶ç³»ç»Ÿç§ç±»æ¥æŒ‡å®šæ¬²æŒ‚è½½çš„ç±»å‹ã€‚å¸¸è§çš„ Linux æ”¯æŒç±»å‹æœ‰ <ul><li>xfs</li><li>ext3</li><li>ext4</li><li>reiserfs</li><li>vfat</li><li>Iso9660ï¼ˆå…‰ç›˜æ ¼å¼ï¼‰</li><li>nfsï¼ˆç½‘ç»œæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼‰</li><li>cifsï¼ˆç½‘ç»œæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼‰</li><li>smbfsï¼ˆç½‘ç»œæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼‰</li></ul></li><li>oï¼šåé¢å¯ä»¥æ¥ä¸€äº›æŒ‚è½½æ—¶é¢å¤–åŠ ä¸Šçš„å‚æ•°ï¼Œä¾‹å¦‚è´¦æˆ·ã€å¯†ç ã€è¯»å†™æƒé™ç­‰ <ul><li>asyncã€syncï¼šæ­¤æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦ä½¿ç”¨åŒæ­¥å†™å…¥ï¼ˆsyncï¼‰æˆ–å¼‚æ­¥ï¼ˆasyncï¼‰çš„å†…å­˜æœºåˆ¶ï¼Œè¯·å‚è€ƒæ–‡ä»¶ç³»ç»Ÿè¿ä½œæ–¹å¼ã€‚é¢„è®¾ä¸º async</li><li>atimeã€noatimeï¼šæ˜¯å¦ä¿®è®¢æ–‡ä»¶çš„è¯»å–æ—¶é—´ï¼ˆatimeï¼‰ï¼Œä¸ºäº†æ•ˆèƒ½ï¼ŒæŸäº›æ—¶åˆ»åˆ»ä½¿ç”¨ noatime</li><li>roã€rwï¼šæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿä½åªè¯»ï¼ˆroï¼‰æˆ–å¯æ“¦å†™ï¼ˆrwï¼‰</li><li>autoã€noautoï¼šå…è®¸æ­¤ filesystem è¢« ä»¥ mount -a è‡ªåŠ¨æŒ‚è½½ï¼ˆautoï¼‰</li><li>devã€nodevï¼šæ˜¯å¦å…è®¸æ­¤ filesystem ä¸Šï¼Œå¯å»ºç«‹è£…ç½®æ–‡ä»¶ï¼Ÿdev ä¸ºå…è®¸</li><li>suidã€nosuidï¼šæ˜¯å¦å…è®¸æ­¤ filesystem å«æœ‰ suidã€sgid çš„æ–‡ä»¶æ ¼å¼</li><li>execã€noexecï¼šæ˜¯å¦å…è®¸æ­¤ filesystem ä¸Šæ‹¥æœ‰å¯æ‰§è¡Œ binary æ–‡ä»¶</li><li>userã€nouserï¼šæ˜¯å¦å…è®¸æ­¤ filesystem è®©ä»»ä½•ä½¿ç”¨è€…æ‰§è¡Œ mount ï¼Ÿä¸€èˆ¬æ¥è¯´ mount ä»…æœ‰ root å¯ä»¥è¿›è¡Œï¼Œä½†ä¸‹è¾¾ user å‚æ•°åˆ™å¯ä»¥è®©ä¸€èˆ¬ user ä¹Ÿèƒ½å¤Ÿå¯¹æ­¤ partition è¿›è¡Œ mount</li><li>defaultsï¼šé»˜è®¤å€¼ä¸º rwã€suidã€devã€execã€autoã€nouserã€async</li><li>remountï¼šé‡æ–°æŒ‚è½½ï¼Œè¿™åœ¨ç³»ç»Ÿé™¤é”™æˆ–é‡æ–°æ›´æ–°å‚æ•°æ—¶ï¼Œå¾ˆæœ‰ç”¨</li></ul></li></ul><p>åŸºæœ¬ä¸Š CentOS 7 ä¸éœ€è¦åŠ ä¸Š -t è¿™ä¸ªé€‰é¡¹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†æä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæ–‡ä»¶ç³»ç»Ÿæ ¼å¼ï¼Œè¿™ä¹Ÿæ˜¯ä½¿ç”¨ blkid å°±èƒ½å¤Ÿæ˜¾ç¤ºæ­£ç¡®çš„æ–‡ä»¶ç³»ç»Ÿçš„ç¼˜æ•…ã€‚</p><p>é‚£ä¹ˆ centos æ˜¯æ€ä¹ˆæ‰¾å‡ºæ–‡ä»¶ç³»ç»Ÿç±»å‹çš„å‘¢ï¼Ÿç”±äºæ–‡ä»¶ç³»ç»Ÿå‡ ä¹éƒ½æœ‰ superblock ï¼Œå¯ä»¥é€šè¿‡åˆ†æ superblock æ­é… linux è‡ªå·±çš„é©±åŠ¨ç¨‹åºå»æµ‹è¯•æŒ‚è½½ï¼Œå¦‚æœæˆåŠŸäº†ï¼Œå°±likeè‡ªåŠ¨çš„ä½¿ç”¨è¯¥ç±»å‹çš„æ–‡ä»¶ç³»ç»ŸæŒ‚è½½èµ·æ¥ã€‚é‚£ä¹ˆå¯ä»¥ä¸»è¦åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶ä¸­æ‰¾åˆ°æœ‰å“ªäº› filesystem æ”¯æŒä¸Šè¿°çš„æŒ‚è½½æµ‹è¯•</p><ul><li>/etc/filesystemsï¼šç³»ç»ŸæŒ‡å®šçš„æµ‹è¯•æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿç±»å‹çš„ä¼˜å…ˆçº§</li><li>/proc/filesystemsï¼šlinux ç³»ç»Ÿå·²ç»åŠ è½½çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹</li></ul><p>å¯ä»¥åœ¨ <code>/lib/modules/$(uname -r)/kernel/fs/</code> ç›®å½•ä¸­æ‰¾åˆ°ç›¸å…³æ–‡ä»¶ç³»ç»Ÿç±»å‹çš„é©±åŠ¨ç¨‹åºï¼Œæ¯”å¦‚ ext4 çš„é©±åŠ¨åœ¨ <code>/lib/modules/$(uname -r)/kernel/fs/ext4/</code> ç›®å½•ä¸‹</p><p>æ³¨ï¼š<code>$(uname -r)</code>æ‹¬å·ä¸­çš„æŒ‡ä»¤å¯ä»¥æ‰§è¡Œçš„ï¼Œä½¿ç”¨è¿™ç§å ä½æ¥å¼•ç”¨æŒ‡ä»¤è¾“å‡ºçš„ç»“æœ</p><p>å¦å¤–ï¼Œè¿‡å»éƒ½ä¹ æƒ¯ä½¿ç”¨è£…ç½®æ–‡ä»¶åç„¶åç›´æ¥ç”¨è¯¥æ–‡ä»¶åæ¥æŒ‚è½½ï¼Œä¸è¿‡è¿™é‡Œæ¨èä½¿ç”¨ UUID æ¥è¯†åˆ«æ–‡ä»¶ç³»ç»Ÿï¼Œå› ä¸ºæ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¾ˆå¯é </p><h3 id="æŒ‚è½½-xfs-ext4-vfat-ç­‰æ–‡ä»¶ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#æŒ‚è½½-xfs-ext4-vfat-ç­‰æ–‡ä»¶ç³»ç»Ÿ" aria-hidden="true">#</a> æŒ‚è½½ xfs/ext4/vfat ç­‰æ–‡ä»¶ç³»ç»Ÿ</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å…ˆæ‰¾å‡º uuidï¼Œä½¿ç”¨ uuid æ¥æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿåˆ° /data/xfs å†…</span>
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># blkid /dev/sda4</span>
/dev/sda4: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;819c0c18-8d4a-4c3f-9a98-0ab039e769f5&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;xfs&quot;</span> <span class="token assign-left variable">PARTLABEL</span><span class="token operator">=</span><span class="token string">&quot;Linux filesystem&quot;</span> <span class="token assign-left variable">PARTUUID</span><span class="token operator">=</span><span class="token string">&quot;3819b115-2ab8-4fb6-8425-bb2ff8e797b7&quot;</span> 
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># mount UUID=&quot;819c0c18-8d4a-4c3f-9a98-0ab039e769f5&quot; /data/xfs</span>
mount: æŒ‚è½½ç‚¹ /data/xfs ä¸å­˜åœ¨
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># mkdir -p /data/xfs</span>
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># mount UUID=&quot;819c0c18-8d4a-4c3f-9a98-0ab039e769f5&quot; /data/xfs</span>
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># df /data/xfs</span>
æ–‡ä»¶ç³»ç»Ÿ         1K-å—  å·²ç”¨    å¯ç”¨ 	  å·²ç”¨% æŒ‚è½½ç‚¹
/dev/sda4      <span class="token number">1038336</span> <span class="token number">32896</span> <span class="token number">1005440</span>    <span class="token number">4</span>% /data/xfs
<span class="token comment"># è¿™é‡Œé¡ºåˆ©æŒ‚è½½äº†ï¼Œä¸”å®¹é‡çº¦ä¸º 1g å·¦å³</span>
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># df -h /data/xfs</span>
æ–‡ä»¶ç³»ç»Ÿ        å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹
/dev/sda4      1014M   33M  982M    <span class="token number">4</span>% /data/xfs


<span class="token comment"># ä½¿ç”¨ç›¸åŒçš„æ–¹å¼ï¼Œå°† /dev/sda5 æŒ‚è½½åˆ° /dev/ext4 ç›®å½•</span>
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># mkdir /data/ext4</span>
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># blkid /dev/sda5</span>
/dev/sda5: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;b0923041-024a-47cf-a4b8-d59b573855d7&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;ext4&quot;</span> <span class="token assign-left variable">PARTLABEL</span><span class="token operator">=</span><span class="token string">&quot;Microsoft basic data&quot;</span> <span class="token assign-left variable">PARTUUID</span><span class="token operator">=</span><span class="token string">&quot;9cffc784-99a3-40f6-8e5f-0c71b3bb7f05&quot;</span> 
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># mount UUID=&quot;b0923041-024a-47cf-a4b8-d59b573855d7&quot; /data/ext4</span>
<span class="token punctuation">[</span>root@study fs<span class="token punctuation">]</span><span class="token comment"># df /data/ext4</span>
æ–‡ä»¶ç³»ç»Ÿ        1K-å—  å·²ç”¨   å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹
/dev/sda5      <span class="token number">999320</span>  <span class="token number">2564</span> <span class="token number">927944</span>    <span class="token number">1</span>% /data/ext4

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æŒ‚è½½-cd-æˆ–-dvd-å…‰ç›˜" tabindex="-1"><a class="header-anchor" href="#æŒ‚è½½-cd-æˆ–-dvd-å…‰ç›˜" aria-hidden="true">#</a> æŒ‚è½½ CD æˆ– DVD å…‰ç›˜</h3><p>è¿™é‡Œæ‹¿å‡ºè£…ç³»ç»Ÿçš„æ—¶å€™é‚£ä¸ª iso çš„æ–‡ä»¶ï¼ŒåŠ è½½åˆ°è™šæ‹Ÿæœºä¸­</p><figure><img src="`+u+`" alt="image-20191027165331804" tabindex="0" loading="lazy"><figcaption>image-20191027165331804</figcaption></figure><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># blkid</span>
/dev/sr0: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;2019-07-12-09-13-14-35&quot;</span> <span class="token assign-left variable">LABEL</span><span class="token operator">=</span><span class="token string">&quot;VBox_GAs_6.0.10&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;iso9660&quot;</span> 
<span class="token comment"># æ‰¾åˆ°ä¸Šå›¾çš„å…‰é©±</span>
/dev/sr1: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;2019-09-11-18-50-31-00&quot;</span> <span class="token assign-left variable">LABEL</span><span class="token operator">=</span><span class="token string">&quot;CentOS 7 x86_64&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;iso9660&quot;</span> <span class="token assign-left variable">PTTYPE</span><span class="token operator">=</span><span class="token string">&quot;dos&quot;</span> 
<span class="token punctuation">..</span>.

<span class="token comment"># æŒ‚è½½åˆ° /data/cdrom ç›®å½•ä¸‹</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkdir /data/cdrom</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mount /dev/sr1 /data/cdrom/</span>
mount: /dev/sr1 å†™ä¿æŠ¤ï¼Œå°†ä»¥åªè¯»æ–¹å¼æŒ‚è½½
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># df /data/cdrom/</span>
æ–‡ä»¶ç³»ç»Ÿ         1K-å—    å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹
/dev/sr1       <span class="token number">4554702</span> <span class="token number">4554702</span>     <span class="token number">0</span>  <span class="token number">100</span>% /data/cdrom

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…‰é©±æŒ‚è½½ä¹‹åå°±æ— æ³•é€€å‡ºç›˜ç‰‡äº†ï¼Œé™¤éå¸è½½æ‰èƒ½å¤Ÿé€€å‡ºã€‚åœ¨å›¾å½¢ç•Œé¢ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¸®ä½ æŒ‚è½½è¿™ä¸ªå…‰ç›˜åˆ° /media/ é‡Œé¢å»ï¼Œä¹Ÿå¯ä»¥ä¸å¸é™¤å°±ç›´æ¥é€€å‡ºï¼Œä½†æ˜¯æ–‡å­—ç•Œé¢å°±æ²¡æœ‰è¿™ä¸ªç¦åˆ©äº†</p><h3 id="æŒ‚è½½-vfat-usb-ç£ç›˜" tabindex="-1"><a class="header-anchor" href="#æŒ‚è½½-vfat-usb-ç£ç›˜" aria-hidden="true">#</a> æŒ‚è½½ vfat ï¼ˆUSB ç£ç›˜ï¼‰</h3><p>USB ä¸èƒ½æ˜¯ NTFS çš„æ–‡ä»¶ç³»ç»Ÿ</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ç”±äºç¬”è€…æ²¡æœ‰ USB ç£ç›˜ï¼Œè¿™é‡Œå°±ä¸åšç»ƒä¹ äº†ï¼Œç›´æ¥å¤åˆ¶å‘½ä»¤
blkid
/dev/sda1:UUID<span class="token operator">=</span><span class="token string">&quot;xxxx22&quot;</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">&quot;vfat&quot;</span>
<span class="token function">mkdir</span> /data/usb
<span class="token function">mount</span> <span class="token parameter variable">-o</span> <span class="token assign-left variable">codepage</span><span class="token operator">=</span><span class="token number">950</span>,iocharset<span class="token operator">=</span>utf8 <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;xxxx22&quot;</span> /data/usb
<span class="token function">df</span> /data/usb
æ–‡ä»¶ç³»ç»Ÿ         1K-å—    å·²ç”¨    å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹
/dev/sda1    <span class="token number">4554702</span> <span class="token number">4554702</span>     <span class="token number">0</span>  <span class="token number">100</span>% /data/usb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœå¸¦æœ‰ä¸­æ–‡æ–‡ä»¶åçš„æ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æŒ‚è½½æ—¶æŒ‡å®šä¸‹æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿæ‰€ä½¿ç”¨çš„è¯­ç³»æ•°æ®ï¼Œåœ¨ man mount æ‰¾åˆ° vfat æ–‡ä»¶æ ¼å¼å½“ä¸­å¯ç”¨ä½¿ç”¨ codepage æ¥å¤„ç†ï¼Œä¸­æ–‡è¯­ç³»ä»£ç ä¸º 950</p><p>å¦‚æœä½ ä½¿ç”¨çš„ usb ç£ç›˜æ˜¯ NTFS æ—¶ï¼Œå› ä¸ºé¢„è®¾çš„ CentOS 7 ä¸æ”¯æŒ NTFS æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ï¼Œæ‰€ä»¥éœ€è¦å®‰è£… NTFS æ–‡ä»¶ç³»ç»Ÿçš„é©±åŠ¨ç¨‹åºåï¼Œæ‰å¯ä»¥ï¼ˆè¯¥éƒ¨åˆ†åç»­è®²è§£ yum æœåŠ¡å™¨æ—¶ä¼šç»§ç»­ï¼‰</p><h3 id="é‡æ–°æŒ‚è½½æ ¹ç›®å½•ä¸æŒ‚è½½ä¸ç‰¹å®šç›®å½•" tabindex="-1"><a class="header-anchor" href="#é‡æ–°æŒ‚è½½æ ¹ç›®å½•ä¸æŒ‚è½½ä¸ç‰¹å®šç›®å½•" aria-hidden="true">#</a> é‡æ–°æŒ‚è½½æ ¹ç›®å½•ä¸æŒ‚è½½ä¸ç‰¹å®šç›®å½•</h3><p>æ ¹ç›®å½•ä¸èƒ½è¢«å¸è½½çš„ï¼Œå¦‚æœæƒ³è¦æ”¹å˜æŒ‚è½½å‚æ•°æˆ–åˆ™æ ¹ç›®å½•å‡ºç°ã€Œåªè¯»ã€çŠ¶æ€æ—¶ï¼Œå¦‚ä½•é‡æ–°æŒ‚è½½å‘¢ï¼Ÿæœ€å¯èƒ½çš„å¤„ç†æ–¹å¼å°±æ˜¯é‡æ–°å¯åŠ¨ç³»ç»Ÿï¼Œä½†æ˜¯å¯ä»¥ç”¨ä¸‹é¢çš„æŒ‡ä»¤æ¥åš</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å°† / é‡æ–°æŒ‚è½½ï¼Œå¹¶åŠ å…¥å‚æ•°ä¸º rw ä¸ auto</span>
<span class="token function">mount</span> <span class="token parameter variable">-o</span> remount,rw,auto /
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦å¤–ï¼Œå¯ä»¥åˆ©ç”¨ mount æ¥å°†æŸä¸ªç›®å½•æŒ‚è½½åˆ°å¦å¤–ä¸€ä¸ªæœ¨å»ï¼Œè¿™å¹¶ä¸æ˜¯æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œæ˜¯é¢å¤–æ•…éšœæŸä¸ªç›®å½•çš„æ–¹æ³•ï¼Œè™½ç„¶ä¸‹é¢çš„æ¼”ç¤ºä¹Ÿå¯ä»¥ä½¿ç”¨ symbolic link æ¥è¿ç»“ï¼Œä¸è¿‡åœ¨æŸäº›ä¸æ”¯æŒç¬¦å·é“¾æ¥çš„ç¨‹åºè¿è¡Œä¸­ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥å¤„ç†</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mkdir /data/var</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mount --bind /var /data/var</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># ls -lid /var /data/var</span>
<span class="token number">69</span> drwxr-xr-x. <span class="token number">20</span> root root <span class="token number">282</span> <span class="token number">10</span>æœˆ  <span class="token number">4</span> <span class="token number">18</span>:38 /data/var
<span class="token number">69</span> drwxr-xr-x. <span class="token number">20</span> root root <span class="token number">282</span> <span class="token number">10</span>æœˆ  <span class="token number">4</span> <span class="token number">18</span>:38 /var
<span class="token comment"># å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªç›®å½•ä¸€æ¨¡ä¸€æ ·</span>

<span class="token comment"># é€šè¿‡ mount æŒ‡ä»¤æŸ¥æ‰¾ var å†…å®¹ï¼Œçœ‹åˆ°ä¸‹é¢çš„ /data/var çš„æŒ‚è½½å±æ€§</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mount | grep var</span>
sunrpc on /var/lib/nfs/rpc_pipefs <span class="token builtin class-name">type</span> rpc_pipefs <span class="token punctuation">(</span>rw,relatime<span class="token punctuation">)</span>
/dev/mapper/centos-root on /data/var <span class="token builtin class-name">type</span> xfs <span class="token punctuation">(</span>rw,relatime,seclabel,attr2,inode64,noquota<span class="token punctuation">)</span>
<span class="token comment"># ä»æ­¤è¿›å…¥ /data/var å°±æ˜¯è¿›å…¥ /var çš„æ•ˆæœäº†</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="umount-å°†è£…ç½®æ–‡ä»¶å¸é™¤" tabindex="-1"><a class="header-anchor" href="#umount-å°†è£…ç½®æ–‡ä»¶å¸é™¤" aria-hidden="true">#</a> umount å°†è£…ç½®æ–‡ä»¶å¸é™¤</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">umount</span> <span class="token punctuation">[</span>-fn<span class="token punctuation">]</span> è£…ç½®æ–‡ä»¶åæˆ–æŒ‚è½½ç‚¹

-fï¼šå¼ºåˆ¶å¸é™¤ï¼Œå¯ç”¨åœ¨ç±»ä¼¼ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿæ— æ³•è¯»å–åˆ°çš„æƒ…å†µä¸‹
-lï¼šlikeå¸é™¤æ–‡ä»¶ç³»ç»Ÿï¼Œæ¯” <span class="token parameter variable">-f</span> è¿˜å¼º
-nï¼šä¸æ›´æ–° /etc/mtab æƒ…å†µä¸‹å¸é™¤

<span class="token comment"># å°†æœ¬ç« è®²è§£çš„ç¤ºä¾‹æŒ‚è½½å…¨éƒ¨å¸é™¤</span>
/dev/sr1 on /data/cdrom <span class="token builtin class-name">type</span> iso9660 <span class="token punctuation">(</span>ro,relatime<span class="token punctuation">)</span>
/dev/mapper/centos-root on /data/var <span class="token builtin class-name">type</span> xfs <span class="token punctuation">(</span>rw,relatime,seclabel,attr2,inode64,noquota<span class="token punctuation">)</span>

<span class="token comment"># ç¬”è€…è¿™é‡Œåˆšæ‰è™šæ‹Ÿæœºé‡å¯äº†ï¼Œæ‰¾ä¸åˆ° /data/xfs å’Œ /data/ext4 çš„æŒ‚è½½ç‚¹ä¿¡æ¯äº†</span>
<span class="token comment"># æŸ¥çœ‹äº†ä¸‹ç›®å½•ä¿¡æ¯ï¼Œå‘ç°å˜æˆæœ€åä¸€ä¸ª ä¸€æ ·çš„äº†ï¼Œéƒ½æ˜¯ /dev/mapper/centos-root</span>

<span class="token comment"># å¸è½½åé¢å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼</span>
<span class="token comment"># umount /dev/sr1  # ç”¨è£…ç½®æ–‡ä»¶å</span>
<span class="token function">umount</span> /data/cdrom <span class="token comment"># ç”¨æŒ‚è½½ç‚¹æ¥å¸è½½</span>
<span class="token function">umount</span> /data/var <span class="token comment"># è¯´æ˜¯è¿™ä¸ªè£…ç½®æœ‰è¢«å…¶ä»–æ–¹å¼æŒ‚è½½ï¼Œè¿™é‡Œä¸€å®šè¦ç”¨æŒ‚è½½ç‚¹</span>
<span class="token comment"># è¿™é‡Œç¬”è€…å°±æ‡µé€¼äº†ï¼Œå®Œå…¨çœ‹ä¸å‡ºæ¥æ€ä¹ˆç®—æ˜¯è¢«å…¶ä»–æŒ‚è½½ç‚¹æŒ‚è½½çš„ï¼Ÿ</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ€-ç£ç›˜-æ–‡ä»¶ç³»ç»Ÿå‚æ•°ä¿®è®¢" tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç£ç›˜-æ–‡ä»¶ç³»ç»Ÿå‚æ•°ä¿®è®¢" aria-hidden="true">#</a> ğŸ€ ç£ç›˜/æ–‡ä»¶ç³»ç»Ÿå‚æ•°ä¿®è®¢</h2><p>æŸäº›æ—¶å€™ï¼Œå¯èƒ½å¸Œæœ›ä¿®æ”¹ä¸€ä¸‹ç›®å‰æ–‡ä»¶ç³»ç»Ÿçš„ä¸€äº›ç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚éœ€è¦ä¿®æ”¹ Label nameï¼Œæˆ–åˆ™æ˜¯ journal çš„å‚æ•°ï¼Œæˆ–åˆ™æ˜¯å…¶ä»–ç£ç›˜ã€æ–‡ä»¶ç³»ç»Ÿè¿ä½œæ—¶çš„ç›¸å…³å‚æ•°ï¼ˆDMA å¯åŠ¨ä¸å¦ï¼‰ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸‹é¢çš„ç›¸å…³æŒ‡ä»¤äº†</p><h3 id="mknod" tabindex="-1"><a class="header-anchor" href="#mknod" aria-hidden="true">#</a> mknod</h3><p>åœ¨ Linux ä¸‹æ‰€æœ‰çš„è£…ç½®éƒ½ä»¥æ–‡ä»¶æ¥ä»£è¡¨çš„ï¼Œä½†æ˜¯é‚£ä¸ªæ–‡ä»¶å¦‚ä½•ä»£è¡¨è¯¥è£…ç½®å‘¢ï¼Ÿ</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>mrcode@study ~<span class="token punctuation">]</span>$ ll /dev/sda*
<span class="token comment"># æ³¨æ„è¿™é‡Œçš„ 8,0 è¿™ä¸€åˆ—</span>
brw-rw----. <span class="token number">1</span> root disk <span class="token number">8</span>, <span class="token number">0</span> Oct <span class="token number">27</span> <span class="token number">17</span>:36 /dev/sda
brw-rw----. <span class="token number">1</span> root disk <span class="token number">8</span>, <span class="token number">1</span> Oct <span class="token number">27</span> <span class="token number">17</span>:36 /dev/sda1
brw-rw----. <span class="token number">1</span> root disk <span class="token number">8</span>, <span class="token number">2</span> Oct <span class="token number">27</span> <span class="token number">17</span>:36 /dev/sda2
brw-rw----. <span class="token number">1</span> root disk <span class="token number">8</span>, <span class="token number">3</span> Oct <span class="token number">27</span> <span class="token number">17</span>:36 /dev/sda3
brw-rw----. <span class="token number">1</span> root disk <span class="token number">8</span>, <span class="token number">4</span> Oct <span class="token number">27</span> <span class="token number">17</span>:36 /dev/sda4
brw-rw----. <span class="token number">1</span> root disk <span class="token number">8</span>, <span class="token number">5</span> Oct <span class="token number">27</span> <span class="token number">17</span>:36 /dev/sda5

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢ä¿¡æ¯ä¸­çš„ 8 ä¸ºä¸»è¦è£…ç½®ä»£ç ï¼ˆMajorï¼‰ï¼Œè€Œ 0~5 åˆ™ä¸ºæ¬¡è¦è£…ç½®ä»£ç ï¼ˆMinorï¼‰ï¼Œlinux æ ¸å¿ƒå°±æ˜¯é€šè¿‡è¿™ä¸¤ä¸ªæ•°å€¼æ¥å†³å®šçš„ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¸¸è§çš„ç£ç›˜æ–‡ä»¶å /dev/sda ä¸ /dev/loop0 è£…ç½®ä»£ç å¦‚ä¸‹æ‰€ç¤º</p><table><thead><tr><th style="text-align:center;">ç£ç›˜æ–‡ä»¶å</th><th style="text-align:center;">Major</th><th style="text-align:center;">Minor</th></tr></thead><tbody><tr><td style="text-align:center;">/dev/sda</td><td style="text-align:center;">8</td><td style="text-align:center;">0-15</td></tr><tr><td style="text-align:center;">/dev/sdb</td><td style="text-align:center;">8</td><td style="text-align:center;">16-31</td></tr><tr><td style="text-align:center;">/dev/loop0</td><td style="text-align:center;">7</td><td style="text-align:center;">0</td></tr><tr><td style="text-align:center;">/dev/loop1</td><td style="text-align:center;">7</td><td style="text-align:center;">1</td></tr></tbody></table><p>å¯ä»¥é€šè¿‡æ ¸å¿ƒå®˜ç½‘è¿ç»“äº†è§£æ›´å¤šæ ¸å¿ƒæ”¯æ’‘çš„ç¡¬ä»¶è£…ç½®ä»£ç ã€‚åŸºæœ¬ä¸Š linux æ ¸å¿ƒ 2.6 ä»¥åï¼Œç¡¬ä»¶æ–‡ä»¶åå·²ç»éƒ½å¯ä»¥è¢«ç³»ç»Ÿè‡ªåŠ¨çš„å®æ—¶äº§ç”Ÿäº†ï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºè£…ç½®æ–‡ä»¶ã€‚ä¸å¤ŸæŸäº›æƒ…å†µä¸‹éœ€è¦ä¸œæ¶Œå¤„ç†è£…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚åœ¨æŸäº›æœåŠ¡è¢«å…³åˆ°ç‰¹å®šç›®å½•ä¸‹æ—¶ï¼ˆchrootï¼‰å°±éœ€è¦è¿™æ ·åšäº†ï¼Œæ­¤æ—¶ mknod æŒ‡ä»¤å¯ä»¥å®ç°</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mknod</span> è£…ç½®æ–‡ä»¶å <span class="token punctuation">[</span>bcp<span class="token punctuation">]</span><span class="token punctuation">[</span>Major<span class="token punctuation">]</span><span class="token punctuation">[</span>Minor<span class="token punctuation">]</span>
é€‰é¡¹ä¸å‚æ•°
è£…ç½®ç§ç±»ï¼š
 bï¼šè®¾ç½®è£…ç½®åç§°æˆä¸ºä¸€ä¸ªå‘¨è¾¹å­˜å‚¨è®¾å¤‡æ–‡ä»¶ï¼Œä¾‹å¦‚ç£ç›˜ç­‰
 cï¼šè®¾ç½®è£…ç½®åç§°æˆä¸ºä¸€ä¸ªå‘¨è¾¹è¾“å…¥è®¾å¤‡æ–‡ä»¶ï¼Œä¾‹å¦‚é¼ æ ‡ã€é”®ç›˜ç¯
 pï¼šè®¾ç½®è£…ç½®åç§°æˆä¸ºä¸€ä¸ª FIFO æ–‡ä»¶
Majorï¼šä¸»è¦è£…ç½®ä»£ç 
Minorï¼šæ¬¡è¦è£…ç½®ä»£ç 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®è·µç»ƒä¹ </p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ä¸Šè¿°ä»‹ç»çŸ¥é“  /dev/sda10 çš„è£…ç½®ä»£ç ä¸º 8ï¼Œ10 ï¼Œè¯·å»ºç«‹å¹¶æŸ¥é˜…æ­¤è£…ç½®</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mknod /dev/sda10 b 8 10</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># ll /dev/sda10</span>
brw-r--r--. <span class="token number">1</span> root root <span class="token number">8</span>, <span class="token number">10</span> <span class="token number">10</span>æœˆ <span class="token number">27</span> <span class="token number">17</span>:52 /dev/sda10
<span class="token comment"># æ³¨æ„å‰é¢çš„ b å’Œ 8ï¼Œ10 è¿™ä¸ªæ˜¯æœ‰æ„ä¹‰çš„ä¸è¦éšæ„è®¾å®š</span>

<span class="token comment"># å»ºç«‹ä¸€ä¸ª FIFO æ–‡ä»¶</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mknod /tmp/testpipe p</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># ll /tmp/testpipe </span>
prw-r--r--. <span class="token number">1</span> root root <span class="token number">0</span> <span class="token number">10</span>æœˆ <span class="token number">27</span> <span class="token number">17</span>:53 /tmp/testpipe
<span class="token comment"># è¯¥æ–‡ä»¶ä¸æ˜¯ä¸€èˆ¬æ–‡ä»¶ï¼Œä¸å¯ä»¥éšä¾¿æ”¾è¿™é‡Œï¼Œæµ‹è¯•å®Œæˆååˆ é™¤æ‰è¯¥æ–‡ä»¶</span>

<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># rm /dev/sda10 /tmp/testpipe </span>
rmï¼šæ˜¯å¦åˆ é™¤å—ç‰¹æ®Šæ–‡ä»¶ <span class="token string">&quot;/dev/sda10&quot;</span>ï¼Ÿy
rmï¼šæ˜¯å¦åˆ é™¤å…ˆè¿›å…ˆå‡º <span class="token string">&quot;/tmp/testpipe&quot;</span>ï¼Ÿy

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xfs-admin-ä¿®æ”¹-xfs-æ–‡ä»¶ç³»ç»Ÿçš„-uuid-ä¸-lable-name" tabindex="-1"><a class="header-anchor" href="#xfs-admin-ä¿®æ”¹-xfs-æ–‡ä»¶ç³»ç»Ÿçš„-uuid-ä¸-lable-name" aria-hidden="true">#</a> xfs_admin ä¿®æ”¹ XFS æ–‡ä»¶ç³»ç»Ÿçš„ UUID ä¸ Lable name</h3><p>å¦‚æœå½“åˆæ ¼å¼åŒ–çš„æ‰‹å¿˜è®°åŠ ä¸Š lable nameï¼Œåæ¥æƒ³è¦é‡æ–°åŠ ä¸Šï¼Œä¸éœ€è¦é‡æ–°æ ¼å¼åŒ–</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>xfs_admin <span class="token punctuation">[</span>-lu<span class="token punctuation">]</span> <span class="token punctuation">[</span>-L labe<span class="token punctuation">]</span><span class="token punctuation">[</span>-U uuid<span class="token punctuation">]</span> è£…ç½®æ–‡ä»¶å
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>lï¼šåˆ—å‡ºè¿™ä¸ªè£…ç½®çš„ lable</li><li>uï¼šåˆ—å‡ºè¿™ä¸ªè£…ç½®çš„ uuid</li><li>Lï¼šè®¾ç½®è¿™ä¸ªè£…ç½®çš„ label name</li><li>Uï¼šè®¾ç½®è¿™ä¸ªè£…ç½®çš„ uuid</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å¼€å§‹æŸ¥çœ‹ï¼Œæ²¡æœ‰ label</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># xfs_admin -l /dev/sda4</span>
label <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
<span class="token comment"># è®¾ç½®åï¼Œå‘ç°åäº†</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># xfs_admin -L mrcode_xfs /dev/sda4</span>
writing all SBs
new label <span class="token operator">=</span> <span class="token string">&quot;mrcode_xfs&quot;</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># xfs_admin -l /dev/sda4</span>
label <span class="token operator">=</span> <span class="token string">&quot;mrcode_xfs&quot;</span>

<span class="token comment"># åˆ©ç”¨ uuidgen äº§ç”Ÿæ–° UUID æ¥è®¾ç½® /dev/sda4 ï¼Œå¹¶æµ‹è¯•æŒ‚è½½</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># umount /dev/sda4</span>
umount: /dev/sda4ï¼šæœªæŒ‚è½½  <span class="token comment"># å‰é¢ç»ƒä¹ ä¸­æˆ‘è¯´å’‹æ²¡æœ‰å‘ç°ä»–äº†ï¼ŒåŸæ¥æŒ‚è½½å¤±æ•ˆäº†ï¼Ÿ</span>
<span class="token comment"># ç”Ÿæˆ uuid</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># uuidgen</span>
edfa7161-5847-4935-80e1-6e081be9ab77
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># xfs_admin -u /dev/sda4</span>
UUID <span class="token operator">=</span> 819c0c18-8d4a-4c3f-9a98-0ab039e769f5
<span class="token comment"># ä¿®æ”¹ä¸ºæ–°ç”Ÿæˆçš„ uuid</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># xfs_admin -U edfa7161-5847-4935-80e1-6e081be9ab77 /dev/sda4</span>
Clearing log and setting UUID
writing all SBs
new UUID <span class="token operator">=</span> edfa7161-5847-4935-80e1-6e081be9ab77
<span class="token comment"># ç”¨æ–°çš„ uuid æŒ‚è½½</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mount UUID=edfa7161-5847-4935-80e1-6e081be9ab77 /data/xfs</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="tune2fs-ä¿®æ”¹-ext4-çš„-label-name-ä¸-uuid" tabindex="-1"><a class="header-anchor" href="#tune2fs-ä¿®æ”¹-ext4-çš„-label-name-ä¸-uuid" aria-hidden="true">#</a> tune2fs ä¿®æ”¹ ext4 çš„ label name ä¸ UUID</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>tune2fs <span class="token punctuation">[</span>-l<span class="token punctuation">]</span><span class="token punctuation">[</span>-L label<span class="token punctuation">]</span><span class="token punctuation">[</span>-U uuid<span class="token punctuation">]</span> è£…ç½®å

-lï¼šç±»ä¼¼ dumpe2fs <span class="token parameter variable">-h</span> çš„åŠŸèƒ½ï¼Œå°† superblock å†…çš„æ•°æ®è¯»å‡ºæ¥
-Lï¼šä¿®æ”¹ label name
-Uï¼šä¿®æ”¹ UUID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®è·µç»ƒä¹ </p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># dumpe2fs -h /dev/sda5 | grep name</span>
dumpe2fs <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
Filesystem volume name:   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>		<span class="token comment"># æ— åç§°</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># tune2fs -L mrcode_ext4 /dev/sda5</span>
tune2fs <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># mount LABEL=mrcode_ext4 /data/ext4</span>
<span class="token comment"># å†æ¬¡æŸ¥çœ‹å°±æœ‰äº†</span>
<span class="token punctuation">[</span>root@study ~<span class="token punctuation">]</span><span class="token comment"># dumpe2fs -h /dev/sda5 | grep name</span>
dumpe2fs <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
Filesystem volume name:   mrcode_ext4

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,74);function k(v,f){const a=t("RouterLink");return p(),l("div",null,[m,i("p",null,[s("è¿™é‡Œä¹‹åäº†ä¹‹å‰è®²è§£è¿‡çš„ "),o(a,{to:"/99-tools/Linux/07/01.html#dumpe2fs-%E6%9F%A5%E8%AF%A2-ext-%E5%AE%B6%E6%97%8F-superblock-%E4%BF%A1%E6%81%AF%E7%9A%84%E6%8C%87%E4%BB%A4"},{default:c(()=>[s("dumpe2fs")]),_:1}),s(" å‘½ä»¤ï¼Œè¿™é‡Œå°±èƒ½å†å›è¿‡å¤´å»ç»ƒä¹ äº†")]),b])}const x=e(d,[["render",k],["__file","03.html.vue"]]);export{x as default};
