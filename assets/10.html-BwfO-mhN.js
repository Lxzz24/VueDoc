import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as c,c as i,a as n,b as a,w as e,d as l,e as t}from"./app-CvlAI_tu.js";const u="/VueDoc/assets/image-20231221140740305-Cv7MOsjG.png",r="/VueDoc/assets/image-20231221140837145-D_ba2RX7.png",d={},k={class:"hint-container details"},v=n("summary",null,"ç›®å½•",-1),m={class:"table-of-contents"},b=l('<p>å¯¹ä¸€ä¸ª Web åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œé™¤äº† Servletã€Filter è¿™äº›é€»è¾‘ç»„ä»¶ï¼Œè¿˜éœ€è¦ JSP è¿™æ ·çš„è§†å›¾æ–‡ä»¶ï¼Œå¤–åŠ ä¸€å †é™æ€èµ„æºæ–‡ä»¶ï¼Œå¦‚ CSSã€JS ç­‰ã€‚</p><p>åˆç†ç»„ç»‡æ–‡ä»¶ç»“æ„éå¸¸é‡è¦ã€‚æˆ‘ä»¬ä»¥ä¸€ä¸ªå…·ä½“çš„ Web åº”ç”¨ç¨‹åºä¸ºä¾‹ï¼š</p><figure><img src="'+u+`" alt="image-20231221140740305" tabindex="0" loading="lazy"><figcaption>image-20231221140740305</figcaption></figure><p>æˆ‘ä»¬æŠŠæ‰€æœ‰çš„é™æ€èµ„æºæ–‡ä»¶æ”¾å…¥ <code>/static/</code> ç›®å½•ï¼Œåœ¨å¼€å‘é˜¶æ®µï¼Œæœ‰äº› Web æœåŠ¡å™¨ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬åŠ ä¸€ä¸ªä¸“é—¨è´Ÿè´£å¤„ç†é™æ€æ–‡ä»¶çš„ Servletï¼Œä½†å¦‚æœ <code>IndexServlet</code> æ˜ å°„è·¯å¾„ä¸º <code>/</code>ï¼Œä¼šå±è”½æ‰å¤„ç†é™æ€æ–‡ä»¶çš„ Servlet æ˜ å°„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±ç¼–å†™ä¸€ä¸ªå¤„ç†é™æ€æ–‡ä»¶çš„ <code>FileServlet</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">&quot;/static/*&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServletContext</span> ctx <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// RequestURI åŒ…å« ContextPath, éœ€è¦å»æ‰:</span>
        <span class="token class-name">String</span> urlPath <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–çœŸå®æ–‡ä»¶è·¯å¾„:</span>
        <span class="token class-name">String</span> filepath <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span>urlPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>filepath <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ— æ³•è·å–åˆ°è·¯å¾„:</span>
            resp<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">.</span><span class="token constant">SC_NOT_FOUND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Path</span> path <span class="token operator">=</span> <span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>path<span class="token punctuation">.</span><span class="token function">toFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ–‡ä»¶ä¸å­˜åœ¨:</span>
            resp<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">.</span><span class="token constant">SC_NOT_FOUND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æ ¹æ®æ–‡ä»¶åçŒœæµ‹ Content-Type:</span>
        <span class="token class-name">String</span> mime <span class="token operator">=</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">probeContentType</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mime <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mime <span class="token operator">=</span> <span class="token string">&quot;application/octet-stream&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span>mime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¯»å–æ–‡ä»¶å¹¶å†™å…¥ Response:</span>
        <span class="token class-name">OutputStream</span> output <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> input <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>filepath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            input<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        output<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ä¸€æ¥ï¼Œåœ¨å¼€å‘é˜¶æ®µï¼Œæˆ‘ä»¬å°±å¯ä»¥æ–¹ä¾¿åœ°é«˜æ•ˆå¼€å‘ã€‚</p><p>ç±»ä¼¼ Tomcat è¿™æ ·çš„ Web æœåŠ¡å™¨ï¼Œè¿è¡Œçš„ Web åº”ç”¨ç¨‹åºé€šå¸¸éƒ½æ˜¯ä¸šåŠ¡ç³»ç»Ÿï¼Œå› æ­¤ï¼Œè¿™ç±»æœåŠ¡å™¨ä¹Ÿè¢«ç§°ä¸ºåº”ç”¨æœåŠ¡å™¨ã€‚åº”ç”¨æœåŠ¡å™¨å¹¶ä¸æ“…é•¿å¤„ç†é™æ€æ–‡ä»¶ï¼Œä¹Ÿä¸é€‚åˆç›´æ¥æš´éœ²ç»™ç”¨æˆ·ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ—¶ï¼Œæ€»æ˜¯ä½¿ç”¨ç±»ä¼¼ Nginx è¿™æ ·çš„æœåŠ¡å™¨å……å½“åå‘ä»£ç†å’Œé™æ€æœåŠ¡å™¨ï¼Œåªæœ‰åŠ¨æ€è¯·æ±‚æ‰ä¼šæ”¾è¡Œç»™åº”ç”¨æœåŠ¡å™¨ï¼Œæ‰€ä»¥ï¼Œéƒ¨ç½²æ¶æ„å¦‚ä¸‹ï¼š</p><figure><img src="`+r+`" alt="image-20231221140837145" tabindex="0" loading="lazy"><figcaption>image-20231221140837145</figcaption></figure><p>å®ç°ä¸Šè¿°åŠŸèƒ½çš„ Nginx é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p><div class="language-conf line-numbers-mode" data-ext="conf"><pre class="language-conf"><code>server {
    listen 80;

    server_name www.local.liaoxuefeng.com;

    # é™æ€æ–‡ä»¶æ ¹ç›®å½•:
    root /path/to/src/main/webapp;

    access_log /var/log/nginx/webapp_access_log;
    error_log  /var/log/nginx/webapp_error_log;

    # å¤„ç†é™æ€æ–‡ä»¶è¯·æ±‚:
    location /static {
    }

    # å¤„ç†é™æ€æ–‡ä»¶è¯·æ±‚:
    location /favicon.ico {
    }

    # ä¸å…è®¸è¯·æ±‚ / WEB-INF:
    location /WEB-INF {
        return 404;
    }

    # å…¶ä»–è¯·æ±‚è½¬å‘ç»™ Tomcat:
    location / {
        proxy_pass       http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ Nginx é…åˆ Tomcat æœåŠ¡å™¨ï¼Œå¯ä»¥å……åˆ†å‘æŒ¥ Nginx ä½œä¸ºç½‘å…³çš„ä¼˜åŠ¿ï¼Œæ—¢å¯ä»¥é«˜æ•ˆå¤„ç†é™æ€æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æŠŠ httpsã€é˜²ç«å¢™ã€é™é€Ÿã€åçˆ¬è™«ç­‰åŠŸèƒ½æ”¾åˆ° Nginx ä¸­ï¼Œä½¿å¾—æˆ‘ä»¬è‡ªå·±çš„ WebApp èƒ½ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚</p><h2 id="ğŸ€-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç»ƒä¹ " aria-hidden="true">#</a> ğŸ€ ç»ƒä¹ </h2><p>ä½¿ç”¨ Nginx + Tomcat éƒ¨ç½²</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>éƒ¨ç½² Web åº”ç”¨ç¨‹åºæ—¶ï¼Œè¦è®¾è®¡åˆç†çš„ç›®å½•ç»“æ„ï¼ŒåŒæ—¶è€ƒè™‘å¼€å‘æ¨¡å¼éœ€è¦ä¾¿æ·æ€§ï¼Œç”Ÿäº§æ¨¡å¼éœ€è¦é«˜æ€§èƒ½ã€‚</p>`,15);function f(g,_){const s=o("router-link");return c(),i("div",null,[n("details",k,[v,n("nav",m,[n("ul",null,[n("li",null,[a(s,{to:"#ğŸ€-ç»ƒä¹ "},{default:e(()=>[t("ğŸ€ ç»ƒä¹ ")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å°ç»“"},{default:e(()=>[t("ğŸ€ å°ç»“")]),_:1})])])])]),b])}const w=p(d,[["render",f],["__file","10.html.vue"]]);export{w as default};
