import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as c,c as l,a as n,b as a,w as t,d as i,e as p}from"./app-CvlAI_tu.js";const u="/VueDoc/assets/l-20231220153735267-BOfXCnbp.png",k="/VueDoc/assets/l-20231220153735157-D4VVJ6Ky.png",r="/VueDoc/assets/l-20231220153735205-Dtb32IAS.png",d="/VueDoc/assets/image-20231220154101109-CKpbTmAk.png",m="/VueDoc/assets/image-20231220154024058-BhOn3t7U.png",g={},v={class:"hint-container details"},b=n("summary",null,"ç›®å½•",-1),w={class:"table-of-contents"},f=i('<p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œä¸€ä¸ªå®Œæ•´çš„ Web åº”ç”¨ç¨‹åºçš„å¼€å‘æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>ç¼–å†™ Servletï¼›</li><li>æ‰“åŒ…ä¸º war æ–‡ä»¶ï¼›</li><li>å¤åˆ¶åˆ° Tomcat çš„ webapps ç›®å½•ä¸‹ï¼›</li><li>å¯åŠ¨ Tomcatã€‚</li></ol><p>è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸æ˜¯å¾ˆç¹çï¼Ÿå¦‚æœæˆ‘ä»¬æƒ³åœ¨ IDE ä¸­æ–­ç‚¹è°ƒè¯•ï¼Œè¿˜éœ€è¦æ‰“å¼€ Tomcat çš„è¿œç¨‹è°ƒè¯•ç«¯å£å¹¶ä¸”è¿æ¥ä¸Šå»ã€‚</p><figure><img src="'+u+'" alt="javaee-expert" tabindex="0" loading="lazy"><figcaption>javaee-expert</figcaption></figure><figure><img src="'+k+`" alt="javaee-newbee" tabindex="0" loading="lazy"><figcaption>javaee-newbee</figcaption></figure><p>è®¸å¤šåˆå­¦è€…ç»å¸¸å¡åœ¨å¦‚ä½•åœ¨ IDE ä¸­å¯åŠ¨ Tomcat å¹¶åŠ è½½ webappï¼Œæ›´ä¸è¦è¯´æ–­ç‚¹è°ƒè¯•äº†ã€‚</p><p>æˆ‘ä»¬éœ€è¦ä¸€ç§ç®€å•å¯é ï¼Œèƒ½ç›´æ¥åœ¨ IDE ä¸­å¯åŠ¨å¹¶è°ƒè¯• webapp çš„æ–¹æ³•ã€‚</p><p>å› ä¸º Tomcat å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª Java ç¨‹åºï¼Œæˆ‘ä»¬çœ‹çœ‹ Tomcat çš„å¯åŠ¨æµç¨‹ï¼š</p><ol><li>å¯åŠ¨ JVM å¹¶æ‰§è¡Œ Tomcat çš„ <code>main()</code> æ–¹æ³•ï¼›</li><li>åŠ è½½ war å¹¶åˆå§‹åŒ– Servletï¼›</li><li>æ­£å¸¸æœåŠ¡ã€‚</li></ol><p>å¯åŠ¨ Tomcat æ— éå°±æ˜¯è®¾ç½®å¥½ classpath å¹¶æ‰§è¡Œ Tomcat æŸä¸ª jar åŒ…çš„ <code>main()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠ Tomcat çš„ jar åŒ…å…¨éƒ¨å¼•å…¥è¿›æ¥ï¼Œç„¶åè‡ªå·±ç¼–å†™ä¸€ä¸ª <code>main()</code> æ–¹æ³•ï¼Œå…ˆå¯åŠ¨ Tomcatï¼Œç„¶åè®©å®ƒåŠ è½½æˆ‘ä»¬çš„ webapp å°±è¡Œã€‚</p><p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ª <code>web-servlet-embedded</code> å·¥ç¨‹ï¼Œç¼–å†™ <code>pom.xml</code> å¦‚ä¸‹ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.itranswarp.learnjava<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>web-servlet-embedded<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">&gt;</span></span>war<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.reporting.outputEncoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.reporting.outputEncoding</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tomcat.version</span><span class="token punctuation">&gt;</span></span>10.1.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tomcat.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.tomcat.embed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tomcat-embed-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${tomcat.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.tomcat.embed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>tomcat-embed-jasper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${tomcat.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­ï¼Œ<code>&lt;packaging&gt;</code> ç±»å‹ä»ç„¶ä¸º <code>war</code>ï¼Œå¼•å…¥ä¾èµ– <code>tomcat-embed-core</code> å’Œ <code>tomcat-embed-jasper</code>ï¼Œå¼•å…¥çš„ Tomcat ç‰ˆæœ¬ <code>&lt;tomcat.version&gt;</code> ä¸º <code>10.1.1</code>ã€‚</p><p>ä¸å¿…å¼•å…¥ Servlet APIï¼Œå› ä¸ºå¼•å…¥ Tomcat ä¾èµ–åè‡ªåŠ¨å¼•å…¥äº† Servlet APIã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸ç¼–å†™ Servlet å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>urlPatterns <span class="token operator">=</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;text/html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            name <span class="token operator">=</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">PrintWriter</span> pw <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;h1&gt;Hello,&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;!&lt;/h1&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ª <code>main()</code> æ–¹æ³•ï¼Œå¯åŠ¨ Tomcat æœåŠ¡å™¨ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯åŠ¨ Tomcat:</span>
        <span class="token class-name">Tomcat</span> tomcat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tomcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tomcat<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">getInteger</span><span class="token punctuation">(</span><span class="token string">&quot;port&quot;</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tomcat<span class="token punctuation">.</span><span class="token function">getConnector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ›å»º webapp:</span>
        <span class="token class-name">Context</span> ctx <span class="token operator">=</span> tomcat<span class="token punctuation">.</span><span class="token function">addWebapp</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;src/main/webapp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebResourceRoot</span> resources <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardRoot</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        resources<span class="token punctuation">.</span><span class="token function">addPreResources</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">DirResourceSet</span><span class="token punctuation">(</span>resources<span class="token punctuation">,</span> <span class="token string">&quot;/WEB-INF/classes&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;target/classes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setResources</span><span class="token punctuation">(</span>resources<span class="token punctuation">)</span><span class="token punctuation">;</span>
        tomcat<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tomcat<span class="token punctuation">.</span><span class="token function">getServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ï¼Œæˆ‘ä»¬ç›´æ¥è¿è¡Œ <code>main()</code> æ–¹æ³•ï¼Œå³å¯å¯åŠ¨åµŒå…¥å¼ Tomcat æœåŠ¡å™¨ï¼Œç„¶åï¼Œé€šè¿‡é¢„è®¾çš„ <code>tomcat.addWebapp(&quot;&quot;, new File(&quot;src/main/webapp&quot;)</code>ï¼ŒTomcat ä¼šè‡ªåŠ¨åŠ è½½å½“å‰å·¥ç¨‹ä½œä¸ºæ ¹ webappï¼Œå¯ç›´æ¥åœ¨æµè§ˆå™¨è®¿é—® <code>http://localhost:8080/</code>ï¼š</p><figure><img src="`+r+`" alt="embedded-tomcat" tabindex="0" loading="lazy"><figcaption>embedded-tomcat</figcaption></figure><p>é€šè¿‡ <code>main()</code> æ–¹æ³•å¯åŠ¨ Tomcat æœåŠ¡å™¨å¹¶åŠ è½½æˆ‘ä»¬è‡ªå·±çš„ webapp æœ‰å¦‚ä¸‹å¥½å¤„ï¼š</p><ol><li>å¯åŠ¨ç®€å•ï¼Œæ— éœ€ä¸‹è½½ Tomcat æˆ–å®‰è£…ä»»ä½• IDE æ’ä»¶ï¼›</li><li>è°ƒè¯•æ–¹ä¾¿ï¼Œå¯åœ¨ IDE ä¸­ä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼›</li><li>ä½¿ç”¨ Maven åˆ›å»º war åŒ…åï¼Œä¹Ÿå¯ä»¥æ­£å¸¸éƒ¨ç½²åˆ°ç‹¬ç«‹çš„ Tomcat æœåŠ¡å™¨ä¸­ã€‚</li></ol><h2 id="ğŸ€-ç”Ÿæˆå¯æ‰§è¡Œ-war-åŒ…" tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç”Ÿæˆå¯æ‰§è¡Œ-war-åŒ…" aria-hidden="true">#</a> ğŸ€ ç”Ÿæˆå¯æ‰§è¡Œ war åŒ…</h2><p>å¦‚æœè¦ç”Ÿæˆå¯æ‰§è¡Œçš„ war åŒ…ï¼Œç”¨ <code>java -jar xxx.war</code> å¯åŠ¨ï¼Œåˆ™éœ€è¦æŠŠ Tomcat çš„ä¾èµ–é¡¹çš„ <code>&lt;scope&gt;</code> å»æ‰ï¼Œç„¶åé…ç½® <code>maven-war-plugin</code> å¦‚ä¸‹ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">...</span><span class="token punctuation">&gt;</span></span>
    ...
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">&gt;</span></span>hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-war-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.3.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
					<span class="token comment">&lt;!-- å¤åˆ¶ classes åˆ° war åŒ…æ ¹ç›®å½• --&gt;</span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>webResources</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">&gt;</span></span>
							<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">&gt;</span></span>\${project.build.directory}/classes<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>webResources</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>archiveClasses</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>archiveClasses</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>archive</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span><span class="token punctuation">&gt;</span></span>
							<span class="token comment">&lt;!-- æ·»åŠ  Class-Path --&gt;</span>
							<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>addClasspath</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>addClasspath</span><span class="token punctuation">&gt;</span></span>
							<span class="token comment">&lt;!-- Classpath å‰ç¼€ --&gt;</span>
							<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>classpathPrefix</span><span class="token punctuation">&gt;</span></span>tmp-webapp/WEB-INF/lib/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>classpathPrefix</span><span class="token punctuation">&gt;</span></span>
							<span class="token comment">&lt;!-- main å¯åŠ¨ç±» --&gt;</span>
							<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">&gt;</span></span>com.itranswarp.learnjava.Main<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">&gt;</span></span>
						<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">&gt;</span></span>
					<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>archive</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”Ÿæˆçš„ war åŒ…ç»“æ„å¦‚ä¸‹ï¼š</p><figure><img src="`+d+`" alt="image-20231220154101109" tabindex="0" loading="lazy"><figcaption>image-20231220154101109</figcaption></figure><p>ä¹‹æ‰€ä»¥è¦æŠŠç¼–è¯‘åçš„ classes å¤åˆ¶åˆ° war åŒ…æ ¹ç›®å½•ï¼Œæ˜¯å› ä¸ºç”¨ <code>java -jar hello.war</code> å¯åŠ¨æ—¶ï¼ŒJVM çš„ Class Loader ä¸ä¼šæŸ¥æ‰¾ <code>WEB-INF/lib</code> çš„ jar åŒ…ï¼Œè€Œæ˜¯ç›´æ¥ä» <code>hello.war</code> çš„æ ¹ç›®å½•æŸ¥æ‰¾ã€‚<code>MANIFEST.MF</code> ç”Ÿæˆçš„å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Main-Class: com.itranswarp.learnjava.Main
Class-Path: tmp-webapp/WEB-INF/lib/tomcat-embed-core-10.1.1.jar tmp-weba
 pp/WEB-INF/lib/tomcat-annotations-api-10.1.1.jar tmp-webapp/WEB-INF/lib
 /tomcat-embed-jasper-10.1.1.jar tmp-webapp/WEB-INF/lib/tomcat-embed-el-
 <span class="token number">10.1</span>.1.jar tmp-webapp/WEB-INF/lib/ecj-3.18.0.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„åˆ° <code>Class-Path</code> çš„è·¯å¾„ï¼Œè¿™é‡Œå®šä¹‰çš„ <code>Class-Path</code> ç›¸å½“äº <code>java -cp</code> æŒ‡å®šçš„ Classpathï¼ŒJVM ä¸ä¼šåœ¨ä¸€ä¸ª jar åŒ…ä¸­æŸ¥æ‰¾ jar åŒ…å†…çš„ jar åŒ…ï¼Œå®ƒåªä¼šåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æœç´¢ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬è¦ä¿®æ”¹ <code>main()</code> æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œ <code>main()</code> æ–¹æ³•æ—¶ï¼Œå…ˆè‡ªè§£å‹ <code>war</code> åŒ…ï¼Œå†å¯åŠ¨ Tomcatï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ¤å®šæ˜¯å¦ä» jar/war å¯åŠ¨:</span>
        <span class="token class-name">String</span> jarFile <span class="token operator">=</span> <span class="token class-name">Main</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getProtectionDomain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCodeSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> isJarFile <span class="token operator">=</span> jarFile<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.war&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> jarFile<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.jar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å®šä½ webapp æ ¹ç›®å½•:</span>
        <span class="token class-name">String</span> webDir <span class="token operator">=</span> isJarFile <span class="token operator">?</span> <span class="token string">&quot;tmp-webapp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;src/main/webapp&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isJarFile<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è§£å‹åˆ° tmp-webapp:</span>
            <span class="token class-name">Path</span> baseDir <span class="token operator">=</span> <span class="token class-name">Paths</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>webDir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span>baseDir<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>baseDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createDirectories</span><span class="token punctuation">(</span>baseDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;extract to:&quot;</span> <span class="token operator">+</span> baseDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">JarFile</span> jar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JarFile</span><span class="token punctuation">(</span>jarFile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JarEntry</span><span class="token punctuation">&gt;</span></span> entries <span class="token operator">=</span> jar<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">comparing</span><span class="token punctuation">(</span><span class="token class-name">JarEntry</span><span class="token operator">::</span><span class="token function">getName</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">JarEntry</span> entry <span class="token operator">:</span> entries<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Path</span> res <span class="token operator">=</span> baseDir<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>entry<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">createDirectories</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>jar<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// JVM é€€å‡ºæ—¶è‡ªåŠ¨åˆ é™¤ tmp-webapp:</span>
            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addShutdownHook</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span>baseDir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token class-name">Comparator</span><span class="token punctuation">.</span><span class="token function">reverseOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Path</span><span class="token operator">::</span><span class="token function">toFile</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">File</span><span class="token operator">::</span><span class="token function">delete</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¯åŠ¨ Tomcat:</span>
        <span class="token class-name">TomcatRunner</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>webDir<span class="token punctuation">,</span> isJarFile <span class="token operator">?</span> <span class="token string">&quot;tmp-webapp&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;target/classes&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Tomcat å¯åŠ¨ç±»:</span>
<span class="token keyword">class</span> <span class="token class-name">TomcatRunner</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span> webDir<span class="token punctuation">,</span> <span class="token class-name">String</span> baseDir<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Tomcat</span> tomcat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Tomcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tomcat<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">getInteger</span><span class="token punctuation">(</span><span class="token string">&quot;port&quot;</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tomcat<span class="token punctuation">.</span><span class="token function">getConnector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Context</span> ctx <span class="token operator">=</span> tomcat<span class="token punctuation">.</span><span class="token function">addWebapp</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>webDir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebResourceRoot</span> resources <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StandardRoot</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        resources<span class="token punctuation">.</span><span class="token function">addPreResources</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DirResourceSet</span><span class="token punctuation">(</span>resources<span class="token punctuation">,</span> <span class="token string">&quot;/WEB-INF/classes&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>baseDir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctx<span class="token punctuation">.</span><span class="token function">setResources</span><span class="token punctuation">(</span>resources<span class="token punctuation">)</span><span class="token punctuation">;</span>
        tomcat<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tomcat<span class="token punctuation">.</span><span class="token function">getServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œæ‰§è¡Œ <code>java -jar hello.war</code> æ—¶ï¼ŒJVM å…ˆå®šä½ <code>hello.war</code> çš„ <code>Main</code> ç±»ï¼Œè¿è¡Œ <code>main()</code>ï¼Œè‡ªåŠ¨è§£å‹åï¼Œæ–‡ä»¶ç³»ç»Ÿç›®å½•å¦‚ä¸‹ï¼š</p><figure><img src="`+m+'" alt="image-20231220154024058" tabindex="0" loading="lazy"><figcaption>image-20231220154024058</figcaption></figure><p>è§£å‹åçš„ç›®å½•ç»“æ„å’Œæˆ‘ä»¬åœ¨ <code>MANIFEST.MF</code> ä¸­è®¾å®šçš„ <code>Class-Path</code> ä¸€è‡´ï¼Œå› æ­¤ï¼ŒJVM èƒ½é¡ºåˆ©åŠ è½½ Tomcat çš„ jar åŒ…ï¼Œç„¶åè¿è¡Œ Tomcatï¼Œå¯åŠ¨ Web Appã€‚</p><p>ç¼–å†™å¯æ‰§è¡Œçš„ jar æˆ–è€… war éœ€è¦æ³¨æ„çš„å‡ ç‚¹ï¼š</p><ul><li>å¿…é¡»åœ¨ <code>MANIFEST.MF</code> ä¸­æŒ‡å®š <code>Main-Class</code> å’Œ <code>Class-Path</code>ï¼›</li><li><code>Main</code> å¿…é¡»èƒ½åœ¨ jar/war åŒ…çš„æ ¹ç›®å½•ä¸‹è¢« JVM çš„ Class Loader åŠ è½½ï¼›</li><li><code>Main</code> è´Ÿè´£è§£å‹ jar/warï¼Œè§£å‹åçš„ç›®å½•ç»“æ„ä¸ <code>MANIFEST.MF</code> ä¸­è®¾å®šçš„ <code>Class-Path</code> ä¸€è‡´ï¼›</li><li><code>Main</code> ä¸èƒ½å¼•ç”¨ä»»ä½•è§£å‹åæ‰èƒ½è¢«åŠ è½½çš„ç±»ï¼Œä¾‹å¦‚ <code>org.apache.catalina.startup.Tomcat</code>ã€‚</li></ul><p>å¯¹ SpringBoot æœ‰æ‰€äº†è§£çš„ç«¥é‹å¯èƒ½çŸ¥é“ï¼ŒSpringBoot ä¹Ÿæ”¯æŒåœ¨ <code>main()</code> æ–¹æ³•ä¸­ä¸€è¡Œä»£ç ç›´æ¥å¯åŠ¨ Tomcatï¼Œå¹¶ä¸”è¿˜èƒ½æ–¹ä¾¿åœ°æ›´æ¢æˆ Jetty ç­‰å…¶ä»–æœåŠ¡å™¨ã€‚å®ƒçš„å¯åŠ¨æ–¹å¼å’Œæˆ‘ä»¬ä»‹ç»çš„æ˜¯åŸºæœ¬ä¸€æ ·çš„ï¼Œåç»­æ¶‰åŠåˆ° SpringBoot çš„éƒ¨åˆ†æˆ‘ä»¬è¿˜ä¼šè¯¦ç»†è®²è§£ã€‚</p><h2 id="ğŸ€-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç»ƒä¹ " aria-hidden="true">#</a> ğŸ€ ç»ƒä¹ </h2><p>ä½¿ç”¨åµŒå…¥å¼ Tomcat è¿è¡Œ Servlet</p><p>æ³¨æ„ï¼šå¼•å…¥çš„ Tomcat çš„ scope ä¸º <code>provided</code>ï¼Œåœ¨ Idea ä¸‹è¿è¡Œæ—¶ï¼Œéœ€è¦è®¾ç½® <code>Run/Debug Configurations</code>ï¼Œé€‰æ‹© <code>Application - Main</code>ï¼Œé’©ä¸Š <code>Include dependencies with &quot;Provided&quot; scope</code>ï¼Œè¿™æ ·æ‰èƒ½è®© Idea åœ¨è¿è¡Œæ—¶æŠŠ Tomcat ç›¸å…³ä¾èµ–åŒ…è‡ªåŠ¨æ·»åŠ åˆ° classpath ä¸­ã€‚</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>å¼€å‘ Servlet æ—¶ï¼Œæ¨èä½¿ç”¨ <code>main()</code> æ–¹æ³•å¯åŠ¨åµŒå…¥å¼ Tomcat æœåŠ¡å™¨å¹¶åŠ è½½å½“å‰å·¥ç¨‹çš„ webappï¼Œä¾¿äºå¼€å‘è°ƒè¯•ï¼Œä¸”ä¸å½±å“æ‰“åŒ…éƒ¨ç½²ï¼Œèƒ½æå¤§åœ°æå‡å¼€å‘æ•ˆç‡ã€‚</p>',41);function h(y,q){const s=o("router-link");return c(),l("div",null,[n("details",v,[b,n("nav",w,[n("ul",null,[n("li",null,[a(s,{to:"#ğŸ€-ç”Ÿæˆå¯æ‰§è¡Œ-war-åŒ…"},{default:t(()=>[p("ğŸ€ ç”Ÿæˆå¯æ‰§è¡Œ war åŒ…")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-ç»ƒä¹ "},{default:t(()=>[p("ğŸ€ ç»ƒä¹ ")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å°ç»“"},{default:t(()=>[p("ğŸ€ å°ç»“")]),_:1})])])])]),f])}const T=e(g,[["render",h],["__file","3.html.vue"]]);export{T as default};
