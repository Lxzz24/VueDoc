import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as c,o,c as l,a as n,b as a,w as t,d as i,e as p}from"./app-CvlAI_tu.js";const u={},k={class:"hint-container details"},r=n("summary",null,"ç›®å½•",-1),d={class:"table-of-contents"},m=i(`<p>å¯¹ç§°åŠ å¯†ç®—æ³•è§£å†³äº†æ•°æ®åŠ å¯†çš„é—®é¢˜ã€‚æˆ‘ä»¬ä»¥ AES åŠ å¯†ä¸ºä¾‹ï¼Œåœ¨ç°å®ä¸–ç•Œä¸­ï¼Œå°æ˜è¦å‘è·¯äººç”²å‘é€ä¸€ä¸ªåŠ å¯†æ–‡ä»¶ï¼Œä»–å¯ä»¥å…ˆç”Ÿæˆä¸€ä¸ª AES å¯†é’¥ï¼Œå¯¹æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼Œç„¶åæŠŠåŠ å¯†æ–‡ä»¶å‘é€ç»™å¯¹æ–¹ã€‚å› ä¸ºå¯¹æ–¹è¦è§£å¯†ï¼Œå°±å¿…é¡»éœ€è¦å°æ˜ç”Ÿæˆçš„å¯†é’¥ã€‚</p><p>ç°åœ¨é—®é¢˜æ¥äº†ï¼šå¦‚ä½•ä¼ é€’å¯†é’¥ï¼Ÿ</p><p>åœ¨ä¸å®‰å…¨çš„ä¿¡é“ä¸Šä¼ é€’åŠ å¯†æ–‡ä»¶æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºé»‘å®¢æ‹¿åˆ°åŠ å¯†æ–‡ä»¶æ²¡æœ‰ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚ä½•å¦‚ä½•åœ¨ä¸å®‰å…¨çš„ä¿¡é“ä¸Šå®‰å…¨åœ°ä¼ è¾“å¯†é’¥ï¼Ÿ</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯†é’¥äº¤æ¢ç®—æ³•å³ DH ç®—æ³•ï¼šDiffie-Hellman ç®—æ³•åº”è¿è€Œç”Ÿã€‚</p><p>DH ç®—æ³•è§£å†³äº†å¯†é’¥åœ¨åŒæ–¹ä¸ç›´æ¥ä¼ é€’å¯†é’¥çš„æƒ…å†µä¸‹å®Œæˆå¯†é’¥äº¤æ¢ï¼Œè¿™ä¸ªç¥å¥‡çš„äº¤æ¢åŸç†å®Œå…¨ç”±æ•°å­¦ç†è®ºæ”¯æŒã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ DH ç®—æ³•äº¤æ¢å¯†é’¥çš„æ­¥éª¤ã€‚å‡è®¾ç”²ä¹™åŒæ–¹éœ€è¦ä¼ é€’å¯†é’¥ï¼Œä»–ä»¬ä¹‹é—´å¯ä»¥è¿™ä¹ˆåšï¼š</p><ol><li>ç”²é¦–å…ˆé€‰æ‹©ä¸€ä¸ªç´ æ•° <code>p</code>ï¼Œä¾‹å¦‚ 97ï¼Œåº•æ•° <code>g</code> æ˜¯ <code>p</code> çš„ä¸€ä¸ªåŸæ ¹ï¼Œä¾‹å¦‚ 5ï¼Œéšæœºæ•° <code>a</code>ï¼Œä¾‹å¦‚ 123ï¼Œç„¶åè®¡ç®— <code>A=g^a mod p</code>ï¼Œç»“æœæ˜¯ 34ï¼Œç„¶åï¼Œç”²å‘é€ <code>pï¼97</code>ï¼Œ<code>g=5</code>ï¼Œ<code>A=34</code> ç»™ä¹™ï¼›</li><li>ä¹™æ–¹æ”¶åˆ°åï¼Œä¹Ÿé€‰æ‹©ä¸€ä¸ªéšæœºæ•° <code>b</code>ï¼Œä¾‹å¦‚ï¼Œ456ï¼Œç„¶åè®¡ç®— <code>B = g^b mod p</code>ï¼Œç»“æœæ˜¯ 75ï¼Œä¹™å†åŒæ—¶è®¡ç®— <code>s = A^b mod p</code>ï¼Œç»“æœæ˜¯ 22ï¼›</li><li>ä¹™æŠŠè®¡ç®—çš„ <code>B=75</code> å‘ç»™ç”²ï¼Œç”²è®¡ç®— <code>s ï¼ B^a mod p</code>ï¼Œè®¡ç®—ç»“æœä¸ä¹™ç®—å‡ºçš„ç»“æœä¸€æ ·ï¼Œéƒ½æ˜¯ 22ã€‚</li></ol><p>æ‰€ä»¥æœ€ç»ˆåŒæ–¹åå•†å‡ºçš„å¯†é’¥ <code>s</code> æ˜¯ 22ã€‚æ³¨æ„åˆ°è¿™ä¸ªå¯†é’¥ <code>s</code> å¹¶æ²¡æœ‰åœ¨ç½‘ç»œä¸Šä¼ è¾“ã€‚è€Œé€šè¿‡ç½‘ç»œä¼ è¾“çš„ <code>p</code>ï¼Œ<code>g</code>ï¼Œ<code>A</code> å’Œ <code>B</code> æ˜¯æ— æ³•æ¨ç®—å‡º <code>s</code> çš„ï¼Œå› ä¸ºå®é™…ç®—æ³•é€‰æ‹©çš„ç´ æ•°æ˜¯éå¸¸å¤§çš„ã€‚</p><p>æ‰€ä»¥ï¼Œæ›´ç¡®åˆ‡åœ°è¯´ï¼ŒDH ç®—æ³•æ˜¯ä¸€ä¸ªå¯†é’¥åå•†ç®—æ³•ï¼ŒåŒæ–¹æœ€ç»ˆåå•†å‡ºä¸€ä¸ªå…±åŒçš„å¯†é’¥ï¼Œè€Œè¿™ä¸ªå¯†é’¥ä¸ä¼šé€šè¿‡ç½‘ç»œä¼ è¾“ã€‚</p><p>å¦‚æœæˆ‘ä»¬æŠŠ <code>a</code> çœ‹æˆç”²çš„ç§é’¥ï¼Œ<code>A</code> çœ‹æˆç”²çš„å…¬é’¥ï¼Œ<code>b</code> çœ‹æˆä¹™çš„ç§é’¥ï¼Œ<code>B</code> çœ‹æˆä¹™çš„å…¬é’¥ï¼ŒDH ç®—æ³•çš„æœ¬è´¨å°±æ˜¯åŒæ–¹å„è‡ªç”Ÿæˆè‡ªå·±çš„ç§é’¥å’Œå…¬é’¥ï¼Œç§é’¥ä»…å¯¹è‡ªå·±å¯è§ï¼Œç„¶åäº¤æ¢å…¬é’¥ï¼Œå¹¶æ ¹æ®è‡ªå·±çš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥ï¼Œç”Ÿæˆæœ€ç»ˆçš„å¯†é’¥ <code>secretKey</code>ï¼ŒDH ç®—æ³•é€šè¿‡æ•°å­¦å®šå¾‹ä¿è¯äº†åŒæ–¹å„è‡ªè®¡ç®—å‡ºçš„ <code>secretKey</code> æ˜¯ç›¸åŒçš„ã€‚</p><p>ä½¿ç”¨ Java å®ç° DH ç®—æ³•çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigInteger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">KeyAgreement</span></span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Bob å’Œ Alice:</span>
        <span class="token class-name">Person</span> bob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Person</span> alice <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å„è‡ªç”Ÿæˆ KeyPair:</span>
        bob<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        alice<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åŒæ–¹äº¤æ¢å„è‡ªçš„ PublicKey:</span>
        <span class="token comment">// Bob æ ¹æ® Alice çš„ PublicKey ç”Ÿæˆè‡ªå·±çš„æœ¬åœ°å¯†é’¥:</span>
        bob<span class="token punctuation">.</span><span class="token function">generateSecretKey</span><span class="token punctuation">(</span>alice<span class="token punctuation">.</span>publicKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Alice æ ¹æ® Bob çš„ PublicKey ç”Ÿæˆè‡ªå·±çš„æœ¬åœ°å¯†é’¥:</span>
        alice<span class="token punctuation">.</span><span class="token function">generateSecretKey</span><span class="token punctuation">(</span>bob<span class="token punctuation">.</span>publicKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ£€æŸ¥åŒæ–¹çš„æœ¬åœ°å¯†é’¥æ˜¯å¦ç›¸åŒ:</span>
        bob<span class="token punctuation">.</span><span class="token function">printKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        alice<span class="token punctuation">.</span><span class="token function">printKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŒæ–¹çš„ SecretKey ç›¸åŒï¼Œåç»­é€šä¿¡å°†ä½¿ç”¨ SecretKey ä½œä¸ºå¯†é’¥è¿›è¡Œ AES åŠ è§£å¯†...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PublicKey</span> publicKey<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">PrivateKey</span> privateKey<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> secretKey<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç”Ÿæˆæœ¬åœ° KeyPair:</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">KeyPairGenerator</span> kpGen <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            kpGen<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">KeyPair</span> kp <span class="token operator">=</span> kpGen<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>privateKey <span class="token operator">=</span> kp<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>publicKey <span class="token operator">=</span> kp<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">GeneralSecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateSecretKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> receivedPubKeyBytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// ä» byte[] æ¢å¤ PublicKey:</span>
            <span class="token class-name">X509EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>receivedPubKeyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">KeyFactory</span> kf <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">PublicKey</span> receivedPublicKey <span class="token operator">=</span> kf<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// ç”Ÿæˆæœ¬åœ°å¯†é’¥:</span>
            <span class="token class-name">KeyAgreement</span> keyAgreement <span class="token operator">=</span> <span class="token class-name">KeyAgreement</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            keyAgreement<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è‡ªå·±çš„ PrivateKey</span>
            keyAgreement<span class="token punctuation">.</span><span class="token function">doPhase</span><span class="token punctuation">(</span>receivedPublicKey<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯¹æ–¹çš„ PublicKey</span>
            <span class="token comment">// ç”Ÿæˆ SecretKey å¯†é’¥:</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>secretKey <span class="token operator">=</span> keyAgreement<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">GeneralSecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Name: %s\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Private key: %x\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>privateKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Public key: %x\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>publicKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Secret key: %x\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>secretKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯ DH ç®—æ³•å¹¶æœªè§£å†³ä¸­é—´äººæ”»å‡»ï¼Œå³ç”²ä¹™åŒæ–¹å¹¶ä¸èƒ½ç¡®ä¿ä¸è‡ªå·±é€šä¿¡çš„æ˜¯å¦çœŸçš„æ˜¯å¯¹æ–¹ã€‚æ¶ˆé™¤ä¸­é—´äººæ”»å‡»éœ€è¦å…¶ä»–æ–¹æ³•ã€‚</p><h2 id="ğŸ€-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç»ƒä¹ " aria-hidden="true">#</a> ğŸ€ ç»ƒä¹ </h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itranswarp<span class="token punctuation">.</span>learnjava</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigInteger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">KeyAgreement</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Learn Java from https://www.liaoxuefeng.com/
 *
 * <span class="token keyword">@author</span> liaoxuefeng
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// Bob å’Œ Alice:</span>
		<span class="token class-name">Person</span> bob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Person</span> alice <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// å„è‡ªç”Ÿæˆ KeyPair:</span>
		bob<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		alice<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// åŒæ–¹äº¤æ¢å„è‡ªçš„ PublicKey:</span>
		<span class="token comment">// Bob æ ¹æ® Alice çš„ PublicKey ç”Ÿæˆè‡ªå·±çš„æœ¬åœ°å¯†é’¥:</span>
		bob<span class="token punctuation">.</span><span class="token function">generateSecretKey</span><span class="token punctuation">(</span>alice<span class="token punctuation">.</span>publicKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// Alice æ ¹æ® Bob çš„ PublicKey ç”Ÿæˆè‡ªå·±çš„æœ¬åœ°å¯†é’¥:</span>
		alice<span class="token punctuation">.</span><span class="token function">generateSecretKey</span><span class="token punctuation">(</span>bob<span class="token punctuation">.</span>publicKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// æ£€æŸ¥åŒæ–¹çš„æœ¬åœ°å¯†é’¥æ˜¯å¦ç›¸åŒ:</span>
		bob<span class="token punctuation">.</span><span class="token function">printKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		alice<span class="token punctuation">.</span><span class="token function">printKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// åŒæ–¹çš„ SecretKey ç›¸åŒï¼Œåç»­é€šä¿¡å°†ä½¿ç”¨ SecretKey ä½œä¸ºå¯†é’¥è¿›è¡Œ AES åŠ è§£å¯†...</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">PublicKey</span> publicKey<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token class-name">PrivateKey</span> privateKey<span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> secretKey<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ç”Ÿæˆæœ¬åœ° KeyPair:</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token class-name">KeyPairGenerator</span> kpGen <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			kpGen<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">KeyPair</span> kp <span class="token operator">=</span> kpGen<span class="token punctuation">.</span><span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>privateKey <span class="token operator">=</span> kp<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>publicKey <span class="token operator">=</span> kp<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">GeneralSecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateSecretKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> receivedPubKeyBytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token comment">// ä» byte[] æ¢å¤ PublicKey:</span>
			<span class="token class-name">X509EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>receivedPubKeyBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">KeyFactory</span> kf <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">PublicKey</span> receivedPublicKey <span class="token operator">=</span> kf<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// ç”Ÿæˆæœ¬åœ°å¯†é’¥:</span>
			<span class="token class-name">KeyAgreement</span> keyAgreement <span class="token operator">=</span> <span class="token class-name">KeyAgreement</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			keyAgreement<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è‡ªå·±çš„ PrivateKey</span>
			keyAgreement<span class="token punctuation">.</span><span class="token function">doPhase</span><span class="token punctuation">(</span>receivedPublicKey<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯¹æ–¹çš„ PublicKey</span>
			<span class="token comment">// ç”Ÿæˆ SecretKey å¯†é’¥:</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>secretKey <span class="token operator">=</span> keyAgreement<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">GeneralSecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Name: %s\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Private key: %x\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>privateKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Public key: %x\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>publicKey<span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Secret key: %x\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>secretKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>DH ç®—æ³•æ˜¯ä¸€ç§å¯†é’¥äº¤æ¢åè®®ï¼Œé€šä¿¡åŒæ–¹é€šè¿‡ä¸å®‰å…¨çš„ä¿¡é“åå•†å¯†é’¥ï¼Œç„¶åè¿›è¡Œå¯¹ç§°åŠ å¯†ä¼ è¾“ã€‚</p><p>DH ç®—æ³•æ²¡æœ‰è§£å†³ä¸­é—´äººæ”»å‡»ã€‚</p>`,18);function v(b,y){const s=c("router-link");return o(),l("div",null,[n("details",k,[r,n("nav",d,[n("ul",null,[n("li",null,[a(s,{to:"#ğŸ€-ç»ƒä¹ "},{default:t(()=>[p("ğŸ€ ç»ƒä¹ ")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å°ç»“"},{default:t(()=>[p("ğŸ€ å°ç»“")]),_:1})])])])]),m])}const K=e(u,[["render",v],["__file","7.html.vue"]]);export{K as default};
