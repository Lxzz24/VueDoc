import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as e,c,a as n,b as t,w as p,d as i,e as l}from"./app-CvlAI_tu.js";const u={},d={class:"hint-container details"},k=n("summary",null,"ç›®å½•",-1),r={class:"table-of-contents"},v=i(`<p>ä½¿ç”¨ <code>ReentrantLock</code> æ¯”ç›´æ¥ä½¿ç”¨ <code>synchronized</code> æ›´å®‰å…¨ï¼Œå¯ä»¥æ›¿ä»£ <code>synchronized</code> è¿›è¡Œçº¿ç¨‹åŒæ­¥ã€‚</p><p>ä½†æ˜¯ï¼Œ<code>synchronized</code> å¯ä»¥é…åˆ <code>wait</code> å’Œ <code>notify</code> å®ç°çº¿ç¨‹åœ¨æ¡ä»¶ä¸æ»¡è¶³æ—¶ç­‰å¾…ï¼Œæ¡ä»¶æ»¡è¶³æ—¶å”¤é†’ï¼Œç”¨ <code>ReentrantLock</code> æˆ‘ä»¬æ€ä¹ˆç¼–å†™ <code>wait</code> å’Œ <code>notify</code> çš„åŠŸèƒ½å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ä½¿ç”¨ <code>Condition</code> å¯¹è±¡æ¥å®ç° <code>wait</code> å’Œ <code>notify</code> çš„åŠŸèƒ½ã€‚</p><p>æˆ‘ä»¬ä»ç„¶ä»¥ <code>TaskQueue</code> ä¸ºä¾‹ï¼ŒæŠŠå‰é¢ç”¨ <code>synchronized</code> å®ç°çš„åŠŸèƒ½é€šè¿‡ <code>ReentrantLock</code> å’Œ <code>Condition</code> æ¥å®ç°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">TaskQueue</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Condition</span> condition <span class="token operator">=</span> lock<span class="token punctuation">.</span><span class="token function">newCondition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
            condition<span class="token punctuation">.</span><span class="token function">signalAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                condition<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> queue<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯è§ï¼Œä½¿ç”¨ <code>Condition</code> æ—¶ï¼Œå¼•ç”¨çš„ <code>Condition</code> å¯¹è±¡å¿…é¡»ä» <code>Lock</code> å®ä¾‹çš„ <code>newCondition()</code> è¿”å›ï¼Œè¿™æ ·æ‰èƒ½è·å¾—ä¸€ä¸ªç»‘å®šäº† <code>Lock</code> å®ä¾‹çš„ <code>Condition</code> å®ä¾‹ã€‚</p><p><code>Condition</code> æä¾›çš„ <code>await()</code>ã€<code>signal()</code>ã€<code>signalAll()</code> åŸç†å’Œ <code>synchronized</code> é”å¯¹è±¡çš„ <code>wait()</code>ã€<code>notify()</code>ã€<code>notifyAll()</code> æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸”å…¶è¡Œä¸ºä¹Ÿæ˜¯ä¸€æ ·çš„ï¼š</p><ul><li><code>await()</code> ä¼šé‡Šæ”¾å½“å‰é”ï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼›</li><li><code>signal()</code> ä¼šå”¤é†’æŸä¸ªç­‰å¾…çº¿ç¨‹ï¼›</li><li><code>signalAll()</code> ä¼šå”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ï¼›</li><li>å”¤é†’çº¿ç¨‹ä» <code>await()</code> è¿”å›åéœ€è¦é‡æ–°è·å¾—é”ã€‚</li></ul><p>æ­¤å¤–ï¼Œå’Œ <code>tryLock()</code> ç±»ä¼¼ï¼Œ<code>await()</code> å¯ä»¥åœ¨ç­‰å¾…æŒ‡å®šæ—¶é—´åï¼Œå¦‚æœè¿˜æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹é€šè¿‡ <code>signal()</code> æˆ– <code>signalAll()</code> å”¤é†’ï¼Œå¯ä»¥è‡ªå·±é†’æ¥ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>condition<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECOND</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¢«å…¶ä»–çº¿ç¨‹å”¤é†’</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹å”¤é†’</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯è§ï¼Œä½¿ç”¨ <code>Condition</code> é…åˆ <code>Lock</code>ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°æ›´çµæ´»çš„çº¿ç¨‹åŒæ­¥ã€‚</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p><code>Condition</code> å¯ä»¥æ›¿ä»£ <code>wait</code> å’Œ <code>notify</code>ï¼›</p><p><code>Condition</code> å¯¹è±¡å¿…é¡»ä» <code>Lock</code> å¯¹è±¡è·å–ã€‚</p>`,14);function m(b,w){const s=o("router-link");return e(),c("div",null,[n("details",d,[k,n("nav",r,[n("ul",null,[n("li",null,[t(s,{to:"#ğŸ€-å°ç»“"},{default:p(()=>[l("ğŸ€ å°ç»“")]),_:1})])])])]),v])}const _=a(u,[["render",m],["__file","11.html.vue"]]);export{_ as default};
