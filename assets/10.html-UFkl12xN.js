import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as e,o as c,c as o,a as n,b as t,w as p,d as l,e as i}from"./app-CvlAI_tu.js";const d={},u={class:"hint-container details"},k=n("summary",null,"ç›®å½•",-1),r={class:"table-of-contents"},v=l(`<p>ä» Java 5 å¼€å§‹ï¼Œå¼•å…¥äº†ä¸€ä¸ªé«˜çº§çš„å¤„ç†å¹¶å‘çš„ <code>java.util.concurrent</code> åŒ…ï¼Œå®ƒæä¾›äº†å¤§é‡æ›´é«˜çº§çš„å¹¶å‘åŠŸèƒ½ï¼Œèƒ½å¤§å¤§ç®€åŒ–å¤šçº¿ç¨‹ç¨‹åºçš„ç¼–å†™ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ Java è¯­è¨€ç›´æ¥æä¾›äº† <code>synchronized</code> å…³é”®å­—ç”¨äºåŠ é”ï¼Œä½†è¿™ç§é”ä¸€æ˜¯å¾ˆé‡ï¼ŒäºŒæ˜¯è·å–æ—¶å¿…é¡»ä¸€ç›´ç­‰å¾…ï¼Œæ²¡æœ‰é¢å¤–çš„å°è¯•æœºåˆ¶ã€‚</p><p><code>java.util.concurrent.locks</code> åŒ…æä¾›çš„ <code>ReentrantLock</code> ç”¨äºæ›¿ä»£ <code>synchronized</code> åŠ é”ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¼ ç»Ÿçš„ <code>synchronized</code> ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœç”¨ <code>ReentrantLock</code> æ›¿ä»£ï¼Œå¯ä»¥æŠŠä»£ç æ”¹é€ ä¸ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Lock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› ä¸º <code>synchronized</code> æ˜¯ Java è¯­è¨€å±‚é¢æä¾›çš„è¯­æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦è€ƒè™‘å¼‚å¸¸ï¼Œè€Œ <code>ReentrantLock</code> æ˜¯ Java ä»£ç å®ç°çš„é”ï¼Œæˆ‘ä»¬å°±å¿…é¡»å…ˆè·å–é”ï¼Œç„¶ååœ¨ <code>finally</code> ä¸­æ­£ç¡®é‡Šæ”¾é”ã€‚</p><p>é¡¾åæ€ä¹‰ï¼Œ<code>ReentrantLock</code> æ˜¯å¯é‡å…¥é”ï¼Œå®ƒå’Œ <code>synchronized</code> ä¸€æ ·ï¼Œä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å–åŒä¸€ä¸ªé”ã€‚</p><p>å’Œ <code>synchronized</code> ä¸åŒçš„æ˜¯ï¼Œ<code>ReentrantLock</code> å¯ä»¥å°è¯•è·å–é”ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šè¿°ä»£ç åœ¨å°è¯•è·å–é”çš„æ—¶å€™ï¼Œæœ€å¤šç­‰å¾… 1 ç§’ã€‚å¦‚æœ 1 ç§’åä»æœªè·å–åˆ°é”ï¼Œ<code>tryLock()</code> è¿”å› <code>false</code>ï¼Œç¨‹åºå°±å¯ä»¥åšä¸€äº›é¢å¤–å¤„ç†ï¼Œè€Œä¸æ˜¯æ— é™ç­‰å¾…ä¸‹å»ã€‚</p><p>æ‰€ä»¥ï¼Œä½¿ç”¨ <code>ReentrantLock</code> æ¯”ç›´æ¥ä½¿ç”¨ <code>synchronized</code> æ›´å®‰å…¨ï¼Œçº¿ç¨‹åœ¨ <code>tryLock()</code> å¤±è´¥çš„æ—¶å€™ä¸ä¼šå¯¼è‡´æ­»é”ã€‚</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p><code>ReentrantLock</code> å¯ä»¥æ›¿ä»£ <code>synchronized</code> è¿›è¡ŒåŒæ­¥ï¼›</p><p><code>ReentrantLock</code> è·å–é”æ›´å®‰å…¨ï¼›</p><p>å¿…é¡»å…ˆè·å–åˆ°é”ï¼Œå†è¿›å…¥ <code>try {...}</code> ä»£ç å—ï¼Œæœ€åä½¿ç”¨ <code>finally</code> ä¿è¯é‡Šæ”¾é”ï¼›</p><p>å¯ä»¥ä½¿ç”¨ <code>tryLock()</code> å°è¯•è·å–é”ã€‚</p>`,17);function m(y,b){const s=e("router-link");return c(),o("div",null,[n("details",u,[k,n("nav",r,[n("ul",null,[n("li",null,[t(s,{to:"#ğŸ€-å°ç»“"},{default:p(()=>[i("ğŸ€ å°ç»“")]),_:1})])])])]),v])}const _=a(d,[["render",m],["__file","10.html.vue"]]);export{_ as default};
