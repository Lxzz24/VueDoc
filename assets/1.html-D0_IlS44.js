import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o as u,c as r,a as s,b as a,w as t,e as n,d as l}from"./app-CvlAI_tu.js";const k="/VueDoc/assets/l-20231220145145867-C585lgaO.jpeg",d="/VueDoc/assets/l-20231220145145950-V9C2ArEU.jpeg",v="/VueDoc/assets/l-20231220145145930-DpFmlY4y.jpeg",m={},T={class:"hint-container details"},b=s("summary",null,"ç›®å½•",-1),h={class:"table-of-contents"},g=l('<p>ä»Šå¤©æˆ‘ä»¬è®¿é—®ç½‘ç«™ï¼Œä½¿ç”¨ App æ—¶ï¼Œéƒ½æ˜¯åŸºäº Web è¿™ç§ Browser/Server æ¨¡å¼ï¼Œç®€ç§° BS æ¶æ„ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼Œå®¢æˆ·ç«¯åªéœ€è¦æµè§ˆå™¨ï¼Œåº”ç”¨ç¨‹åºçš„é€»è¾‘å’Œæ•°æ®éƒ½å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ã€‚æµè§ˆå™¨åªéœ€è¦è¯·æ±‚æœåŠ¡å™¨ï¼Œè·å– Web é¡µé¢ï¼Œå¹¶æŠŠ Web é¡µé¢å±•ç¤ºç»™ç”¨æˆ·å³å¯ã€‚</p><p>Web é¡µé¢å…·æœ‰æå¼ºçš„äº¤äº’æ€§ã€‚ç”±äº Web é¡µé¢æ˜¯ç”¨ HTML ç¼–å†™çš„ï¼Œè€Œ HTML å…·å¤‡è¶…å¼ºçš„è¡¨ç°åŠ›ï¼Œå¹¶ä¸”ï¼ŒæœåŠ¡å™¨ç«¯å‡çº§åï¼Œå®¢æˆ·ç«¯æ— éœ€ä»»ä½•éƒ¨ç½²å°±å¯ä»¥ä½¿ç”¨åˆ°æ–°çš„ç‰ˆæœ¬ï¼Œå› æ­¤ï¼ŒBS æ¶æ„å‡çº§éå¸¸å®¹æ˜“ã€‚</p><h2 id="ğŸ€-http-åè®®" tabindex="-1"><a class="header-anchor" href="#ğŸ€-http-åè®®" aria-hidden="true">#</a> ğŸ€ HTTP åè®®</h2><p>åœ¨ Web åº”ç”¨ä¸­ï¼Œæµè§ˆå™¨è¯·æ±‚ä¸€ä¸ª URLï¼ŒæœåŠ¡å™¨å°±æŠŠç”Ÿæˆçš„ HTML ç½‘é¡µå‘é€ç»™æµè§ˆå™¨ï¼Œè€Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ä¼ è¾“åè®®æ˜¯ HTTPï¼Œæ‰€ä»¥ï¼š</p><ul><li>HTML æ˜¯ä¸€ç§ç”¨æ¥å®šä¹‰ç½‘é¡µçš„æ–‡æœ¬ï¼Œä¼š HTMLï¼Œå°±å¯ä»¥ç¼–å†™ç½‘é¡µï¼›</li><li>HTTP æ˜¯åœ¨ç½‘ç»œä¸Šä¼ è¾“ HTML çš„åè®®ï¼Œç”¨äºæµè§ˆå™¨å’ŒæœåŠ¡å™¨çš„é€šä¿¡ã€‚</li></ul><p>HTTP åè®®æ˜¯ä¸€ä¸ªåŸºäº TCP åè®®ä¹‹ä¸Šçš„è¯·æ±‚ - å“åº”åè®®ï¼Œå®ƒéå¸¸ç®€å•ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨ Chrome æµè§ˆå™¨æŸ¥çœ‹æ–°æµªé¦–é¡µï¼Œç„¶åé€‰æ‹© View - Developer - Inspect Elements å°±å¯ä»¥çœ‹åˆ° HTMLï¼š</p><figure><img src="'+k+'" alt="html" tabindex="0" loading="lazy"><figcaption>html</figcaption></figure><p>åˆ‡æ¢åˆ° Networkï¼Œé‡æ–°åŠ è½½é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨å‘å‡ºçš„æ¯ä¸€ä¸ªè¯·æ±‚å’Œå“åº”ï¼š</p><figure><img src="'+d+`" alt="http" tabindex="0" loading="lazy"><figcaption>http</figcaption></figure><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>ä½¿ç”¨ Chrome æµè§ˆå™¨å¯ä»¥æ–¹ä¾¿åœ°è°ƒè¯• Web åº”ç”¨ç¨‹åºã€‚</p></div><p>å¯¹äº Browser æ¥è¯´ï¼Œè¯·æ±‚é¡µé¢çš„æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>ä¸æœåŠ¡å™¨å»ºç«‹ TCP è¿æ¥ï¼›</li><li>å‘é€ HTTP è¯·æ±‚ï¼›</li><li>æ”¶å– HTTP å“åº”ï¼Œç„¶åæŠŠç½‘é¡µåœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºå‡ºæ¥ã€‚</li></ol><p>æµè§ˆå™¨å‘é€çš„ HTTP è¯·æ±‚å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token constant">GET</span> <span class="token operator">/</span> <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
<span class="token class-name">Host</span><span class="token operator">:</span> www<span class="token punctuation">.</span>sina<span class="token punctuation">.</span>com<span class="token punctuation">.</span>cn
<span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> xxx
<span class="token class-name">Accept</span><span class="token operator">:</span> <span class="token operator">*</span><span class="token comment">/*
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¶ä¸­ï¼Œç¬¬ä¸€è¡Œè¡¨ç¤ºä½¿ç”¨ <code>GET</code> è¯·æ±‚è·å–è·¯å¾„ä¸º <code>/</code> çš„èµ„æºï¼Œå¹¶ä½¿ç”¨ <code>HTTP/1.1</code> åè®®ï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œæ¯è¡Œéƒ½æ˜¯ä»¥ <code>Header: Value</code> å½¢å¼è¡¨ç¤ºçš„ HTTP å¤´ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„ HTTP Header åŒ…æ‹¬ï¼š</p><ul><li>Host: è¡¨ç¤ºè¯·æ±‚çš„ä¸»æœºåï¼Œå› ä¸ºä¸€ä¸ªæœåŠ¡å™¨ä¸Šå¯èƒ½è¿è¡Œç€å¤šä¸ªç½‘ç«™ï¼Œå› æ­¤ï¼ŒHost è¡¨ç¤ºæµè§ˆå™¨æ­£åœ¨è¯·æ±‚çš„åŸŸåï¼›</li><li>User-Agent: æ ‡è¯†å®¢æˆ·ç«¯æœ¬èº«ï¼Œä¾‹å¦‚ Chrome æµè§ˆå™¨çš„æ ‡è¯†ç±»ä¼¼ <code>Mozilla/5.0 ... Chrome/79</code>ï¼ŒIE æµè§ˆå™¨çš„æ ‡è¯†ç±»ä¼¼ <code>Mozilla/5.0 (Windows NT ...) like Gecko</code>ï¼›</li><li>Acceptï¼šè¡¨ç¤ºæµè§ˆå™¨èƒ½æ¥æ”¶çš„èµ„æºç±»å‹ï¼Œå¦‚ <code>text/*</code>ï¼Œ<code>image/*</code> æˆ–è€… <code>*/*</code> è¡¨ç¤ºæ‰€æœ‰ï¼›</li><li>Accept-Languageï¼šè¡¨ç¤ºæµè§ˆå™¨åå¥½çš„è¯­è¨€ï¼ŒæœåŠ¡å™¨å¯ä»¥æ®æ­¤è¿”å›ä¸åŒè¯­è¨€çš„ç½‘é¡µï¼›</li><li>Accept-Encodingï¼šè¡¨ç¤ºæµè§ˆå™¨å¯ä»¥æ”¯æŒçš„å‹ç¼©ç±»å‹ï¼Œä¾‹å¦‚ <code>gzip, deflate, br</code>ã€‚</li></ul><p>æœåŠ¡å™¨çš„å“åº”å¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>HTTP/1.1 <span class="token number">200</span> OK
Content-Type: text/html
Content-Length: <span class="token number">21932</span>
Content-Encoding: <span class="token function">gzip</span>
Cache-Control: max-age<span class="token operator">=</span><span class="token number">300</span>

<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span><span class="token punctuation">..</span>. ç½‘é¡µæ•°æ®<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœåŠ¡å™¨å“åº”çš„ç¬¬ä¸€è¡Œæ€»æ˜¯ç‰ˆæœ¬å· + ç©ºæ ¼ + æ•°å­— + ç©ºæ ¼ + æ–‡æœ¬ï¼Œæ•°å­—è¡¨ç¤ºå“åº”ä»£ç ï¼Œå…¶ä¸­ <code>2xx</code> è¡¨ç¤ºæˆåŠŸï¼Œ<code>3xx</code> è¡¨ç¤ºé‡å®šå‘ï¼Œ<code>4xx</code> è¡¨ç¤ºå®¢æˆ·ç«¯å¼•å‘çš„é”™è¯¯ï¼Œ<code>5xx</code> è¡¨ç¤ºæœåŠ¡å™¨ç«¯å¼•å‘çš„é”™è¯¯ã€‚æ•°å­—æ˜¯ç»™ç¨‹åºè¯†åˆ«ï¼Œæ–‡æœ¬åˆ™æ˜¯ç»™å¼€å‘è€…è°ƒè¯•ä½¿ç”¨çš„ã€‚å¸¸è§çš„å“åº”ä»£ç æœ‰ï¼š</p><ul><li><code>200 OK</code>ï¼šè¡¨ç¤ºæˆåŠŸï¼›</li><li><code>301 Moved Permanently</code>ï¼šè¡¨ç¤ºè¯¥ URL å·²ç»æ°¸ä¹…é‡å®šå‘ï¼›</li><li><code>302 Found</code>ï¼šè¡¨ç¤ºè¯¥ URL éœ€è¦ä¸´æ—¶é‡å®šå‘ï¼›</li><li><code>304 Not Modified</code>ï¼šè¡¨ç¤ºè¯¥èµ„æºæ²¡æœ‰ä¿®æ”¹ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„ç‰ˆæœ¬ï¼›</li><li><code>400 Bad Request</code>ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªé”™è¯¯çš„è¯·æ±‚ï¼Œä¾‹å¦‚å‚æ•°æ— æ•ˆï¼›</li><li><code>401 Unauthorized</code>ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯å› ä¸ºèº«ä»½æœªéªŒè¯è€Œä¸å…è®¸è®¿é—®è¯¥ URLï¼›</li><li><code>403 Forbidden</code>ï¼šè¡¨ç¤ºæœåŠ¡å™¨å› ä¸ºæƒé™é—®é¢˜æ‹’ç»äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼›</li><li><code>404 Not Found</code>ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚äº†ä¸€ä¸ªä¸å­˜åœ¨çš„èµ„æºï¼›</li><li><code>500 Internal Server Error</code>ï¼šè¡¨ç¤ºæœåŠ¡å™¨å¤„ç†æ—¶å†…éƒ¨å‡ºé”™ï¼Œä¾‹å¦‚å› ä¸ºæ— æ³•è¿æ¥æ•°æ®åº“ï¼›</li><li><code>503 Service Unavailable</code>ï¼šè¡¨ç¤ºæœåŠ¡å™¨æ­¤åˆ»æš‚æ—¶æ— æ³•å¤„ç†è¯·æ±‚ã€‚</li></ul><p>ä»ç¬¬äºŒè¡Œå¼€å§‹ï¼ŒæœåŠ¡å™¨æ¯ä¸€è¡Œå‡è¿”å›ä¸€ä¸ª HTTP å¤´ã€‚æœåŠ¡å™¨ç»å¸¸è¿”å›çš„ HTTP Header åŒ…æ‹¬ï¼š</p><ul><li><code>Content-Type</code>ï¼šè¡¨ç¤ºè¯¥å“åº”å†…å®¹çš„ç±»å‹ï¼Œä¾‹å¦‚ <code>text/html</code>ï¼Œ<code>image/jpeg</code>ï¼›</li><li><code>Content-Length</code>ï¼šè¡¨ç¤ºè¯¥å“åº”å†…å®¹çš„é•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰ï¼›</li><li><code>Content-Encoding</code>ï¼šè¡¨ç¤ºè¯¥å“åº”å‹ç¼©ç®—æ³•ï¼Œä¾‹å¦‚ <code>gzip</code>ï¼›</li><li><code>Cache-Control</code>ï¼šæŒ‡ç¤ºå®¢æˆ·ç«¯åº”å¦‚ä½•ç¼“å­˜ï¼Œä¾‹å¦‚ <code>max-age=300</code> è¡¨ç¤ºå¯ä»¥æœ€å¤šç¼“å­˜ 300 ç§’ã€‚</li></ul><p>HTTP è¯·æ±‚å’Œå“åº”éƒ½ç”± HTTP Header å’Œ HTTP Body æ„æˆï¼Œå…¶ä¸­ HTTP Header æ¯è¡Œéƒ½ä»¥ <code>\\r\\n</code> ç»“æŸã€‚å¦‚æœé‡åˆ°ä¸¤ä¸ªè¿ç»­çš„ <code>\\r\\n</code>ï¼Œé‚£ä¹ˆåé¢å°±æ˜¯ HTTP Bodyã€‚æµè§ˆå™¨è¯»å– HTTP Bodyï¼Œå¹¶æ ¹æ® Header ä¿¡æ¯ä¸­æŒ‡ç¤ºçš„ <code>Content-Type</code>ã€<code>Content-Encoding</code> ç­‰è§£å‹åæ˜¾ç¤ºç½‘é¡µã€å›¾åƒæˆ–å…¶ä»–å†…å®¹ã€‚</p><p>é€šå¸¸æµè§ˆå™¨è·å–çš„ç¬¬ä¸€ä¸ªèµ„æºæ˜¯ HTML ç½‘é¡µï¼Œåœ¨ç½‘é¡µä¸­ï¼Œå¦‚æœåµŒå…¥äº† JavaScriptã€CSSã€å›¾ç‰‡ã€è§†é¢‘ç­‰å…¶ä»–èµ„æºï¼Œæµè§ˆå™¨ä¼šæ ¹æ®èµ„æºçš„ URL å†æ¬¡å‘æœåŠ¡å™¨è¯·æ±‚å¯¹åº”çš„èµ„æºã€‚</p>`,24),w={href:"https://www.amazon.cn/dp/B00M2DKYRC/",target:"_blank",rel:"noopener noreferrer"},f={href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP",target:"_blank",rel:"noopener noreferrer"},H=s("h2",{id:"ğŸ€-ç¼–å†™-http-server",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#ğŸ€-ç¼–å†™-http-server","aria-hidden":"true"},"#"),n(" ğŸ€ ç¼–å†™ HTTP Server")],-1),y=l(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServerSocket</span> ss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç›‘å¬æŒ‡å®šç«¯å£</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;server is running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Socket</span> sock <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;connected from&quot;</span> <span class="token operator">+</span> sock<span class="token punctuation">.</span><span class="token function">getRemoteSocketAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span>sock<span class="token punctuation">)</span><span class="token punctuation">;</span>
            t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Handler</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token class-name">Socket</span> sock<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token class-name">Socket</span> sock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sock <span class="token operator">=</span> sock<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> input <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sock<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">OutputStream</span> output <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sock<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">handle</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>sock<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ioe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;client disconnected.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> input<span class="token punctuation">,</span> <span class="token class-name">OutputStream</span> output<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// TODO: å¤„ç† HTTP è¯·æ±‚</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åªéœ€è¦åœ¨ <code>handle()</code> æ–¹æ³•ä¸­ï¼Œç”¨ Reader è¯»å– HTTP è¯·æ±‚ï¼Œç”¨ Writer å‘é€ HTTP å“åº”ï¼Œå³å¯å®ç°ä¸€ä¸ªæœ€ç®€å•çš„ HTTP æœåŠ¡å™¨ã€‚ç¼–å†™ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> input<span class="token punctuation">,</span> <span class="token class-name">OutputStream</span> output<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Process new http request...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¯»å– HTTP è¯·æ±‚:</span>
    <span class="token keyword">boolean</span> requestOk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> first <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;GET / HTTP/1.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        requestOk <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> header <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>header<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// è¯»å–åˆ°ç©ºè¡Œæ—¶, HTTP Header è¯»å–å®Œæ¯•</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>requestOk <span class="token operator">?</span> <span class="token string">&quot;Response OK&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Response Error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>requestOk<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å‘é€é”™è¯¯å“åº”:</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;HTTP/1.0 404 Not Found\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Length: 0\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// å‘é€æˆåŠŸå“åº”:</span>
        <span class="token class-name">String</span> data <span class="token operator">=</span> <span class="token string">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello, world!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> length <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;HTTP/1.0 200 OK\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Connection: close\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type: text/html\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Length:&quot;</span> <span class="token operator">+</span> length <span class="token operator">+</span> <span class="token string">&quot;\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;\\r\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç©ºè¡Œæ ‡è¯† Header å’Œ Body çš„åˆ†éš”</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„æ ¸å¿ƒä»£ç æ˜¯ï¼Œå…ˆè¯»å– HTTP è¯·æ±‚ï¼Œè¿™é‡Œæˆ‘ä»¬åªå¤„ç† <code>GET /</code> çš„è¯·æ±‚ã€‚å½“è¯»å–åˆ°ç©ºè¡Œæ—¶ï¼Œè¡¨ç¤ºå·²è¯»åˆ°è¿ç»­ä¸¤ä¸ª <code>\\r\\n</code>ï¼Œè¯´æ˜è¯·æ±‚ç»“æŸï¼Œå¯ä»¥å‘é€å“åº”ã€‚å‘é€å“åº”çš„æ—¶å€™ï¼Œé¦–å…ˆå‘é€å“åº”ä»£ç  <code>HTTP/1.0 200 OK</code> è¡¨ç¤ºä¸€ä¸ªæˆåŠŸçš„ 200 å“åº”ï¼Œä½¿ç”¨ <code>HTTP/1.0</code> åè®®ï¼Œç„¶åï¼Œä¾æ¬¡å‘é€ Headerï¼Œå‘é€å®Œ Header åï¼Œå†å‘é€ä¸€ä¸ªç©ºè¡Œæ ‡è¯† Header ç»“æŸï¼Œç´§æ¥ç€å‘é€ HTTP Bodyï¼Œåœ¨æµè§ˆå™¨è¾“å…¥ <code>http://local.liaoxuefeng.com:8080/</code> å°±å¯ä»¥çœ‹åˆ°å“åº”é¡µé¢ï¼š</p><figure><img src="`+v+'" alt="httpserver" tabindex="0" loading="lazy"><figcaption>httpserver</figcaption></figure><p>HTTP ç›®å‰æœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œ<code>1.0</code> æ˜¯æ—©æœŸç‰ˆæœ¬ï¼Œæµè§ˆå™¨æ¯æ¬¡å»ºç«‹ TCP è¿æ¥åï¼Œåªå‘é€ä¸€ä¸ª HTTP è¯·æ±‚å¹¶æ¥æ”¶ä¸€ä¸ª HTTP å“åº”ï¼Œç„¶åå°±å…³é—­ TCP è¿æ¥ã€‚ç”±äºåˆ›å»º TCP è¿æ¥æœ¬èº«å°±éœ€è¦æ¶ˆè€—ä¸€å®šçš„æ—¶é—´ï¼Œå› æ­¤ï¼ŒHTTP 1.1 å…è®¸æµè§ˆå™¨å’ŒæœåŠ¡å™¨åœ¨åŒä¸€ä¸ª TCP è¿æ¥ä¸Šåå¤å‘é€ã€æ¥æ”¶å¤šä¸ª HTTP è¯·æ±‚å’Œå“åº”ï¼Œè¿™æ ·å°±å¤§å¤§æé«˜äº†ä¼ è¾“æ•ˆç‡ã€‚</p><p>æˆ‘ä»¬æ³¨æ„åˆ° HTTP åè®®æ˜¯ä¸€ä¸ªè¯·æ±‚ - å“åº”åè®®ï¼Œå®ƒæ€»æ˜¯å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œç„¶åæ¥æ”¶ä¸€ä¸ªå“åº”ã€‚èƒ½ä¸èƒ½ä¸€æ¬¡æ€§å‘é€å¤šä¸ªè¯·æ±‚ï¼Œç„¶åå†æ¥æ”¶å¤šä¸ªå“åº”å‘¢ï¼ŸHTTP 2.0 å¯ä»¥æ”¯æŒæµè§ˆå™¨åŒæ—¶å‘å‡ºå¤šä¸ªè¯·æ±‚ï¼Œä½†æ¯ä¸ªè¯·æ±‚éœ€è¦å”¯ä¸€æ ‡è¯†ï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸æŒ‰è¯·æ±‚çš„é¡ºåºè¿”å›å¤šä¸ªå“åº”ï¼Œç”±æµè§ˆå™¨è‡ªå·±æŠŠæ”¶åˆ°çš„å“åº”å’Œè¯·æ±‚å¯¹åº”èµ·æ¥ã€‚å¯è§ï¼ŒHTTP 2.0 è¿›ä¸€æ­¥æé«˜äº†ä¼ è¾“æ•ˆç‡ï¼Œå› ä¸ºæµè§ˆå™¨å‘å‡ºä¸€ä¸ªè¯·æ±‚åï¼Œä¸å¿…ç­‰å¾…å“åº”ï¼Œå°±å¯ä»¥ç»§ç»­å‘ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚</p><p>HTTP 3.0 ä¸ºäº†è¿›ä¸€æ­¥æé«˜é€Ÿåº¦ï¼Œå°†æŠ›å¼ƒ TCP åè®®ï¼Œæ”¹ä¸ºä½¿ç”¨æ— éœ€åˆ›å»ºè¿æ¥çš„ UDP åè®®ï¼Œç›®å‰ HTTP 3.0 ä»ç„¶å¤„äºå®éªŒé˜¶æ®µã€‚</p><h2 id="ğŸ€-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç»ƒä¹ " aria-hidden="true">#</a> ğŸ€ ç»ƒä¹ </h2><p>ç¼–å†™ä¸€ä¸ªç®€å•çš„ HTTP æœåŠ¡å™¨</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>ä½¿ç”¨ B/S æ¶æ„æ—¶ï¼Œæ€»æ˜¯é€šè¿‡ HTTP åè®®å®ç°é€šä¿¡ï¼›</p><p>Web å¼€å‘é€šå¸¸æ˜¯æŒ‡å¼€å‘æœåŠ¡å™¨ç«¯çš„ Web åº”ç”¨ç¨‹åºã€‚</p>',13);function P(_,S){const e=p("router-link"),o=p("ExternalLinkIcon"),c=p("RouterLink");return u(),r("div",null,[s("details",T,[b,s("nav",h,[s("ul",null,[s("li",null,[a(e,{to:"#ğŸ€-http-åè®®"},{default:t(()=>[n("ğŸ€ HTTP åè®®")]),_:1})]),s("li",null,[a(e,{to:"#ğŸ€-ç¼–å†™-http-server"},{default:t(()=>[n("ğŸ€ ç¼–å†™ HTTP Server")]),_:1})]),s("li",null,[a(e,{to:"#ğŸ€-ç»ƒä¹ "},{default:t(()=>[n("ğŸ€ ç»ƒä¹ ")]),_:1})]),s("li",null,[a(e,{to:"#ğŸ€-å°ç»“"},{default:t(()=>[n("ğŸ€ å°ç»“")]),_:1})])])])]),g,s("p",null,[n("å…³äº HTTP åè®®çš„è¯¦ç»†å†…å®¹ï¼Œè¯·å‚è€ƒ "),s("a",w,[n("HTTP æƒå¨æŒ‡å—"),a(o)]),n(" ä¸€ä¹¦ï¼Œæˆ–è€…"),s("a",f,[n("Mozilla å¼€å‘è€…ç½‘ç«™"),a(o)]),n("ã€‚")]),s("p",null,[n("æˆ‘ä»¬åœ¨å‰é¢ä»‹ç»çš„ "),a(c,{to:"/1-Java/15_%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/6.html"},{default:t(()=>[n("HTTP ç¼–ç¨‹")]),_:1}),n(" æ˜¯ä»¥å®¢æˆ·ç«¯çš„èº«ä»½å»è¯·æ±‚æœåŠ¡å™¨èµ„æºã€‚ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä»¥æœåŠ¡å™¨çš„èº«ä»½å“åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œç¼–å†™æœåŠ¡å™¨ç¨‹åºæ¥å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚é€šå¸¸å°±ç§°ä¹‹ä¸º Web å¼€å‘ã€‚")]),H,s("p",null,[n("æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ç¼–å†™ HTTP Serverã€‚ä¸€ä¸ª HTTP Server æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª TCP æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å…ˆç”¨ "),a(c,{to:"/1-Java/15_%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/2.html"},{default:t(()=>[n("TCP ç¼–ç¨‹")]),_:1}),n(" çš„å¤šçº¿ç¨‹å®ç°çš„æœåŠ¡å™¨ç«¯æ¡†æ¶ï¼š")]),y])}const x=i(m,[["render",P],["__file","1.html.vue"]]);export{x as default};
