import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as c,o,c as l,a as n,b as a,w as t,d as u,e as p}from"./app-CvlAI_tu.js";const i="/VueDoc/assets/image-20231219105723473-Besa5ZE1.png",k="/VueDoc/assets/image-20231219110607652-CwnZ7HTF.png",r={},d={class:"hint-container details"},v=n("summary",null,"ç›®å½•",-1),m={class:"table-of-contents"},b=u('<p>åœ¨å¼€å‘ç½‘ç»œåº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬åˆä¼šé‡åˆ° Socket è¿™ä¸ªæ¦‚å¿µã€‚Socket æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œä¸€ä¸ªåº”ç”¨ç¨‹åºé€šè¿‡ä¸€ä¸ª Socket æ¥å»ºç«‹ä¸€ä¸ªè¿œç¨‹è¿æ¥ï¼Œè€Œ Socket å†…éƒ¨é€šè¿‡ TCP/IP åè®®æŠŠæ•°æ®ä¼ è¾“åˆ°ç½‘ç»œï¼š</p><figure><img src="'+i+'" alt="image-20231219105723473" tabindex="0" loading="lazy"><figcaption>image-20231219105723473</figcaption></figure><p>Socketã€TCP å’Œéƒ¨åˆ† IP çš„åŠŸèƒ½éƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿæä¾›çš„ï¼Œä¸åŒçš„ç¼–ç¨‹è¯­è¨€åªæ˜¯æä¾›äº†å¯¹æ“ä½œç³»ç»Ÿè°ƒç”¨çš„ç®€å•çš„å°è£…ã€‚ä¾‹å¦‚ï¼ŒJava æä¾›çš„å‡ ä¸ª Socket ç›¸å…³çš„ç±»å°±å°è£…äº†æ“ä½œç³»ç»Ÿæä¾›çš„æ¥å£ã€‚</p><p><em>ä¸ºä»€ä¹ˆéœ€è¦ Socket è¿›è¡Œç½‘ç»œé€šä¿¡ï¼Ÿ</em></p><blockquote><p>å› ä¸ºä»…ä»…é€šè¿‡ IP åœ°å€è¿›è¡Œé€šä¿¡æ˜¯ä¸å¤Ÿçš„ï¼ŒåŒä¸€å°è®¡ç®—æœºåŒä¸€æ—¶é—´ä¼šè¿è¡Œå¤šä¸ªç½‘ç»œåº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚æµè§ˆå™¨ã€QQã€é‚®ä»¶å®¢æˆ·ç«¯ç­‰ã€‚å½“æ“ä½œç³»ç»Ÿæ¥æ”¶åˆ°ä¸€ä¸ªæ•°æ®åŒ…çš„æ—¶å€™ï¼Œå¦‚æœåªæœ‰ IP åœ°å€ï¼Œå®ƒæ²¡æ³•åˆ¤æ–­åº”è¯¥å‘ç»™å“ªä¸ªåº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥ï¼Œæ“ä½œç³»ç»ŸæŠ½è±¡å‡º Socket æ¥å£ï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºéœ€è¦å„è‡ªå¯¹åº”åˆ°ä¸åŒçš„ Socketï¼Œæ•°æ®åŒ…æ‰èƒ½æ ¹æ® Socket æ­£ç¡®åœ°å‘åˆ°å¯¹åº”çš„åº”ç”¨ç¨‹åºã€‚</p></blockquote><p>ä¸€ä¸ª Socket å°±æ˜¯ç”± IP åœ°å€å’Œç«¯å£å·ï¼ˆèŒƒå›´æ˜¯ 0ï½65535ï¼‰ç»„æˆï¼Œå¯ä»¥æŠŠ Socket ç®€å•ç†è§£ä¸º IP åœ°å€åŠ ç«¯å£å·ã€‚ç«¯å£å·æ€»æ˜¯ç”±æ“ä½œç³»ç»Ÿåˆ†é…ï¼Œå®ƒæ˜¯ä¸€ä¸ª 0ï½65535 ä¹‹é—´çš„æ•°å­—ï¼Œå…¶ä¸­ï¼Œå°äº 1024 çš„ç«¯å£å±äº <em>ç‰¹æƒç«¯å£</em>ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œå¤§äº 1024 çš„ç«¯å£å¯ä»¥ç”±ä»»æ„ç”¨æˆ·çš„åº”ç”¨ç¨‹åºæ‰“å¼€ã€‚</p><figure><img src="'+k+`" alt="image-20231219110607652" tabindex="0" loading="lazy"><figcaption>image-20231219110607652</figcaption></figure><p>ä½¿ç”¨ Socket è¿›è¡Œç½‘ç»œç¼–ç¨‹æ—¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„ç½‘ç»œé€šä¿¡ã€‚å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹å¿…é¡»å……å½“æœåŠ¡å™¨ç«¯ï¼Œå®ƒä¼šä¸»åŠ¨ç›‘å¬æŸä¸ªæŒ‡å®šçš„ç«¯å£ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹å¿…é¡»å……å½“å®¢æˆ·ç«¯ï¼Œå®ƒå¿…é¡»ä¸»åŠ¨è¿æ¥æœåŠ¡å™¨çš„ IP åœ°å€å’ŒæŒ‡å®šç«¯å£ï¼Œå¦‚æœè¿æ¥æˆåŠŸï¼ŒæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å°±æˆåŠŸåœ°å»ºç«‹äº†ä¸€ä¸ª TCP è¿æ¥ï¼ŒåŒæ–¹åç»­å°±å¯ä»¥éšæ—¶å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚</p><p>å› æ­¤ï¼Œå½“ Socket è¿æ¥æˆåŠŸåœ°åœ¨æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ä¹‹é—´å»ºç«‹åï¼š</p><ul><li>å¯¹æœåŠ¡å™¨ç«¯æ¥è¯´ï¼Œå®ƒçš„ Socket æ˜¯æŒ‡å®šçš„ IP åœ°å€å’ŒæŒ‡å®šçš„ç«¯å£å·ï¼›</li><li>å¯¹å®¢æˆ·ç«¯æ¥è¯´ï¼Œå®ƒçš„ Socket æ˜¯å®ƒæ‰€åœ¨è®¡ç®—æœºçš„ IP åœ°å€å’Œä¸€ä¸ªç”±æ“ä½œç³»ç»Ÿåˆ†é…çš„éšæœºç«¯å£å·ã€‚</li></ul><h2 id="ğŸ€-æœåŠ¡å™¨ç«¯" tabindex="-1"><a class="header-anchor" href="#ğŸ€-æœåŠ¡å™¨ç«¯" aria-hidden="true">#</a> ğŸ€ æœåŠ¡å™¨ç«¯</h2><p>è¦ä½¿ç”¨ Socket ç¼–ç¨‹ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ç¼–å†™æœåŠ¡å™¨ç«¯ç¨‹åºã€‚Java æ ‡å‡†åº“æä¾›äº† <code>ServerSocket</code> æ¥å®ç°å¯¹æŒ‡å®š IP å’ŒæŒ‡å®šç«¯å£çš„ç›‘å¬ã€‚<code>ServerSocket</code> çš„å…¸å‹å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ServerSocket</span> ss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç›‘å¬æŒ‡å®šç«¯å£</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;server is running...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Socket</span> sock <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;connected from&quot;</span> <span class="token operator">+</span> sock<span class="token punctuation">.</span><span class="token function">getRemoteSocketAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span>sock<span class="token punctuation">)</span><span class="token punctuation">;</span>
            t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Handler</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token class-name">Socket</span> sock<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token class-name">Socket</span> sock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sock <span class="token operator">=</span> sock<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> input <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sock<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">OutputStream</span> output <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sock<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">handle</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>sock<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ioe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;client disconnected.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> input<span class="token punctuation">,</span> <span class="token class-name">OutputStream</span> output<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;hello\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> s <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;bye&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;bye\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;ok:&quot;</span> <span class="token operator">+</span> s <span class="token operator">+</span> <span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœåŠ¡å™¨ç«¯é€šè¿‡ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">ServerSocket</span> ss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨æŒ‡å®šç«¯å£ <code>6666</code> ç›‘å¬ã€‚è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰æŒ‡å®š IP åœ°å€ï¼Œè¡¨ç¤ºåœ¨è®¡ç®—æœºçš„æ‰€æœ‰ç½‘ç»œæ¥å£ä¸Šè¿›è¡Œç›‘å¬ã€‚</p><p>å¦‚æœ <code>ServerSocket</code> ç›‘å¬æˆåŠŸï¼Œæˆ‘ä»¬å°±ä½¿ç”¨ä¸€ä¸ªæ— é™å¾ªç¯æ¥å¤„ç†å®¢æˆ·ç«¯çš„è¿æ¥ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Socket</span> sock <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span>sock<span class="token punctuation">)</span><span class="token punctuation">;</span>
    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„åˆ°ä»£ç  <code>ss.accept()</code> è¡¨ç¤ºæ¯å½“æœ‰æ–°çš„å®¢æˆ·ç«¯è¿æ¥è¿›æ¥åï¼Œå°±è¿”å›ä¸€ä¸ª <code>Socket</code> å®ä¾‹ï¼Œè¿™ä¸ª <code>Socket</code> å®ä¾‹å°±æ˜¯ç”¨æ¥å’Œåˆšè¿æ¥çš„å®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡çš„ã€‚ç”±äºå®¢æˆ·ç«¯å¾ˆå¤šï¼Œè¦å®ç°å¹¶å‘å¤„ç†ï¼Œæˆ‘ä»¬å°±å¿…é¡»ä¸ºæ¯ä¸ªæ–°çš„ <code>Socket</code> åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥å¤„ç†ï¼Œè¿™æ ·ï¼Œä¸»çº¿ç¨‹çš„ä½œç”¨å°±æ˜¯æ¥æ”¶æ–°çš„è¿æ¥ï¼Œæ¯å½“æ”¶åˆ°æ–°è¿æ¥åï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚</p><p>æˆ‘ä»¬åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹çš„ç« èŠ‚ä¸­ä»‹ç»è¿‡çº¿ç¨‹æ± ï¼Œè¿™é‡Œä¹Ÿå®Œå…¨å¯ä»¥åˆ©ç”¨çº¿ç¨‹æ± æ¥å¤„ç†å®¢æˆ·ç«¯è¿æ¥ï¼Œèƒ½å¤§å¤§æé«˜è¿è¡Œæ•ˆç‡ã€‚</p><p>å¦‚æœæ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥è¿›æ¥ï¼Œ<code>accept()</code> æ–¹æ³•ä¼šé˜»å¡å¹¶ä¸€ç›´ç­‰å¾…ã€‚å¦‚æœæœ‰å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶è¿æ¥è¿›æ¥ï¼Œ<code>ServerSocket</code> ä¼šæŠŠè¿æ¥æ‰”åˆ°é˜Ÿåˆ—é‡Œï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªå¤„ç†ã€‚å¯¹äº Java ç¨‹åºè€Œè¨€ï¼Œåªéœ€è¦é€šè¿‡å¾ªç¯ä¸æ–­è°ƒç”¨ <code>accept()</code> å°±å¯ä»¥è·å–æ–°çš„è¿æ¥ã€‚</p><h2 id="ğŸ€-å®¢æˆ·ç«¯" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å®¢æˆ·ç«¯" aria-hidden="true">#</a> ğŸ€ å®¢æˆ·ç«¯</h2><p>ç›¸æ¯”æœåŠ¡å™¨ç«¯ï¼Œå®¢æˆ·ç«¯ç¨‹åºå°±è¦ç®€å•å¾ˆå¤šã€‚ä¸€ä¸ªå…¸å‹çš„å®¢æˆ·ç«¯ç¨‹åºå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Socket</span> sock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿æ¥æŒ‡å®šæœåŠ¡å™¨å’Œç«¯å£</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> input <span class="token operator">=</span> sock<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">OutputStream</span> output <span class="token operator">=</span> sock<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">handle</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        sock<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;disconnected.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> input<span class="token punctuation">,</span> <span class="token class-name">OutputStream</span> output<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;[server]&quot;</span> <span class="token operator">+</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;&gt;&gt;&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‰“å°æç¤º</span>
            <span class="token class-name">String</span> s <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¯»å–ä¸€è¡Œè¾“å…¥</span>
            writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
            writer<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> resp <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;&lt;&lt;&quot;</span> <span class="token operator">+</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>resp<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;bye&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®¢æˆ·ç«¯ç¨‹åºé€šè¿‡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Socket</span> sock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¿æ¥åˆ°æœåŠ¡å™¨ç«¯ï¼Œæ³¨æ„ä¸Šè¿°ä»£ç çš„æœåŠ¡å™¨åœ°å€æ˜¯ <code>&quot;localhost&quot;</code>ï¼Œè¡¨ç¤ºæœ¬æœºåœ°å€ï¼Œç«¯å£å·æ˜¯ <code>6666</code>ã€‚å¦‚æœè¿æ¥æˆåŠŸï¼Œå°†è¿”å›ä¸€ä¸ª <code>Socket</code> å®ä¾‹ï¼Œç”¨äºåç»­é€šä¿¡ã€‚</p><h2 id="ğŸ€-socket-æµ" tabindex="-1"><a class="header-anchor" href="#ğŸ€-socket-æµ" aria-hidden="true">#</a> ğŸ€ Socket æµ</h2><p>å½“ Socket è¿æ¥åˆ›å»ºæˆåŠŸåï¼Œæ— è®ºæ˜¯æœåŠ¡å™¨ç«¯ï¼Œè¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨ <code>Socket</code> å®ä¾‹è¿›è¡Œç½‘ç»œé€šä¿¡ã€‚å› ä¸º TCP æ˜¯ä¸€ç§åŸºäºæµçš„åè®®ï¼Œå› æ­¤ï¼ŒJava æ ‡å‡†åº“ä½¿ç”¨ <code>InputStream</code> å’Œ <code>OutputStream</code> æ¥å°è£… Socket çš„æ•°æ®æµï¼Œè¿™æ ·æˆ‘ä»¬ä½¿ç”¨ Socket çš„æµï¼Œå’Œæ™®é€š IO æµç±»ä¼¼ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// ç”¨äºè¯»å–ç½‘ç»œæ•°æ®:</span>
<span class="token class-name">InputStream</span> in <span class="token operator">=</span> sock<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç”¨äºå†™å…¥ç½‘ç»œæ•°æ®:</span>
<span class="token class-name">OutputStream</span> out <span class="token operator">=</span> sock<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åæˆ‘ä»¬é‡ç‚¹æ¥çœ‹çœ‹ï¼Œä¸ºä»€ä¹ˆå†™å…¥ç½‘ç»œæ•°æ®æ—¶ï¼Œè¦è°ƒç”¨ <code>flush()</code> æ–¹æ³•ã€‚</p><p>å¦‚æœä¸è°ƒç”¨ <code>flush()</code>ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½ä¼šå‘ç°ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½æ”¶ä¸åˆ°æ•°æ®ï¼Œè¿™å¹¶ä¸æ˜¯ Java æ ‡å‡†åº“çš„è®¾è®¡é—®é¢˜ï¼Œè€Œæ˜¯æˆ‘ä»¬ä»¥æµçš„å½¢å¼å†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯ä¸€å†™å…¥å°±ç«‹åˆ»å‘é€åˆ°ç½‘ç»œï¼Œè€Œæ˜¯å…ˆå†™å…¥å†…å­˜ç¼“å†²åŒºï¼Œç›´åˆ°ç¼“å†²åŒºæ»¡äº†ä»¥åï¼Œæ‰ä¼šä¸€æ¬¡æ€§çœŸæ­£å‘é€åˆ°ç½‘ç»œï¼Œè¿™æ ·è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜ä¼ è¾“æ•ˆç‡ã€‚å¦‚æœç¼“å†²åŒºçš„æ•°æ®å¾ˆå°‘ï¼Œè€Œæˆ‘ä»¬åˆæƒ³å¼ºåˆ¶æŠŠè¿™äº›æ•°æ®å‘é€åˆ°ç½‘ç»œï¼Œå°±å¿…é¡»è°ƒç”¨ <code>flush()</code> å¼ºåˆ¶æŠŠç¼“å†²åŒºæ•°æ®å‘é€å‡ºå»ã€‚</p><h2 id="ğŸ€-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç»ƒä¹ " aria-hidden="true">#</a> ğŸ€ ç»ƒä¹ </h2><p>ä½¿ç”¨ Socket å®ç°æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é€šä¿¡</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>ä½¿ç”¨ Java è¿›è¡Œ TCP ç¼–ç¨‹æ—¶ï¼Œéœ€è¦ä½¿ç”¨ Socket æ¨¡å‹ï¼š</p><ul><li>æœåŠ¡å™¨ç«¯ç”¨ <code>ServerSocket</code> ç›‘å¬æŒ‡å®šç«¯å£ï¼›</li><li>å®¢æˆ·ç«¯ä½¿ç”¨ <code>Socket(InetAddress, port)</code> è¿æ¥æœåŠ¡å™¨ï¼›</li><li>æœåŠ¡å™¨ç«¯ç”¨ <code>accept()</code> æ¥æ”¶è¿æ¥å¹¶è¿”å› <code>Socket</code>ï¼›</li><li>åŒæ–¹é€šè¿‡ <code>Socket</code> æ‰“å¼€ <code>InputStream</code>/<code>OutputStream</code> è¯»å†™æ•°æ®ï¼›</li><li>æœåŠ¡å™¨ç«¯é€šå¸¸ä½¿ç”¨å¤šçº¿ç¨‹åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼Œåˆ©ç”¨çº¿ç¨‹æ± å¯å¤§å¹…æå‡æ•ˆç‡ï¼›</li><li><code>flush()</code> ç”¨äºå¼ºåˆ¶è¾“å‡ºç¼“å†²åŒºåˆ°ç½‘ç»œã€‚</li></ul>`,37);function S(w,f){const s=c("router-link");return o(),l("div",null,[n("details",d,[v,n("nav",m,[n("ul",null,[n("li",null,[a(s,{to:"#ğŸ€-æœåŠ¡å™¨ç«¯"},{default:t(()=>[p("ğŸ€ æœåŠ¡å™¨ç«¯")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å®¢æˆ·ç«¯"},{default:t(()=>[p("ğŸ€ å®¢æˆ·ç«¯")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-socket-æµ"},{default:t(()=>[p("ğŸ€ Socket æµ")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-ç»ƒä¹ "},{default:t(()=>[p("ğŸ€ ç»ƒä¹ ")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å°ç»“"},{default:t(()=>[p("ğŸ€ å°ç»“")]),_:1})])])])]),b])}const g=e(r,[["render",S],["__file","2.html.vue"]]);export{g as default};
