import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as c,c as l,a as n,b as a,w as e,d as i,e as t}from"./app-CvlAI_tu.js";const u={},k={class:"hint-container details"},d=n("summary",null,"ç›®å½•",-1),r={class:"table-of-contents"},v=i(`<blockquote><p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p></blockquote><p>ä»£ç†æ¨¡å¼ï¼Œå³ Proxyï¼Œå®ƒå’Œ Adapter æ¨¡å¼å¾ˆç±»ä¼¼ã€‚æˆ‘ä»¬å…ˆå›é¡¾ Adapter æ¨¡å¼ï¼Œå®ƒç”¨äºæŠŠ A æ¥å£è½¬æ¢ä¸º B æ¥å£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">B</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">A</span> a<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">BAdapter</span><span class="token punctuation">(</span><span class="token class-name">A</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> a<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œ Proxy æ¨¡å¼ä¸æ˜¯æŠŠ A æ¥å£è½¬æ¢æˆ B æ¥å£ï¼Œå®ƒè¿˜æ˜¯è½¬æ¢æˆ A æ¥å£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AProxy</span> <span class="token keyword">implements</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">A</span> a<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">AProxy</span><span class="token punctuation">(</span><span class="token class-name">A</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> a<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆç€ Proxy å°±æ˜¯ä¸ºäº†ç»™ A æ¥å£å†åŒ…ä¸€å±‚ï¼Œè¿™ä¸æ˜¯è„±äº†è£¤å­æ”¾å±å—ï¼Ÿ</p><p>å½“ç„¶ä¸æ˜¯ã€‚æˆ‘ä»¬è§‚å¯Ÿ Proxy çš„å®ç° A æ¥å£çš„æ–¹æ³•ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·å†™å½“ç„¶æ²¡å•¥åµç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è°ƒç”¨ <code>a.a()</code> çš„å‰åï¼ŒåŠ ä¸€äº›é¢å¤–çš„ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getCurrentUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">SecurityException</span><span class="token punctuation">(</span><span class="token string">&quot;Forbidden&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å®ç°äº†æƒé™æ£€æŸ¥ï¼Œåªæœ‰ç¬¦åˆè¦æ±‚çš„ç”¨æˆ·ï¼Œæ‰ä¼šçœŸæ­£è°ƒç”¨ç›®æ ‡æ–¹æ³•ï¼Œå¦åˆ™ï¼Œä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>æœ‰çš„ç«¥é‹ä¼šé—®ï¼Œä¸ºå•¥ä¸æŠŠæƒé™æ£€æŸ¥çš„åŠŸèƒ½ç›´æ¥å†™åˆ°ç›®æ ‡å®ä¾‹ A çš„å†…éƒ¨ï¼Ÿ</p><p>å› ä¸ºæˆ‘ä»¬ç¼–å†™ä»£ç çš„åŸåˆ™æœ‰ï¼š</p><ul><li>èŒè´£æ¸…æ™°ï¼šä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä»¶äº‹ï¼›</li><li>æ˜“äºæµ‹è¯•ï¼šä¸€æ¬¡åªæµ‹ä¸€ä¸ªåŠŸèƒ½ã€‚</li></ul><p>ç”¨ Proxy å®ç°è¿™ä¸ªæƒé™æ£€æŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æ›´æ¸…æ™°ã€æ›´ç®€æ´çš„ä»£ç ï¼š</p><ul><li><code>A</code> æ¥å£ï¼šåªå®šä¹‰æ¥å£ï¼›</li><li><code>ABusiness</code> ç±»ï¼šåªå®ç° A æ¥å£çš„ä¸šåŠ¡é€»è¾‘ï¼›</li><li><code>APermissionProxy</code> ç±»ï¼šåªå®ç° A æ¥å£çš„æƒé™æ£€æŸ¥ä»£ç†ã€‚</li></ul><p>å¦‚æœæˆ‘ä»¬å¸Œæœ›ç¼–å†™å…¶ä»–ç±»å‹çš„ä»£ç†ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ç±»ä¼¼ ALogProxy ï¼Œè€Œä¸å¿…å¯¹ç°æœ‰çš„ A æ¥å£ã€ ABusiness ç±»è¿›è¡Œä¿®æ”¹ã€‚</p><p>å®é™…ä¸Šæƒé™æ£€æŸ¥åªæ˜¯ä»£ç†æ¨¡å¼çš„ä¸€ç§åº”ç”¨ã€‚Proxy è¿˜å¹¿æ³›åº”ç”¨åœ¨ï¼š</p><h2 id="ğŸ€-è¿œç¨‹ä»£ç†" tabindex="-1"><a class="header-anchor" href="#ğŸ€-è¿œç¨‹ä»£ç†" aria-hidden="true">#</a> ğŸ€ è¿œç¨‹ä»£ç†</h2><p>è¿œç¨‹ä»£ç†å³ Remote Proxy ï¼Œæœ¬åœ°çš„è°ƒç”¨è€…æŒæœ‰çš„æ¥å£å®é™…ä¸Šæ˜¯ä¸€ä¸ªä»£ç†ï¼Œè¿™ä¸ªä»£ç†è´Ÿè´£æŠŠå¯¹æ¥å£çš„æ–¹æ³•è®¿é—®è½¬æ¢æˆè¿œç¨‹è°ƒç”¨ï¼Œç„¶åè¿”å›ç»“æœã€‚Java å†…ç½®çš„ RMI æœºåˆ¶å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¿œç¨‹ä»£ç†æ¨¡å¼ã€‚</p><h2 id="ğŸ€-è™šä»£ç†" tabindex="-1"><a class="header-anchor" href="#ğŸ€-è™šä»£ç†" aria-hidden="true">#</a> ğŸ€ è™šä»£ç†</h2><p>è™šä»£ç†å³ Virtual Proxyï¼Œå®ƒè®©è°ƒç”¨è€…å…ˆæŒæœ‰ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä½†çœŸæ­£çš„å¯¹è±¡å°šæœªåˆ›å»ºã€‚å¦‚æœæ²¡æœ‰å¿…è¦ï¼Œè¿™ä¸ªçœŸæ­£çš„å¯¹è±¡æ˜¯ä¸ä¼šè¢«åˆ›å»ºçš„ï¼Œç›´åˆ°å®¢æˆ·ç«¯éœ€è¦çœŸçš„å¿…é¡»è°ƒç”¨æ—¶ï¼Œæ‰åˆ›å»ºçœŸæ­£çš„å¯¹è±¡ã€‚JDBC çš„è¿æ¥æ± è¿”å›çš„ JDBC è¿æ¥ï¼ˆConnection å¯¹è±¡ï¼‰å°±å¯ä»¥æ˜¯ä¸€ä¸ªè™šä»£ç†ï¼Œå³è·å–è¿æ¥æ—¶æ ¹æœ¬æ²¡æœ‰ä»»ä½•å®é™…çš„æ•°æ®åº“è¿æ¥ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡æ‰§è¡Œ JDBC æŸ¥è¯¢æˆ–æ›´æ–°æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ›å»ºå®é™…çš„ JDBC è¿æ¥ã€‚</p><h2 id="ğŸ€-ä¿æŠ¤ä»£ç†" tabindex="-1"><a class="header-anchor" href="#ğŸ€-ä¿æŠ¤ä»£ç†" aria-hidden="true">#</a> ğŸ€ ä¿æŠ¤ä»£ç†</h2><p>ä¿æŠ¤ä»£ç†å³ Protection Proxy ï¼Œå®ƒç”¨ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå§‹å¯¹è±¡çš„è®¿é—®ï¼Œå¸¸ç”¨äºé‰´æƒã€‚</p><h2 id="ğŸ€-æ™ºèƒ½å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#ğŸ€-æ™ºèƒ½å¼•ç”¨" aria-hidden="true">#</a> ğŸ€ æ™ºèƒ½å¼•ç”¨</h2><p>æ™ºèƒ½å¼•ç”¨å³ Smart Reference ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§ä»£ç†å¯¹è±¡ï¼Œå¦‚æœæœ‰å¾ˆå¤šå®¢æˆ·ç«¯å¯¹å®ƒè¿›è¡Œè®¿é—®ï¼Œé€šè¿‡å†…éƒ¨çš„è®¡æ•°å™¨å¯ä»¥åœ¨å¤–éƒ¨è°ƒç”¨è€…éƒ½ä¸ä½¿ç”¨åè‡ªåŠ¨é‡Šæ”¾å®ƒã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•åº”ç”¨ä»£ç†æ¨¡å¼ç¼–å†™ä¸€ä¸ª JDBC è¿æ¥æ± ï¼ˆ<code>DataSource</code>ï¼‰ã€‚æˆ‘ä»¬é¦–å…ˆæ¥ç¼–å†™ä¸€ä¸ªè™šä»£ç†ï¼Œå³å¦‚æœè°ƒç”¨è€…è·å–åˆ° <code>Connection</code> åï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œä»»ä½• SQL æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ª Connection Proxy å®é™…ä¸Šå¹¶ä¸ä¼šçœŸæ­£æ‰“å¼€ JDBC è¿æ¥ã€‚è°ƒç”¨è€…ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">DataSource</span> lazyDataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LazyDataSource</span><span class="token punctuation">(</span>jdbcUrl<span class="token punctuation">,</span> jdbcUsername<span class="token punctuation">,</span> jdbcPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;get lazy connection...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Connection</span> conn1 <span class="token operator">=</span> lazyDataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¹¶æ²¡æœ‰å®é™…æ‰“å¼€çœŸæ­£çš„ Connection</span>
<span class="token punctuation">}</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;get lazy connection...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Connection</span> conn2 <span class="token operator">=</span> lazyDataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> conn2<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM students&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ‰“å¼€äº†çœŸæ­£çš„ Connection</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æˆ‘ä»¬æ¥æ€è€ƒå¦‚ä½•å®ç°è¿™ä¸ª <code>LazyConnectionProxy</code> ã€‚ä¸ºäº†ç®€åŒ–ä»£ç ï¼Œæˆ‘ä»¬é¦–å…ˆé’ˆå¯¹ <code>Connection</code> æ¥å£åšä¸€ä¸ªæŠ½è±¡çš„ä»£ç†ç±»ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractConnectionProxy</span> <span class="token keyword">implements</span> <span class="token class-name">Connection</span> <span class="token punctuation">{</span>

    <span class="token comment">// æŠ½è±¡æ–¹æ³•è·å–å®é™…çš„ Connection:</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token class-name">Connection</span> <span class="token function">getRealConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å®ç° Connection æ¥å£çš„æ¯ä¸€ä¸ªæ–¹æ³•:</span>
    <span class="token keyword">public</span> <span class="token class-name">Statement</span> <span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getRealConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">PreparedStatement</span> <span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getRealConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//... å…¶ä»–ä»£ç†æ–¹æ³•...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ª <code>AbstractConnectionProxy</code> ä»£ç†ç±»çš„ä½œç”¨æ˜¯æŠŠ <code>Connection</code> æ¥å£å®šä¹‰çš„æ–¹æ³•å…¨éƒ¨å®ç°ä¸€éï¼Œå› ä¸º <code>Connection</code> æ¥å£å®šä¹‰çš„æ–¹æ³•å¤ªå¤šäº†ï¼Œåé¢æˆ‘ä»¬è¦ç¼–å†™çš„ <code>LazyConnectionProxy</code> åªéœ€è¦ç»§æ‰¿ <code>AbstractConnectionProxy</code>ï¼Œå°±ä¸å¿…å†æŠŠ <code>Connection</code> æ¥å£æ–¹æ³•æŒ¨ä¸ªå®ç°ä¸€éã€‚</p><p><code>LazyConnectionProxy</code> å®ç°å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LazyConnectionProxy</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractConnectionProxy</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Connection</span><span class="token punctuation">&gt;</span></span> supplier<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Connection</span> target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">LazyConnectionProxy</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Connection</span><span class="token punctuation">&gt;</span></span> supplier<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>supplier <span class="token operator">=</span> supplier<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è¦†å†™ close æ–¹æ³•ï¼šåªæœ‰ target ä¸ä¸º null æ—¶æ‰éœ€è¦å…³é—­:</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Close connection:&quot;</span> <span class="token operator">+</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Connection</span> <span class="token function">getRealConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            target <span class="token operator">=</span> supplier<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœè°ƒç”¨è€…æ²¡æœ‰æ‰§è¡Œä»»ä½• SQL è¯­å¥ï¼Œé‚£ä¹ˆ <code>target</code> å­—æ®µå§‹ç»ˆä¸º <code>null</code>ã€‚åªæœ‰ç¬¬ä¸€æ¬¡æ‰§è¡Œ SQL è¯­å¥æ—¶ï¼ˆå³è°ƒç”¨ä»»ä½•ç±»ä¼¼ <code>prepareStatement()</code> æ–¹æ³•æ—¶ï¼Œè§¦å‘ <code>getRealConnection()</code> è°ƒç”¨ï¼‰ï¼Œæ‰ä¼šçœŸæ­£æ‰“å¼€å®é™…çš„ JDBC Connectionã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¼–å†™ä¸€ä¸ª <code>LazyDataSource</code> æ¥æ”¯æŒè¿™ä¸ª <code>LazyConnectionProxy</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LazyDataSource</span> <span class="token keyword">implements</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">LazyDataSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">LazyConnectionProxy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Open connection:&quot;</span> <span class="token operator">+</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> conn<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æ‰§è¡Œä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>get lazy connection<span class="token punctuation">..</span>.
get lazy connection<span class="token punctuation">..</span>.
Open connection: com.mysql.jdbc.JDBC4Connection@7a36aefa
å°æ˜
å°çº¢
å°å†›
å°ç™½
<span class="token punctuation">..</span>.
Close connection: com.mysql.jdbc.JDBC4Connection@7a36aefa
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯è§ç¬¬ä¸€ä¸ª <code>getConnection()</code> è°ƒç”¨è·å–åˆ°çš„ <code>LazyConnectionProxy</code> å¹¶æ²¡æœ‰å®é™…æ‰“å¼€çœŸæ­£çš„ JDBC Connection ã€‚</p><p>ä½¿ç”¨è¿æ¥æ± çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›èƒ½é‡å¤ä½¿ç”¨è¿æ¥ã€‚å¦‚æœè°ƒç”¨æ–¹ç¼–å†™è¿™æ ·çš„ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">DataSource</span> pooledDataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PooledDataSource</span><span class="token punctuation">(</span>jdbcUrl<span class="token punctuation">,</span> jdbcUsername<span class="token punctuation">,</span> jdbcPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Connection</span> conn <span class="token operator">=</span> pooledDataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Connection</span> conn <span class="token operator">=</span> pooledDataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–åˆ°çš„æ˜¯åŒä¸€ä¸ª Connection</span>
<span class="token punctuation">}</span>
<span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Connection</span> conn <span class="token operator">=</span> pooledDataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–åˆ°çš„æ˜¯åŒä¸€ä¸ª Connection</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è°ƒç”¨æ–¹å¹¶ä¸å…³å¿ƒæ˜¯å¦å¤ç”¨äº† <code>Connection</code>ï¼Œä½†ä» <code>PooledDataSource</code> è·å–çš„ <code>Connection</code> ç¡®å®è‡ªå¸¦è¿™ä¸ªä¼˜åŒ–åŠŸèƒ½ã€‚å¦‚ä½•å®ç°å¯å¤ç”¨ <code>Connection</code> çš„è¿æ¥æ± ï¼Ÿç­”æ¡ˆä»ç„¶æ˜¯ä½¿ç”¨ä»£ç†æ¨¡å¼ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PooledConnectionProxy</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractConnectionProxy</span> <span class="token punctuation">{</span>
    <span class="token comment">// å®é™…çš„ Connection:</span>
    <span class="token class-name">Connection</span> target<span class="token punctuation">;</span>
    <span class="token comment">// ç©ºé—²é˜Ÿåˆ—:</span>
    <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PooledConnectionProxy</span><span class="token punctuation">&gt;</span></span> idleQueue<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PooledConnectionProxy</span><span class="token punctuation">(</span><span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PooledConnectionProxy</span><span class="token punctuation">&gt;</span></span> idleQueue<span class="token punctuation">,</span> <span class="token class-name">Connection</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>idleQueue <span class="token operator">=</span> idleQueue<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Fake close and released to idle queue for future reuse:&quot;</span> <span class="token operator">+</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¹¶æ²¡æœ‰è°ƒç”¨å®é™… Connection çš„ close() æ–¹æ³•,</span>
        <span class="token comment">// è€Œæ˜¯æŠŠè‡ªå·±æ”¾å…¥ç©ºé—²é˜Ÿåˆ—:</span>
        idleQueue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">Connection</span> <span class="token function">getRealConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤ç”¨è¿æ¥çš„å…³é”®åœ¨äºè¦†å†™ <code>close()</code> æ–¹æ³•ï¼Œå®ƒå¹¶æ²¡æœ‰çœŸæ­£å…³é—­åº•å±‚ JDBC è¿æ¥ï¼Œè€Œæ˜¯æŠŠè‡ªå·±æ”¾å›ä¸€ä¸ªç©ºé—²é˜Ÿåˆ—ï¼Œä»¥ä¾¿ä¸‹æ¬¡ä½¿ç”¨ã€‚</p><p>ç©ºé—²é˜Ÿåˆ—ç”± <code>PooledDataSource</code> è´Ÿè´£ç»´æŠ¤ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PooledDataSource</span> <span class="token keyword">implements</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token comment">// ç»´æŠ¤ä¸€ä¸ªç©ºé—²é˜Ÿåˆ—:</span>
    <span class="token keyword">private</span> <span class="token class-name">Queue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PooledConnectionProxy</span><span class="token punctuation">&gt;</span></span> idleQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PooledDataSource</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token comment">// é¦–å…ˆè¯•å›¾è·å–ä¸€ä¸ªç©ºé—²è¿æ¥:</span>
        <span class="token class-name">PooledConnectionProxy</span> conn <span class="token operator">=</span> idleQueue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ²¡æœ‰ç©ºé—²è¿æ¥æ—¶ï¼Œæ‰“å¼€ä¸€ä¸ªæ–°è¿æ¥:</span>
            conn <span class="token operator">=</span> <span class="token function">openNewConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Return pooled connection:&quot;</span> <span class="token operator">+</span> conn<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> conn<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">PooledConnectionProxy</span> <span class="token function">openNewConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Open new connection:&quot;</span> <span class="token operator">+</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PooledConnectionProxy</span><span class="token punctuation">(</span>idleQueue<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æ‰§è¡Œè°ƒç”¨æ–¹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Open new connection: com.mysql.jdbc.JDBC4Connection@61ca2dfa
Fake close and released to idle queue <span class="token keyword">for</span> future reuse: com.mysql.jdbc.JDBC4Connection@61ca2dfa
Return pooled connection: com.mysql.jdbc.JDBC4Connection@61ca2dfa
Fake close and released to idle queue <span class="token keyword">for</span> future reuse: com.mysql.jdbc.JDBC4Connection@61ca2dfa
Return pooled connection: com.mysql.jdbc.JDBC4Connection@61ca2dfa
Fake close and released to idle queue <span class="token keyword">for</span> future reuse: com.mysql.jdbc.JDBC4Connection@61ca2dfa
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é™¤äº†ç¬¬ä¸€æ¬¡æ‰“å¼€äº†ä¸€ä¸ªçœŸæ­£çš„ JDBC Connection ï¼Œåç»­è·å–çš„ <code>Connection</code> å®é™…ä¸Šæ˜¯åŒä¸€ä¸ª JDBC Connection ã€‚ä½†æ˜¯ï¼Œå¯¹äºè°ƒç”¨æ–¹æ¥è¯´ï¼Œå®Œå…¨ä¸éœ€è¦çŸ¥é“åº•å±‚åšäº†å“ªäº›ä¼˜åŒ–ã€‚</p><p>æˆ‘ä»¬å®é™…ä½¿ç”¨çš„ DataSource ï¼Œä¾‹å¦‚ HikariCP ï¼Œéƒ½æ˜¯åŸºäºä»£ç†æ¨¡å¼å®ç°çš„ï¼ŒåŸç†åŒä¸Šï¼Œä½†å¢åŠ äº†æ›´å¤šçš„å¦‚åŠ¨æ€ä¼¸ç¼©çš„åŠŸèƒ½ï¼ˆä¸€ä¸ªè¿æ¥ç©ºé—²ä¸€æ®µæ—¶é—´åè‡ªåŠ¨å…³é—­ï¼‰ã€‚</p><p>æœ‰çš„ç«¥é‹ä¼šå‘ç° Proxy æ¨¡å¼å’Œ Decorator æ¨¡å¼æœ‰äº›ç±»ä¼¼ã€‚ç¡®å®ï¼Œè¿™ä¸¤è€…çœ‹èµ·æ¥å¾ˆåƒï¼Œä½†åŒºåˆ«åœ¨äºï¼šDecorator æ¨¡å¼è®©è°ƒç”¨è€…è‡ªå·±åˆ›å»ºæ ¸å¿ƒç±»ï¼Œç„¶åç»„åˆå„ç§åŠŸèƒ½ï¼Œè€Œ Proxy æ¨¡å¼å†³ä¸èƒ½è®©è°ƒç”¨è€…è‡ªå·±åˆ›å»ºå†ç»„åˆï¼Œå¦åˆ™å°±å¤±å»äº†ä»£ç†çš„åŠŸèƒ½ã€‚Proxy æ¨¡å¼è®©è°ƒç”¨è€…è®¤ä¸ºè·å–åˆ°çš„æ˜¯æ ¸å¿ƒç±»æ¥å£ï¼Œä½†å®é™…ä¸Šæ˜¯ä»£ç†ç±»ã€‚</p><h2 id="ğŸ€-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç»ƒä¹ " aria-hidden="true">#</a> ğŸ€ ç»ƒä¹ </h2><p>ä½¿ç”¨ä»£ç†æ¨¡å¼ç¼–å†™ä¸€ä¸ª JDBC è¿æ¥æ± </p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>ä»£ç†æ¨¡å¼é€šè¿‡å°è£…ä¸€ä¸ªå·²æœ‰æ¥å£ï¼Œå¹¶å‘è°ƒç”¨æ–¹è¿”å›ç›¸åŒçš„æ¥å£ç±»å‹ï¼Œèƒ½è®©è°ƒç”¨æ–¹åœ¨ä¸æ”¹å˜ä»»ä½•ä»£ç çš„å‰æä¸‹å¢å¼ºæŸäº›åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œé‰´æƒã€å»¶è¿ŸåŠ è½½ã€è¿æ¥æ± å¤ç”¨ç­‰ï¼‰ã€‚</p><p>ä½¿ç”¨ Proxy æ¨¡å¼è¦æ±‚è°ƒç”¨æ–¹æŒæœ‰æ¥å£ï¼Œä½œä¸º Proxy çš„ç±»ä¹Ÿå¿…é¡»å®ç°ç›¸åŒçš„æ¥å£ç±»å‹ã€‚</p>`,56);function m(b,y){const s=o("router-link");return c(),l("div",null,[n("details",k,[d,n("nav",r,[n("ul",null,[n("li",null,[a(s,{to:"#ğŸ€-è¿œç¨‹ä»£ç†"},{default:e(()=>[t("ğŸ€ è¿œç¨‹ä»£ç†")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-è™šä»£ç†"},{default:e(()=>[t("ğŸ€ è™šä»£ç†")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-ä¿æŠ¤ä»£ç†"},{default:e(()=>[t("ğŸ€ ä¿æŠ¤ä»£ç†")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-æ™ºèƒ½å¼•ç”¨"},{default:e(()=>[t("ğŸ€ æ™ºèƒ½å¼•ç”¨")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-ç»ƒä¹ "},{default:e(()=>[t("ğŸ€ ç»ƒä¹ ")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å°ç»“"},{default:e(()=>[t("ğŸ€ å°ç»“")]),_:1})])])])]),v])}const C=p(u,[["render",m],["__file","2_7.html.vue"]]);export{C as default};
