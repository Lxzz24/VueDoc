import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as t,o as p,c as e,a as n,b as c,w as o,d as l,e as u}from"./app-CvlAI_tu.js";const i={},k={class:"hint-container details"},r=n("summary",null,"ç›®å½•",-1),d={class:"table-of-contents"},m=l(`<p>ä¸Šä¸€èŠ‚æˆ‘ä»¬è®²çš„ AES åŠ å¯†ï¼Œç»†å¿ƒçš„ç«¥é‹å¯èƒ½ä¼šå‘ç°ï¼Œå¯†é’¥é•¿åº¦æ˜¯å›ºå®šçš„ 128/192/256 ä½ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ç”¨ WinZip/WinRAR é‚£æ ·ï¼Œéšä¾¿è¾“å…¥å‡ ä½éƒ½å¯ä»¥ã€‚</p><p>è¿™æ˜¯å› ä¸ºå¯¹ç§°åŠ å¯†ç®—æ³•å†³å®šäº†å£ä»¤å¿…é¡»æ˜¯å›ºå®šé•¿åº¦ï¼Œç„¶åå¯¹æ˜æ–‡è¿›è¡Œåˆ†å—åŠ å¯†ã€‚åˆå› ä¸ºå®‰å…¨éœ€æ±‚ï¼Œå£ä»¤é•¿åº¦å¾€å¾€éƒ½æ˜¯ 128 ä½ä»¥ä¸Šï¼Œå³è‡³å°‘ 16 ä¸ªå­—ç¬¦ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„åŠ å¯†è½¯ä»¶ï¼Œè¾“å…¥ 6 ä½ã€8 ä½éƒ½å¯ä»¥ï¼Œéš¾é“åŠ å¯†æ–¹å¼ä¸ä¸€æ ·ï¼Ÿ</p><p>å®é™…ä¸Šç”¨æˆ·è¾“å…¥çš„å£ä»¤å¹¶ä¸èƒ½ç›´æ¥ä½œä¸º AES çš„å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆé™¤éé•¿åº¦æ°å¥½æ˜¯ 128/192/256 ä½ï¼‰ï¼Œå¹¶ä¸”ç”¨æˆ·è¾“å…¥çš„å£ä»¤ä¸€èˆ¬éƒ½æœ‰è§„å¾‹ï¼Œå®‰å…¨æ€§è¿œè¿œä¸å¦‚å®‰å…¨éšæœºæ•°äº§ç”Ÿçš„éšæœºå£ä»¤ã€‚å› æ­¤ï¼Œç”¨æˆ·è¾“å…¥çš„å£ä»¤ï¼Œé€šå¸¸è¿˜éœ€è¦ä½¿ç”¨ PBE ç®—æ³•ï¼Œé‡‡ç”¨éšæœºæ•°æ‚å‡‘è®¡ç®—å‡ºçœŸæ­£çš„å¯†é’¥ï¼Œå†è¿›è¡ŒåŠ å¯†ã€‚</p><p>PBE å°±æ˜¯ Password Based Encryption çš„ç¼©å†™ï¼Œå®ƒçš„ä½œç”¨å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>key <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>userPassword<span class="token punctuation">,</span> secureRandomPassword<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>PBE çš„ä½œç”¨å°±æ˜¯æŠŠç”¨æˆ·è¾“å…¥çš„å£ä»¤å’Œä¸€ä¸ªå®‰å…¨éšæœºçš„å£ä»¤é‡‡ç”¨æ‚å‡‘åè®¡ç®—å‡ºçœŸæ­£çš„å¯†é’¥ã€‚ä»¥ AES å¯†é’¥ä¸ºä¾‹ï¼Œæˆ‘ä»¬è®©ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå£ä»¤ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œé€šè¿‡ PBE ç®—æ³•è®¡ç®—å‡ºçœŸæ­£çš„ AES å£ä»¤ï¼Œå†è¿›è¡ŒåŠ å¯†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// æŠŠ BouncyCastle ä½œä¸º Provider æ·»åŠ åˆ° java.security:</span>
        <span class="token class-name">Security</span><span class="token punctuation">.</span><span class="token function">addProvider</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BouncyCastleProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŸæ–‡:</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ å¯†å£ä»¤:</span>
        <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">&quot;hello12345&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// 16 bytes éšæœº Salt:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> salt <span class="token operator">=</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">.</span><span class="token function">getInstanceStrong</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generateSeed</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;salt: %032x\\n&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> salt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åŠ å¯†:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encrypted <span class="token operator">=</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;encrypted:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è§£å¯†:</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decrypted <span class="token operator">=</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> encrypted<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;decrypted:&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åŠ å¯†:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token class-name">String</span> password<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> salt<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token class-name">PBEKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PBEKeySpec</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKeyFactory</span> skeyFactory <span class="token operator">=</span> <span class="token class-name">SecretKeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;PBEwithSHA1and128bitAES-CBC-BC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKey</span> skey <span class="token operator">=</span> skeyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PBEParameterSpec</span> pbeps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PBEParameterSpec</span><span class="token punctuation">(</span>salt<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;PBEwithSHA1and128bitAES-CBC-BC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> skey<span class="token punctuation">,</span> pbeps<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è§£å¯†:</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token class-name">String</span> password<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> salt<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">GeneralSecurityException</span> <span class="token punctuation">{</span>
        <span class="token class-name">PBEKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PBEKeySpec</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKeyFactory</span> skeyFactory <span class="token operator">=</span> <span class="token class-name">SecretKeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;PBEwithSHA1and128bitAES-CBC-BC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecretKey</span> skey <span class="token operator">=</span> skeyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PBEParameterSpec</span> pbeps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PBEParameterSpec</span><span class="token punctuation">(</span>salt<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;PBEwithSHA1and128bitAES-CBC-BC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">DECRYPT_MODE</span><span class="token punctuation">,</span> skey<span class="token punctuation">,</span> pbeps<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ PBE æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¼•å…¥ BouncyCastleï¼Œå¹¶æŒ‡å®šç®—æ³•æ˜¯ <code>PBEwithSHA1and128bitAES-CBC-BC</code>ã€‚è§‚å¯Ÿä»£ç ï¼Œå®é™…ä¸ŠçœŸæ­£çš„ AES å¯†é’¥æ˜¯è°ƒç”¨ <code>Cipher</code> çš„ <code>init()</code> æ–¹æ³•æ—¶åŒæ—¶ä¼ å…¥ <code>SecretKey</code> å’Œ <code>PBEParameterSpec</code> å®ç°çš„ã€‚åœ¨åˆ›å»º <code>PBEParameterSpec</code> çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æŒ‡å®šäº†å¾ªç¯æ¬¡æ•° <code>1000</code>ï¼Œå¾ªç¯æ¬¡æ•°è¶Šå¤šï¼Œæš´åŠ›ç ´è§£éœ€è¦çš„è®¡ç®—é‡å°±è¶Šå¤§ã€‚</p><p>å¦‚æœæˆ‘ä»¬æŠŠ salt å’Œå¾ªç¯æ¬¡æ•°å›ºå®šï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªé€šç”¨çš„ â€œå£ä»¤â€ åŠ å¯†è½¯ä»¶ã€‚å¦‚æœæˆ‘ä»¬æŠŠéšæœºç”Ÿæˆçš„ salt å­˜å‚¨åœ¨ U ç›˜ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ª â€œå£ä»¤â€ åŠ  USB Key çš„åŠ å¯†è½¯ä»¶ï¼Œå®ƒçš„å¥½å¤„åœ¨äºï¼Œå³ä½¿ç”¨æˆ·ä½¿ç”¨äº†ä¸€ä¸ªéå¸¸å¼±çš„å£ä»¤ï¼Œæ²¡æœ‰ USB Key ä»ç„¶æ— æ³•è§£å¯†ï¼Œå› ä¸º USB Key å­˜å‚¨çš„éšæœºæ•°å¯†é’¥å®‰å…¨æ€§éå¸¸é«˜ã€‚</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>PBE ç®—æ³•é€šè¿‡ç”¨æˆ·å£ä»¤å’Œå®‰å…¨çš„éšæœº salt è®¡ç®—å‡º Keyï¼Œç„¶åå†è¿›è¡ŒåŠ å¯†ï¼›</p><p>Key é€šè¿‡å£ä»¤å’Œå®‰å…¨çš„éšæœº salt è®¡ç®—å¾—å‡ºï¼Œå¤§å¤§æé«˜äº†å®‰å…¨æ€§ï¼›</p><p>PBE ç®—æ³•å†…éƒ¨ä½¿ç”¨çš„ä»ç„¶æ˜¯æ ‡å‡†å¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆä¾‹å¦‚ AESï¼‰ã€‚</p>`,14);function v(y,b){const s=t("router-link");return p(),e("div",null,[n("details",k,[r,n("nav",d,[n("ul",null,[n("li",null,[c(s,{to:"#ğŸ€-å°ç»“"},{default:o(()=>[u("ğŸ€ å°ç»“")]),_:1})])])])]),m])}const B=a(i,[["render",v],["__file","6.html.vue"]]);export{B as default};
