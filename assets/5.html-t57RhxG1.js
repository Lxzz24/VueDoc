import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as c,c as u,a as n,b as a,w as t,d as l,e as p}from"./app-CvlAI_tu.js";const i={},k={class:"hint-container details"},r=n("summary",null,"ç›®å½•",-1),d={class:"table-of-contents"},m=l(`<p>ä½¿ç”¨ JDBC æ“ä½œæ•°æ®åº“çš„æ—¶å€™ï¼Œç»å¸¸ä¼šæ‰§è¡Œä¸€äº›æ‰¹é‡æ“ä½œã€‚</p><p>ä¾‹å¦‚ï¼Œä¸€æ¬¡æ€§ç»™ä¼šå‘˜å¢åŠ å¯ç”¨ä¼˜æƒ åˆ¸è‹¥å¹²ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹ SQL ä»£ç ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> coupons <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> <span class="token keyword">type</span><span class="token punctuation">,</span> expires<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token string">&#39;DISCOUNT&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2030-12-31&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> coupons <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> <span class="token keyword">type</span><span class="token punctuation">,</span> expires<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">234</span><span class="token punctuation">,</span> <span class="token string">&#39;DISCOUNT&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2030-12-31&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> coupons <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> <span class="token keyword">type</span><span class="token punctuation">,</span> expires<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">345</span><span class="token punctuation">,</span> <span class="token string">&#39;DISCOUNT&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2030-12-31&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> coupons <span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> <span class="token keyword">type</span><span class="token punctuation">,</span> expires<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">456</span><span class="token punctuation">,</span> <span class="token string">&#39;DISCOUNT&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2030-12-31&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®é™…ä¸Šæ‰§è¡Œ JDBC æ—¶ï¼Œå› ä¸ºåªæœ‰å ä½ç¬¦å‚æ•°ä¸åŒï¼Œæ‰€ä»¥ SQL å®é™…ä¸Šæ˜¯ä¸€æ ·çš„ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> params <span class="token operator">:</span> paramsList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">preparedStatement</span><span class="token punctuation">(</span><span class="token string">&quot;INSERT INTO coupons (user_id, type, expires) VALUES (?,?,?)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ps<span class="token punctuation">.</span><span class="token function">setLong</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ps<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç±»ä¼¼çš„è¿˜æœ‰ï¼Œç»™æ¯ä¸ªå‘˜å·¥è–ªæ°´å¢åŠ  10%ï½30%ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> employees <span class="token keyword">SET</span> salary <span class="token operator">=</span> salary <span class="token operator">*</span> ? <span class="token keyword">WHERE</span> id <span class="token operator">=</span> ?
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é€šè¿‡ä¸€ä¸ªå¾ªç¯æ¥æ‰§è¡Œæ¯ä¸ª <code>PreparedStatement</code> è™½ç„¶å¯è¡Œï¼Œä½†æ˜¯æ€§èƒ½å¾ˆä½ã€‚SQL æ•°æ®åº“å¯¹ SQL è¯­å¥ç›¸åŒï¼Œä½†åªæœ‰å‚æ•°ä¸åŒçš„è‹¥å¹²è¯­å¥å¯ä»¥ä½œä¸º batch æ‰§è¡Œï¼Œå³æ‰¹é‡æ‰§è¡Œï¼Œè¿™ç§æ“ä½œæœ‰ç‰¹åˆ«ä¼˜åŒ–ï¼Œé€Ÿåº¦è¿œè¿œå¿«äºå¾ªç¯æ‰§è¡Œæ¯ä¸ª SQLã€‚</p><p>åœ¨ JDBC ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ SQL æ•°æ®åº“çš„è¿™ä¸€ç‰¹æ€§ï¼ŒæŠŠåŒä¸€ä¸ª SQL ä½†å‚æ•°ä¸åŒçš„è‹¥å¹²æ¬¡æ“ä½œåˆå¹¶ä¸ºä¸€ä¸ª batch æ‰§è¡Œã€‚æˆ‘ä»¬ä»¥æ‰¹é‡æ’å…¥ä¸ºä¾‹ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">&quot;INSERT INTO students (name, gender, grade, score) VALUES (?, ?, ?, ?)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¯¹åŒä¸€ä¸ª PreparedStatement åå¤è®¾ç½®å‚æ•°å¹¶è°ƒç”¨ addBatch():</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Student</span> s <span class="token operator">:</span> students<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span><span class="token function">setBoolean</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>gender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>grade<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ åˆ° batch</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// æ‰§è¡Œ batch:</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ns <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">:</span> ns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token string">&quot;inserted.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// batch ä¸­æ¯ä¸ª SQL æ‰§è¡Œçš„ç»“æœæ•°é‡</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œ batch å’Œæ‰§è¡Œä¸€ä¸ª SQL ä¸åŒç‚¹åœ¨äºï¼Œéœ€è¦å¯¹åŒä¸€ä¸ª <code>PreparedStatement</code> åå¤è®¾ç½®å‚æ•°å¹¶è°ƒç”¨ <code>addBatch()</code>ï¼Œè¿™æ ·å°±ç›¸å½“äºç»™ä¸€ä¸ª SQL åŠ ä¸Šäº†å¤šç»„å‚æ•°ï¼Œç›¸å½“äºå˜æˆäº† â€œå¤šè¡Œâ€SQLã€‚</p><p>ç¬¬äºŒä¸ªä¸åŒç‚¹æ˜¯è°ƒç”¨çš„ä¸æ˜¯ <code>executeUpdate()</code>ï¼Œè€Œæ˜¯ <code>executeBatch()</code>ï¼Œå› ä¸ºæˆ‘ä»¬è®¾ç½®äº†å¤šç»„å‚æ•°ï¼Œç›¸åº”åœ°ï¼Œè¿”å›ç»“æœä¹Ÿæ˜¯å¤šä¸ª <code>int</code> å€¼ï¼Œå› æ­¤è¿”å›ç±»å‹æ˜¯ <code>int[]</code>ï¼Œå¾ªç¯ <code>int[]</code> æ•°ç»„å³å¯è·å–æ¯ç»„å‚æ•°æ‰§è¡Œåå½±å“çš„ç»“æœæ•°é‡ã€‚</p><h2 id="ğŸ€-ç»ƒä¹ " tabindex="-1"><a class="header-anchor" href="#ğŸ€-ç»ƒä¹ " aria-hidden="true">#</a> ğŸ€ ç»ƒä¹ </h2><p>ä½¿ç”¨ Batch æ“ä½œ</p><h2 id="ğŸ€-å°ç»“" tabindex="-1"><a class="header-anchor" href="#ğŸ€-å°ç»“" aria-hidden="true">#</a> ğŸ€ å°ç»“</h2><p>ä½¿ç”¨ JDBC çš„ batch æ“ä½œä¼šå¤§å¤§æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œå¯¹å†…å®¹ç›¸åŒï¼Œå‚æ•°ä¸åŒçš„ SQLï¼Œè¦ä¼˜å…ˆè€ƒè™‘ batch æ“ä½œã€‚</p>`,16);function v(b,S){const s=o("router-link");return c(),u("div",null,[n("details",k,[r,n("nav",d,[n("ul",null,[n("li",null,[a(s,{to:"#ğŸ€-ç»ƒä¹ "},{default:t(()=>[p("ğŸ€ ç»ƒä¹ ")]),_:1})]),n("li",null,[a(s,{to:"#ğŸ€-å°ç»“"},{default:t(()=>[p("ğŸ€ å°ç»“")]),_:1})])])])]),m])}const y=e(i,[["render",v],["__file","5.html.vue"]]);export{y as default};
